function mS(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const l=Object.getOwnPropertyDescriptor(r,s);l&&Object.defineProperty(t,s,l.get?l:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function n(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerpolicy&&(l.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?l.credentials="include":s.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(s){if(s.ep)return;s.ep=!0;const l=n(s);fetch(s.href,l)}})();var gS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ie={exports:{}},gn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Of=Symbol.for("react.element"),Z3=Symbol.for("react.portal"),Y3=Symbol.for("react.fragment"),K3=Symbol.for("react.strict_mode"),J3=Symbol.for("react.profiler"),Q3=Symbol.for("react.provider"),eL=Symbol.for("react.context"),tL=Symbol.for("react.forward_ref"),nL=Symbol.for("react.suspense"),rL=Symbol.for("react.memo"),iL=Symbol.for("react.lazy"),Tw=Symbol.iterator;function sL(t){return t===null||typeof t!="object"?null:(t=Tw&&t[Tw]||t["@@iterator"],typeof t=="function"?t:null)}var _S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vS=Object.assign,xS={};function dh(t,e,n){this.props=t,this.context=e,this.refs=xS,this.updater=n||_S}dh.prototype.isReactComponent={};dh.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};dh.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function bS(){}bS.prototype=dh.prototype;function _x(t,e,n){this.props=t,this.context=e,this.refs=xS,this.updater=n||_S}var vx=_x.prototype=new bS;vx.constructor=_x;vS(vx,dh.prototype);vx.isPureReactComponent=!0;var Sw=Array.isArray,wS=Object.prototype.hasOwnProperty,xx={current:null},ES={key:!0,ref:!0,__self:!0,__source:!0};function TS(t,e,n){var r,s={},l=null,d=null;if(e!=null)for(r in e.ref!==void 0&&(d=e.ref),e.key!==void 0&&(l=""+e.key),e)wS.call(e,r)&&!ES.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var v=Array(c),w=0;w<c;w++)v[w]=arguments[w+2];s.children=v}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:Of,type:t,key:l,ref:d,props:s,_owner:xx.current}}function oL(t,e){return{$$typeof:Of,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function bx(t){return typeof t=="object"&&t!==null&&t.$$typeof===Of}function aL(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Aw=/\/+/g;function R_(t,e){return typeof t=="object"&&t!==null&&t.key!=null?aL(""+t.key):e.toString(36)}function Om(t,e,n,r,s){var l=typeof t;(l==="undefined"||l==="boolean")&&(t=null);var d=!1;if(t===null)d=!0;else switch(l){case"string":case"number":d=!0;break;case"object":switch(t.$$typeof){case Of:case Z3:d=!0}}if(d)return d=t,s=s(d),t=r===""?"."+R_(d,0):r,Sw(s)?(n="",t!=null&&(n=t.replace(Aw,"$&/")+"/"),Om(s,e,n,"",function(w){return w})):s!=null&&(bx(s)&&(s=oL(s,n+(!s.key||d&&d.key===s.key?"":(""+s.key).replace(Aw,"$&/")+"/")+t)),e.push(s)),1;if(d=0,r=r===""?".":r+":",Sw(t))for(var c=0;c<t.length;c++){l=t[c];var v=r+R_(l,c);d+=Om(l,e,n,v,s)}else if(v=sL(t),typeof v=="function")for(t=v.call(t),c=0;!(l=t.next()).done;)l=l.value,v=r+R_(l,c++),d+=Om(l,e,n,v,s);else if(l==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return d}function nm(t,e,n){if(t==null)return t;var r=[],s=0;return Om(t,r,"","",function(l){return e.call(n,l,s++)}),r}function lL(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var $i={current:null},Dm={transition:null},cL={ReactCurrentDispatcher:$i,ReactCurrentBatchConfig:Dm,ReactCurrentOwner:xx};gn.Children={map:nm,forEach:function(t,e,n){nm(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return nm(t,function(){e++}),e},toArray:function(t){return nm(t,function(e){return e})||[]},only:function(t){if(!bx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};gn.Component=dh;gn.Fragment=Y3;gn.Profiler=J3;gn.PureComponent=_x;gn.StrictMode=K3;gn.Suspense=nL;gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cL;gn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=vS({},t.props),s=t.key,l=t.ref,d=t._owner;if(e!=null){if(e.ref!==void 0&&(l=e.ref,d=xx.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(v in e)wS.call(e,v)&&!ES.hasOwnProperty(v)&&(r[v]=e[v]===void 0&&c!==void 0?c[v]:e[v])}var v=arguments.length-2;if(v===1)r.children=n;else if(1<v){c=Array(v);for(var w=0;w<v;w++)c[w]=arguments[w+2];r.children=c}return{$$typeof:Of,type:t.type,key:s,ref:l,props:r,_owner:d}};gn.createContext=function(t){return t={$$typeof:eL,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Q3,_context:t},t.Consumer=t};gn.createElement=TS;gn.createFactory=function(t){var e=TS.bind(null,t);return e.type=t,e};gn.createRef=function(){return{current:null}};gn.forwardRef=function(t){return{$$typeof:tL,render:t}};gn.isValidElement=bx;gn.lazy=function(t){return{$$typeof:iL,_payload:{_status:-1,_result:t},_init:lL}};gn.memo=function(t,e){return{$$typeof:rL,type:t,compare:e===void 0?null:e}};gn.startTransition=function(t){var e=Dm.transition;Dm.transition={};try{t()}finally{Dm.transition=e}};gn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};gn.useCallback=function(t,e){return $i.current.useCallback(t,e)};gn.useContext=function(t){return $i.current.useContext(t)};gn.useDebugValue=function(){};gn.useDeferredValue=function(t){return $i.current.useDeferredValue(t)};gn.useEffect=function(t,e){return $i.current.useEffect(t,e)};gn.useId=function(){return $i.current.useId()};gn.useImperativeHandle=function(t,e,n){return $i.current.useImperativeHandle(t,e,n)};gn.useInsertionEffect=function(t,e){return $i.current.useInsertionEffect(t,e)};gn.useLayoutEffect=function(t,e){return $i.current.useLayoutEffect(t,e)};gn.useMemo=function(t,e){return $i.current.useMemo(t,e)};gn.useReducer=function(t,e,n){return $i.current.useReducer(t,e,n)};gn.useRef=function(t){return $i.current.useRef(t)};gn.useState=function(t){return $i.current.useState(t)};gn.useSyncExternalStore=function(t,e,n){return $i.current.useSyncExternalStore(t,e,n)};gn.useTransition=function(){return $i.current.useTransition()};gn.version="18.2.0";(function(t){t.exports=gn})(Ie);const Fu=yS(Ie.exports),Pw=mS({__proto__:null,default:Fu},[Ie.exports]);var U0={},gl={exports:{}},Ps={},SS={exports:{}},AS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Ne,et){var _t=Ne.length;Ne.push(et);e:for(;0<_t;){var at=_t-1>>>1,Ot=Ne[at];if(0<s(Ot,et))Ne[at]=et,Ne[_t]=Ot,_t=at;else break e}}function n(Ne){return Ne.length===0?null:Ne[0]}function r(Ne){if(Ne.length===0)return null;var et=Ne[0],_t=Ne.pop();if(_t!==et){Ne[0]=_t;e:for(var at=0,Ot=Ne.length,tn=Ot>>>1;at<tn;){var $t=2*(at+1)-1,cn=Ne[$t],sn=$t+1,Bt=Ne[sn];if(0>s(cn,_t))sn<Ot&&0>s(Bt,cn)?(Ne[at]=Bt,Ne[sn]=_t,at=sn):(Ne[at]=cn,Ne[$t]=_t,at=$t);else if(sn<Ot&&0>s(Bt,_t))Ne[at]=Bt,Ne[sn]=_t,at=sn;else break e}}return et}function s(Ne,et){var _t=Ne.sortIndex-et.sortIndex;return _t!==0?_t:Ne.id-et.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var d=Date,c=d.now();t.unstable_now=function(){return d.now()-c}}var v=[],w=[],C=1,I=null,S=3,z=!1,F=!1,B=!1,Q=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function G(Ne){for(var et=n(w);et!==null;){if(et.callback===null)r(w);else if(et.startTime<=Ne)r(w),et.sortIndex=et.expirationTime,e(v,et);else break;et=n(w)}}function se(Ne){if(B=!1,G(Ne),!F)if(n(v)!==null)F=!0,Qe(he);else{var et=n(w);et!==null&&yn(se,et.startTime-Ne)}}function he(Ne,et){F=!1,B&&(B=!1,q(Be),Be=-1),z=!0;var _t=S;try{for(G(et),I=n(v);I!==null&&(!(I.expirationTime>et)||Ne&&!He());){var at=I.callback;if(typeof at=="function"){I.callback=null,S=I.priorityLevel;var Ot=at(I.expirationTime<=et);et=t.unstable_now(),typeof Ot=="function"?I.callback=Ot:I===n(v)&&r(v),G(et)}else r(v);I=n(v)}if(I!==null)var tn=!0;else{var $t=n(w);$t!==null&&yn(se,$t.startTime-et),tn=!1}return tn}finally{I=null,S=_t,z=!1}}var ye=!1,we=null,Be=-1,Ve=5,xe=-1;function He(){return!(t.unstable_now()-xe<Ve)}function wt(){if(we!==null){var Ne=t.unstable_now();xe=Ne;var et=!0;try{et=we(!0,Ne)}finally{et?yt():(ye=!1,we=null)}}else ye=!1}var yt;if(typeof j=="function")yt=function(){j(wt)};else if(typeof MessageChannel<"u"){var ot=new MessageChannel,zt=ot.port2;ot.port1.onmessage=wt,yt=function(){zt.postMessage(null)}}else yt=function(){Q(wt,0)};function Qe(Ne){we=Ne,ye||(ye=!0,yt())}function yn(Ne,et){Be=Q(function(){Ne(t.unstable_now())},et)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ne){Ne.callback=null},t.unstable_continueExecution=function(){F||z||(F=!0,Qe(he))},t.unstable_forceFrameRate=function(Ne){0>Ne||125<Ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ve=0<Ne?Math.floor(1e3/Ne):5},t.unstable_getCurrentPriorityLevel=function(){return S},t.unstable_getFirstCallbackNode=function(){return n(v)},t.unstable_next=function(Ne){switch(S){case 1:case 2:case 3:var et=3;break;default:et=S}var _t=S;S=et;try{return Ne()}finally{S=_t}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ne,et){switch(Ne){case 1:case 2:case 3:case 4:case 5:break;default:Ne=3}var _t=S;S=Ne;try{return et()}finally{S=_t}},t.unstable_scheduleCallback=function(Ne,et,_t){var at=t.unstable_now();switch(typeof _t=="object"&&_t!==null?(_t=_t.delay,_t=typeof _t=="number"&&0<_t?at+_t:at):_t=at,Ne){case 1:var Ot=-1;break;case 2:Ot=250;break;case 5:Ot=1073741823;break;case 4:Ot=1e4;break;default:Ot=5e3}return Ot=_t+Ot,Ne={id:C++,callback:et,priorityLevel:Ne,startTime:_t,expirationTime:Ot,sortIndex:-1},_t>at?(Ne.sortIndex=_t,e(w,Ne),n(v)===null&&Ne===n(w)&&(B?(q(Be),Be=-1):B=!0,yn(se,_t-at))):(Ne.sortIndex=Ot,e(v,Ne),F||z||(F=!0,Qe(he))),Ne},t.unstable_shouldYield=He,t.unstable_wrapCallback=function(Ne){var et=S;return function(){var _t=S;S=et;try{return Ne.apply(this,arguments)}finally{S=_t}}}})(AS);(function(t){t.exports=AS})(SS);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PS=Ie.exports,As=SS.exports;function qe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var CS=new Set,rf={};function Cc(t,e){Xu(t,e),Xu(t+"Capture",e)}function Xu(t,e){for(rf[t]=e,t=0;t<e.length;t++)CS.add(e[t])}var ma=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),V0=Object.prototype.hasOwnProperty,uL=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Cw={},Iw={};function hL(t){return V0.call(Iw,t)?!0:V0.call(Cw,t)?!1:uL.test(t)?Iw[t]=!0:(Cw[t]=!0,!1)}function dL(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function fL(t,e,n,r){if(e===null||typeof e>"u"||dL(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Wi(t,e,n,r,s,l,d){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=l,this.removeEmptyString=d}var fi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){fi[t]=new Wi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];fi[e]=new Wi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){fi[t]=new Wi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){fi[t]=new Wi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){fi[t]=new Wi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){fi[t]=new Wi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){fi[t]=new Wi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){fi[t]=new Wi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){fi[t]=new Wi(t,5,!1,t.toLowerCase(),null,!1,!1)});var wx=/[\-:]([a-z])/g;function Ex(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(wx,Ex);fi[e]=new Wi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(wx,Ex);fi[e]=new Wi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(wx,Ex);fi[e]=new Wi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){fi[t]=new Wi(t,1,!1,t.toLowerCase(),null,!1,!1)});fi.xlinkHref=new Wi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){fi[t]=new Wi(t,1,!1,t.toLowerCase(),null,!0,!0)});function Tx(t,e,n,r){var s=fi.hasOwnProperty(e)?fi[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(fL(e,n,s,r)&&(n=null),r||s===null?hL(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var wa=PS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,rm=Symbol.for("react.element"),wu=Symbol.for("react.portal"),Eu=Symbol.for("react.fragment"),Sx=Symbol.for("react.strict_mode"),j0=Symbol.for("react.profiler"),IS=Symbol.for("react.provider"),kS=Symbol.for("react.context"),Ax=Symbol.for("react.forward_ref"),G0=Symbol.for("react.suspense"),$0=Symbol.for("react.suspense_list"),Px=Symbol.for("react.memo"),Qa=Symbol.for("react.lazy"),MS=Symbol.for("react.offscreen"),kw=Symbol.iterator;function fd(t){return t===null||typeof t!="object"?null:(t=kw&&t[kw]||t["@@iterator"],typeof t=="function"?t:null)}var yr=Object.assign,O_;function Md(t){if(O_===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);O_=e&&e[1]||""}return`
`+O_+t}var D_=!1;function z_(t,e){if(!t||D_)return"";D_=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(w){var r=w}Reflect.construct(t,[],e)}else{try{e.call()}catch(w){r=w}t.call(e.prototype)}else{try{throw Error()}catch(w){r=w}t()}}catch(w){if(w&&r&&typeof w.stack=="string"){for(var s=w.stack.split(`
`),l=r.stack.split(`
`),d=s.length-1,c=l.length-1;1<=d&&0<=c&&s[d]!==l[c];)c--;for(;1<=d&&0<=c;d--,c--)if(s[d]!==l[c]){if(d!==1||c!==1)do if(d--,c--,0>c||s[d]!==l[c]){var v=`
`+s[d].replace(" at new "," at ");return t.displayName&&v.includes("<anonymous>")&&(v=v.replace("<anonymous>",t.displayName)),v}while(1<=d&&0<=c);break}}}finally{D_=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Md(t):""}function pL(t){switch(t.tag){case 5:return Md(t.type);case 16:return Md("Lazy");case 13:return Md("Suspense");case 19:return Md("SuspenseList");case 0:case 2:case 15:return t=z_(t.type,!1),t;case 11:return t=z_(t.type.render,!1),t;case 1:return t=z_(t.type,!0),t;default:return""}}function W0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Eu:return"Fragment";case wu:return"Portal";case j0:return"Profiler";case Sx:return"StrictMode";case G0:return"Suspense";case $0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case kS:return(t.displayName||"Context")+".Consumer";case IS:return(t._context.displayName||"Context")+".Provider";case Ax:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Px:return e=t.displayName||null,e!==null?e:W0(t.type)||"Memo";case Qa:e=t._payload,t=t._init;try{return W0(t(e))}catch{}}return null}function mL(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W0(e);case 8:return e===Sx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function yl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function LS(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function gL(t){var e=LS(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,l=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(d){r=""+d,l.call(this,d)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(d){r=""+d},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function im(t){t._valueTracker||(t._valueTracker=gL(t))}function RS(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=LS(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function sg(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function H0(t,e){var n=e.checked;return yr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n!=null?n:t._wrapperState.initialChecked})}function Mw(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=yl(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function OS(t,e){e=e.checked,e!=null&&Tx(t,"checked",e,!1)}function q0(t,e){OS(t,e);var n=yl(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?X0(t,e.type,n):e.hasOwnProperty("defaultValue")&&X0(t,e.type,yl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Lw(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function X0(t,e,n){(e!=="number"||sg(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ld=Array.isArray;function Bu(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+yl(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Z0(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(qe(91));return yr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Rw(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(qe(92));if(Ld(n)){if(1<n.length)throw Error(qe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:yl(n)}}function DS(t,e){var n=yl(e.value),r=yl(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Ow(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function zS(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Y0(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?zS(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var sm,FS=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(sm=sm||document.createElement("div"),sm.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=sm.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function sf(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ud={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},yL=["Webkit","ms","Moz","O"];Object.keys(Ud).forEach(function(t){yL.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ud[e]=Ud[t]})});function BS(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ud.hasOwnProperty(t)&&Ud[t]?(""+e).trim():e+"px"}function NS(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=BS(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var _L=yr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function K0(t,e){if(e){if(_L[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(qe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(qe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(qe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(qe(62))}}function J0(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Q0=null;function Cx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ev=null,Nu=null,Uu=null;function Dw(t){if(t=Ff(t)){if(typeof ev!="function")throw Error(qe(280));var e=t.stateNode;e&&(e=Qg(e),ev(t.stateNode,t.type,e))}}function US(t){Nu?Uu?Uu.push(t):Uu=[t]:Nu=t}function VS(){if(Nu){var t=Nu,e=Uu;if(Uu=Nu=null,Dw(t),e)for(t=0;t<e.length;t++)Dw(e[t])}}function jS(t,e){return t(e)}function GS(){}var F_=!1;function $S(t,e,n){if(F_)return t(e,n);F_=!0;try{return jS(t,e,n)}finally{F_=!1,(Nu!==null||Uu!==null)&&(GS(),VS())}}function of(t,e){var n=t.stateNode;if(n===null)return null;var r=Qg(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(qe(231,e,typeof n));return n}var tv=!1;if(ma)try{var pd={};Object.defineProperty(pd,"passive",{get:function(){tv=!0}}),window.addEventListener("test",pd,pd),window.removeEventListener("test",pd,pd)}catch{tv=!1}function vL(t,e,n,r,s,l,d,c,v){var w=Array.prototype.slice.call(arguments,3);try{e.apply(n,w)}catch(C){this.onError(C)}}var Vd=!1,og=null,ag=!1,nv=null,xL={onError:function(t){Vd=!0,og=t}};function bL(t,e,n,r,s,l,d,c,v){Vd=!1,og=null,vL.apply(xL,arguments)}function wL(t,e,n,r,s,l,d,c,v){if(bL.apply(this,arguments),Vd){if(Vd){var w=og;Vd=!1,og=null}else throw Error(qe(198));ag||(ag=!0,nv=w)}}function Ic(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,(e.flags&4098)!==0&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function WS(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function zw(t){if(Ic(t)!==t)throw Error(qe(188))}function EL(t){var e=t.alternate;if(!e){if(e=Ic(t),e===null)throw Error(qe(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var l=s.alternate;if(l===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===l.child){for(l=s.child;l;){if(l===n)return zw(s),t;if(l===r)return zw(s),e;l=l.sibling}throw Error(qe(188))}if(n.return!==r.return)n=s,r=l;else{for(var d=!1,c=s.child;c;){if(c===n){d=!0,n=s,r=l;break}if(c===r){d=!0,r=s,n=l;break}c=c.sibling}if(!d){for(c=l.child;c;){if(c===n){d=!0,n=l,r=s;break}if(c===r){d=!0,r=l,n=s;break}c=c.sibling}if(!d)throw Error(qe(189))}}if(n.alternate!==r)throw Error(qe(190))}if(n.tag!==3)throw Error(qe(188));return n.stateNode.current===n?t:e}function HS(t){return t=EL(t),t!==null?qS(t):null}function qS(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=qS(t);if(e!==null)return e;t=t.sibling}return null}var XS=As.unstable_scheduleCallback,Fw=As.unstable_cancelCallback,TL=As.unstable_shouldYield,SL=As.unstable_requestPaint,Ir=As.unstable_now,AL=As.unstable_getCurrentPriorityLevel,Ix=As.unstable_ImmediatePriority,ZS=As.unstable_UserBlockingPriority,lg=As.unstable_NormalPriority,PL=As.unstable_LowPriority,YS=As.unstable_IdlePriority,Zg=null,Uo=null;function CL(t){if(Uo&&typeof Uo.onCommitFiberRoot=="function")try{Uo.onCommitFiberRoot(Zg,t,void 0,(t.current.flags&128)===128)}catch{}}var uo=Math.clz32?Math.clz32:ML,IL=Math.log,kL=Math.LN2;function ML(t){return t>>>=0,t===0?32:31-(IL(t)/kL|0)|0}var om=64,am=4194304;function Rd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function cg(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,l=t.pingedLanes,d=n&268435455;if(d!==0){var c=d&~s;c!==0?r=Rd(c):(l&=d,l!==0&&(r=Rd(l)))}else d=n&~s,d!==0?r=Rd(d):l!==0&&(r=Rd(l));if(r===0)return 0;if(e!==0&&e!==r&&(e&s)===0&&(s=r&-r,l=e&-e,s>=l||s===16&&(l&4194240)!==0))return e;if((r&4)!==0&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-uo(e),s=1<<n,r|=t[n],e&=~s;return r}function LL(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function RL(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,l=t.pendingLanes;0<l;){var d=31-uo(l),c=1<<d,v=s[d];v===-1?((c&n)===0||(c&r)!==0)&&(s[d]=LL(c,e)):v<=e&&(t.expiredLanes|=c),l&=~c}}function rv(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function KS(){var t=om;return om<<=1,(om&4194240)===0&&(om=64),t}function B_(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Df(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-uo(e),t[e]=n}function OL(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-uo(n),l=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~l}}function kx(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-uo(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Nn=0;function JS(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var QS,Mx,eA,tA,nA,iv=!1,lm=[],al=null,ll=null,cl=null,af=new Map,lf=new Map,tl=[],DL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bw(t,e){switch(t){case"focusin":case"focusout":al=null;break;case"dragenter":case"dragleave":ll=null;break;case"mouseover":case"mouseout":cl=null;break;case"pointerover":case"pointerout":af.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":lf.delete(e.pointerId)}}function md(t,e,n,r,s,l){return t===null||t.nativeEvent!==l?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:l,targetContainers:[s]},e!==null&&(e=Ff(e),e!==null&&Mx(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function zL(t,e,n,r,s){switch(e){case"focusin":return al=md(al,t,e,n,r,s),!0;case"dragenter":return ll=md(ll,t,e,n,r,s),!0;case"mouseover":return cl=md(cl,t,e,n,r,s),!0;case"pointerover":var l=s.pointerId;return af.set(l,md(af.get(l)||null,t,e,n,r,s)),!0;case"gotpointercapture":return l=s.pointerId,lf.set(l,md(lf.get(l)||null,t,e,n,r,s)),!0}return!1}function rA(t){var e=dc(t.target);if(e!==null){var n=Ic(e);if(n!==null){if(e=n.tag,e===13){if(e=WS(n),e!==null){t.blockedOn=e,nA(t.priority,function(){eA(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function zm(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=sv(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Q0=r,n.target.dispatchEvent(r),Q0=null}else return e=Ff(n),e!==null&&Mx(e),t.blockedOn=n,!1;e.shift()}return!0}function Nw(t,e,n){zm(t)&&n.delete(e)}function FL(){iv=!1,al!==null&&zm(al)&&(al=null),ll!==null&&zm(ll)&&(ll=null),cl!==null&&zm(cl)&&(cl=null),af.forEach(Nw),lf.forEach(Nw)}function gd(t,e){t.blockedOn===e&&(t.blockedOn=null,iv||(iv=!0,As.unstable_scheduleCallback(As.unstable_NormalPriority,FL)))}function cf(t){function e(s){return gd(s,t)}if(0<lm.length){gd(lm[0],t);for(var n=1;n<lm.length;n++){var r=lm[n];r.blockedOn===t&&(r.blockedOn=null)}}for(al!==null&&gd(al,t),ll!==null&&gd(ll,t),cl!==null&&gd(cl,t),af.forEach(e),lf.forEach(e),n=0;n<tl.length;n++)r=tl[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<tl.length&&(n=tl[0],n.blockedOn===null);)rA(n),n.blockedOn===null&&tl.shift()}var Vu=wa.ReactCurrentBatchConfig,ug=!0;function BL(t,e,n,r){var s=Nn,l=Vu.transition;Vu.transition=null;try{Nn=1,Lx(t,e,n,r)}finally{Nn=s,Vu.transition=l}}function NL(t,e,n,r){var s=Nn,l=Vu.transition;Vu.transition=null;try{Nn=4,Lx(t,e,n,r)}finally{Nn=s,Vu.transition=l}}function Lx(t,e,n,r){if(ug){var s=sv(t,e,n,r);if(s===null)X_(t,e,r,hg,n),Bw(t,r);else if(zL(s,t,e,n,r))r.stopPropagation();else if(Bw(t,r),e&4&&-1<DL.indexOf(t)){for(;s!==null;){var l=Ff(s);if(l!==null&&QS(l),l=sv(t,e,n,r),l===null&&X_(t,e,r,hg,n),l===s)break;s=l}s!==null&&r.stopPropagation()}else X_(t,e,r,null,n)}}var hg=null;function sv(t,e,n,r){if(hg=null,t=Cx(r),t=dc(t),t!==null)if(e=Ic(t),e===null)t=null;else if(n=e.tag,n===13){if(t=WS(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return hg=t,null}function iA(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(AL()){case Ix:return 1;case ZS:return 4;case lg:case PL:return 16;case YS:return 536870912;default:return 16}default:return 16}}var il=null,Rx=null,Fm=null;function sA(){if(Fm)return Fm;var t,e=Rx,n=e.length,r,s="value"in il?il.value:il.textContent,l=s.length;for(t=0;t<n&&e[t]===s[t];t++);var d=n-t;for(r=1;r<=d&&e[n-r]===s[l-r];r++);return Fm=s.slice(t,1<r?1-r:void 0)}function Bm(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function cm(){return!0}function Uw(){return!1}function Cs(t){function e(n,r,s,l,d){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=l,this.target=d,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(l):l[c]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?cm:Uw,this.isPropagationStopped=Uw,this}return yr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=cm)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=cm)},persist:function(){},isPersistent:cm}),e}var fh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ox=Cs(fh),zf=yr({},fh,{view:0,detail:0}),UL=Cs(zf),N_,U_,yd,Yg=yr({},zf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Dx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==yd&&(yd&&t.type==="mousemove"?(N_=t.screenX-yd.screenX,U_=t.screenY-yd.screenY):U_=N_=0,yd=t),N_)},movementY:function(t){return"movementY"in t?t.movementY:U_}}),Vw=Cs(Yg),VL=yr({},Yg,{dataTransfer:0}),jL=Cs(VL),GL=yr({},zf,{relatedTarget:0}),V_=Cs(GL),$L=yr({},fh,{animationName:0,elapsedTime:0,pseudoElement:0}),WL=Cs($L),HL=yr({},fh,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),qL=Cs(HL),XL=yr({},fh,{data:0}),jw=Cs(XL),ZL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},YL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},KL={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function JL(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=KL[t])?!!e[t]:!1}function Dx(){return JL}var QL=yr({},zf,{key:function(t){if(t.key){var e=ZL[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Bm(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?YL[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Dx,charCode:function(t){return t.type==="keypress"?Bm(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Bm(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),eR=Cs(QL),tR=yr({},Yg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gw=Cs(tR),nR=yr({},zf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Dx}),rR=Cs(nR),iR=yr({},fh,{propertyName:0,elapsedTime:0,pseudoElement:0}),sR=Cs(iR),oR=yr({},Yg,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),aR=Cs(oR),lR=[9,13,27,32],zx=ma&&"CompositionEvent"in window,jd=null;ma&&"documentMode"in document&&(jd=document.documentMode);var cR=ma&&"TextEvent"in window&&!jd,oA=ma&&(!zx||jd&&8<jd&&11>=jd),$w=String.fromCharCode(32),Ww=!1;function aA(t,e){switch(t){case"keyup":return lR.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lA(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Tu=!1;function uR(t,e){switch(t){case"compositionend":return lA(e);case"keypress":return e.which!==32?null:(Ww=!0,$w);case"textInput":return t=e.data,t===$w&&Ww?null:t;default:return null}}function hR(t,e){if(Tu)return t==="compositionend"||!zx&&aA(t,e)?(t=sA(),Fm=Rx=il=null,Tu=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return oA&&e.locale!=="ko"?null:e.data;default:return null}}var dR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!dR[t.type]:e==="textarea"}function cA(t,e,n,r){US(r),e=dg(e,"onChange"),0<e.length&&(n=new Ox("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Gd=null,uf=null;function fR(t){xA(t,0)}function Kg(t){var e=Pu(t);if(RS(e))return t}function pR(t,e){if(t==="change")return e}var uA=!1;if(ma){var j_;if(ma){var G_="oninput"in document;if(!G_){var qw=document.createElement("div");qw.setAttribute("oninput","return;"),G_=typeof qw.oninput=="function"}j_=G_}else j_=!1;uA=j_&&(!document.documentMode||9<document.documentMode)}function Xw(){Gd&&(Gd.detachEvent("onpropertychange",hA),uf=Gd=null)}function hA(t){if(t.propertyName==="value"&&Kg(uf)){var e=[];cA(e,uf,t,Cx(t)),$S(fR,e)}}function mR(t,e,n){t==="focusin"?(Xw(),Gd=e,uf=n,Gd.attachEvent("onpropertychange",hA)):t==="focusout"&&Xw()}function gR(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Kg(uf)}function yR(t,e){if(t==="click")return Kg(e)}function _R(t,e){if(t==="input"||t==="change")return Kg(e)}function vR(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var mo=typeof Object.is=="function"?Object.is:vR;function hf(t,e){if(mo(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!V0.call(e,s)||!mo(t[s],e[s]))return!1}return!0}function Zw(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Yw(t,e){var n=Zw(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Zw(n)}}function dA(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?dA(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function fA(){for(var t=window,e=sg();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=sg(t.document)}return e}function Fx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function xR(t){var e=fA(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&dA(n.ownerDocument.documentElement,n)){if(r!==null&&Fx(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,l=Math.min(r.start,s);r=r.end===void 0?l:Math.min(r.end,s),!t.extend&&l>r&&(s=r,r=l,l=s),s=Yw(n,l);var d=Yw(n,r);s&&d&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==d.node||t.focusOffset!==d.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),l>r?(t.addRange(e),t.extend(d.node,d.offset)):(e.setEnd(d.node,d.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var bR=ma&&"documentMode"in document&&11>=document.documentMode,Su=null,ov=null,$d=null,av=!1;function Kw(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;av||Su==null||Su!==sg(r)||(r=Su,"selectionStart"in r&&Fx(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),$d&&hf($d,r)||($d=r,r=dg(ov,"onSelect"),0<r.length&&(e=new Ox("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Su)))}function um(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Au={animationend:um("Animation","AnimationEnd"),animationiteration:um("Animation","AnimationIteration"),animationstart:um("Animation","AnimationStart"),transitionend:um("Transition","TransitionEnd")},$_={},pA={};ma&&(pA=document.createElement("div").style,"AnimationEvent"in window||(delete Au.animationend.animation,delete Au.animationiteration.animation,delete Au.animationstart.animation),"TransitionEvent"in window||delete Au.transitionend.transition);function Jg(t){if($_[t])return $_[t];if(!Au[t])return t;var e=Au[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in pA)return $_[t]=e[n];return t}var mA=Jg("animationend"),gA=Jg("animationiteration"),yA=Jg("animationstart"),_A=Jg("transitionend"),vA=new Map,Jw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bl(t,e){vA.set(t,e),Cc(e,[t])}for(var W_=0;W_<Jw.length;W_++){var H_=Jw[W_],wR=H_.toLowerCase(),ER=H_[0].toUpperCase()+H_.slice(1);bl(wR,"on"+ER)}bl(mA,"onAnimationEnd");bl(gA,"onAnimationIteration");bl(yA,"onAnimationStart");bl("dblclick","onDoubleClick");bl("focusin","onFocus");bl("focusout","onBlur");bl(_A,"onTransitionEnd");Xu("onMouseEnter",["mouseout","mouseover"]);Xu("onMouseLeave",["mouseout","mouseover"]);Xu("onPointerEnter",["pointerout","pointerover"]);Xu("onPointerLeave",["pointerout","pointerover"]);Cc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Cc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Cc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Cc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Cc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Cc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Od="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),TR=new Set("cancel close invalid load scroll toggle".split(" ").concat(Od));function Qw(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,wL(r,e,void 0,t),t.currentTarget=null}function xA(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var l=void 0;if(e)for(var d=r.length-1;0<=d;d--){var c=r[d],v=c.instance,w=c.currentTarget;if(c=c.listener,v!==l&&s.isPropagationStopped())break e;Qw(s,c,w),l=v}else for(d=0;d<r.length;d++){if(c=r[d],v=c.instance,w=c.currentTarget,c=c.listener,v!==l&&s.isPropagationStopped())break e;Qw(s,c,w),l=v}}}if(ag)throw t=nv,ag=!1,nv=null,t}function ir(t,e){var n=e[dv];n===void 0&&(n=e[dv]=new Set);var r=t+"__bubble";n.has(r)||(bA(e,t,2,!1),n.add(r))}function q_(t,e,n){var r=0;e&&(r|=4),bA(n,t,r,e)}var hm="_reactListening"+Math.random().toString(36).slice(2);function df(t){if(!t[hm]){t[hm]=!0,CS.forEach(function(n){n!=="selectionchange"&&(TR.has(n)||q_(n,!1,t),q_(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[hm]||(e[hm]=!0,q_("selectionchange",!1,e))}}function bA(t,e,n,r){switch(iA(e)){case 1:var s=BL;break;case 4:s=NL;break;default:s=Lx}n=s.bind(null,e,n,t),s=void 0,!tv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function X_(t,e,n,r,s){var l=r;if((e&1)===0&&(e&2)===0&&r!==null)e:for(;;){if(r===null)return;var d=r.tag;if(d===3||d===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(d===4)for(d=r.return;d!==null;){var v=d.tag;if((v===3||v===4)&&(v=d.stateNode.containerInfo,v===s||v.nodeType===8&&v.parentNode===s))return;d=d.return}for(;c!==null;){if(d=dc(c),d===null)return;if(v=d.tag,v===5||v===6){r=l=d;continue e}c=c.parentNode}}r=r.return}$S(function(){var w=l,C=Cx(n),I=[];e:{var S=vA.get(t);if(S!==void 0){var z=Ox,F=t;switch(t){case"keypress":if(Bm(n)===0)break e;case"keydown":case"keyup":z=eR;break;case"focusin":F="focus",z=V_;break;case"focusout":F="blur",z=V_;break;case"beforeblur":case"afterblur":z=V_;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":z=Vw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":z=jL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":z=rR;break;case mA:case gA:case yA:z=WL;break;case _A:z=sR;break;case"scroll":z=UL;break;case"wheel":z=aR;break;case"copy":case"cut":case"paste":z=qL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":z=Gw}var B=(e&4)!==0,Q=!B&&t==="scroll",q=B?S!==null?S+"Capture":null:S;B=[];for(var j=w,G;j!==null;){G=j;var se=G.stateNode;if(G.tag===5&&se!==null&&(G=se,q!==null&&(se=of(j,q),se!=null&&B.push(ff(j,se,G)))),Q)break;j=j.return}0<B.length&&(S=new z(S,F,null,n,C),I.push({event:S,listeners:B}))}}if((e&7)===0){e:{if(S=t==="mouseover"||t==="pointerover",z=t==="mouseout"||t==="pointerout",S&&n!==Q0&&(F=n.relatedTarget||n.fromElement)&&(dc(F)||F[ga]))break e;if((z||S)&&(S=C.window===C?C:(S=C.ownerDocument)?S.defaultView||S.parentWindow:window,z?(F=n.relatedTarget||n.toElement,z=w,F=F?dc(F):null,F!==null&&(Q=Ic(F),F!==Q||F.tag!==5&&F.tag!==6)&&(F=null)):(z=null,F=w),z!==F)){if(B=Vw,se="onMouseLeave",q="onMouseEnter",j="mouse",(t==="pointerout"||t==="pointerover")&&(B=Gw,se="onPointerLeave",q="onPointerEnter",j="pointer"),Q=z==null?S:Pu(z),G=F==null?S:Pu(F),S=new B(se,j+"leave",z,n,C),S.target=Q,S.relatedTarget=G,se=null,dc(C)===w&&(B=new B(q,j+"enter",F,n,C),B.target=G,B.relatedTarget=Q,se=B),Q=se,z&&F)t:{for(B=z,q=F,j=0,G=B;G;G=au(G))j++;for(G=0,se=q;se;se=au(se))G++;for(;0<j-G;)B=au(B),j--;for(;0<G-j;)q=au(q),G--;for(;j--;){if(B===q||q!==null&&B===q.alternate)break t;B=au(B),q=au(q)}B=null}else B=null;z!==null&&eE(I,S,z,B,!1),F!==null&&Q!==null&&eE(I,Q,F,B,!0)}}e:{if(S=w?Pu(w):window,z=S.nodeName&&S.nodeName.toLowerCase(),z==="select"||z==="input"&&S.type==="file")var he=pR;else if(Hw(S))if(uA)he=_R;else{he=gR;var ye=mR}else(z=S.nodeName)&&z.toLowerCase()==="input"&&(S.type==="checkbox"||S.type==="radio")&&(he=yR);if(he&&(he=he(t,w))){cA(I,he,n,C);break e}ye&&ye(t,S,w),t==="focusout"&&(ye=S._wrapperState)&&ye.controlled&&S.type==="number"&&X0(S,"number",S.value)}switch(ye=w?Pu(w):window,t){case"focusin":(Hw(ye)||ye.contentEditable==="true")&&(Su=ye,ov=w,$d=null);break;case"focusout":$d=ov=Su=null;break;case"mousedown":av=!0;break;case"contextmenu":case"mouseup":case"dragend":av=!1,Kw(I,n,C);break;case"selectionchange":if(bR)break;case"keydown":case"keyup":Kw(I,n,C)}var we;if(zx)e:{switch(t){case"compositionstart":var Be="onCompositionStart";break e;case"compositionend":Be="onCompositionEnd";break e;case"compositionupdate":Be="onCompositionUpdate";break e}Be=void 0}else Tu?aA(t,n)&&(Be="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(Be="onCompositionStart");Be&&(oA&&n.locale!=="ko"&&(Tu||Be!=="onCompositionStart"?Be==="onCompositionEnd"&&Tu&&(we=sA()):(il=C,Rx="value"in il?il.value:il.textContent,Tu=!0)),ye=dg(w,Be),0<ye.length&&(Be=new jw(Be,t,null,n,C),I.push({event:Be,listeners:ye}),we?Be.data=we:(we=lA(n),we!==null&&(Be.data=we)))),(we=cR?uR(t,n):hR(t,n))&&(w=dg(w,"onBeforeInput"),0<w.length&&(C=new jw("onBeforeInput","beforeinput",null,n,C),I.push({event:C,listeners:w}),C.data=we))}xA(I,e)})}function ff(t,e,n){return{instance:t,listener:e,currentTarget:n}}function dg(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,l=s.stateNode;s.tag===5&&l!==null&&(s=l,l=of(t,n),l!=null&&r.unshift(ff(t,l,s)),l=of(t,e),l!=null&&r.push(ff(t,l,s))),t=t.return}return r}function au(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function eE(t,e,n,r,s){for(var l=e._reactName,d=[];n!==null&&n!==r;){var c=n,v=c.alternate,w=c.stateNode;if(v!==null&&v===r)break;c.tag===5&&w!==null&&(c=w,s?(v=of(n,l),v!=null&&d.unshift(ff(n,v,c))):s||(v=of(n,l),v!=null&&d.push(ff(n,v,c)))),n=n.return}d.length!==0&&t.push({event:e,listeners:d})}var SR=/\r\n?/g,AR=/\u0000|\uFFFD/g;function tE(t){return(typeof t=="string"?t:""+t).replace(SR,`
`).replace(AR,"")}function dm(t,e,n){if(e=tE(e),tE(t)!==e&&n)throw Error(qe(425))}function fg(){}var lv=null,cv=null;function uv(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var hv=typeof setTimeout=="function"?setTimeout:void 0,PR=typeof clearTimeout=="function"?clearTimeout:void 0,nE=typeof Promise=="function"?Promise:void 0,CR=typeof queueMicrotask=="function"?queueMicrotask:typeof nE<"u"?function(t){return nE.resolve(null).then(t).catch(IR)}:hv;function IR(t){setTimeout(function(){throw t})}function Z_(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),cf(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);cf(e)}function ul(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function rE(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ph=Math.random().toString(36).slice(2),zo="__reactFiber$"+ph,pf="__reactProps$"+ph,ga="__reactContainer$"+ph,dv="__reactEvents$"+ph,kR="__reactListeners$"+ph,MR="__reactHandles$"+ph;function dc(t){var e=t[zo];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ga]||n[zo]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=rE(t);t!==null;){if(n=t[zo])return n;t=rE(t)}return e}t=n,n=t.parentNode}return null}function Ff(t){return t=t[zo]||t[ga],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Pu(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(qe(33))}function Qg(t){return t[pf]||null}var fv=[],Cu=-1;function wl(t){return{current:t}}function sr(t){0>Cu||(t.current=fv[Cu],fv[Cu]=null,Cu--)}function tr(t,e){Cu++,fv[Cu]=t.current,t.current=e}var _l={},Pi=wl(_l),ts=wl(!1),vc=_l;function Zu(t,e){var n=t.type.contextTypes;if(!n)return _l;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},l;for(l in n)s[l]=e[l];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function ns(t){return t=t.childContextTypes,t!=null}function pg(){sr(ts),sr(Pi)}function iE(t,e,n){if(Pi.current!==_l)throw Error(qe(168));tr(Pi,e),tr(ts,n)}function wA(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(qe(108,mL(t)||"Unknown",s));return yr({},n,r)}function mg(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||_l,vc=Pi.current,tr(Pi,t),tr(ts,ts.current),!0}function sE(t,e,n){var r=t.stateNode;if(!r)throw Error(qe(169));n?(t=wA(t,e,vc),r.__reactInternalMemoizedMergedChildContext=t,sr(ts),sr(Pi),tr(Pi,t)):sr(ts),tr(ts,n)}var la=null,ey=!1,Y_=!1;function EA(t){la===null?la=[t]:la.push(t)}function LR(t){ey=!0,EA(t)}function El(){if(!Y_&&la!==null){Y_=!0;var t=0,e=Nn;try{var n=la;for(Nn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}la=null,ey=!1}catch(s){throw la!==null&&(la=la.slice(t+1)),XS(Ix,El),s}finally{Nn=e,Y_=!1}}return null}var Iu=[],ku=0,gg=null,yg=0,Ns=[],Us=0,xc=null,ua=1,ha="";function ac(t,e){Iu[ku++]=yg,Iu[ku++]=gg,gg=t,yg=e}function TA(t,e,n){Ns[Us++]=ua,Ns[Us++]=ha,Ns[Us++]=xc,xc=t;var r=ua;t=ha;var s=32-uo(r)-1;r&=~(1<<s),n+=1;var l=32-uo(e)+s;if(30<l){var d=s-s%5;l=(r&(1<<d)-1).toString(32),r>>=d,s-=d,ua=1<<32-uo(e)+s|n<<s|r,ha=l+t}else ua=1<<l|n<<s|r,ha=t}function Bx(t){t.return!==null&&(ac(t,1),TA(t,1,0))}function Nx(t){for(;t===gg;)gg=Iu[--ku],Iu[ku]=null,yg=Iu[--ku],Iu[ku]=null;for(;t===xc;)xc=Ns[--Us],Ns[Us]=null,ha=Ns[--Us],Ns[Us]=null,ua=Ns[--Us],Ns[Us]=null}var Es=null,bs=null,dr=!1,lo=null;function SA(t,e){var n=Vs(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function oE(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Es=t,bs=ul(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Es=t,bs=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=xc!==null?{id:ua,overflow:ha}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Vs(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Es=t,bs=null,!0):!1;default:return!1}}function pv(t){return(t.mode&1)!==0&&(t.flags&128)===0}function mv(t){if(dr){var e=bs;if(e){var n=e;if(!oE(t,e)){if(pv(t))throw Error(qe(418));e=ul(n.nextSibling);var r=Es;e&&oE(t,e)?SA(r,n):(t.flags=t.flags&-4097|2,dr=!1,Es=t)}}else{if(pv(t))throw Error(qe(418));t.flags=t.flags&-4097|2,dr=!1,Es=t}}}function aE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Es=t}function fm(t){if(t!==Es)return!1;if(!dr)return aE(t),dr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!uv(t.type,t.memoizedProps)),e&&(e=bs)){if(pv(t))throw AA(),Error(qe(418));for(;e;)SA(t,e),e=ul(e.nextSibling)}if(aE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(qe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){bs=ul(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}bs=null}}else bs=Es?ul(t.stateNode.nextSibling):null;return!0}function AA(){for(var t=bs;t;)t=ul(t.nextSibling)}function Yu(){bs=Es=null,dr=!1}function Ux(t){lo===null?lo=[t]:lo.push(t)}var RR=wa.ReactCurrentBatchConfig;function oo(t,e){if(t&&t.defaultProps){e=yr({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var _g=wl(null),vg=null,Mu=null,Vx=null;function jx(){Vx=Mu=vg=null}function Gx(t){var e=_g.current;sr(_g),t._currentValue=e}function gv(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ju(t,e){vg=t,Vx=Mu=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&e)!==0&&(Qi=!0),t.firstContext=null)}function Ws(t){var e=t._currentValue;if(Vx!==t)if(t={context:t,memoizedValue:e,next:null},Mu===null){if(vg===null)throw Error(qe(308));Mu=t,vg.dependencies={lanes:0,firstContext:t}}else Mu=Mu.next=t;return e}var fc=null;function $x(t){fc===null?fc=[t]:fc.push(t)}function PA(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,$x(e)):(n.next=s.next,s.next=n),e.interleaved=n,ya(t,r)}function ya(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var el=!1;function Wx(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function CA(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function da(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function hl(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,(Tn&2)!==0){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,ya(t,n)}return s=r.interleaved,s===null?(e.next=e,$x(r)):(e.next=s.next,s.next=e),r.interleaved=e,ya(t,n)}function Nm(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,kx(t,n)}}function lE(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var d={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?s=l=d:l=l.next=d,n=n.next}while(n!==null);l===null?s=l=e:l=l.next=e}else s=l=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:l,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function xg(t,e,n,r){var s=t.updateQueue;el=!1;var l=s.firstBaseUpdate,d=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var v=c,w=v.next;v.next=null,d===null?l=w:d.next=w,d=v;var C=t.alternate;C!==null&&(C=C.updateQueue,c=C.lastBaseUpdate,c!==d&&(c===null?C.firstBaseUpdate=w:c.next=w,C.lastBaseUpdate=v))}if(l!==null){var I=s.baseState;d=0,C=w=v=null,c=l;do{var S=c.lane,z=c.eventTime;if((r&S)===S){C!==null&&(C=C.next={eventTime:z,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var F=t,B=c;switch(S=e,z=n,B.tag){case 1:if(F=B.payload,typeof F=="function"){I=F.call(z,I,S);break e}I=F;break e;case 3:F.flags=F.flags&-65537|128;case 0:if(F=B.payload,S=typeof F=="function"?F.call(z,I,S):F,S==null)break e;I=yr({},I,S);break e;case 2:el=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,S=s.effects,S===null?s.effects=[c]:S.push(c))}else z={eventTime:z,lane:S,tag:c.tag,payload:c.payload,callback:c.callback,next:null},C===null?(w=C=z,v=I):C=C.next=z,d|=S;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;S=c,c=S.next,S.next=null,s.lastBaseUpdate=S,s.shared.pending=null}}while(1);if(C===null&&(v=I),s.baseState=v,s.firstBaseUpdate=w,s.lastBaseUpdate=C,e=s.shared.interleaved,e!==null){s=e;do d|=s.lane,s=s.next;while(s!==e)}else l===null&&(s.shared.lanes=0);wc|=d,t.lanes=d,t.memoizedState=I}}function cE(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(qe(191,s));s.call(r)}}}var IA=new PS.Component().refs;function yv(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:yr({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ty={isMounted:function(t){return(t=t._reactInternals)?Ic(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ji(),s=fl(t),l=da(r,s);l.payload=e,n!=null&&(l.callback=n),e=hl(t,l,s),e!==null&&(ho(e,t,s,r),Nm(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ji(),s=fl(t),l=da(r,s);l.tag=1,l.payload=e,n!=null&&(l.callback=n),e=hl(t,l,s),e!==null&&(ho(e,t,s,r),Nm(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ji(),r=fl(t),s=da(n,r);s.tag=2,e!=null&&(s.callback=e),e=hl(t,s,r),e!==null&&(ho(e,t,r,n),Nm(e,t,r))}};function uE(t,e,n,r,s,l,d){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,l,d):e.prototype&&e.prototype.isPureReactComponent?!hf(n,r)||!hf(s,l):!0}function kA(t,e,n){var r=!1,s=_l,l=e.contextType;return typeof l=="object"&&l!==null?l=Ws(l):(s=ns(e)?vc:Pi.current,r=e.contextTypes,l=(r=r!=null)?Zu(t,s):_l),e=new e(n,l),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ty,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=l),e}function hE(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ty.enqueueReplaceState(e,e.state,null)}function _v(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=IA,Wx(t);var l=e.contextType;typeof l=="object"&&l!==null?s.context=Ws(l):(l=ns(e)?vc:Pi.current,s.context=Zu(t,l)),s.state=t.memoizedState,l=e.getDerivedStateFromProps,typeof l=="function"&&(yv(t,e,l,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&ty.enqueueReplaceState(s,s.state,null),xg(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function _d(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(qe(309));var r=n.stateNode}if(!r)throw Error(qe(147,t));var s=r,l=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===l?e.ref:(e=function(d){var c=s.refs;c===IA&&(c=s.refs={}),d===null?delete c[l]:c[l]=d},e._stringRef=l,e)}if(typeof t!="string")throw Error(qe(284));if(!n._owner)throw Error(qe(290,t))}return t}function pm(t,e){throw t=Object.prototype.toString.call(e),Error(qe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function dE(t){var e=t._init;return e(t._payload)}function MA(t){function e(q,j){if(t){var G=q.deletions;G===null?(q.deletions=[j],q.flags|=16):G.push(j)}}function n(q,j){if(!t)return null;for(;j!==null;)e(q,j),j=j.sibling;return null}function r(q,j){for(q=new Map;j!==null;)j.key!==null?q.set(j.key,j):q.set(j.index,j),j=j.sibling;return q}function s(q,j){return q=pl(q,j),q.index=0,q.sibling=null,q}function l(q,j,G){return q.index=G,t?(G=q.alternate,G!==null?(G=G.index,G<j?(q.flags|=2,j):G):(q.flags|=2,j)):(q.flags|=1048576,j)}function d(q){return t&&q.alternate===null&&(q.flags|=2),q}function c(q,j,G,se){return j===null||j.tag!==6?(j=r0(G,q.mode,se),j.return=q,j):(j=s(j,G),j.return=q,j)}function v(q,j,G,se){var he=G.type;return he===Eu?C(q,j,G.props.children,se,G.key):j!==null&&(j.elementType===he||typeof he=="object"&&he!==null&&he.$$typeof===Qa&&dE(he)===j.type)?(se=s(j,G.props),se.ref=_d(q,j,G),se.return=q,se):(se=Wm(G.type,G.key,G.props,null,q.mode,se),se.ref=_d(q,j,G),se.return=q,se)}function w(q,j,G,se){return j===null||j.tag!==4||j.stateNode.containerInfo!==G.containerInfo||j.stateNode.implementation!==G.implementation?(j=i0(G,q.mode,se),j.return=q,j):(j=s(j,G.children||[]),j.return=q,j)}function C(q,j,G,se,he){return j===null||j.tag!==7?(j=yc(G,q.mode,se,he),j.return=q,j):(j=s(j,G),j.return=q,j)}function I(q,j,G){if(typeof j=="string"&&j!==""||typeof j=="number")return j=r0(""+j,q.mode,G),j.return=q,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case rm:return G=Wm(j.type,j.key,j.props,null,q.mode,G),G.ref=_d(q,null,j),G.return=q,G;case wu:return j=i0(j,q.mode,G),j.return=q,j;case Qa:var se=j._init;return I(q,se(j._payload),G)}if(Ld(j)||fd(j))return j=yc(j,q.mode,G,null),j.return=q,j;pm(q,j)}return null}function S(q,j,G,se){var he=j!==null?j.key:null;if(typeof G=="string"&&G!==""||typeof G=="number")return he!==null?null:c(q,j,""+G,se);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case rm:return G.key===he?v(q,j,G,se):null;case wu:return G.key===he?w(q,j,G,se):null;case Qa:return he=G._init,S(q,j,he(G._payload),se)}if(Ld(G)||fd(G))return he!==null?null:C(q,j,G,se,null);pm(q,G)}return null}function z(q,j,G,se,he){if(typeof se=="string"&&se!==""||typeof se=="number")return q=q.get(G)||null,c(j,q,""+se,he);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case rm:return q=q.get(se.key===null?G:se.key)||null,v(j,q,se,he);case wu:return q=q.get(se.key===null?G:se.key)||null,w(j,q,se,he);case Qa:var ye=se._init;return z(q,j,G,ye(se._payload),he)}if(Ld(se)||fd(se))return q=q.get(G)||null,C(j,q,se,he,null);pm(j,se)}return null}function F(q,j,G,se){for(var he=null,ye=null,we=j,Be=j=0,Ve=null;we!==null&&Be<G.length;Be++){we.index>Be?(Ve=we,we=null):Ve=we.sibling;var xe=S(q,we,G[Be],se);if(xe===null){we===null&&(we=Ve);break}t&&we&&xe.alternate===null&&e(q,we),j=l(xe,j,Be),ye===null?he=xe:ye.sibling=xe,ye=xe,we=Ve}if(Be===G.length)return n(q,we),dr&&ac(q,Be),he;if(we===null){for(;Be<G.length;Be++)we=I(q,G[Be],se),we!==null&&(j=l(we,j,Be),ye===null?he=we:ye.sibling=we,ye=we);return dr&&ac(q,Be),he}for(we=r(q,we);Be<G.length;Be++)Ve=z(we,q,Be,G[Be],se),Ve!==null&&(t&&Ve.alternate!==null&&we.delete(Ve.key===null?Be:Ve.key),j=l(Ve,j,Be),ye===null?he=Ve:ye.sibling=Ve,ye=Ve);return t&&we.forEach(function(He){return e(q,He)}),dr&&ac(q,Be),he}function B(q,j,G,se){var he=fd(G);if(typeof he!="function")throw Error(qe(150));if(G=he.call(G),G==null)throw Error(qe(151));for(var ye=he=null,we=j,Be=j=0,Ve=null,xe=G.next();we!==null&&!xe.done;Be++,xe=G.next()){we.index>Be?(Ve=we,we=null):Ve=we.sibling;var He=S(q,we,xe.value,se);if(He===null){we===null&&(we=Ve);break}t&&we&&He.alternate===null&&e(q,we),j=l(He,j,Be),ye===null?he=He:ye.sibling=He,ye=He,we=Ve}if(xe.done)return n(q,we),dr&&ac(q,Be),he;if(we===null){for(;!xe.done;Be++,xe=G.next())xe=I(q,xe.value,se),xe!==null&&(j=l(xe,j,Be),ye===null?he=xe:ye.sibling=xe,ye=xe);return dr&&ac(q,Be),he}for(we=r(q,we);!xe.done;Be++,xe=G.next())xe=z(we,q,Be,xe.value,se),xe!==null&&(t&&xe.alternate!==null&&we.delete(xe.key===null?Be:xe.key),j=l(xe,j,Be),ye===null?he=xe:ye.sibling=xe,ye=xe);return t&&we.forEach(function(wt){return e(q,wt)}),dr&&ac(q,Be),he}function Q(q,j,G,se){if(typeof G=="object"&&G!==null&&G.type===Eu&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case rm:e:{for(var he=G.key,ye=j;ye!==null;){if(ye.key===he){if(he=G.type,he===Eu){if(ye.tag===7){n(q,ye.sibling),j=s(ye,G.props.children),j.return=q,q=j;break e}}else if(ye.elementType===he||typeof he=="object"&&he!==null&&he.$$typeof===Qa&&dE(he)===ye.type){n(q,ye.sibling),j=s(ye,G.props),j.ref=_d(q,ye,G),j.return=q,q=j;break e}n(q,ye);break}else e(q,ye);ye=ye.sibling}G.type===Eu?(j=yc(G.props.children,q.mode,se,G.key),j.return=q,q=j):(se=Wm(G.type,G.key,G.props,null,q.mode,se),se.ref=_d(q,j,G),se.return=q,q=se)}return d(q);case wu:e:{for(ye=G.key;j!==null;){if(j.key===ye)if(j.tag===4&&j.stateNode.containerInfo===G.containerInfo&&j.stateNode.implementation===G.implementation){n(q,j.sibling),j=s(j,G.children||[]),j.return=q,q=j;break e}else{n(q,j);break}else e(q,j);j=j.sibling}j=i0(G,q.mode,se),j.return=q,q=j}return d(q);case Qa:return ye=G._init,Q(q,j,ye(G._payload),se)}if(Ld(G))return F(q,j,G,se);if(fd(G))return B(q,j,G,se);pm(q,G)}return typeof G=="string"&&G!==""||typeof G=="number"?(G=""+G,j!==null&&j.tag===6?(n(q,j.sibling),j=s(j,G),j.return=q,q=j):(n(q,j),j=r0(G,q.mode,se),j.return=q,q=j),d(q)):n(q,j)}return Q}var Ku=MA(!0),LA=MA(!1),Bf={},Vo=wl(Bf),mf=wl(Bf),gf=wl(Bf);function pc(t){if(t===Bf)throw Error(qe(174));return t}function Hx(t,e){switch(tr(gf,e),tr(mf,t),tr(Vo,Bf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Y0(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Y0(e,t)}sr(Vo),tr(Vo,e)}function Ju(){sr(Vo),sr(mf),sr(gf)}function RA(t){pc(gf.current);var e=pc(Vo.current),n=Y0(e,t.type);e!==n&&(tr(mf,t),tr(Vo,n))}function qx(t){mf.current===t&&(sr(Vo),sr(mf))}var mr=wl(0);function bg(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if((e.flags&128)!==0)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var K_=[];function Xx(){for(var t=0;t<K_.length;t++)K_[t]._workInProgressVersionPrimary=null;K_.length=0}var Um=wa.ReactCurrentDispatcher,J_=wa.ReactCurrentBatchConfig,bc=0,gr=null,Hr=null,Qr=null,wg=!1,Wd=!1,yf=0,OR=0;function vi(){throw Error(qe(321))}function Zx(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!mo(t[n],e[n]))return!1;return!0}function Yx(t,e,n,r,s,l){if(bc=l,gr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Um.current=t===null||t.memoizedState===null?BR:NR,t=n(r,s),Wd){l=0;do{if(Wd=!1,yf=0,25<=l)throw Error(qe(301));l+=1,Qr=Hr=null,e.updateQueue=null,Um.current=UR,t=n(r,s)}while(Wd)}if(Um.current=Eg,e=Hr!==null&&Hr.next!==null,bc=0,Qr=Hr=gr=null,wg=!1,e)throw Error(qe(300));return t}function Kx(){var t=yf!==0;return yf=0,t}function Ro(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qr===null?gr.memoizedState=Qr=t:Qr=Qr.next=t,Qr}function Hs(){if(Hr===null){var t=gr.alternate;t=t!==null?t.memoizedState:null}else t=Hr.next;var e=Qr===null?gr.memoizedState:Qr.next;if(e!==null)Qr=e,Hr=t;else{if(t===null)throw Error(qe(310));Hr=t,t={memoizedState:Hr.memoizedState,baseState:Hr.baseState,baseQueue:Hr.baseQueue,queue:Hr.queue,next:null},Qr===null?gr.memoizedState=Qr=t:Qr=Qr.next=t}return Qr}function _f(t,e){return typeof e=="function"?e(t):e}function Q_(t){var e=Hs(),n=e.queue;if(n===null)throw Error(qe(311));n.lastRenderedReducer=t;var r=Hr,s=r.baseQueue,l=n.pending;if(l!==null){if(s!==null){var d=s.next;s.next=l.next,l.next=d}r.baseQueue=s=l,n.pending=null}if(s!==null){l=s.next,r=r.baseState;var c=d=null,v=null,w=l;do{var C=w.lane;if((bc&C)===C)v!==null&&(v=v.next={lane:0,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null}),r=w.hasEagerState?w.eagerState:t(r,w.action);else{var I={lane:C,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null};v===null?(c=v=I,d=r):v=v.next=I,gr.lanes|=C,wc|=C}w=w.next}while(w!==null&&w!==l);v===null?d=r:v.next=c,mo(r,e.memoizedState)||(Qi=!0),e.memoizedState=r,e.baseState=d,e.baseQueue=v,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do l=s.lane,gr.lanes|=l,wc|=l,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function e0(t){var e=Hs(),n=e.queue;if(n===null)throw Error(qe(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,l=e.memoizedState;if(s!==null){n.pending=null;var d=s=s.next;do l=t(l,d.action),d=d.next;while(d!==s);mo(l,e.memoizedState)||(Qi=!0),e.memoizedState=l,e.baseQueue===null&&(e.baseState=l),n.lastRenderedState=l}return[l,r]}function OA(){}function DA(t,e){var n=gr,r=Hs(),s=e(),l=!mo(r.memoizedState,s);if(l&&(r.memoizedState=s,Qi=!0),r=r.queue,Jx(BA.bind(null,n,r,t),[t]),r.getSnapshot!==e||l||Qr!==null&&Qr.memoizedState.tag&1){if(n.flags|=2048,vf(9,FA.bind(null,n,r,s,e),void 0,null),ei===null)throw Error(qe(349));(bc&30)!==0||zA(n,e,s)}return s}function zA(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=gr.updateQueue,e===null?(e={lastEffect:null,stores:null},gr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function FA(t,e,n,r){e.value=n,e.getSnapshot=r,NA(e)&&UA(t)}function BA(t,e,n){return n(function(){NA(e)&&UA(t)})}function NA(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!mo(t,n)}catch{return!0}}function UA(t){var e=ya(t,1);e!==null&&ho(e,t,1,-1)}function fE(t){var e=Ro();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_f,lastRenderedState:t},e.queue=t,t=t.dispatch=FR.bind(null,gr,t),[e.memoizedState,t]}function vf(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=gr.updateQueue,e===null?(e={lastEffect:null,stores:null},gr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function VA(){return Hs().memoizedState}function Vm(t,e,n,r){var s=Ro();gr.flags|=t,s.memoizedState=vf(1|e,n,void 0,r===void 0?null:r)}function ny(t,e,n,r){var s=Hs();r=r===void 0?null:r;var l=void 0;if(Hr!==null){var d=Hr.memoizedState;if(l=d.destroy,r!==null&&Zx(r,d.deps)){s.memoizedState=vf(e,n,l,r);return}}gr.flags|=t,s.memoizedState=vf(1|e,n,l,r)}function pE(t,e){return Vm(8390656,8,t,e)}function Jx(t,e){return ny(2048,8,t,e)}function jA(t,e){return ny(4,2,t,e)}function GA(t,e){return ny(4,4,t,e)}function $A(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function WA(t,e,n){return n=n!=null?n.concat([t]):null,ny(4,4,$A.bind(null,e,t),n)}function Qx(){}function HA(t,e){var n=Hs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Zx(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function qA(t,e){var n=Hs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Zx(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function XA(t,e,n){return(bc&21)===0?(t.baseState&&(t.baseState=!1,Qi=!0),t.memoizedState=n):(mo(n,e)||(n=KS(),gr.lanes|=n,wc|=n,t.baseState=!0),e)}function DR(t,e){var n=Nn;Nn=n!==0&&4>n?n:4,t(!0);var r=J_.transition;J_.transition={};try{t(!1),e()}finally{Nn=n,J_.transition=r}}function ZA(){return Hs().memoizedState}function zR(t,e,n){var r=fl(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},YA(t))KA(e,n);else if(n=PA(t,e,n,r),n!==null){var s=ji();ho(n,t,r,s),JA(n,e,r)}}function FR(t,e,n){var r=fl(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(YA(t))KA(e,s);else{var l=t.alternate;if(t.lanes===0&&(l===null||l.lanes===0)&&(l=e.lastRenderedReducer,l!==null))try{var d=e.lastRenderedState,c=l(d,n);if(s.hasEagerState=!0,s.eagerState=c,mo(c,d)){var v=e.interleaved;v===null?(s.next=s,$x(e)):(s.next=v.next,v.next=s),e.interleaved=s;return}}catch{}finally{}n=PA(t,e,s,r),n!==null&&(s=ji(),ho(n,t,r,s),JA(n,e,r))}}function YA(t){var e=t.alternate;return t===gr||e!==null&&e===gr}function KA(t,e){Wd=wg=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function JA(t,e,n){if((n&4194240)!==0){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,kx(t,n)}}var Eg={readContext:Ws,useCallback:vi,useContext:vi,useEffect:vi,useImperativeHandle:vi,useInsertionEffect:vi,useLayoutEffect:vi,useMemo:vi,useReducer:vi,useRef:vi,useState:vi,useDebugValue:vi,useDeferredValue:vi,useTransition:vi,useMutableSource:vi,useSyncExternalStore:vi,useId:vi,unstable_isNewReconciler:!1},BR={readContext:Ws,useCallback:function(t,e){return Ro().memoizedState=[t,e===void 0?null:e],t},useContext:Ws,useEffect:pE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Vm(4194308,4,$A.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Vm(4194308,4,t,e)},useInsertionEffect:function(t,e){return Vm(4,2,t,e)},useMemo:function(t,e){var n=Ro();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ro();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=zR.bind(null,gr,t),[r.memoizedState,t]},useRef:function(t){var e=Ro();return t={current:t},e.memoizedState=t},useState:fE,useDebugValue:Qx,useDeferredValue:function(t){return Ro().memoizedState=t},useTransition:function(){var t=fE(!1),e=t[0];return t=DR.bind(null,t[1]),Ro().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=gr,s=Ro();if(dr){if(n===void 0)throw Error(qe(407));n=n()}else{if(n=e(),ei===null)throw Error(qe(349));(bc&30)!==0||zA(r,e,n)}s.memoizedState=n;var l={value:n,getSnapshot:e};return s.queue=l,pE(BA.bind(null,r,l,t),[t]),r.flags|=2048,vf(9,FA.bind(null,r,l,n,e),void 0,null),n},useId:function(){var t=Ro(),e=ei.identifierPrefix;if(dr){var n=ha,r=ua;n=(r&~(1<<32-uo(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=yf++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=OR++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},NR={readContext:Ws,useCallback:HA,useContext:Ws,useEffect:Jx,useImperativeHandle:WA,useInsertionEffect:jA,useLayoutEffect:GA,useMemo:qA,useReducer:Q_,useRef:VA,useState:function(){return Q_(_f)},useDebugValue:Qx,useDeferredValue:function(t){var e=Hs();return XA(e,Hr.memoizedState,t)},useTransition:function(){var t=Q_(_f)[0],e=Hs().memoizedState;return[t,e]},useMutableSource:OA,useSyncExternalStore:DA,useId:ZA,unstable_isNewReconciler:!1},UR={readContext:Ws,useCallback:HA,useContext:Ws,useEffect:Jx,useImperativeHandle:WA,useInsertionEffect:jA,useLayoutEffect:GA,useMemo:qA,useReducer:e0,useRef:VA,useState:function(){return e0(_f)},useDebugValue:Qx,useDeferredValue:function(t){var e=Hs();return Hr===null?e.memoizedState=t:XA(e,Hr.memoizedState,t)},useTransition:function(){var t=e0(_f)[0],e=Hs().memoizedState;return[t,e]},useMutableSource:OA,useSyncExternalStore:DA,useId:ZA,unstable_isNewReconciler:!1};function Qu(t,e){try{var n="",r=e;do n+=pL(r),r=r.return;while(r);var s=n}catch(l){s=`
Error generating stack: `+l.message+`
`+l.stack}return{value:t,source:e,stack:s,digest:null}}function t0(t,e,n){return{value:t,source:null,stack:n!=null?n:null,digest:e!=null?e:null}}function vv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var VR=typeof WeakMap=="function"?WeakMap:Map;function QA(t,e,n){n=da(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Sg||(Sg=!0,Iv=r),vv(t,e)},n}function eP(t,e,n){n=da(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){vv(t,e)}}var l=t.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){vv(t,e),typeof r!="function"&&(dl===null?dl=new Set([this]):dl.add(this));var d=e.stack;this.componentDidCatch(e.value,{componentStack:d!==null?d:""})}),n}function mE(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new VR;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=tO.bind(null,t,e,n),e.then(t,t))}function gE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function yE(t,e,n,r,s){return(t.mode&1)===0?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=da(-1,1),e.tag=2,hl(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=s,t)}var jR=wa.ReactCurrentOwner,Qi=!1;function Ni(t,e,n,r){e.child=t===null?LA(e,null,n,r):Ku(e,t.child,n,r)}function _E(t,e,n,r,s){n=n.render;var l=e.ref;return ju(e,s),r=Yx(t,e,n,r,l,s),n=Kx(),t!==null&&!Qi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,_a(t,e,s)):(dr&&n&&Bx(e),e.flags|=1,Ni(t,e,r,s),e.child)}function vE(t,e,n,r,s){if(t===null){var l=n.type;return typeof l=="function"&&!a1(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=l,tP(t,e,l,r,s)):(t=Wm(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(l=t.child,(t.lanes&s)===0){var d=l.memoizedProps;if(n=n.compare,n=n!==null?n:hf,n(d,r)&&t.ref===e.ref)return _a(t,e,s)}return e.flags|=1,t=pl(l,r),t.ref=e.ref,t.return=e,e.child=t}function tP(t,e,n,r,s){if(t!==null){var l=t.memoizedProps;if(hf(l,r)&&t.ref===e.ref)if(Qi=!1,e.pendingProps=r=l,(t.lanes&s)!==0)(t.flags&131072)!==0&&(Qi=!0);else return e.lanes=t.lanes,_a(t,e,s)}return xv(t,e,n,r,s)}function nP(t,e,n){var r=e.pendingProps,s=r.children,l=t!==null?t.memoizedState:null;if(r.mode==="hidden")if((e.mode&1)===0)e.memoizedState={baseLanes:0,cachePool:null,transitions:null},tr(Ru,_s),_s|=n;else{if((n&1073741824)===0)return t=l!==null?l.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,tr(Ru,_s),_s|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=l!==null?l.baseLanes:n,tr(Ru,_s),_s|=r}else l!==null?(r=l.baseLanes|n,e.memoizedState=null):r=n,tr(Ru,_s),_s|=r;return Ni(t,e,s,n),e.child}function rP(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function xv(t,e,n,r,s){var l=ns(n)?vc:Pi.current;return l=Zu(e,l),ju(e,s),n=Yx(t,e,n,r,l,s),r=Kx(),t!==null&&!Qi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,_a(t,e,s)):(dr&&r&&Bx(e),e.flags|=1,Ni(t,e,n,s),e.child)}function xE(t,e,n,r,s){if(ns(n)){var l=!0;mg(e)}else l=!1;if(ju(e,s),e.stateNode===null)jm(t,e),kA(e,n,r),_v(e,n,r,s),r=!0;else if(t===null){var d=e.stateNode,c=e.memoizedProps;d.props=c;var v=d.context,w=n.contextType;typeof w=="object"&&w!==null?w=Ws(w):(w=ns(n)?vc:Pi.current,w=Zu(e,w));var C=n.getDerivedStateFromProps,I=typeof C=="function"||typeof d.getSnapshotBeforeUpdate=="function";I||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(c!==r||v!==w)&&hE(e,d,r,w),el=!1;var S=e.memoizedState;d.state=S,xg(e,r,d,s),v=e.memoizedState,c!==r||S!==v||ts.current||el?(typeof C=="function"&&(yv(e,n,C,r),v=e.memoizedState),(c=el||uE(e,n,c,r,S,v,w))?(I||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(e.flags|=4194308)):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=v),d.props=r,d.state=v,d.context=w,r=c):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{d=e.stateNode,CA(t,e),c=e.memoizedProps,w=e.type===e.elementType?c:oo(e.type,c),d.props=w,I=e.pendingProps,S=d.context,v=n.contextType,typeof v=="object"&&v!==null?v=Ws(v):(v=ns(n)?vc:Pi.current,v=Zu(e,v));var z=n.getDerivedStateFromProps;(C=typeof z=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(c!==I||S!==v)&&hE(e,d,r,v),el=!1,S=e.memoizedState,d.state=S,xg(e,r,d,s);var F=e.memoizedState;c!==I||S!==F||ts.current||el?(typeof z=="function"&&(yv(e,n,z,r),F=e.memoizedState),(w=el||uE(e,n,w,r,S,F,v)||!1)?(C||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(r,F,v),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(r,F,v)),typeof d.componentDidUpdate=="function"&&(e.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof d.componentDidUpdate!="function"||c===t.memoizedProps&&S===t.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&S===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=F),d.props=r,d.state=F,d.context=v,r=w):(typeof d.componentDidUpdate!="function"||c===t.memoizedProps&&S===t.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&S===t.memoizedState||(e.flags|=1024),r=!1)}return bv(t,e,n,r,l,s)}function bv(t,e,n,r,s,l){rP(t,e);var d=(e.flags&128)!==0;if(!r&&!d)return s&&sE(e,n,!1),_a(t,e,l);r=e.stateNode,jR.current=e;var c=d&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&d?(e.child=Ku(e,t.child,null,l),e.child=Ku(e,null,c,l)):Ni(t,e,c,l),e.memoizedState=r.state,s&&sE(e,n,!0),e.child}function iP(t){var e=t.stateNode;e.pendingContext?iE(t,e.pendingContext,e.pendingContext!==e.context):e.context&&iE(t,e.context,!1),Hx(t,e.containerInfo)}function bE(t,e,n,r,s){return Yu(),Ux(s),e.flags|=256,Ni(t,e,n,r),e.child}var wv={dehydrated:null,treeContext:null,retryLane:0};function Ev(t){return{baseLanes:t,cachePool:null,transitions:null}}function sP(t,e,n){var r=e.pendingProps,s=mr.current,l=!1,d=(e.flags&128)!==0,c;if((c=d)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(l=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),tr(mr,s&1),t===null)return mv(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((e.mode&1)===0?e.lanes=1:t.data==="$!"?e.lanes=8:e.lanes=1073741824,null):(d=r.children,t=r.fallback,l?(r=e.mode,l=e.child,d={mode:"hidden",children:d},(r&1)===0&&l!==null?(l.childLanes=0,l.pendingProps=d):l=sy(d,r,0,null),t=yc(t,r,n,null),l.return=e,t.return=e,l.sibling=t,e.child=l,e.child.memoizedState=Ev(n),e.memoizedState=wv,t):e1(e,d));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return GR(t,e,d,r,c,s,n);if(l){l=r.fallback,d=e.mode,s=t.child,c=s.sibling;var v={mode:"hidden",children:r.children};return(d&1)===0&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=v,e.deletions=null):(r=pl(s,v),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?l=pl(c,l):(l=yc(l,d,n,null),l.flags|=2),l.return=e,r.return=e,r.sibling=l,e.child=r,r=l,l=e.child,d=t.child.memoizedState,d=d===null?Ev(n):{baseLanes:d.baseLanes|n,cachePool:null,transitions:d.transitions},l.memoizedState=d,l.childLanes=t.childLanes&~n,e.memoizedState=wv,r}return l=t.child,t=l.sibling,r=pl(l,{mode:"visible",children:r.children}),(e.mode&1)===0&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function e1(t,e){return e=sy({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function mm(t,e,n,r){return r!==null&&Ux(r),Ku(e,t.child,null,n),t=e1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function GR(t,e,n,r,s,l,d){if(n)return e.flags&256?(e.flags&=-257,r=t0(Error(qe(422))),mm(t,e,d,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(l=r.fallback,s=e.mode,r=sy({mode:"visible",children:r.children},s,0,null),l=yc(l,s,d,null),l.flags|=2,r.return=e,l.return=e,r.sibling=l,e.child=r,(e.mode&1)!==0&&Ku(e,t.child,null,d),e.child.memoizedState=Ev(d),e.memoizedState=wv,l);if((e.mode&1)===0)return mm(t,e,d,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,l=Error(qe(419)),r=t0(l,r,void 0),mm(t,e,d,r)}if(c=(d&t.childLanes)!==0,Qi||c){if(r=ei,r!==null){switch(d&-d){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=(s&(r.suspendedLanes|d))!==0?0:s,s!==0&&s!==l.retryLane&&(l.retryLane=s,ya(t,s),ho(r,t,s,-1))}return o1(),r=t0(Error(qe(421))),mm(t,e,d,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=nO.bind(null,t),s._reactRetry=e,null):(t=l.treeContext,bs=ul(s.nextSibling),Es=e,dr=!0,lo=null,t!==null&&(Ns[Us++]=ua,Ns[Us++]=ha,Ns[Us++]=xc,ua=t.id,ha=t.overflow,xc=e),e=e1(e,r.children),e.flags|=4096,e)}function wE(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),gv(t.return,e,n)}function n0(t,e,n,r,s){var l=t.memoizedState;l===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(l.isBackwards=e,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=n,l.tailMode=s)}function oP(t,e,n){var r=e.pendingProps,s=r.revealOrder,l=r.tail;if(Ni(t,e,r.children,n),r=mr.current,(r&2)!==0)r=r&1|2,e.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&wE(t,n,e);else if(t.tag===19)wE(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(tr(mr,r),(e.mode&1)===0)e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&bg(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),n0(e,!1,s,n,l);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&bg(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}n0(e,!0,n,null,l);break;case"together":n0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function jm(t,e){(e.mode&1)===0&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function _a(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),wc|=e.lanes,(n&e.childLanes)===0)return null;if(t!==null&&e.child!==t.child)throw Error(qe(153));if(e.child!==null){for(t=e.child,n=pl(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=pl(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function $R(t,e,n){switch(e.tag){case 3:iP(e),Yu();break;case 5:RA(e);break;case 1:ns(e.type)&&mg(e);break;case 4:Hx(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;tr(_g,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(tr(mr,mr.current&1),e.flags|=128,null):(n&e.child.childLanes)!==0?sP(t,e,n):(tr(mr,mr.current&1),t=_a(t,e,n),t!==null?t.sibling:null);tr(mr,mr.current&1);break;case 19:if(r=(n&e.childLanes)!==0,(t.flags&128)!==0){if(r)return oP(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),tr(mr,mr.current),r)break;return null;case 22:case 23:return e.lanes=0,nP(t,e,n)}return _a(t,e,n)}var aP,Tv,lP,cP;aP=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Tv=function(){};lP=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,pc(Vo.current);var l=null;switch(n){case"input":s=H0(t,s),r=H0(t,r),l=[];break;case"select":s=yr({},s,{value:void 0}),r=yr({},r,{value:void 0}),l=[];break;case"textarea":s=Z0(t,s),r=Z0(t,r),l=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=fg)}K0(n,r);var d;n=null;for(w in s)if(!r.hasOwnProperty(w)&&s.hasOwnProperty(w)&&s[w]!=null)if(w==="style"){var c=s[w];for(d in c)c.hasOwnProperty(d)&&(n||(n={}),n[d]="")}else w!=="dangerouslySetInnerHTML"&&w!=="children"&&w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(rf.hasOwnProperty(w)?l||(l=[]):(l=l||[]).push(w,null));for(w in r){var v=r[w];if(c=s!=null?s[w]:void 0,r.hasOwnProperty(w)&&v!==c&&(v!=null||c!=null))if(w==="style")if(c){for(d in c)!c.hasOwnProperty(d)||v&&v.hasOwnProperty(d)||(n||(n={}),n[d]="");for(d in v)v.hasOwnProperty(d)&&c[d]!==v[d]&&(n||(n={}),n[d]=v[d])}else n||(l||(l=[]),l.push(w,n)),n=v;else w==="dangerouslySetInnerHTML"?(v=v?v.__html:void 0,c=c?c.__html:void 0,v!=null&&c!==v&&(l=l||[]).push(w,v)):w==="children"?typeof v!="string"&&typeof v!="number"||(l=l||[]).push(w,""+v):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&(rf.hasOwnProperty(w)?(v!=null&&w==="onScroll"&&ir("scroll",t),l||c===v||(l=[])):(l=l||[]).push(w,v))}n&&(l=l||[]).push("style",n);var w=l;(e.updateQueue=w)&&(e.flags|=4)}};cP=function(t,e,n,r){n!==r&&(e.flags|=4)};function vd(t,e){if(!dr)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function xi(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function WR(t,e,n){var r=e.pendingProps;switch(Nx(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xi(e),null;case 1:return ns(e.type)&&pg(),xi(e),null;case 3:return r=e.stateNode,Ju(),sr(ts),sr(Pi),Xx(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(fm(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&(e.flags&256)===0||(e.flags|=1024,lo!==null&&(Lv(lo),lo=null))),Tv(t,e),xi(e),null;case 5:qx(e);var s=pc(gf.current);if(n=e.type,t!==null&&e.stateNode!=null)lP(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(qe(166));return xi(e),null}if(t=pc(Vo.current),fm(e)){r=e.stateNode,n=e.type;var l=e.memoizedProps;switch(r[zo]=e,r[pf]=l,t=(e.mode&1)!==0,n){case"dialog":ir("cancel",r),ir("close",r);break;case"iframe":case"object":case"embed":ir("load",r);break;case"video":case"audio":for(s=0;s<Od.length;s++)ir(Od[s],r);break;case"source":ir("error",r);break;case"img":case"image":case"link":ir("error",r),ir("load",r);break;case"details":ir("toggle",r);break;case"input":Mw(r,l),ir("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},ir("invalid",r);break;case"textarea":Rw(r,l),ir("invalid",r)}K0(n,l),s=null;for(var d in l)if(l.hasOwnProperty(d)){var c=l[d];d==="children"?typeof c=="string"?r.textContent!==c&&(l.suppressHydrationWarning!==!0&&dm(r.textContent,c,t),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(l.suppressHydrationWarning!==!0&&dm(r.textContent,c,t),s=["children",""+c]):rf.hasOwnProperty(d)&&c!=null&&d==="onScroll"&&ir("scroll",r)}switch(n){case"input":im(r),Lw(r,l,!0);break;case"textarea":im(r),Ow(r);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(r.onclick=fg)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{d=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=zS(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=d.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=d.createElement(n,{is:r.is}):(t=d.createElement(n),n==="select"&&(d=t,r.multiple?d.multiple=!0:r.size&&(d.size=r.size))):t=d.createElementNS(t,n),t[zo]=e,t[pf]=r,aP(t,e,!1,!1),e.stateNode=t;e:{switch(d=J0(n,r),n){case"dialog":ir("cancel",t),ir("close",t),s=r;break;case"iframe":case"object":case"embed":ir("load",t),s=r;break;case"video":case"audio":for(s=0;s<Od.length;s++)ir(Od[s],t);s=r;break;case"source":ir("error",t),s=r;break;case"img":case"image":case"link":ir("error",t),ir("load",t),s=r;break;case"details":ir("toggle",t),s=r;break;case"input":Mw(t,r),s=H0(t,r),ir("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=yr({},r,{value:void 0}),ir("invalid",t);break;case"textarea":Rw(t,r),s=Z0(t,r),ir("invalid",t);break;default:s=r}K0(n,s),c=s;for(l in c)if(c.hasOwnProperty(l)){var v=c[l];l==="style"?NS(t,v):l==="dangerouslySetInnerHTML"?(v=v?v.__html:void 0,v!=null&&FS(t,v)):l==="children"?typeof v=="string"?(n!=="textarea"||v!=="")&&sf(t,v):typeof v=="number"&&sf(t,""+v):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(rf.hasOwnProperty(l)?v!=null&&l==="onScroll"&&ir("scroll",t):v!=null&&Tx(t,l,v,d))}switch(n){case"input":im(t),Lw(t,r,!1);break;case"textarea":im(t),Ow(t);break;case"option":r.value!=null&&t.setAttribute("value",""+yl(r.value));break;case"select":t.multiple=!!r.multiple,l=r.value,l!=null?Bu(t,!!r.multiple,l,!1):r.defaultValue!=null&&Bu(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=fg)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return xi(e),null;case 6:if(t&&e.stateNode!=null)cP(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(qe(166));if(n=pc(gf.current),pc(Vo.current),fm(e)){if(r=e.stateNode,n=e.memoizedProps,r[zo]=e,(l=r.nodeValue!==n)&&(t=Es,t!==null))switch(t.tag){case 3:dm(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&dm(r.nodeValue,n,(t.mode&1)!==0)}l&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[zo]=e,e.stateNode=r}return xi(e),null;case 13:if(sr(mr),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(dr&&bs!==null&&(e.mode&1)!==0&&(e.flags&128)===0)AA(),Yu(),e.flags|=98560,l=!1;else if(l=fm(e),r!==null&&r.dehydrated!==null){if(t===null){if(!l)throw Error(qe(318));if(l=e.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(qe(317));l[zo]=e}else Yu(),(e.flags&128)===0&&(e.memoizedState=null),e.flags|=4;xi(e),l=!1}else lo!==null&&(Lv(lo),lo=null),l=!0;if(!l)return e.flags&65536?e:null}return(e.flags&128)!==0?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,(e.mode&1)!==0&&(t===null||(mr.current&1)!==0?qr===0&&(qr=3):o1())),e.updateQueue!==null&&(e.flags|=4),xi(e),null);case 4:return Ju(),Tv(t,e),t===null&&df(e.stateNode.containerInfo),xi(e),null;case 10:return Gx(e.type._context),xi(e),null;case 17:return ns(e.type)&&pg(),xi(e),null;case 19:if(sr(mr),l=e.memoizedState,l===null)return xi(e),null;if(r=(e.flags&128)!==0,d=l.rendering,d===null)if(r)vd(l,!1);else{if(qr!==0||t!==null&&(t.flags&128)!==0)for(t=e.child;t!==null;){if(d=bg(t),d!==null){for(e.flags|=128,vd(l,!1),r=d.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)l=n,t=r,l.flags&=14680066,d=l.alternate,d===null?(l.childLanes=0,l.lanes=t,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=d.childLanes,l.lanes=d.lanes,l.child=d.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=d.memoizedProps,l.memoizedState=d.memoizedState,l.updateQueue=d.updateQueue,l.type=d.type,t=d.dependencies,l.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return tr(mr,mr.current&1|2),e.child}t=t.sibling}l.tail!==null&&Ir()>eh&&(e.flags|=128,r=!0,vd(l,!1),e.lanes=4194304)}else{if(!r)if(t=bg(d),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),vd(l,!0),l.tail===null&&l.tailMode==="hidden"&&!d.alternate&&!dr)return xi(e),null}else 2*Ir()-l.renderingStartTime>eh&&n!==1073741824&&(e.flags|=128,r=!0,vd(l,!1),e.lanes=4194304);l.isBackwards?(d.sibling=e.child,e.child=d):(n=l.last,n!==null?n.sibling=d:e.child=d,l.last=d)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=Ir(),e.sibling=null,n=mr.current,tr(mr,r?n&1|2:n&1),e):(xi(e),null);case 22:case 23:return s1(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&(e.mode&1)!==0?(_s&1073741824)!==0&&(xi(e),e.subtreeFlags&6&&(e.flags|=8192)):xi(e),null;case 24:return null;case 25:return null}throw Error(qe(156,e.tag))}function HR(t,e){switch(Nx(e),e.tag){case 1:return ns(e.type)&&pg(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ju(),sr(ts),sr(Pi),Xx(),t=e.flags,(t&65536)!==0&&(t&128)===0?(e.flags=t&-65537|128,e):null;case 5:return qx(e),null;case 13:if(sr(mr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(qe(340));Yu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return sr(mr),null;case 4:return Ju(),null;case 10:return Gx(e.type._context),null;case 22:case 23:return s1(),null;case 24:return null;default:return null}}var gm=!1,Ti=!1,qR=typeof WeakSet=="function"?WeakSet:Set,Et=null;function Lu(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Er(t,e,r)}else n.current=null}function Sv(t,e,n){try{n()}catch(r){Er(t,e,r)}}var EE=!1;function XR(t,e){if(lv=ug,t=fA(),Fx(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,l=r.focusNode;r=r.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var d=0,c=-1,v=-1,w=0,C=0,I=t,S=null;t:for(;;){for(var z;I!==n||s!==0&&I.nodeType!==3||(c=d+s),I!==l||r!==0&&I.nodeType!==3||(v=d+r),I.nodeType===3&&(d+=I.nodeValue.length),(z=I.firstChild)!==null;)S=I,I=z;for(;;){if(I===t)break t;if(S===n&&++w===s&&(c=d),S===l&&++C===r&&(v=d),(z=I.nextSibling)!==null)break;I=S,S=I.parentNode}I=z}n=c===-1||v===-1?null:{start:c,end:v}}else n=null}n=n||{start:0,end:0}}else n=null;for(cv={focusedElem:t,selectionRange:n},ug=!1,Et=e;Et!==null;)if(e=Et,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Et=t;else for(;Et!==null;){e=Et;try{var F=e.alternate;if((e.flags&1024)!==0)switch(e.tag){case 0:case 11:case 15:break;case 1:if(F!==null){var B=F.memoizedProps,Q=F.memoizedState,q=e.stateNode,j=q.getSnapshotBeforeUpdate(e.elementType===e.type?B:oo(e.type,B),Q);q.__reactInternalSnapshotBeforeUpdate=j}break;case 3:var G=e.stateNode.containerInfo;G.nodeType===1?G.textContent="":G.nodeType===9&&G.documentElement&&G.removeChild(G.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(qe(163))}}catch(se){Er(e,e.return,se)}if(t=e.sibling,t!==null){t.return=e.return,Et=t;break}Et=e.return}return F=EE,EE=!1,F}function Hd(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var l=s.destroy;s.destroy=void 0,l!==void 0&&Sv(e,n,l)}s=s.next}while(s!==r)}}function ry(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Av(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function uP(t){var e=t.alternate;e!==null&&(t.alternate=null,uP(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[zo],delete e[pf],delete e[dv],delete e[kR],delete e[MR])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function hP(t){return t.tag===5||t.tag===3||t.tag===4}function TE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||hP(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Pv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=fg));else if(r!==4&&(t=t.child,t!==null))for(Pv(t,e,n),t=t.sibling;t!==null;)Pv(t,e,n),t=t.sibling}function Cv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Cv(t,e,n),t=t.sibling;t!==null;)Cv(t,e,n),t=t.sibling}var li=null,ao=!1;function qa(t,e,n){for(n=n.child;n!==null;)dP(t,e,n),n=n.sibling}function dP(t,e,n){if(Uo&&typeof Uo.onCommitFiberUnmount=="function")try{Uo.onCommitFiberUnmount(Zg,n)}catch{}switch(n.tag){case 5:Ti||Lu(n,e);case 6:var r=li,s=ao;li=null,qa(t,e,n),li=r,ao=s,li!==null&&(ao?(t=li,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):li.removeChild(n.stateNode));break;case 18:li!==null&&(ao?(t=li,n=n.stateNode,t.nodeType===8?Z_(t.parentNode,n):t.nodeType===1&&Z_(t,n),cf(t)):Z_(li,n.stateNode));break;case 4:r=li,s=ao,li=n.stateNode.containerInfo,ao=!0,qa(t,e,n),li=r,ao=s;break;case 0:case 11:case 14:case 15:if(!Ti&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var l=s,d=l.destroy;l=l.tag,d!==void 0&&((l&2)!==0||(l&4)!==0)&&Sv(n,e,d),s=s.next}while(s!==r)}qa(t,e,n);break;case 1:if(!Ti&&(Lu(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){Er(n,e,c)}qa(t,e,n);break;case 21:qa(t,e,n);break;case 22:n.mode&1?(Ti=(r=Ti)||n.memoizedState!==null,qa(t,e,n),Ti=r):qa(t,e,n);break;default:qa(t,e,n)}}function SE(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new qR),e.forEach(function(r){var s=rO.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function so(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var l=t,d=e,c=d;e:for(;c!==null;){switch(c.tag){case 5:li=c.stateNode,ao=!1;break e;case 3:li=c.stateNode.containerInfo,ao=!0;break e;case 4:li=c.stateNode.containerInfo,ao=!0;break e}c=c.return}if(li===null)throw Error(qe(160));dP(l,d,s),li=null,ao=!1;var v=s.alternate;v!==null&&(v.return=null),s.return=null}catch(w){Er(s,e,w)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)fP(e,t),e=e.sibling}function fP(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(so(e,t),Io(t),r&4){try{Hd(3,t,t.return),ry(3,t)}catch(B){Er(t,t.return,B)}try{Hd(5,t,t.return)}catch(B){Er(t,t.return,B)}}break;case 1:so(e,t),Io(t),r&512&&n!==null&&Lu(n,n.return);break;case 5:if(so(e,t),Io(t),r&512&&n!==null&&Lu(n,n.return),t.flags&32){var s=t.stateNode;try{sf(s,"")}catch(B){Er(t,t.return,B)}}if(r&4&&(s=t.stateNode,s!=null)){var l=t.memoizedProps,d=n!==null?n.memoizedProps:l,c=t.type,v=t.updateQueue;if(t.updateQueue=null,v!==null)try{c==="input"&&l.type==="radio"&&l.name!=null&&OS(s,l),J0(c,d);var w=J0(c,l);for(d=0;d<v.length;d+=2){var C=v[d],I=v[d+1];C==="style"?NS(s,I):C==="dangerouslySetInnerHTML"?FS(s,I):C==="children"?sf(s,I):Tx(s,C,I,w)}switch(c){case"input":q0(s,l);break;case"textarea":DS(s,l);break;case"select":var S=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!l.multiple;var z=l.value;z!=null?Bu(s,!!l.multiple,z,!1):S!==!!l.multiple&&(l.defaultValue!=null?Bu(s,!!l.multiple,l.defaultValue,!0):Bu(s,!!l.multiple,l.multiple?[]:"",!1))}s[pf]=l}catch(B){Er(t,t.return,B)}}break;case 6:if(so(e,t),Io(t),r&4){if(t.stateNode===null)throw Error(qe(162));s=t.stateNode,l=t.memoizedProps;try{s.nodeValue=l}catch(B){Er(t,t.return,B)}}break;case 3:if(so(e,t),Io(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{cf(e.containerInfo)}catch(B){Er(t,t.return,B)}break;case 4:so(e,t),Io(t);break;case 13:so(e,t),Io(t),s=t.child,s.flags&8192&&(l=s.memoizedState!==null,s.stateNode.isHidden=l,!l||s.alternate!==null&&s.alternate.memoizedState!==null||(r1=Ir())),r&4&&SE(t);break;case 22:if(C=n!==null&&n.memoizedState!==null,t.mode&1?(Ti=(w=Ti)||C,so(e,t),Ti=w):so(e,t),Io(t),r&8192){if(w=t.memoizedState!==null,(t.stateNode.isHidden=w)&&!C&&(t.mode&1)!==0)for(Et=t,C=t.child;C!==null;){for(I=Et=C;Et!==null;){switch(S=Et,z=S.child,S.tag){case 0:case 11:case 14:case 15:Hd(4,S,S.return);break;case 1:Lu(S,S.return);var F=S.stateNode;if(typeof F.componentWillUnmount=="function"){r=S,n=S.return;try{e=r,F.props=e.memoizedProps,F.state=e.memoizedState,F.componentWillUnmount()}catch(B){Er(r,n,B)}}break;case 5:Lu(S,S.return);break;case 22:if(S.memoizedState!==null){PE(I);continue}}z!==null?(z.return=S,Et=z):PE(I)}C=C.sibling}e:for(C=null,I=t;;){if(I.tag===5){if(C===null){C=I;try{s=I.stateNode,w?(l=s.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(c=I.stateNode,v=I.memoizedProps.style,d=v!=null&&v.hasOwnProperty("display")?v.display:null,c.style.display=BS("display",d))}catch(B){Er(t,t.return,B)}}}else if(I.tag===6){if(C===null)try{I.stateNode.nodeValue=w?"":I.memoizedProps}catch(B){Er(t,t.return,B)}}else if((I.tag!==22&&I.tag!==23||I.memoizedState===null||I===t)&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===t)break e;for(;I.sibling===null;){if(I.return===null||I.return===t)break e;C===I&&(C=null),I=I.return}C===I&&(C=null),I.sibling.return=I.return,I=I.sibling}}break;case 19:so(e,t),Io(t),r&4&&SE(t);break;case 21:break;default:so(e,t),Io(t)}}function Io(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(hP(n)){var r=n;break e}n=n.return}throw Error(qe(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(sf(s,""),r.flags&=-33);var l=TE(t);Cv(t,l,s);break;case 3:case 4:var d=r.stateNode.containerInfo,c=TE(t);Pv(t,c,d);break;default:throw Error(qe(161))}}catch(v){Er(t,t.return,v)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function ZR(t,e,n){Et=t,pP(t)}function pP(t,e,n){for(var r=(t.mode&1)!==0;Et!==null;){var s=Et,l=s.child;if(s.tag===22&&r){var d=s.memoizedState!==null||gm;if(!d){var c=s.alternate,v=c!==null&&c.memoizedState!==null||Ti;c=gm;var w=Ti;if(gm=d,(Ti=v)&&!w)for(Et=s;Et!==null;)d=Et,v=d.child,d.tag===22&&d.memoizedState!==null?CE(s):v!==null?(v.return=d,Et=v):CE(s);for(;l!==null;)Et=l,pP(l),l=l.sibling;Et=s,gm=c,Ti=w}AE(t)}else(s.subtreeFlags&8772)!==0&&l!==null?(l.return=s,Et=l):AE(t)}}function AE(t){for(;Et!==null;){var e=Et;if((e.flags&8772)!==0){var n=e.alternate;try{if((e.flags&8772)!==0)switch(e.tag){case 0:case 11:case 15:Ti||ry(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ti)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:oo(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var l=e.updateQueue;l!==null&&cE(e,l,r);break;case 3:var d=e.updateQueue;if(d!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}cE(e,d,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var v=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":v.autoFocus&&n.focus();break;case"img":v.src&&(n.src=v.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var w=e.alternate;if(w!==null){var C=w.memoizedState;if(C!==null){var I=C.dehydrated;I!==null&&cf(I)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(qe(163))}Ti||e.flags&512&&Av(e)}catch(S){Er(e,e.return,S)}}if(e===t){Et=null;break}if(n=e.sibling,n!==null){n.return=e.return,Et=n;break}Et=e.return}}function PE(t){for(;Et!==null;){var e=Et;if(e===t){Et=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Et=n;break}Et=e.return}}function CE(t){for(;Et!==null;){var e=Et;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ry(4,e)}catch(v){Er(e,n,v)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(v){Er(e,s,v)}}var l=e.return;try{Av(e)}catch(v){Er(e,l,v)}break;case 5:var d=e.return;try{Av(e)}catch(v){Er(e,d,v)}}}catch(v){Er(e,e.return,v)}if(e===t){Et=null;break}var c=e.sibling;if(c!==null){c.return=e.return,Et=c;break}Et=e.return}}var YR=Math.ceil,Tg=wa.ReactCurrentDispatcher,t1=wa.ReactCurrentOwner,Gs=wa.ReactCurrentBatchConfig,Tn=0,ei=null,Nr=null,di=0,_s=0,Ru=wl(0),qr=0,xf=null,wc=0,iy=0,n1=0,qd=null,Ji=null,r1=0,eh=1/0,aa=null,Sg=!1,Iv=null,dl=null,ym=!1,sl=null,Ag=0,Xd=0,kv=null,Gm=-1,$m=0;function ji(){return(Tn&6)!==0?Ir():Gm!==-1?Gm:Gm=Ir()}function fl(t){return(t.mode&1)===0?1:(Tn&2)!==0&&di!==0?di&-di:RR.transition!==null?($m===0&&($m=KS()),$m):(t=Nn,t!==0||(t=window.event,t=t===void 0?16:iA(t.type)),t)}function ho(t,e,n,r){if(50<Xd)throw Xd=0,kv=null,Error(qe(185));Df(t,n,r),((Tn&2)===0||t!==ei)&&(t===ei&&((Tn&2)===0&&(iy|=n),qr===4&&nl(t,di)),rs(t,r),n===1&&Tn===0&&(e.mode&1)===0&&(eh=Ir()+500,ey&&El()))}function rs(t,e){var n=t.callbackNode;RL(t,e);var r=cg(t,t===ei?di:0);if(r===0)n!==null&&Fw(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Fw(n),e===1)t.tag===0?LR(IE.bind(null,t)):EA(IE.bind(null,t)),CR(function(){(Tn&6)===0&&El()}),n=null;else{switch(JS(r)){case 1:n=Ix;break;case 4:n=ZS;break;case 16:n=lg;break;case 536870912:n=YS;break;default:n=lg}n=wP(n,mP.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function mP(t,e){if(Gm=-1,$m=0,(Tn&6)!==0)throw Error(qe(327));var n=t.callbackNode;if(Gu()&&t.callbackNode!==n)return null;var r=cg(t,t===ei?di:0);if(r===0)return null;if((r&30)!==0||(r&t.expiredLanes)!==0||e)e=Pg(t,r);else{e=r;var s=Tn;Tn|=2;var l=yP();(ei!==t||di!==e)&&(aa=null,eh=Ir()+500,gc(t,e));do try{QR();break}catch(c){gP(t,c)}while(1);jx(),Tg.current=l,Tn=s,Nr!==null?e=0:(ei=null,di=0,e=qr)}if(e!==0){if(e===2&&(s=rv(t),s!==0&&(r=s,e=Mv(t,s))),e===1)throw n=xf,gc(t,0),nl(t,r),rs(t,Ir()),n;if(e===6)nl(t,r);else{if(s=t.current.alternate,(r&30)===0&&!KR(s)&&(e=Pg(t,r),e===2&&(l=rv(t),l!==0&&(r=l,e=Mv(t,l))),e===1))throw n=xf,gc(t,0),nl(t,r),rs(t,Ir()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(qe(345));case 2:lc(t,Ji,aa);break;case 3:if(nl(t,r),(r&130023424)===r&&(e=r1+500-Ir(),10<e)){if(cg(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){ji(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=hv(lc.bind(null,t,Ji,aa),e);break}lc(t,Ji,aa);break;case 4:if(nl(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var d=31-uo(r);l=1<<d,d=e[d],d>s&&(s=d),r&=~l}if(r=s,r=Ir()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*YR(r/1960))-r,10<r){t.timeoutHandle=hv(lc.bind(null,t,Ji,aa),r);break}lc(t,Ji,aa);break;case 5:lc(t,Ji,aa);break;default:throw Error(qe(329))}}}return rs(t,Ir()),t.callbackNode===n?mP.bind(null,t):null}function Mv(t,e){var n=qd;return t.current.memoizedState.isDehydrated&&(gc(t,e).flags|=256),t=Pg(t,e),t!==2&&(e=Ji,Ji=n,e!==null&&Lv(e)),t}function Lv(t){Ji===null?Ji=t:Ji.push.apply(Ji,t)}function KR(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],l=s.getSnapshot;s=s.value;try{if(!mo(l(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function nl(t,e){for(e&=~n1,e&=~iy,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-uo(e),r=1<<n;t[n]=-1,e&=~r}}function IE(t){if((Tn&6)!==0)throw Error(qe(327));Gu();var e=cg(t,0);if((e&1)===0)return rs(t,Ir()),null;var n=Pg(t,e);if(t.tag!==0&&n===2){var r=rv(t);r!==0&&(e=r,n=Mv(t,r))}if(n===1)throw n=xf,gc(t,0),nl(t,e),rs(t,Ir()),n;if(n===6)throw Error(qe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,lc(t,Ji,aa),rs(t,Ir()),null}function i1(t,e){var n=Tn;Tn|=1;try{return t(e)}finally{Tn=n,Tn===0&&(eh=Ir()+500,ey&&El())}}function Ec(t){sl!==null&&sl.tag===0&&(Tn&6)===0&&Gu();var e=Tn;Tn|=1;var n=Gs.transition,r=Nn;try{if(Gs.transition=null,Nn=1,t)return t()}finally{Nn=r,Gs.transition=n,Tn=e,(Tn&6)===0&&El()}}function s1(){_s=Ru.current,sr(Ru)}function gc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,PR(n)),Nr!==null)for(n=Nr.return;n!==null;){var r=n;switch(Nx(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&pg();break;case 3:Ju(),sr(ts),sr(Pi),Xx();break;case 5:qx(r);break;case 4:Ju();break;case 13:sr(mr);break;case 19:sr(mr);break;case 10:Gx(r.type._context);break;case 22:case 23:s1()}n=n.return}if(ei=t,Nr=t=pl(t.current,null),di=_s=e,qr=0,xf=null,n1=iy=wc=0,Ji=qd=null,fc!==null){for(e=0;e<fc.length;e++)if(n=fc[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,l=n.pending;if(l!==null){var d=l.next;l.next=s,r.next=d}n.pending=r}fc=null}return t}function gP(t,e){do{var n=Nr;try{if(jx(),Um.current=Eg,wg){for(var r=gr.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}wg=!1}if(bc=0,Qr=Hr=gr=null,Wd=!1,yf=0,t1.current=null,n===null||n.return===null){qr=1,xf=e,Nr=null;break}e:{var l=t,d=n.return,c=n,v=e;if(e=di,c.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){var w=v,C=c,I=C.tag;if((C.mode&1)===0&&(I===0||I===11||I===15)){var S=C.alternate;S?(C.updateQueue=S.updateQueue,C.memoizedState=S.memoizedState,C.lanes=S.lanes):(C.updateQueue=null,C.memoizedState=null)}var z=gE(d);if(z!==null){z.flags&=-257,yE(z,d,c,l,e),z.mode&1&&mE(l,w,e),e=z,v=w;var F=e.updateQueue;if(F===null){var B=new Set;B.add(v),e.updateQueue=B}else F.add(v);break e}else{if((e&1)===0){mE(l,w,e),o1();break e}v=Error(qe(426))}}else if(dr&&c.mode&1){var Q=gE(d);if(Q!==null){(Q.flags&65536)===0&&(Q.flags|=256),yE(Q,d,c,l,e),Ux(Qu(v,c));break e}}l=v=Qu(v,c),qr!==4&&(qr=2),qd===null?qd=[l]:qd.push(l),l=d;do{switch(l.tag){case 3:l.flags|=65536,e&=-e,l.lanes|=e;var q=QA(l,v,e);lE(l,q);break e;case 1:c=v;var j=l.type,G=l.stateNode;if((l.flags&128)===0&&(typeof j.getDerivedStateFromError=="function"||G!==null&&typeof G.componentDidCatch=="function"&&(dl===null||!dl.has(G)))){l.flags|=65536,e&=-e,l.lanes|=e;var se=eP(l,c,e);lE(l,se);break e}}l=l.return}while(l!==null)}vP(n)}catch(he){e=he,Nr===n&&n!==null&&(Nr=n=n.return);continue}break}while(1)}function yP(){var t=Tg.current;return Tg.current=Eg,t===null?Eg:t}function o1(){(qr===0||qr===3||qr===2)&&(qr=4),ei===null||(wc&268435455)===0&&(iy&268435455)===0||nl(ei,di)}function Pg(t,e){var n=Tn;Tn|=2;var r=yP();(ei!==t||di!==e)&&(aa=null,gc(t,e));do try{JR();break}catch(s){gP(t,s)}while(1);if(jx(),Tn=n,Tg.current=r,Nr!==null)throw Error(qe(261));return ei=null,di=0,qr}function JR(){for(;Nr!==null;)_P(Nr)}function QR(){for(;Nr!==null&&!TL();)_P(Nr)}function _P(t){var e=bP(t.alternate,t,_s);t.memoizedProps=t.pendingProps,e===null?vP(t):Nr=e,t1.current=null}function vP(t){var e=t;do{var n=e.alternate;if(t=e.return,(e.flags&32768)===0){if(n=WR(n,e,_s),n!==null){Nr=n;return}}else{if(n=HR(n,e),n!==null){n.flags&=32767,Nr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{qr=6,Nr=null;return}}if(e=e.sibling,e!==null){Nr=e;return}Nr=e=t}while(e!==null);qr===0&&(qr=5)}function lc(t,e,n){var r=Nn,s=Gs.transition;try{Gs.transition=null,Nn=1,eO(t,e,n,r)}finally{Gs.transition=s,Nn=r}return null}function eO(t,e,n,r){do Gu();while(sl!==null);if((Tn&6)!==0)throw Error(qe(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(qe(177));t.callbackNode=null,t.callbackPriority=0;var l=n.lanes|n.childLanes;if(OL(t,l),t===ei&&(Nr=ei=null,di=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||ym||(ym=!0,wP(lg,function(){return Gu(),null})),l=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||l){l=Gs.transition,Gs.transition=null;var d=Nn;Nn=1;var c=Tn;Tn|=4,t1.current=null,XR(t,n),fP(n,t),xR(cv),ug=!!lv,cv=lv=null,t.current=n,ZR(n),SL(),Tn=c,Nn=d,Gs.transition=l}else t.current=n;if(ym&&(ym=!1,sl=t,Ag=s),l=t.pendingLanes,l===0&&(dl=null),CL(n.stateNode),rs(t,Ir()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Sg)throw Sg=!1,t=Iv,Iv=null,t;return(Ag&1)!==0&&t.tag!==0&&Gu(),l=t.pendingLanes,(l&1)!==0?t===kv?Xd++:(Xd=0,kv=t):Xd=0,El(),null}function Gu(){if(sl!==null){var t=JS(Ag),e=Gs.transition,n=Nn;try{if(Gs.transition=null,Nn=16>t?16:t,sl===null)var r=!1;else{if(t=sl,sl=null,Ag=0,(Tn&6)!==0)throw Error(qe(331));var s=Tn;for(Tn|=4,Et=t.current;Et!==null;){var l=Et,d=l.child;if((Et.flags&16)!==0){var c=l.deletions;if(c!==null){for(var v=0;v<c.length;v++){var w=c[v];for(Et=w;Et!==null;){var C=Et;switch(C.tag){case 0:case 11:case 15:Hd(8,C,l)}var I=C.child;if(I!==null)I.return=C,Et=I;else for(;Et!==null;){C=Et;var S=C.sibling,z=C.return;if(uP(C),C===w){Et=null;break}if(S!==null){S.return=z,Et=S;break}Et=z}}}var F=l.alternate;if(F!==null){var B=F.child;if(B!==null){F.child=null;do{var Q=B.sibling;B.sibling=null,B=Q}while(B!==null)}}Et=l}}if((l.subtreeFlags&2064)!==0&&d!==null)d.return=l,Et=d;else e:for(;Et!==null;){if(l=Et,(l.flags&2048)!==0)switch(l.tag){case 0:case 11:case 15:Hd(9,l,l.return)}var q=l.sibling;if(q!==null){q.return=l.return,Et=q;break e}Et=l.return}}var j=t.current;for(Et=j;Et!==null;){d=Et;var G=d.child;if((d.subtreeFlags&2064)!==0&&G!==null)G.return=d,Et=G;else e:for(d=j;Et!==null;){if(c=Et,(c.flags&2048)!==0)try{switch(c.tag){case 0:case 11:case 15:ry(9,c)}}catch(he){Er(c,c.return,he)}if(c===d){Et=null;break e}var se=c.sibling;if(se!==null){se.return=c.return,Et=se;break e}Et=c.return}}if(Tn=s,El(),Uo&&typeof Uo.onPostCommitFiberRoot=="function")try{Uo.onPostCommitFiberRoot(Zg,t)}catch{}r=!0}return r}finally{Nn=n,Gs.transition=e}}return!1}function kE(t,e,n){e=Qu(n,e),e=QA(t,e,1),t=hl(t,e,1),e=ji(),t!==null&&(Df(t,1,e),rs(t,e))}function Er(t,e,n){if(t.tag===3)kE(t,t,n);else for(;e!==null;){if(e.tag===3){kE(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(dl===null||!dl.has(r))){t=Qu(n,t),t=eP(e,t,1),e=hl(e,t,1),t=ji(),e!==null&&(Df(e,1,t),rs(e,t));break}}e=e.return}}function tO(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ji(),t.pingedLanes|=t.suspendedLanes&n,ei===t&&(di&n)===n&&(qr===4||qr===3&&(di&130023424)===di&&500>Ir()-r1?gc(t,0):n1|=n),rs(t,e)}function xP(t,e){e===0&&((t.mode&1)===0?e=1:(e=am,am<<=1,(am&130023424)===0&&(am=4194304)));var n=ji();t=ya(t,e),t!==null&&(Df(t,e,n),rs(t,n))}function nO(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),xP(t,n)}function rO(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(qe(314))}r!==null&&r.delete(e),xP(t,n)}var bP;bP=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ts.current)Qi=!0;else{if((t.lanes&n)===0&&(e.flags&128)===0)return Qi=!1,$R(t,e,n);Qi=(t.flags&131072)!==0}else Qi=!1,dr&&(e.flags&1048576)!==0&&TA(e,yg,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;jm(t,e),t=e.pendingProps;var s=Zu(e,Pi.current);ju(e,n),s=Yx(null,e,r,t,s,n);var l=Kx();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ns(r)?(l=!0,mg(e)):l=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Wx(e),s.updater=ty,e.stateNode=s,s._reactInternals=e,_v(e,r,t,n),e=bv(null,e,r,!0,l,n)):(e.tag=0,dr&&l&&Bx(e),Ni(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(jm(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=sO(r),t=oo(r,t),s){case 0:e=xv(null,e,r,t,n);break e;case 1:e=xE(null,e,r,t,n);break e;case 11:e=_E(null,e,r,t,n);break e;case 14:e=vE(null,e,r,oo(r.type,t),n);break e}throw Error(qe(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:oo(r,s),xv(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:oo(r,s),xE(t,e,r,s,n);case 3:e:{if(iP(e),t===null)throw Error(qe(387));r=e.pendingProps,l=e.memoizedState,s=l.element,CA(t,e),xg(e,r,null,n);var d=e.memoizedState;if(r=d.element,l.isDehydrated)if(l={element:r,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},e.updateQueue.baseState=l,e.memoizedState=l,e.flags&256){s=Qu(Error(qe(423)),e),e=bE(t,e,r,n,s);break e}else if(r!==s){s=Qu(Error(qe(424)),e),e=bE(t,e,r,n,s);break e}else for(bs=ul(e.stateNode.containerInfo.firstChild),Es=e,dr=!0,lo=null,n=LA(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Yu(),r===s){e=_a(t,e,n);break e}Ni(t,e,r,n)}e=e.child}return e;case 5:return RA(e),t===null&&mv(e),r=e.type,s=e.pendingProps,l=t!==null?t.memoizedProps:null,d=s.children,uv(r,s)?d=null:l!==null&&uv(r,l)&&(e.flags|=32),rP(t,e),Ni(t,e,d,n),e.child;case 6:return t===null&&mv(e),null;case 13:return sP(t,e,n);case 4:return Hx(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ku(e,null,r,n):Ni(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:oo(r,s),_E(t,e,r,s,n);case 7:return Ni(t,e,e.pendingProps,n),e.child;case 8:return Ni(t,e,e.pendingProps.children,n),e.child;case 12:return Ni(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,l=e.memoizedProps,d=s.value,tr(_g,r._currentValue),r._currentValue=d,l!==null)if(mo(l.value,d)){if(l.children===s.children&&!ts.current){e=_a(t,e,n);break e}}else for(l=e.child,l!==null&&(l.return=e);l!==null;){var c=l.dependencies;if(c!==null){d=l.child;for(var v=c.firstContext;v!==null;){if(v.context===r){if(l.tag===1){v=da(-1,n&-n),v.tag=2;var w=l.updateQueue;if(w!==null){w=w.shared;var C=w.pending;C===null?v.next=v:(v.next=C.next,C.next=v),w.pending=v}}l.lanes|=n,v=l.alternate,v!==null&&(v.lanes|=n),gv(l.return,n,e),c.lanes|=n;break}v=v.next}}else if(l.tag===10)d=l.type===e.type?null:l.child;else if(l.tag===18){if(d=l.return,d===null)throw Error(qe(341));d.lanes|=n,c=d.alternate,c!==null&&(c.lanes|=n),gv(d,n,e),d=l.sibling}else d=l.child;if(d!==null)d.return=l;else for(d=l;d!==null;){if(d===e){d=null;break}if(l=d.sibling,l!==null){l.return=d.return,d=l;break}d=d.return}l=d}Ni(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ju(e,n),s=Ws(s),r=r(s),e.flags|=1,Ni(t,e,r,n),e.child;case 14:return r=e.type,s=oo(r,e.pendingProps),s=oo(r.type,s),vE(t,e,r,s,n);case 15:return tP(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:oo(r,s),jm(t,e),e.tag=1,ns(r)?(t=!0,mg(e)):t=!1,ju(e,n),kA(e,r,s),_v(e,r,s,n),bv(null,e,r,!0,t,n);case 19:return oP(t,e,n);case 22:return nP(t,e,n)}throw Error(qe(156,e.tag))};function wP(t,e){return XS(t,e)}function iO(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vs(t,e,n,r){return new iO(t,e,n,r)}function a1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function sO(t){if(typeof t=="function")return a1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ax)return 11;if(t===Px)return 14}return 2}function pl(t,e){var n=t.alternate;return n===null?(n=Vs(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Wm(t,e,n,r,s,l){var d=2;if(r=t,typeof t=="function")a1(t)&&(d=1);else if(typeof t=="string")d=5;else e:switch(t){case Eu:return yc(n.children,s,l,e);case Sx:d=8,s|=8;break;case j0:return t=Vs(12,n,e,s|2),t.elementType=j0,t.lanes=l,t;case G0:return t=Vs(13,n,e,s),t.elementType=G0,t.lanes=l,t;case $0:return t=Vs(19,n,e,s),t.elementType=$0,t.lanes=l,t;case MS:return sy(n,s,l,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case IS:d=10;break e;case kS:d=9;break e;case Ax:d=11;break e;case Px:d=14;break e;case Qa:d=16,r=null;break e}throw Error(qe(130,t==null?t:typeof t,""))}return e=Vs(d,n,e,s),e.elementType=t,e.type=r,e.lanes=l,e}function yc(t,e,n,r){return t=Vs(7,t,r,e),t.lanes=n,t}function sy(t,e,n,r){return t=Vs(22,t,r,e),t.elementType=MS,t.lanes=n,t.stateNode={isHidden:!1},t}function r0(t,e,n){return t=Vs(6,t,null,e),t.lanes=n,t}function i0(t,e,n){return e=Vs(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function oO(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=B_(0),this.expirationTimes=B_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=B_(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function l1(t,e,n,r,s,l,d,c,v){return t=new oO(t,e,n,c,v),e===1?(e=1,l===!0&&(e|=8)):e=0,l=Vs(3,null,null,e),t.current=l,l.stateNode=t,l.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Wx(l),t}function aO(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wu,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function EP(t){if(!t)return _l;t=t._reactInternals;e:{if(Ic(t)!==t||t.tag!==1)throw Error(qe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ns(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(qe(171))}if(t.tag===1){var n=t.type;if(ns(n))return wA(t,n,e)}return e}function TP(t,e,n,r,s,l,d,c,v){return t=l1(n,r,!0,t,s,l,d,c,v),t.context=EP(null),n=t.current,r=ji(),s=fl(n),l=da(r,s),l.callback=e!=null?e:null,hl(n,l,s),t.current.lanes=s,Df(t,s,r),rs(t,r),t}function oy(t,e,n,r){var s=e.current,l=ji(),d=fl(s);return n=EP(n),e.context===null?e.context=n:e.pendingContext=n,e=da(l,d),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=hl(s,e,d),t!==null&&(ho(t,s,d,l),Nm(t,s,d)),d}function Cg(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ME(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function c1(t,e){ME(t,e),(t=t.alternate)&&ME(t,e)}function lO(){return null}var SP=typeof reportError=="function"?reportError:function(t){console.error(t)};function u1(t){this._internalRoot=t}ay.prototype.render=u1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(qe(409));oy(t,e,null,null)};ay.prototype.unmount=u1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ec(function(){oy(null,t,null,null)}),e[ga]=null}};function ay(t){this._internalRoot=t}ay.prototype.unstable_scheduleHydration=function(t){if(t){var e=tA();t={blockedOn:null,target:t,priority:e};for(var n=0;n<tl.length&&e!==0&&e<tl[n].priority;n++);tl.splice(n,0,t),n===0&&rA(t)}};function h1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ly(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function LE(){}function cO(t,e,n,r,s){if(s){if(typeof r=="function"){var l=r;r=function(){var w=Cg(d);l.call(w)}}var d=TP(e,r,t,0,null,!1,!1,"",LE);return t._reactRootContainer=d,t[ga]=d.current,df(t.nodeType===8?t.parentNode:t),Ec(),d}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var w=Cg(v);c.call(w)}}var v=l1(t,0,!1,null,null,!1,!1,"",LE);return t._reactRootContainer=v,t[ga]=v.current,df(t.nodeType===8?t.parentNode:t),Ec(function(){oy(e,v,n,r)}),v}function cy(t,e,n,r,s){var l=n._reactRootContainer;if(l){var d=l;if(typeof s=="function"){var c=s;s=function(){var v=Cg(d);c.call(v)}}oy(e,d,t,s)}else d=cO(n,e,t,s,r);return Cg(d)}QS=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Rd(e.pendingLanes);n!==0&&(kx(e,n|1),rs(e,Ir()),(Tn&6)===0&&(eh=Ir()+500,El()))}break;case 13:Ec(function(){var r=ya(t,1);if(r!==null){var s=ji();ho(r,t,1,s)}}),c1(t,1)}};Mx=function(t){if(t.tag===13){var e=ya(t,134217728);if(e!==null){var n=ji();ho(e,t,134217728,n)}c1(t,134217728)}};eA=function(t){if(t.tag===13){var e=fl(t),n=ya(t,e);if(n!==null){var r=ji();ho(n,t,e,r)}c1(t,e)}};tA=function(){return Nn};nA=function(t,e){var n=Nn;try{return Nn=t,e()}finally{Nn=n}};ev=function(t,e,n){switch(e){case"input":if(q0(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Qg(r);if(!s)throw Error(qe(90));RS(r),q0(r,s)}}}break;case"textarea":DS(t,n);break;case"select":e=n.value,e!=null&&Bu(t,!!n.multiple,e,!1)}};jS=i1;GS=Ec;var uO={usingClientEntryPoint:!1,Events:[Ff,Pu,Qg,US,VS,i1]},xd={findFiberByHostInstance:dc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},hO={bundleType:xd.bundleType,version:xd.version,rendererPackageName:xd.rendererPackageName,rendererConfig:xd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:wa.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=HS(t),t===null?null:t.stateNode},findFiberByHostInstance:xd.findFiberByHostInstance||lO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _m=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_m.isDisabled&&_m.supportsFiber)try{Zg=_m.inject(hO),Uo=_m}catch{}}Ps.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uO;Ps.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h1(e))throw Error(qe(200));return aO(t,e,null,n)};Ps.createRoot=function(t,e){if(!h1(t))throw Error(qe(299));var n=!1,r="",s=SP;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=l1(t,1,!1,null,null,n,!1,r,s),t[ga]=e.current,df(t.nodeType===8?t.parentNode:t),new u1(e)};Ps.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(qe(188)):(t=Object.keys(t).join(","),Error(qe(268,t)));return t=HS(e),t=t===null?null:t.stateNode,t};Ps.flushSync=function(t){return Ec(t)};Ps.hydrate=function(t,e,n){if(!ly(e))throw Error(qe(200));return cy(null,t,e,!0,n)};Ps.hydrateRoot=function(t,e,n){if(!h1(t))throw Error(qe(405));var r=n!=null&&n.hydratedSources||null,s=!1,l="",d=SP;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(d=n.onRecoverableError)),e=TP(e,null,t,1,n!=null?n:null,s,!1,l,d),t[ga]=e.current,df(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new ay(e)};Ps.render=function(t,e,n){if(!ly(e))throw Error(qe(200));return cy(null,t,e,!1,n)};Ps.unmountComponentAtNode=function(t){if(!ly(t))throw Error(qe(40));return t._reactRootContainer?(Ec(function(){cy(null,null,t,!1,function(){t._reactRootContainer=null,t[ga]=null})}),!0):!1};Ps.unstable_batchedUpdates=i1;Ps.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ly(n))throw Error(qe(200));if(t==null||t._reactInternals===void 0)throw Error(qe(38));return cy(t,e,n,!1,r)};Ps.version="18.2.0-next-9e3b772b8-20220608";(function(t){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}e(),t.exports=Ps})(gl);const vm=yS(gl.exports);var RE=gl.exports;U0.createRoot=RE.createRoot,U0.hydrateRoot=RE.hydrateRoot;function W(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ig(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const d1=Boolean(typeof process!="object"||String(process)!=="[object process]"||process.browser),OE=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);OE&&parseFloat(OE[1]);const dO="3.2.12";function va(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Hm=typeof process!="object"||String(process)!=="[object process]"||process.browser,fO=typeof window<"u"&&typeof window.orientation<"u",DE=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);DE&&parseFloat(DE[1]);class pO{constructor(e,n){W(this,"name",void 0),W(this,"workerThread",void 0),W(this,"isRunning",!0),W(this,"result",void 0),W(this,"_resolve",()=>{}),W(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,s)=>{this._resolve=r,this._reject=s})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){va(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){va(this.isRunning),this.isRunning=!1,this._reject(e)}}class s0{}const o0=new Map;function mO(t){va(t.source&&!t.url||!t.source&&t.url);let e=o0.get(t.source||t.url);return e||(t.url&&(e=gO(t.url),o0.set(t.url,e)),t.source&&(e=AP(t.source),o0.set(t.source,e))),va(e),e}function gO(t){if(!t.startsWith("http"))return t;const e=yO(t);return AP(e)}function AP(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function yO(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function PP(t,e=!0,n){const r=n||new Set;if(t){if(zE(t))r.add(t);else if(zE(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const s in t)PP(t[s],e,r)}}return n===void 0?Array.from(r):[]}function zE(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const a0=()=>{};class Rv{static isSupported(){return typeof Worker<"u"&&Hm||typeof s0<"u"&&!Hm}constructor(e){W(this,"name",void 0),W(this,"source",void 0),W(this,"url",void 0),W(this,"terminated",!1),W(this,"worker",void 0),W(this,"onMessage",void 0),W(this,"onError",void 0),W(this,"_loadableURL","");const{name:n,source:r,url:s}=e;va(r||s),this.name=n,this.source=r,this.url=s,this.onMessage=a0,this.onError=l=>console.log(l),this.worker=Hm?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=a0,this.onError=a0,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,n){n=n||PP(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=mO({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new s0(r,{eval:!1})}else if(this.source)e=new s0(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class _O{static isSupported(){return Rv.isSupported()}constructor(e){W(this,"name","unnamed"),W(this,"source",void 0),W(this,"url",void 0),W(this,"maxConcurrency",1),W(this,"maxMobileConcurrency",1),W(this,"onDebug",()=>{}),W(this,"reuseWorkers",!0),W(this,"props",{}),W(this,"jobQueue",[]),W(this,"idleQueue",[]),W(this,"count",0),W(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,n=(s,l,d)=>s.done(d),r=(s,l)=>s.error(l)){const s=new Promise(l=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:l}),this));return this._startQueuedJob(),await s}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new pO(n.name,e);e.onMessage=s=>n.onMessage(r,s.type,s.payload),e.onError=s=>n.onError(r,s),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Rv({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return fO?this.maxMobileConcurrency:this.maxConcurrency}}const vO={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class ca{static isSupported(){return Rv.isSupported()}static getWorkerFarm(e={}){return ca._workerFarm=ca._workerFarm||new ca({}),ca._workerFarm.setProps(e),ca._workerFarm}constructor(e){W(this,"props",void 0),W(this,"workerPools",new Map),this.props={...vO},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:s}=e;let l=this.workerPools.get(n);return l||(l=new _O({name:n,source:r,url:s}),l.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,l)),l}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}W(ca,"_workerFarm",void 0);const xO="latest";function bO(t,e={}){const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let s=n.workerUrl;if(!s&&t.id==="compression"&&(s=e.workerUrl),e._workerType==="test"&&(s="modules/".concat(t.module,"/dist/").concat(r)),!s){let l=t.version;l==="latest"&&(l=xO);const d=l?"@".concat(l):"";s="https://unpkg.com/@loaders.gl/".concat(t.module).concat(d,"/dist/").concat(r)}return va(s),s}function wO(t,e=dO){va(t,"no worker provided");const n=t.version;return!(!e||!n)}function EO(t,e){return!ca.isSupported()||!Hm&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function TO(t,e,n,r,s){const l=t.id,d=bO(t,n),v=ca.getWorkerFarm(n).getWorkerPool({name:l,url:d});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const w=await v.startJob("process-on-worker",SO.bind(null,s));return w.postMessage("process",{input:e,options:n,context:r}),await(await w.result).result}async function SO(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:s,input:l,options:d}=r;try{const c=await t(l,d);e.postMessage("done",{id:s,result:c})}catch(c){const v=c instanceof Error?c.message:"unknown error";e.postMessage("error",{id:s,error:v})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function CP(t){return t&&typeof t=="object"&&t.isBuffer}function AO(t){return CP(t)?new Uint8Array(t.buffer,t.byteOffset,t.length).slice().buffer:t}function IP(t){if(CP(t))return AO(t);if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function PO(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),s=new Uint8Array(e);for(let l=0;l<r.length;++l)if(r[l]!==s[l])return!1;return!0}function CO(...t){const e=t.map(l=>l instanceof ArrayBuffer?new Uint8Array(l):l),n=e.reduce((l,d)=>l+d.byteLength,0),r=new Uint8Array(n);let s=0;for(const l of e)r.set(l,s),s+=l.byteLength;return r.buffer}async function IO(t){const e=[];for await(const n of t)e.push(n);return CO(...e)}function FE(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class BE{constructor(e,n){W(this,"name",void 0),W(this,"type",void 0),W(this,"sampleSize",1),W(this,"time",void 0),W(this,"count",void 0),W(this,"samples",void 0),W(this,"lastTiming",void 0),W(this,"lastSampleTime",void 0),W(this,"lastSampleCount",void 0),W(this,"_count",0),W(this,"_time",0),W(this,"_samples",0),W(this,"_startTime",0),W(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=FE(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(FE()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class f1{constructor(e){W(this,"id",void 0),W(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof BE?this.stats[n]=e:this.stats[n]=new BE(n,r)),this.stats[n]}}let kO="";const NE={};function MO(t){for(const e in NE)if(t.startsWith(e)){const n=NE[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(kO).concat(t)),t}function LO(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(e+1):""}const RO=t=>typeof t=="boolean",Zd=t=>typeof t=="function",Nf=t=>t!==null&&typeof t=="object",UE=t=>Nf(t)&&t.constructor==={}.constructor,OO=t=>t&&typeof t[Symbol.iterator]=="function",DO=t=>t&&typeof t[Symbol.asyncIterator]=="function",mh=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,gh=t=>typeof Blob<"u"&&t instanceof Blob,zO=t=>t&&typeof t=="object"&&t.isBuffer,FO=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Nf(t)&&Zd(t.tee)&&Zd(t.cancel)&&Zd(t.getReader),BO=t=>Nf(t)&&Zd(t.read)&&Zd(t.pipe)&&RO(t.readable),kP=t=>FO(t)||BO(t),NO=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,UO=/^([-\w.]+\/[-\w.+]+)/;function VO(t){const e=UO.exec(t);return e?e[1]:t}function VE(t){const e=NO.exec(t);return e?e[1]:""}const jO=/\?.*/;function uy(t){if(mh(t)){const e=l0(t.url||""),n=t.headers.get("content-type")||"";return{url:e,type:VO(n)||VE(e)}}return gh(t)?{url:l0(t.name||""),type:t.type||""}:typeof t=="string"?{url:l0(t),type:VE(t)}:{url:"",type:""}}function GO(t){return mh(t)?t.headers["content-length"]||-1:gh(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}function l0(t){return t.replace(jO,"")}async function MP(t){if(mh(t))return t;const e={},n=GO(t);n>=0&&(e["content-length"]=String(n));const{url:r,type:s}=uy(t);s&&(e["content-type"]=s);const l=await HO(t);l&&(e["x-first-bytes"]=l),typeof t=="string"&&(t=new TextEncoder().encode(t));const d=new Response(t,{headers:e});return Object.defineProperty(d,"url",{value:r}),d}async function $O(t){if(!t.ok){const e=await WO(t);throw new Error(e)}}async function WO(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function HO(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const s=new FileReader;s.onload=l=>{var d;return r(l==null||(d=l.target)===null||d===void 0?void 0:d.result)},s.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=qO(n);return"data:base64,".concat(r)}return null}function qO(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function jE(t,e){if(typeof t=="string"){t=MO(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await MP(t)}function LP(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&Boolean(process.versions.electron))return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Ea(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||LP()}const qm={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},xm=qm.window||qm.self||qm.global,bd=qm.process||{},RP=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Ea();const c0=globalThis;function OP(t){if(!t&&!Ea())return"Node";if(LP(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,s=n.indexOf("Trident/")!==-1;return r||s?"IE":c0.chrome?"Chrome":c0.safari?"Safari":c0.mozInnerScreenX?"Firefox":"Unknown"}function XO(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class ZO{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";W(this,"storage",void 0),W(this,"id",void 0),W(this,"config",{}),this.storage=XO(r),this.id=e,this.config={},Object.assign(this.config,n),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){return this.config={},this.updateConfiguration(e)}updateConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}return this}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function YO(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function KO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function u0(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const s=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const l=t.width*n,d=t.height*n,c=["font-size:1px;","padding:".concat(Math.floor(d/2),"px ").concat(Math.floor(l/2),"px;"),"line-height:".concat(d,"px;"),"background:url(".concat(s,");"),"background-size:".concat(l,"px ").concat(d,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),c]}let kg;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(kg||(kg={}));function GE(t){return typeof t=="string"?kg[t.toUpperCase()]||kg.WHITE:t}function JO(t,e,n){return!Ea&&typeof t=="string"&&(e&&(e=GE(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=GE(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function QO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const s of r)typeof t[s]=="function"&&(e.find(l=>s===l)||(t[s]=t[s].bind(t)))}function Mg(t,e){if(!t)throw new Error(e||"Assertion failed")}function lu(){let t;if(Ea&&"performance"in xm){var e,n;t=xm==null||(e=xm.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in bd){var r;const s=bd==null||(r=bd.hrtime)===null||r===void 0?void 0:r.call(bd);t=s[0]*1e3+s[1]/1e6}else t=Date.now();return t}const cu={debug:Ea&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},eD={enabled:!0,level:0};function Bs(){}const $E={},WE={once:!0};class Uf{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};W(this,"id",void 0),W(this,"VERSION",RP),W(this,"_startTs",lu()),W(this,"_deltaTs",lu()),W(this,"_storage",void 0),W(this,"userData",{}),W(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this._storage=new ZO("__probe-".concat(this.id,"__"),eD),this.userData={},this.timeStamp("".concat(this.id," started")),QO(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((lu()-this._startTs).toPrecision(10))}getDelta(){return Number((lu()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:e}),this}setLevel(e){return this._storage.updateConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.updateConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Mg(e,n)}warn(e){return this._getLogFunction(0,e,cu.warn,arguments,WE)}error(e){return this._getLogFunction(0,e,cu.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,cu.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,cu.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,s=new Array(r>2?r-2:0),l=2;l<r;l++)s[l-2]=arguments[l];return this._getLogFunction(e,n,cu.debug||cu.info,arguments,WE)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Bs,r&&[r],{tag:iD(n)}):Bs}image(e){let{logLevel:n,priority:r,image:s,message:l="",scale:d=1}=e;return this._shouldLog(n||r)?Ea?rD({image:s,message:l,scale:d}):nD({image:s,message:l,scale:d}):Bs}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Bs)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const s=HE({logLevel:e,message:n,opts:r}),{collapsed:l}=r;return s.method=(l?console.groupCollapsed:console.group)||console.info,this._getLogFunction(s)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Bs)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=DP(e)}_getLogFunction(e,n,r,s,l){if(this._shouldLog(e)){l=HE({logLevel:e,message:n,args:s,opts:l}),r=r||l.method,Mg(r),l.total=this.getTotal(),l.delta=this.getDelta(),this._deltaTs=lu();const d=l.tag||l.message;if(l.once)if(!$E[d])$E[d]=lu();else return Bs;return n=tD(this.id,l.message,l),r.bind(console,n,...l.args)}return Bs}}W(Uf,"VERSION",RP);function DP(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Mg(Number.isFinite(e)&&e>=0),e}function HE(t){const{logLevel:e,message:n}=t;t.logLevel=DP(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const s=typeof t.message;return Mg(s==="string"||s==="object"),Object.assign(t,{args:r},t.opts)}function tD(t,e,n){if(typeof e=="string"){const r=n.time?KO(YO(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=JO(e,n.color,n.background)}return e}function nD(t){let{image:e,message:n="",scale:r=1}=t;return(void 0)({image:e,message:n,scale:r}),Bs}function rD(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const l=new Image;return l.onload=()=>{const d=u0(l,n,r);console.log(...d)},l.src=e,Bs}const s=e.nodeName||"";if(s.toLowerCase()==="img")return console.log(...u0(e,n,r)),Bs;if(s.toLowerCase()==="canvas"){const l=new Image;return l.onload=()=>console.log(...u0(l,n,r)),l.src=e.toDataURL(),Bs}return Bs}function iD(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const qE=new Uf({id:"loaders.gl"});class sD{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class oD{constructor(){W(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const zP={fetch:null,mimeType:void 0,nothrow:!1,log:new oD,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:d1,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},aD={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function FP(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const BP=()=>{const t=FP();return t.globalOptions=t.globalOptions||{...zP},t.globalOptions};function lD(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],cD(t,n),hD(e,t,r)}function NP(t,e){const n=BP(),r=t||n;return typeof r.fetch=="function"?r.fetch:Nf(r.fetch)?s=>jE(s,r):e!=null&&e.fetch?e==null?void 0:e.fetch:jE}function cD(t,e){XE(t,null,zP,aD,e);for(const n of e){const r=t&&t[n.id]||{},s=n.options&&n.options[n.id]||{},l=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};XE(r,n.id,s,l,e)}}function XE(t,e,n,r,s){const l=e||"Top level",d=e?"".concat(e,"."):"";for(const c in t){const v=!e&&Nf(t[c]),w=c==="baseUri"&&!e,C=c==="workerUrl"&&e;if(!(c in n)&&!w&&!C){if(c in r)qE.warn("".concat(l," loader option '").concat(d).concat(c,"' no longer supported, use '").concat(r[c],"'"))();else if(!v){const I=uD(c,s);qE.warn("".concat(l," loader option '").concat(d).concat(c,"' not recognized. ").concat(I))()}}}}function uD(t,e){const n=t.toLowerCase();let r="";for(const s of e)for(const l in s.options){if(t===l)return"Did you mean '".concat(s.id,".").concat(l,"'?");const d=l.toLowerCase();(n.startsWith(d)||d.startsWith(n))&&(r=r||"Did you mean '".concat(s.id,".").concat(l,"'?"))}return r}function hD(t,e,n){const s={...t.options||{}};return dD(s,n),s.log===null&&(s.log=new sD),ZE(s,BP()),ZE(s,e),s}function ZE(t,e){for(const n in e)if(n in e){const r=e[n];UE(r)&&UE(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function dD(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function p1(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function m1(t){var e,n;Ig(t,"null loader"),Ig(p1(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const UP=()=>{const t=FP();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function fD(t){const e=UP();t=Array.isArray(t)?t:[t];for(const n of t){const r=m1(n);e.find(s=>r===s)||e.unshift(r)}}function pD(){return UP()}const mD=new Uf({id:"loaders.gl"}),gD=/\.([^.]+)$/;async function yD(t,e=[],n,r){if(!VP(t))return null;let s=YE(t,e,{...n,nothrow:!0},r);if(s)return s;if(gh(t)&&(t=await t.slice(0,10).arrayBuffer(),s=YE(t,e,n,r)),!s&&!(n!=null&&n.nothrow))throw new Error(jP(t));return s}function YE(t,e=[],n,r){if(!VP(t))return null;if(e&&!Array.isArray(e))return m1(e);let s=[];e&&(s=s.concat(e)),n!=null&&n.ignoreRegisteredLoaders||s.push(...pD()),vD(s);const l=_D(t,s,n,r);if(!l&&!(n!=null&&n.nothrow))throw new Error(jP(t));return l}function _D(t,e,n,r){const{url:s,type:l}=uy(t),d=s||(r==null?void 0:r.url);let c=null,v="";if(n!=null&&n.mimeType&&(c=h0(e,n==null?void 0:n.mimeType),v="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),c=c||xD(e,d),v=v||(c?"matched url ".concat(d):""),c=c||h0(e,l),v=v||(c?"matched MIME type ".concat(l):""),c=c||wD(e,t),v=v||(c?"matched initial data ".concat(GP(t)):""),c=c||h0(e,n==null?void 0:n.fallbackMimeType),v=v||(c?"matched fallback MIME type ".concat(l):""),v){var w;mD.log(1,"selectLoader selected ".concat((w=c)===null||w===void 0?void 0:w.name,": ").concat(v,"."))}return c}function VP(t){return!(t instanceof Response&&t.status===204)}function jP(t){const{url:e,type:n}=uy(t);let r="No valid loader found (";r+=e?"".concat(LO(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const s=t?GP(t):"";return r+=s?' first bytes: "'.concat(s,'"'):"first bytes: not available",r+=")",r}function vD(t){for(const e of t)m1(e)}function xD(t,e){const n=e&&gD.exec(e),r=n&&n[1];return r?bD(t,r):null}function bD(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function h0(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function wD(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(ED(e,n))return n}else if(ArrayBuffer.isView(e)){if(KE(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&KE(e,0,n))return n;return null}function ED(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function KE(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(s=>TD(t,e,n,s))}function TD(t,e,n,r){if(r instanceof ArrayBuffer)return PO(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const s=Ov(t,e,r.length);return r===s;default:return!1}}function GP(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?Ov(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?Ov(t,0,e):""}function Ov(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let s="";for(let l=0;l<n;l++)s+=String.fromCharCode(r.getUint8(e+l));return s}const SD=256*1024;function*AD(t,e){const n=(e==null?void 0:e.chunkSize)||SD;let r=0;const s=new TextEncoder;for(;r<t.length;){const l=Math.min(t.length-r,n),d=t.slice(r,r+l);r+=l,yield s.encode(d)}}const PD=256*1024;function*CD(t,e={}){const{chunkSize:n=PD}=e;let r=0;for(;r<t.byteLength;){const s=Math.min(t.byteLength-r,n),l=new ArrayBuffer(s),d=new Uint8Array(t,r,s);new Uint8Array(l).set(d),r+=s,yield l}}const ID=1024*1024;async function*kD(t,e){const n=(e==null?void 0:e.chunkSize)||ID;let r=0;for(;r<t.size;){const s=r+n,l=await t.slice(r,s).arrayBuffer();r=s,yield l}}function JE(t,e){return d1?MD(t,e):LD(t)}async function*MD(t,e){const n=t.getReader();let r;try{for(;;){const s=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:l,value:d}=await s;if(l)return;yield IP(d)}}catch{n.releaseLock()}}async function*LD(t,e){for await(const n of t)yield IP(n)}function RD(t,e){if(typeof t=="string")return AD(t,e);if(t instanceof ArrayBuffer)return CD(t,e);if(gh(t))return kD(t,e);if(kP(t))return JE(t,e);if(mh(t))return JE(t.body,e);throw new Error("makeIterator")}const $P="Cannot convert supplied data type";function OD(t,e,n){if(e.text&&typeof t=="string")return t;if(zO(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const s=t.byteLength||t.length;return(t.byteOffset!==0||s!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+s)),r}throw new Error($P)}async function DD(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return OD(t,e);if(gh(t)&&(t=await MP(t)),mh(t)){const s=t;return await $O(s),e.binary?await s.arrayBuffer():await s.text()}if(kP(t)&&(t=RD(t,n)),OO(t)||DO(t))return IO(t);throw new Error($P)}function zD(t,e,n=null){if(n)return n;const r={fetch:NP(e,t),...t};return Array.isArray(r.loaders)||(r.loaders=null),r}function FD(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function g1(t,e,n,r){va(!r||typeof r=="object"),e&&!Array.isArray(e)&&!p1(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:s}=uy(t),d=FD(e,r),c=await yD(t,d,n);return c?(n=lD(n,c,d,s),r=zD({url:s,parse:g1,loaders:d},n,r),await BD(c,t,n,r)):null}async function BD(t,e,n,r){if(wO(t),mh(e)){const s=e,{ok:l,redirected:d,status:c,statusText:v,type:w,url:C}=s,I=Object.fromEntries(s.headers.entries());r.response={headers:I,ok:l,redirected:d,status:c,statusText:v,type:w,url:C}}if(e=await DD(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(EO(t,n))return await TO(t,e,n,r,g1);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw va(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function Lg(t,e,n,r){!Array.isArray(e)&&!p1(e)&&(n=e,e=void 0);const s=NP(n);let l=t;return typeof t=="string"&&(l=await s(t)),gh(t)&&(l=await s(t)),await g1(l,e,n)}const ND="3.2.12",{_parseImageNode:UD}=globalThis,Dv=typeof Image<"u",zv=typeof ImageBitmap<"u",VD=Boolean(UD),Fv=d1?!0:VD;function jD(t){switch(t){case"auto":return zv||Dv||Fv;case"imagebitmap":return zv;case"image":return Dv;case"data":return Fv;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function GD(){if(zv)return"imagebitmap";if(Dv)return"image";if(Fv)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function $D(t){const e=HD(t);if(!e)throw new Error("Not an image");return e}function WD(t){switch($D(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function HD(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const qD=/^data:image\/svg\+xml/,XD=/\.svg((\?|#).*)?$/;function y1(t){return t&&(qD.test(t)||XD.test(t))}function ZD(t,e){if(y1(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(l){throw new Error(l.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return WP(t,e)}function WP(t,e){if(y1(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function HP(t,e,n){const r=ZD(t,n),s=self.URL||self.webkitURL,l=typeof r!="string"&&s.createObjectURL(r);try{return await YD(l||r,e)}finally{l&&s.revokeObjectURL(l)}}async function YD(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,s)=>{try{n.onload=()=>r(n),n.onerror=l=>s(new Error("Could not load image ".concat(t,": ").concat(l)))}catch(l){s(l)}})}const KD={};let QE=!0;async function JD(t,e,n){let r;y1(n)?r=await HP(t,e,n):r=WP(t,n);const s=e&&e.imagebitmap;return await QD(r,s)}async function QD(t,e=null){if((ez(e)||!QE)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),QE=!1}return await createImageBitmap(t)}function ez(t){for(const e in t||KD)return!1;return!0}const Fo=!1,Yd=!0;function qP(t){const e=Vf(t);return tz(e)||iz(e)||nz(e)||rz(e)}function tz(t){const e=Vf(t);return e.byteLength>=24&&e.getUint32(0,Fo)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Fo),height:e.getUint32(20,Fo)}:null}function nz(t){const e=Vf(t);return e.byteLength>=10&&e.getUint32(0,Fo)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Yd),height:e.getUint16(8,Yd)}:null}function rz(t){const e=Vf(t);return e.byteLength>=14&&e.getUint16(0,Fo)===16973&&e.getUint32(2,Yd)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Yd),height:e.getUint32(22,Yd)}:null}function iz(t){const e=Vf(t);if(!(e.byteLength>=3&&e.getUint16(0,Fo)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:s}=sz();let l=2;for(;l+9<e.byteLength;){const d=e.getUint16(l,Fo);if(s.has(d))return{mimeType:"image/jpeg",height:e.getUint16(l+5,Fo),width:e.getUint16(l+7,Fo)};if(!r.has(d))return null;l+=2,l+=e.getUint16(l,Fo)}return null}function sz(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Vf(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function oz(t,e){const{mimeType:n}=qP(t)||{},r=globalThis._parseImageNode;return Ig(r),await r(t,n)}async function az(t,e,n){e=e||{};const s=(e.image||{}).type||"auto",{url:l}=n||{},d=lz(s);let c;switch(d){case"imagebitmap":c=await JD(t,e,l);break;case"image":c=await HP(t,e,l);break;case"data":c=await oz(t);break;default:Ig(!1)}return s==="data"&&(c=WD(c)),c}function lz(t){switch(t){case"auto":case"data":return GD();default:return jD(t),t}}const cz=["png","jpg","jpeg","gif","webp","bmp","ico","svg"],uz=["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],hz={image:{type:"auto",decode:!0}},XP={id:"image",module:"images",name:"Images",version:ND,mimeTypes:uz,extensions:cz,parse:az,tests:[t=>Boolean(qP(new DataView(t)))],options:hz},Bn=new Uf({id:"deck"});let Bv={};function dz(t){Bv=t}function Ui(t,e,n,r){Bn.level>0&&Bv[t]&&Bv[t].call(null,e,n,r)}function fz(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const pz={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:fz,parseTextSync:JSON.parse},Kd="8.8.20",Xm=globalThis.deck&&globalThis.deck.VERSION;if(Xm&&Xm!==Kd)throw new Error("deck.gl - multiple versions detected: ".concat(Xm," vs ").concat(Kd));Xm||(Bn.log(1,"deck.gl ".concat(Kd))(),globalThis.deck={...globalThis.deck,VERSION:Kd,version:Kd,log:Bn,_registerLoggers:dz},fD([pz,[XP,{imagebitmap:{premultiplyAlpha:"none"}}]]));const mz=globalThis.deck,Mt=new Uf({id:"luma.gl"});function Vi(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const gz="Invalid WebGLRenderingContext",yz="Requires WebGL2";function hy(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&Number.isFinite(t._version))}function mn(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&t._version===2)}function _z(t){return mn(t)?t:null}function dy(t){return Vi(hy(t),gz),t}function Si(t){return Vi(mn(t),yz),t}const Dd={};function vz(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function xz(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function bz(t,e){Dd[t]=!0,e!==void 0&&vz(e)}function wz(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(Dd[r]=!0);while(r!==0);for(r in Dd)if(Dd[r])return delete Dd[r],parseInt(r,10);return 0}}const jf=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const s=new t.VertexAttrib(n);this.attribs[r]=s}this.maxAttrib=0};jf.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};jf.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const kc=function(e){const n=this;this.gl=e,wz(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(l){return l===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(l){const d=n.currentVertexArrayObject;d.maxAttrib=Math.max(d.maxAttrib,l);const c=d.attribs[l];return c.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(l){const d=n.currentVertexArrayObject;d.maxAttrib=Math.max(d.maxAttrib,l);const c=d.attribs[l];return c.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(l,d){switch(l){case 34962:n.currentArrayBuffer=d;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=d;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(l,d){const v=n.currentVertexArrayObject.attribs[l];switch(d){case 34975:return v.buffer;case 34338:return v.enabled;case 34339:return v.size;case 34340:return v.stride;case 34341:return v.type;case 34922:return v.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(l,d,c,v,w,C){const I=n.currentVertexArrayObject;I.maxAttrib=Math.max(I.maxAttrib,l);const S=I.attribs[l];return S.buffer=n.currentArrayBuffer,S.size=d,S.type=c,S.normalized=v,S.stride=w,S.offset=C,S.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{xz("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};kc.prototype.VERTEX_ARRAY_BINDING_OES=34229;kc.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new jf(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};kc.prototype.createVertexArrayOES=function(){const e=new jf(this);return this.vertexArrayObjects.push(e),e};kc.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};kc.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof jf&&e.hasBeenBound&&e.ext===this)};kc.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){bz(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,s=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const l=this.currentVertexArrayObject;if(s===l)return;(!s||l.elementArrayBuffer!==s.elementArrayBuffer)&&r.bindBuffer.call(n,34963,l.elementArrayBuffer);let d=this.currentArrayBuffer;const c=Math.max(s?s.maxAttrib:0,l.maxAttrib);for(let v=0;v<=c;v++){const w=l.attribs[v],C=s?s.attribs[v]:null;if((!s||w.enabled!==C.enabled)&&(w.enabled?r.enableVertexAttribArray.call(n,v):r.disableVertexAttribArray.call(n,v)),w.enabled){let I=!1;(!s||w.buffer!==C.buffer)&&(d!==w.buffer&&(r.bindBuffer.call(n,34962,w.buffer),d=w.buffer),I=!0),(I||w.cached!==C.cached)&&r.vertexAttribPointer.call(n,v,w.size,w.type,w.normalized,w.stride,w.offset)}}this.currentArrayBuffer!==d&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function Ez(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const s=e.call(this)||[];return s.indexOf("OES_vertex_array_object")<0&&s.push("OES_vertex_array_object"),s};const n=t.getExtension;t.getExtension=function(s){const l=n.call(this,s);return l||(s!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new kc(this)),this.__OESVertexArrayObject))}}const e2="OES_element_index",t2="WEBGL_draw_buffers",Tz="EXT_disjoint_timer_query",Sz="EXT_disjoint_timer_query_webgl2",Az="EXT_texture_filter_anisotropic",n2="WEBGL_debug_renderer_info",Pz=35723,Cz=4352,Iz=36795,kz=34047,Mz=37445,Lz=37446,er=t=>mn(t)?void 0:0,Rz={[3074]:t=>mn(t)?void 0:36064,[Pz]:t=>mn(t)?void 0:Cz,[35977]:er,[32937]:er,[Iz]:(t,e)=>{const n=mn(t)?t.getExtension(Sz):t.getExtension(Tz);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[Mz]:(t,e)=>{const n=t.getExtension(n2);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[Lz]:(t,e)=>{const n=t.getExtension(n2);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[kz]:(t,e)=>{const n=t.luma.extensions[Az];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},[32883]:er,[35071]:er,[37447]:er,[36063]:(t,e)=>{if(!mn(t)){const n=t.getExtension(t2);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},[35379]:er,[35374]:er,[35377]:er,[34852]:t=>{if(!mn(t)){const e=t.getExtension(t2);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},[36203]:t=>t.getExtension(e2)?2147483647:65535,[33001]:t=>t.getExtension(e2)?16777216:65535,[33e3]:t=>16777216,[37157]:er,[35373]:er,[35657]:er,[36183]:er,[37137]:er,[34045]:er,[35978]:er,[35979]:er,[35968]:er,[35376]:er,[35375]:er,[35659]:er,[37154]:er,[35371]:er,[35658]:er,[35076]:er,[35077]:er,[35380]:er};function Oz(t,e,n){const r=Rz[n],s=typeof r=="function"?r(t,e,n):r;return s!==void 0?s:e(n)}const Dz="OES_vertex_array_object",ZP="ANGLE_instanced_arrays",zz="WEBGL_draw_buffers",Fz="EXT_disjoint_timer_query",Bz="EXT_texture_filter_anisotropic",Nz="VertexArray requires WebGL2 or OES_vertex_array_object extension";function Uz(t,e){return{webgl2:mn(t),ext:t.getExtension(e)}}const YP={[Dz]:{meta:{suffix:"OES"},createVertexArray:()=>{Vi(!1,Nz)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[ZP]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Vi(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[zz]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Vi(!1)}},[Fz]:{meta:{suffix:"EXT"},createQuery:()=>{Vi(!1)},deleteQuery:()=>{Vi(!1)},beginQuery:()=>{Vi(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},d0={readBuffer:(t,e,n)=>{mn(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:s,ext:l}=Uz(t,ZP);let d;switch(r){case 35069:d=s?void 0:!1;break;case 35070:d=!s&&!l?0:void 0;break}return d!==void 0?d:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!mn(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,s)=>{if(!mn(t))switch(s){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,s)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:s}=t.luma,l=s[Bz];r=l&&l.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:Oz,hint(t,e,n,r){return e(n,r)}};function Vz(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(Ez(t),jz(t),$z(t,YP),Gz(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=Vz;function jz(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function Gz(t,e){let{target:n,target2:r}=e;Object.keys(d0).forEach(s=>{if(typeof d0[s]=="function"){const l=t[s]?t[s].bind(t):()=>{},d=d0[s].bind(null,t,l);n[s]=d,r[s]=d}})}function $z(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&Wz(t,{extension:n,target:t.luma,target2:t})}function Wz(t,e){let{extension:n,target:r,target2:s}=e;const l=YP[n];Vi(l);const{meta:d={}}=l,{suffix:c=""}=d,v=t.getExtension(n);for(const w of Object.keys(l)){const C="".concat(w).concat(c);let I=null;w==="meta"||typeof t[w]=="function"||(v&&typeof v[C]=="function"?I=function(){return v[C](...arguments)}:typeof l[w]=="function"&&(I=l[w].bind(r))),I&&(r[w]=I,s[w]=I)}}const _1={[3042]:!1,[32773]:new Float32Array([0,0,0,0]),[32777]:32774,[34877]:32774,[32969]:1,[32968]:0,[32971]:1,[32970]:0,[3106]:new Float32Array([0,0,0,0]),[3107]:[!0,!0,!0,!0],[2884]:!1,[2885]:1029,[2929]:!1,[2931]:1,[2932]:513,[2928]:new Float32Array([0,1]),[2930]:!0,[3024]:!0,[36006]:null,[2886]:2305,[33170]:4352,[2849]:1,[32823]:!1,[32824]:0,[10752]:0,[32938]:1,[32939]:!1,[3089]:!1,[3088]:new Int32Array([0,0,1024,1024]),[2960]:!1,[2961]:0,[2968]:4294967295,[36005]:4294967295,[2962]:519,[2967]:0,[2963]:4294967295,[34816]:519,[36003]:0,[36004]:4294967295,[2964]:7680,[2965]:7680,[2966]:7680,[34817]:7680,[34818]:7680,[34819]:7680,[2978]:[0,0,1024,1024],[3333]:4,[3317]:4,[37440]:!1,[37441]:!1,[37443]:37444,[35723]:4352,[36010]:null,[35977]:!1,[3330]:0,[3332]:0,[3331]:0,[3314]:0,[32878]:0,[3316]:0,[3315]:0,[32877]:0},Xa=(t,e,n)=>e?t.enable(n):t.disable(n),r2=(t,e,n)=>t.hint(n,e),ms=(t,e,n)=>t.pixelStorei(n,e),Hz=(t,e)=>{const n=mn(t)?36009:36160;return t.bindFramebuffer(n,e)},qz=(t,e)=>t.bindFramebuffer(36008,e);function wd(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const Xz={[3042]:Xa,[32773]:(t,e)=>t.blendColor(...e),[32777]:"blendEquation",[34877]:"blendEquation",[32969]:"blendFunc",[32968]:"blendFunc",[32971]:"blendFunc",[32970]:"blendFunc",[3106]:(t,e)=>t.clearColor(...e),[3107]:(t,e)=>t.colorMask(...e),[2884]:Xa,[2885]:(t,e)=>t.cullFace(e),[2929]:Xa,[2931]:(t,e)=>t.clearDepth(e),[2932]:(t,e)=>t.depthFunc(e),[2928]:(t,e)=>t.depthRange(...e),[2930]:(t,e)=>t.depthMask(e),[3024]:Xa,[35723]:r2,[36006]:Hz,[2886]:(t,e)=>t.frontFace(e),[33170]:r2,[2849]:(t,e)=>t.lineWidth(e),[32823]:Xa,[32824]:"polygonOffset",[10752]:"polygonOffset",[35977]:Xa,[32938]:"sampleCoverage",[32939]:"sampleCoverage",[3089]:Xa,[3088]:(t,e)=>t.scissor(...e),[2960]:Xa,[2961]:(t,e)=>t.clearStencil(e),[2968]:(t,e)=>t.stencilMaskSeparate(1028,e),[36005]:(t,e)=>t.stencilMaskSeparate(1029,e),[2962]:"stencilFuncFront",[2967]:"stencilFuncFront",[2963]:"stencilFuncFront",[34816]:"stencilFuncBack",[36003]:"stencilFuncBack",[36004]:"stencilFuncBack",[2964]:"stencilOpFront",[2965]:"stencilOpFront",[2966]:"stencilOpFront",[34817]:"stencilOpBack",[34818]:"stencilOpBack",[34819]:"stencilOpBack",[2978]:(t,e)=>t.viewport(...e),[3333]:ms,[3317]:ms,[37440]:ms,[37441]:ms,[37443]:ms,[3330]:ms,[3332]:ms,[3331]:ms,[36010]:qz,[3314]:ms,[32878]:ms,[3316]:ms,[3315]:ms,[32877]:ms,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=wd(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=wd(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=wd(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=wd(e)&&e.length===3?[...e,...e]:e;const[n,r,s,l,d,c]=e;t.stencilFuncSeparate(1028,n,r,s),t.stencilFuncSeparate(1029,l,d,c)},stencilOp:(t,e)=>{e=wd(e)&&e.length===3?[...e,...e]:e;const[n,r,s,l,d,c]=e;t.stencilOpSeparate(1028,n,r,s),t.stencilOpSeparate(1029,l,d,c)},viewport:(t,e)=>t.viewport(...e)};function wr(t,e,n){return e[t]!==void 0?e[t]:n[t]}const Zz={blendEquation:(t,e,n)=>t.blendEquationSeparate(wr(32777,e,n),wr(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(wr(32969,e,n),wr(32968,e,n),wr(32971,e,n),wr(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(wr(32824,e,n),wr(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(wr(32938,e,n),wr(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,wr(2962,e,n),wr(2967,e,n),wr(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,wr(34816,e,n),wr(36003,e,n),wr(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,wr(2964,e,n),wr(2965,e,n),wr(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,wr(34817,e,n),wr(34818,e,n),wr(34819,e,n))},i2={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({[36006]:n,[36010]:n});case 36009:return t({[36006]:n});case 36008:return t({[36010]:n});default:return null}},blendColor:(t,e,n,r,s)=>t({[32773]:new Float32Array([e,n,r,s])}),blendEquation:(t,e)=>t({[32777]:e,[34877]:e}),blendEquationSeparate:(t,e,n)=>t({[32777]:e,[34877]:n}),blendFunc:(t,e,n)=>t({[32969]:e,[32968]:n,[32971]:e,[32970]:n}),blendFuncSeparate:(t,e,n,r,s)=>t({[32969]:e,[32968]:n,[32971]:r,[32970]:s}),clearColor:(t,e,n,r,s)=>t({[3106]:new Float32Array([e,n,r,s])}),clearDepth:(t,e)=>t({[2931]:e}),clearStencil:(t,e)=>t({[2961]:e}),colorMask:(t,e,n,r,s)=>t({[3107]:[e,n,r,s]}),cullFace:(t,e)=>t({[2885]:e}),depthFunc:(t,e)=>t({[2932]:e}),depthRange:(t,e,n)=>t({[2928]:new Float32Array([e,n])}),depthMask:(t,e)=>t({[2930]:e}),frontFace:(t,e)=>t({[2886]:e}),lineWidth:(t,e)=>t({[2849]:e}),polygonOffset:(t,e,n)=>t({[32824]:e,[10752]:n}),sampleCoverage:(t,e,n)=>t({[32938]:e,[32939]:n}),scissor:(t,e,n,r,s)=>t({[3088]:new Int32Array([e,n,r,s])}),stencilMask:(t,e)=>t({[2968]:e,[36005]:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({[2962]:e,[2967]:n,[2963]:r,[34816]:e,[36003]:n,[36004]:r}),stencilFuncSeparate:(t,e,n,r,s)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:s}),stencilOp:(t,e,n,r)=>t({[2964]:e,[2965]:n,[2966]:r,[34817]:e,[34818]:n,[34819]:r}),stencilOpSeparate:(t,e,n,r,s)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:s}),viewport:(t,e,n,r,s)=>t({[2978]:[e,n,r,s]})},ko=(t,e)=>t.isEnabled(e),s2={[3042]:ko,[2884]:ko,[2929]:ko,[3024]:ko,[32823]:ko,[32926]:ko,[32928]:ko,[3089]:ko,[2960]:ko,[35977]:ko};function KP(t){for(const e in t)return!1;return!0}function Yz(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let s=0;s<t.length;++s)if(t[s]!==e[s])return!1;return!0}return!1}function o2(t,e){const n=t[e].bind(t);t[e]=function(){const s=arguments.length<=0?void 0:arguments[0];return s in t.state.cache?t.state.enable?t.state.cache[s]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function Kz(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var l=arguments.length,d=new Array(l),c=0;c<l;c++)d[c]=arguments[c];const{valueChanged:v,oldValue:w}=n(t.state._updateCache,...d);return v&&r(...d),w},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function Jz(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class Qz{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?t4(e):Object.assign({},_1),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Vi(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];xa(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const s=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const l in e){Vi(l!==void 0);const d=e[l],c=this.cache[l];Yz(d,c)||(n=!0,r=c,s&&!(l in s)&&(s[l]=c),this.cache[l]=d)}return{valueChanged:n,oldValue:r}}}function JP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(Vi(r!==void 0),!t.state){const{polyfillContext:s}=globalThis;s&&s(t),t.state=new Qz(t,{copyState:r}),Jz(t);for(const l in i2){const d=i2[l];Kz(t,l,d)}o2(t,"getParameter"),o2(t,"isEnabled")}return t.state.enable=n,t}function e4(t){t.state||JP(t,{copyState:!1}),t.state.push()}function a2(t){Vi(t.state),t.state.pop()}function xa(t,e){if(Vi(hy(t),"setParameters requires a WebGL context"),KP(e))return;const n={};for(const s in e){const l=Number(s),d=Xz[s];d&&(typeof d=="string"?n[d]=!0:d(t,e[s],l))}const r=t.state&&t.state.cache;if(r)for(const s in n){const l=Zz[s];l(t,e,r)}}function t4(t,e){if(e=e||_1,typeof e=="number"){const s=e,l=s2[s];return l?l(t,s):t.getParameter(s)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const s of n){const l=s2[s];r[s]=l?l(t,Number(s)):t.getParameter(Number(s))}return r}function n4(t){xa(t,_1)}function $s(t,e,n){if(KP(e))return n(t);const{nocatch:r=!0}=e;e4(t),xa(t,e);let s;if(r)s=n(t),a2(t);else try{s=n(t)}finally{a2(t)}return s}function th(t){const{luma:e}=t;if(t.canvas&&e){const{clientWidth:n}=e.canvasSizeInfo;return n?t.drawingBufferWidth/n:1}return 1}function f0(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=th(t),s=t.drawingBufferWidth,l=t.drawingBufferHeight;return i4(e,r,s,l,n)}function r4(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function i4(t,e,n,r,s){const l=l2(t[0],e,n);let d=c2(t[1],e,r,s),c=l2(t[0]+1,e,n);const v=c===n-1?c:c-1;c=c2(t[1]+1,e,r,s);let w;return s?(c=c===0?c:c+1,w=d,d=c):w=c===r-1?c:c-1,{x:l,y:d,width:Math.max(v-l+1,1),height:Math.max(w-d+1,1)}}function l2(t,e,n){return Math.min(Math.round(t*e),n-1)}function c2(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const v1=Ea(),s4=v1&&typeof document<"u",QP={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function eC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Vi(v1,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},QP,t);const{width:e,height:n}=t;function r(c){if(t.throwOnError)throw new Error(c);return console.error(c),null}t.onError=r;let s;const{canvas:l}=t,d=c4({canvas:l,width:e,height:n,onError:r});return s=l4(d,t),s?(s=x1(s,t),u4(s),s):null}function x1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||h4(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},QP,e);const{manageState:n,debug:r}=e;return n&&JP(t,{copyState:!1,log:function(){for(var s=arguments.length,l=new Array(s),d=0;d<s;d++)l[d]=arguments[d];return Mt.log(1,...l)()}}),v1&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),Mt.level=Math.max(Mt.level,1)):Mt.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function o4(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),s=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),l=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:s||e,renderer:l||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function a4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=r4(e.useDevicePixels);d4(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function l4(t,e){const{onError:n}=e;let r=null;const s=v=>r=v.statusMessage||r;t.addEventListener("webglcontextcreationerror",s,!1);const{webgl1:l=!0,webgl2:d=!0}=e;let c=null;return d&&(c=c||t.getContext("webgl2",e),c=c||t.getContext("experimental-webgl2",e)),l&&(c=c||t.getContext("webgl",e),c=c||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",s,!1),c?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),c):n("Failed to create ".concat(d&&!l?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function c4(t){let{canvas:e,width:n=800,height:r=600,onError:s}=t,l;return typeof e=="string"?(s4&&document.readyState==="complete"||s("createGLContext called on canvas '".concat(e,"' before page was loaded")),l=document.getElementById(e)):e?l=e:(l=document.createElement("canvas"),l.id="lumagl-canvas",l.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",l.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(l,document.body.firstChild)),l}function u4(t){const e=mn(t)?"WebGL2":"WebGL1",n=o4(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",s=t.debug?" debug":"";Mt.info(1,"".concat(e).concat(s," context ").concat(r))()}function h4(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function d4(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,s="height"in n?n.height:t.canvas.clientHeight;(!r||!s)&&(Mt.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,s=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const l=t.luma.canvasSizeInfo;if(l.clientWidth!==r||l.clientHeight!==s||l.devicePixelRatio!==e){let d=e;const c=Math.floor(r*d),v=Math.floor(s*d);t.canvas.width=c,t.canvas.height=v,(t.drawingBufferWidth!==c||t.drawingBufferHeight!==v)&&(Mt.warn("Device pixel ratio clamped")(),d=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/s),t.canvas.width=Math.floor(r*d),t.canvas.height=Math.floor(s*d)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:s,devicePixelRatio:e})}}const Jd="8.5.17",f4="set luma.log.level=1 (or higher) to trace rendering";class p4{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new f1({id:e})),this.stats.get(e)}}const mc=new p4;if(globalThis.luma&&globalThis.luma.VERSION!==Jd)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Jd));globalThis.luma||(Ea()&&Mt.log(1,"luma.gl ".concat(Jd," - ").concat(f4))(),globalThis.luma=globalThis.luma||{VERSION:Jd,version:Jd,log:Mt,stats:mc,globals:{modules:{},nodeIO:{}}});function m4(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function g4(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function gt(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function p0(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return gt(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function ml(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const m0={};function vl(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";m0[t]=m0[t]||1;const e=m0[t]++;return"".concat(t,"-").concat(e)}function u2(t){return gt(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function nh(t){let e=!0;for(const n in t){e=!1;break}return e}function tC(t,e,n,r){const s="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),l=Object.getPrototypeOf(t);r.forEach(d=>{l.methodName||(l[d]=()=>{throw Mt.removed("Calling removed method ".concat(e,".").concat(d,": "),s)(),new Error(d)})})}const uu="Resource subclass must define virtual methods";class Ta{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};dy(e);const{id:r,userData:s={}}=n;this.gl=e,this.gl2=e,this.id=r||vl(this[Symbol.toStringTag]),this.userData=s,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=p0(this.gl,e),gt(e);const s=(this.constructor.PARAMETERS||{})[e];if(s){const l=mn(this.gl);if(!((!("webgl2"in s)||l)&&(!("extension"in s)||this.gl.getExtension(s.extension)))){const c=s.webgl1,v="webgl2"in s?s.webgl2:s.webgl1;return l?v:c}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,s=this.constructor.PARAMETERS||{},l=mn(this.gl),d={},c=n||Object.keys(s);for(const v of c){const w=s[v];if(w&&(!("webgl2"in w)||l)&&(!("extension"in w)||this.gl.getExtension(w.extension))){const I=r?ml(this.gl,v):v;d[I]=this.getParameter(v,e),r&&w.type==="GLenum"&&(d[I]=ml(this.gl,d[I]))}}return d}setParameter(e,n){e=p0(this.gl,e),gt(e);const s=(this.constructor.PARAMETERS||{})[e];if(s){const l=mn(this.gl);if(!((!("webgl2"in s)||l)&&(!("extension"in s)||this.gl.getExtension(s.extension))))throw new Error("Parameter not available on this platform");s.type==="GLenum"&&(n=p0(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return tC(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(uu)}_deleteHandle(){throw new Error(uu)}_bindHandle(e){throw new Error(uu)}_getOptsFromHandle(){throw new Error(uu)}_getParameter(e,n){throw new Error(uu)}_setParameter(e,n){throw new Error(uu)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=mc.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];mc.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id)}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const s=mc.get("Memory Usage".concat(r));s.get("GPU Memory").addCount(e),s.get("".concat(n," Memory")).addCount(e),this.byteLength=e}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id)}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=mc.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength),this.byteLength=0}}const y4="Failed to deduce GL constant from typed array";function Nv(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(y4)}}function bf(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function _4(t){let{data:e,width:n,height:r,bytesPerPixel:s=4,temp:l}=t;const d=n*s;l=l||new Uint8Array(d);for(let c=0;c<r/2;++c){const v=c*d,w=(r-c-1)*d;l.set(e.subarray(v,v+d)),e.copyWithin(v,w,w+d),e.set(l,w)}}function v4(t){let{data:e,width:n,height:r}=t;const s=Math.round(n/2),l=Math.round(r/2),d=new Uint8Array(s*l*4);for(let c=0;c<l;c++)for(let v=0;v<s;v++)for(let w=0;w<4;w++)d[(c*s+v)*4+w]=e[(c*2*n+v*2)*4+w];return{data:d,width:s,height:l}}function Uv(t,e,n){const{removedProps:r={},deprecatedProps:s={},replacedProps:l={}}=n;for(const c in r)if(c in e){const w=r[c]?"".concat(t,".").concat(r[c]):"N/A";Mt.removed("".concat(t,".").concat(c),w)()}for(const c in s)if(c in e){const v=s[c];Mt.deprecated("".concat(t,".").concat(c),"".concat(t,".").concat(v))()}let d=null;for(const c in l)if(c in e){const v=l[c];Mt.deprecated("".concat(t,".").concat(c),"".concat(t,".").concat(v))(),d=d||Object.assign({},e),d[v]=e[c],delete d[c]}return d||e}const x4={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},b4={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class xs{static getBytesPerElement(e){return bf(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return gt(e.size),bf(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new xs(x4,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(s=>this._assign(s)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return xs.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return xs.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=Uv("Accessor",e,b4),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const h2=10,nC={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},w4={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:nC},E4={removedProps:nC};class Kn extends Ta{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/xs.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/xs.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=Uv("Buffer",e,w4),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=Uv("Buffer",e,E4),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new xs(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:s=0}=e,l=e.byteLength||e.length;gt(n);const d=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(d,this.handle),s!==0||l!==void 0?(Si(this.gl),this.gl.bufferSubData(this.target,r,n,s,l)):this.gl.bufferSubData(d,r,n),this.gl.bindBuffer(d,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:s=0,size:l}=e;const{gl:d}=this;return Si(d),d.bindBuffer(36662,n.handle),d.bindBuffer(36663,this.handle),d.copyBufferSubData(36662,36663,r,s,l),d.bindBuffer(36662,null),d.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:s=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Si(this.gl);const l=bf(this.accessor.type||5126,{clamped:!1}),d=this._getAvailableElementCount(n),c=r;let v,w;e?(w=e.length,v=w-c):(v=Math.min(d,s||d),w=c+v);const C=Math.min(d,v);return s=s||C,gt(s<=C),e=e||new l(w),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,s),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?s!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,s):(gt(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(h2,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;gt(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const s=this._getTarget();this.gl.bindBuffer(s,this.handle),this.gl.bufferData(s,r,this.usage),this.gl.bufferSubData(s,n,e),this.gl.bindBuffer(s,null),this.debugData=e.slice(0,h2),this.bytesUsed=r,this._trackAllocatedMemory(r);const l=Nv(e);return gt(l),this.setAccessor(new xs(this.accessor,{type:l})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;gt(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const s=this._getTarget();return this.gl.bindBuffer(s,this.handle),this.gl.bufferData(s,r,n),this.gl.bindBuffer(s,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=bf(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new xs(this.accessor,{type:Nv(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return Mt.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return Mt.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return Mt.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return Mt.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new xs(this.accessor,e),this}}const b1={[6407]:{dataFormat:6407,types:[5121,33635]},[6408]:{dataFormat:6408,types:[5121,32819,32820]},[6406]:{dataFormat:6406,types:[5121]},[6409]:{dataFormat:6409,types:[5121]},[6410]:{dataFormat:6410,types:[5121]},[33326]:{dataFormat:6403,types:[5126],gl2:!0},[33328]:{dataFormat:33319,types:[5126],gl2:!0},[34837]:{dataFormat:6407,types:[5126],gl2:!0},[34836]:{dataFormat:6408,types:[5126],gl2:!0}},rC={[6403]:1,[36244]:1,[33319]:2,[33320]:2,[6407]:3,[36248]:3,[6408]:4,[36249]:4,[6402]:1,[34041]:1,[6406]:1,[6409]:1,[6410]:2},iC={[5126]:4,[5125]:4,[5124]:4,[5123]:2,[5122]:2,[5131]:2,[5120]:1,[5121]:1};function T4(t,e){const n=b1[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=mn(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function S4(t,e){const n=b1[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const A4=[9729,9728],d2=globalThis.WebGLBuffer||function(){};class Tc extends Ta{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:s}=n;let l=!0;return r&&(l=l&&T4(e,r),l=l&&(!s||S4(e,r))),l}constructor(e,n){const{id:r=vl("texture"),handle:s,target:l}=n;super(e,{id:r,handle:s}),this.target=l,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(j=>this.initialize(Object.assign({},e,{pixels:j,data:j}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:s=null,format:l=6408,border:d=0,recreate:c=!1,parameters:v={},pixelStore:w={},textureUnit:C=void 0}=e;n||(n=s);let{width:I,height:S,dataFormat:z,type:F,compressed:B=!1,mipmaps:Q=!0}=e;const{depth:q=0}=e;return{width:I,height:S,compressed:B,dataFormat:z,type:F}=this._deduceParameters({format:l,type:F,dataFormat:z,compressed:B,data:n,width:I,height:S}),this.width=I,this.height=S,this.depth=q,this.format=l,this.type=F,this.dataFormat=z,this.border=d,this.textureUnit=C,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),Q&&this._isNPOT()&&(Mt.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),Q=!1,this._updateForNPOT(v)),this.mipmaps=Q,this.setImageData({data:n,width:I,height:S,depth:q,format:l,type:F,dataFormat:z,border:d,mipmaps:Q,parameters:w,compressed:B}),Q&&this.generateMipmap(),this.setParameters(v),c&&(this.data=n),r&&(this._video={video:n,parameters:v,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:s=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:s}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(Mt.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),$s(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:s=0,format:l=this.format,border:d=this.border,offset:c=0,parameters:v={}}=e;let{data:w=null,type:C=this.type,width:I=this.width,height:S=this.height,dataFormat:z=this.dataFormat,compressed:F=!1}=e;w||(w=r),{type:C,dataFormat:z,compressed:F,width:I,height:S}=this._deduceParameters({format:l,type:C,dataFormat:z,compressed:F,data:w,width:I,height:S});const{gl:B}=this;B.bindTexture(this.target,this.handle);let Q=null;({data:w,dataType:Q}=this._getDataType({data:w,compressed:F}));let q,j=0;if($s(this.gl,v,()=>{switch(Q){case"null":B.texImage2D(n,s,l,I,S,d,z,C,w);break;case"typed-array":B.texImage2D(n,s,l,I,S,d,z,C,w,c);break;case"buffer":q=Si(B),q.bindBuffer(35052,w.handle||w),q.texImage2D(n,s,l,I,S,d,z,C,c),q.bindBuffer(35052,null);break;case"browser-object":mn(B)?B.texImage2D(n,s,l,I,S,d,z,C,w):B.texImage2D(n,s,l,z,C,w);break;case"compressed":for(const[G,se]of w.entries())B.compressedTexImage2D(n,G,se.format,se.width,se.height,d,se.data),j+=se.levelSize;break;default:gt(!1,"Unknown image data type")}}),Q==="compressed")this._trackAllocatedMemory(j,"Texture");else if(w&&w.byteLength)this._trackAllocatedMemory(w.byteLength,"Texture");else{const G=rC[this.dataFormat]||4,se=iC[this.type]||1;this._trackAllocatedMemory(this.width*this.height*G*se,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:s=null,x:l=0,y:d=0,width:c=this.width,height:v=this.height,level:w=0,format:C=this.format,type:I=this.type,dataFormat:S=this.dataFormat,compressed:z=!1,offset:F=0,border:B=this.border,parameters:Q={}}=e;if({type:I,dataFormat:S,compressed:z,width:c,height:v}=this._deduceParameters({format:C,type:I,dataFormat:S,compressed:z,data:s,width:c,height:v}),gt(this.depth===0,"texSubImage not supported for 3D textures"),s||(s=r),s&&s.data){const q=s;s=q.data,c=q.shape[0],v=q.shape[1]}s instanceof Kn&&(s=s.handle),this.gl.bindTexture(this.target,this.handle),$s(this.gl,Q,()=>{if(z)this.gl.compressedTexSubImage2D(n,w,l,d,c,v,C,s);else if(s===null)this.gl.texSubImage2D(n,w,l,d,c,v,S,I,null);else if(ArrayBuffer.isView(s))this.gl.texSubImage2D(n,w,l,d,c,v,S,I,s,F);else if(s instanceof d2){const q=Si(this.gl);q.bindBuffer(35052,s),q.texSubImage2D(n,w,l,d,c,v,S,I,F),q.bindBuffer(35052,null)}else mn(this.gl)?Si(this.gl).texSubImage2D(n,w,l,d,c,v,S,I,s):this.gl.texSubImage2D(n,w,l,d,S,I,s)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return Mt.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof Kn?{data:n.handle,dataType:"buffer"}:n instanceof d2?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:s,height:l,dataFormat:d,type:c,compressed:v}=e;const w=b1[n];return d=d||w&&w.dataFormat,c=c||w&&w.types[0],v=v||w&&w.compressed,{width:s,height:l}=this._deduceImageSize(r,s,l),{dataFormat:d,type:c,compressed:v,width:s,height:l,format:n,data:r}}_deduceImageSize(e,n,r){let s;return typeof ImageData<"u"&&e instanceof ImageData?s={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?s={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?s={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?s={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?s={width:e.videoWidth,height:e.videoHeight}:e?s={width:n,height:r}:s={width:n>=0?n:1,height:r>=0?r:1},gt(s,"Could not deduced texture size"),gt(n===void 0||s.width===n,"Deduced texture width does not match supplied width"),gt(r===void 0||s.height===r,"Deduced texture height does not match supplied height"),s}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:gt(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return mn(this.gl)||!this.width||!this.height?!1:!u2(this.width)||!u2(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:A4.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let P4="";function C4(t,e){return gt(typeof t=="string"),t=P4+t,new Promise((n,r)=>{try{const s=new Image;s.onload=()=>n(s),s.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),s.crossOrigin=e&&e.crossOrigin||"anonymous",s.src=t}catch(s){r(s)}})}class Gi extends Tc{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return Tc.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};dy(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:C4(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const Vv=[34069,34070,34071,34072,34073,34074];class sC extends Tc{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};dy(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:s=0,y:l=0,mipmapLevel:d=0}=e;return this._subImage({target:n,data:r,x:s,y:l,mipmapLevel:d})}async setCubeMapImageData(e){let{width:n,height:r,pixels:s,data:l,border:d=0,format:c=6408,type:v=5121}=e;const{gl:w}=this,C=s||l,I=await Promise.all(Vv.map(S=>{const z=C[S];return Promise.all(Array.isArray(z)?z:[z])}));this.bind(),Vv.forEach((S,z)=>{I[z].length>1&&this.opts.mipmaps!==!1&&Mt.warn("".concat(this.id," has mipmap and multiple LODs."))(),I[z].forEach((F,B)=>{n&&r?w.texImage2D(S,B,c,n,r,d,c,v,F):w.texImage2D(S,B,c,c,v,F)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:s,pixels:l,data:d,border:c=0,format:v=6408,type:w=5121}=e,{gl:C}=this,I=l||d;return this.bind(),I instanceof Promise?I.then(S=>this.setImageDataForFace(Object.assign({},e,{face:n,data:S,pixels:S}))):this.width||this.height?C.texImage2D(n,0,v,r,s,c,v,w,I):C.texImage2D(n,0,v,v,w,I),this}}sC.FACES=Vv;class I4 extends Tc{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return mn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Si(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:s,height:l,depth:d=1,border:c=0,format:v,type:w=5121,offset:C=0,data:I,parameters:S={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),$s(this.gl,S,()=>{ArrayBuffer.isView(I)&&this.gl.texImage3D(this.target,n,r,s,l,d,c,v,w,I),I instanceof Kn&&(this.gl.bindBuffer(35052,I.handle),this.gl.texImage3D(this.target,n,r,s,l,d,c,v,w,C))}),I&&I.byteLength)this._trackAllocatedMemory(I.byteLength,"Texture");else{const z=rC[this.dataFormat]||4,F=iC[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*z*F,"Texture")}return this.loaded=!0,this}}const ic="EXT_color_buffer_float",f2={[33189]:{bpp:2},[33190]:{gl2:!0,bpp:3},[36012]:{gl2:!0,bpp:4},[36168]:{bpp:1},[34041]:{bpp:4},[35056]:{gl2:!0,bpp:4},[36013]:{gl2:!0,bpp:5},[32854]:{bpp:2},[36194]:{bpp:2},[32855]:{bpp:2},[33321]:{gl2:!0,bpp:1},[33330]:{gl2:!0,bpp:1},[33329]:{gl2:!0,bpp:1},[33332]:{gl2:!0,bpp:2},[33331]:{gl2:!0,bpp:2},[33334]:{gl2:!0,bpp:4},[33333]:{gl2:!0,bpp:4},[33323]:{gl2:!0,bpp:2},[33336]:{gl2:!0,bpp:2},[33335]:{gl2:!0,bpp:2},[33338]:{gl2:!0,bpp:4},[33337]:{gl2:!0,bpp:4},[33340]:{gl2:!0,bpp:8},[33339]:{gl2:!0,bpp:8},[32849]:{gl2:!0,bpp:3},[32856]:{gl2:!0,bpp:4},[32857]:{gl2:!0,bpp:4},[36220]:{gl2:!0,bpp:4},[36238]:{gl2:!0,bpp:4},[36975]:{gl2:!0,bpp:4},[36214]:{gl2:!0,bpp:8},[36232]:{gl2:!0,bpp:8},[36226]:{gl2:!0,bpp:16},[36208]:{gl2:!0,bpp:16},[33325]:{gl2:ic,bpp:2},[33327]:{gl2:ic,bpp:4},[34842]:{gl2:ic,bpp:8},[33326]:{gl2:ic,bpp:4},[33328]:{gl2:ic,bpp:8},[34836]:{gl2:ic,bpp:16},[35898]:{gl2:ic,bpp:4}};function k4(t,e,n){const r=n[e];if(!r)return!1;const s=mn(t)&&r.gl2||r.gl1;return typeof s=="string"?t.getExtension(s):s}class Ou extends Ta{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||k4(e,n,f2)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:s=1,samples:l=0}=e;return gt(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),l!==0&&mn(this.gl)?this.gl.renderbufferStorageMultisample(36161,l,n,r,s):this.gl.renderbufferStorage(36161,n,r,s),this.format=n,this.width=r,this.height=s,this.samples=l,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*f2[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const M4=256,L4=1024,R4=16384,p2=6144,m2=6145,g2=6146,y2=34041,oC="clear: bad arguments";function w1(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:s=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const l={};e&&(l.framebuffer=e);let d=0;n&&(d|=R4,n!==!0&&(l.clearColor=n)),r&&(d|=M4,r!==!0&&(l.clearDepth=r)),s&&(d|=L4,r!==!0&&(l.clearStencil=r)),gt(d!==0,oC),$s(t,l,()=>{t.clear(d)})}function O4(t){let{framebuffer:e=null,buffer:n=p2,drawBuffer:r=0,value:s=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Si(t),$s(t,{framebuffer:e},()=>{switch(n){case p2:switch(s.constructor){case Int32Array:t.clearBufferiv(n,r,s);break;case Uint32Array:t.clearBufferuiv(n,r,s);break;case Float32Array:default:t.clearBufferfv(n,r,s)}break;case m2:t.clearBufferfv(m2,0,[s]);break;case g2:t.clearBufferiv(g2,0,[s]);break;case y2:const[l,d]=s;t.clearBufferfi(y2,0,l,d);break;default:gt(!1,oC)}})}function D4(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return gt(!1),0}}function fy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:s=6408}=e;let{sourceAttachment:l=36064,target:d=null,sourceWidth:c,sourceHeight:v,sourceType:w}=e;const{framebuffer:C,deleteFramebuffer:I}=aC(t);gt(C);const{gl:S,handle:z,attachments:F}=C;c=c||C.width,v=v||C.height,l===36064&&z===null&&(l=1028),gt(F[l]),w=w||F[l].type,d=F4(d,w,s,c,v),w=w||Nv(d);const B=S.bindFramebuffer(36160,z);return S.readPixels(n,r,c,v,s,w,d),S.bindFramebuffer(36160,B||null),I&&C.delete(),d}function _2(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=fy(t,{sourceAttachment:e}),{width:s,height:l}=t;for(;l>n;)({data:r,width:s,height:l}=v4({data:r,width:s,height:l}));_4({data:r,width:s,height:l});const d=document.createElement("canvas");d.width=s,d.height=l;const c=d.getContext("2d"),v=c.createImageData(s,l);return v.data.set(r),c.putImageData(v,0,0),d.toDataURL()}function z4(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:r=0,sourceY:s=0,targetMipmaplevel:l=0,targetInternalFormat:d=6408}=n;let{targetX:c,targetY:v,targetZ:w,width:C,height:I}=n;const{framebuffer:S,deleteFramebuffer:z}=aC(t);gt(S);const{gl:F,handle:B}=S,Q=typeof c<"u"||typeof v<"u"||typeof w<"u";c=c||0,v=v||0,w=w||0;const q=F.bindFramebuffer(36160,B);gt(e);let j=null;if(e instanceof Tc&&(j=e,C=Number.isFinite(C)?C:j.width,I=Number.isFinite(I)?I:j.height,j.bind(0),e=j.target),!Q)F.copyTexImage2D(e,l,d,r,s,C,I,0);else switch(e){case 3553:case 34067:F.copyTexSubImage2D(e,l,c,v,r,s,C,I);break;case 35866:case 32879:Si(F).copyTexSubImage3D(e,l,c,v,w,r,s,C,I);break}return j&&j.unbind(),F.bindFramebuffer(36160,q||null),z&&S.delete(),j}function aC(t){return t instanceof Ur?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:q4(t),deleteFramebuffer:!0}}function F4(t,e,n,r,s){if(t)return t;e=e||5121;const l=bf(e,{clamped:!1}),d=D4(n);return new l(r*s*d)}const hr={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function B4(t){const e=new Gi(t,{format:6408,type:5126,dataFormat:6408}),n=new Ur(t,{id:"test-framebuffer",check:!1,attachments:{[36064]:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const lC={[hr.WEBGL2]:[!1,!0],[hr.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[hr.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[hr.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[hr.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[hr.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[hr.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[hr.FLOAT_BLEND]:["EXT_float_blend"],[hr.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[hr.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[hr.TEXTURE_FLOAT]:["OES_texture_float",!0],[hr.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[hr.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[hr.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[hr.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[hr.COLOR_ATTACHMENT_RGBA32F]:[B4,"EXT_color_buffer_float"],[hr.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[hr.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[hr.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[hr.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[hr.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[hr.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},N4=2;function U4(t,e){return cC(t,e)}function cC(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>uC(t,n))}function V4(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in lC)t.luma.caps[e]===void 0&&(t.luma.caps[e]=uC(t,e));return t.luma.caps}function uC(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=j4(t,e)),t.luma.caps[e]||Mt.log(N4,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function j4(t,e){const n=lC[e];gt(n,e);let r;const s=mn(t)&&n[1]||n[0];if(typeof s=="function")r=s(t);else if(Array.isArray(s)){r=!0;for(const l of s)r=r&&Boolean(t.getExtension(l))}else typeof s=="string"?r=Boolean(t.getExtension(s)):typeof s=="boolean"?r=s:gt(!1);return r}const v2="Multiple render targets not supported";class Ur extends Ta{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:s}=n;let l=!0;return r&&(l=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),s&&(l=l&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),l}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Ur(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Si(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Si(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:s=null,color:l=!0,depth:d=!0,stencil:c=!1,check:v=!0,readBuffer:w=void 0,drawBuffers:C=void 0}=e;if(gt(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,s)for(const I in s){const S=s[I];(Array.isArray(S)?S[0]:S).resize({width:n,height:r})}else s=this._createDefaultAttachments(l,d,c,n,r);this.update({clearAttachments:!0,attachments:s,readBuffer:w,drawBuffers:C}),s&&v&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:s,clearAttachments:l=!1,resizeAttachments:d=!0}=e;this.attach(n,{clearAttachments:l,resizeAttachments:d});const{gl:c}=this,v=c.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),s&&this._setDrawBuffers(s),c.bindFramebuffer(36160,v||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return gt(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&Mt.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const s in this.attachments)this.attachments[s].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};n&&Object.keys(this.attachments).forEach(d=>{s[d]=null}),Object.assign(s,e);const l=this.gl.bindFramebuffer(36160,this.handle);for(const d in s){gt(d!==void 0,"Misspelled framebuffer binding point?");const c=Number(d),v=s[c];let w=v;if(!w)this._unattach(c);else if(w instanceof Ou)this._attachRenderbuffer({attachment:c,renderbuffer:w});else if(Array.isArray(v)){const[C,I=0,S=0]=v;w=C,this._attachTexture({attachment:c,texture:C,layer:I,level:S})}else this._attachTexture({attachment:c,texture:w,layer:0,level:0});r&&w&&w.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,l||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(d=>!this.attachments[d]).forEach(d=>{delete this.attachments[d]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error($4(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:s,drawBuffers:l=[]}=e,d=this.gl.bindFramebuffer(36160,this.handle);return(n||r||s)&&w1(this.gl,{color:n,depth:r,stencil:s}),l.forEach((c,v)=>{O4(this.gl,{drawBuffer:v,value:c})}),this.gl.bindFramebuffer(36160,d||null),this}readPixels(){return Mt.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return Mt.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return Mt.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return Mt.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return Mt.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return Mt.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:s=0,width:l,height:d}=e;const c=Si(this.gl),v=c.bindFramebuffer(36008,this.handle);return r===0&&s===0&&l===void 0&&d===void 0?c.invalidateFramebuffer(36008,n):c.invalidateFramebuffer(36008,n,r,s,l,d),c.bindFramebuffer(36008,v),this}getAttachmentParameter(e,n,r){let s=this._getAttachmentParameterFallback(n);return s===null&&(this.gl.bindFramebuffer(36160,this.handle),s=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&s>1e3&&(s=ml(this.gl,s)),s}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const s={};for(const l of r){const d=n?ml(this.gl,l):l;s[d]=this.getAttachmentParameter(e,l,n)}return s}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const s of n){const l=Number(s),d=e?ml(this.gl,l):l;r[d]=this.getAttachmentParameters(l,e)}return r}show(){return typeof window<"u"&&window.open(_2(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>Mt.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=_2(this,{targetMaxHeight:100});return Mt.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,s,l){let d=null;return e&&(d=d||{},d[36064]=new Gi(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:s,height:l,mipmaps:!1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.ownResources.push(d[36064])),n&&r?(d=d||{},d[33306]=new Ou(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:s,height:111}),this.ownResources.push(d[33306])):n?(d=d||{},d[36096]=new Ou(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:s,height:l}),this.ownResources.push(d[36096])):r&&gt(!1),d}_unattach(e){const n=this.attachments[e];!n||(n instanceof Ou?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:s}=this;s.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:s,level:l}=e;const{gl:d}=this;switch(d.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:Si(d).framebufferTextureLayer(36160,n,r.target,l,s);break;case 34067:const v=G4(s);d.framebufferTexture2D(36160,n,v,r.handle,l);break;case 3553:d.framebufferTexture2D(36160,n,3553,r.handle,l);break;default:gt(!1,"Illegal texture type")}d.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=_z(this.gl);n?n.readBuffer(e):gt(e===36064||e===1029,v2),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=Si(n);if(r)r.drawBuffers(e);else{const s=n.getExtension("WEBGL_draw_buffers");s?s.drawBuffersWEBGL(e):gt(e.length===1&&(e[0]===36064||e[0]===1029),v2)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=V4(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function G4(t){return t<34069?t+34069:t}function $4(t){return(Ur.STATUS||{})[t]||"Framebuffer error ".concat(t)}const W4=[36049,36048,33296,33298,33299,33300,33301,33302,33303];Ur.ATTACHMENT_PARAMETERS=W4;function H4(t,e){gt(t instanceof Gi||t instanceof sC||t instanceof I4);const n=t.constructor,{gl:r,width:s,height:l,format:d,type:c,dataFormat:v,border:w,mipmaps:C}=t,I=Object.assign({width:s,height:l,format:d,type:c,dataFormat:v,border:w,mipmaps:C},e);return new n(r,I)}function q4(t,e){const{gl:n,width:r,height:s,id:l}=t;return new Ur(n,Object.assign({},e,{id:"framebuffer-for-".concat(l),width:r,height:s,attachments:{[36064]:t}}))}function Zm(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const X4=35632,Z4=35633;function Y4(t){switch(t){case X4:return"fragment";case Z4:return"vertex";default:return"unknown type"}}function K4(t,e,n,r){const s=t.split(/\r?\n/),l={},d={},c=r||Zm(e)||"(unnamed)",v="".concat(Y4(n)," shader ").concat(c);for(let C=0;C<s.length;C++){const I=s[C];if(I.length<=1)continue;const S=I.split(":"),z=S[0],F=parseInt(S[2],10);if(isNaN(F))throw new Error("GLSL compilation error in ".concat(v,": ").concat(t));z!=="WARNING"?l[F]=I:d[F]=I}const w=J4(e);return{shaderName:v,errors:x2(l,w),warnings:x2(d,w)}}function x2(t,e){let n="";for(let r=0;r<e.length;r++){const s=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(s,`
`),t[r+1])){const l=t[r+1],d=l.split(":",3),c=d[0],v=parseInt(d[1],10)||0,w=l.substring(d.join(":").length+1).trim();n+=hC("^^^ ".concat(c,": ").concat(w,`

`),v)}}return n}function J4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),s=String(r.length+e-1).length;return r.map((l,d)=>{const c=String(d+e),v=c.length;return hC(c,s-v)+n+l})}function hC(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function dC(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const Q4="Shader: GLSL source code must be a JavaScript string";class wf extends Ta{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return gt(!1),"unknown"}}constructor(e,n){dy(e),gt(typeof n.source=="string",Q4);const r=Zm(n.source,null)||n.id||vl("unnamed ".concat(wf.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=Zm(n,null);r&&(this.id=vl(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(wf.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Zm(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:s,errors:l,warnings:d}=K4(r,this.source,this.shaderType,this.id);throw Mt.error("GLSL compilation errors in ".concat(s,`
`).concat(l))(),Mt.warn("GLSL compilation warnings in ".concat(s,`
`).concat(d))(),new Error("GLSL compilation errors in ".concat(s))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class g0 extends wf{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class y0 extends wf{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const e5={[5126]:rr.bind(null,"uniform1fv",gs,1,bi),[35664]:rr.bind(null,"uniform2fv",gs,2,bi),[35665]:rr.bind(null,"uniform3fv",gs,3,bi),[35666]:rr.bind(null,"uniform4fv",gs,4,bi),[5124]:rr.bind(null,"uniform1iv",Za,1,bi),[35667]:rr.bind(null,"uniform2iv",Za,2,bi),[35668]:rr.bind(null,"uniform3iv",Za,3,bi),[35669]:rr.bind(null,"uniform4iv",Za,4,bi),[35670]:rr.bind(null,"uniform1iv",Za,1,bi),[35671]:rr.bind(null,"uniform2iv",Za,2,bi),[35672]:rr.bind(null,"uniform3iv",Za,3,bi),[35673]:rr.bind(null,"uniform4iv",Za,4,bi),[35674]:rr.bind(null,"uniformMatrix2fv",gs,4,sa),[35675]:rr.bind(null,"uniformMatrix3fv",gs,9,sa),[35676]:rr.bind(null,"uniformMatrix4fv",gs,16,sa),[35678]:ai,[35680]:ai,[5125]:rr.bind(null,"uniform1uiv",bm,1,bi),[36294]:rr.bind(null,"uniform2uiv",bm,2,bi),[36295]:rr.bind(null,"uniform3uiv",bm,3,bi),[36296]:rr.bind(null,"uniform4uiv",bm,4,bi),[35685]:rr.bind(null,"uniformMatrix2x3fv",gs,6,sa),[35686]:rr.bind(null,"uniformMatrix2x4fv",gs,8,sa),[35687]:rr.bind(null,"uniformMatrix3x2fv",gs,6,sa),[35688]:rr.bind(null,"uniformMatrix3x4fv",gs,12,sa),[35689]:rr.bind(null,"uniformMatrix4x2fv",gs,8,sa),[35690]:rr.bind(null,"uniformMatrix4x3fv",gs,12,sa),[35678]:ai,[35680]:ai,[35679]:ai,[35682]:ai,[36289]:ai,[36292]:ai,[36293]:ai,[36298]:ai,[36299]:ai,[36300]:ai,[36303]:ai,[36306]:ai,[36307]:ai,[36308]:ai,[36311]:ai},t5={},n5={},r5={},b2=[0];function E1(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(b2[0]=t,t=b2);const s=t.length;if(s%e&&Mt.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let l=r[s];l||(l=new n(s),r[s]=l);for(let d=0;d<s;d++)l[d]=t[d];return l}function gs(t,e){return E1(t,e,Float32Array,t5)}function Za(t,e){return E1(t,e,Int32Array,n5)}function bm(t,e){return E1(t,e,Uint32Array,r5)}function w2(t,e,n){const r=e5[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function i5(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:Boolean(n[2])}}function s5(t,e,n){for(const r in t){const s=t[r];if((!n||Boolean(n[r]))&&!o5(s))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),s),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function o5(t){return Array.isArray(t)||ArrayBuffer.isView(t)?l5(t):isFinite(t)||t===!0||t===!1||t instanceof Tc||t instanceof Ou?!0:t instanceof Ur?Boolean(t.texture):!1}function a5(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let s=0,l=n.length;s<l;++s)r[s]=n[s]}else t[e]=n.slice();else t[e]=n}function l5(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function ai(){let t=null;return(e,n,r)=>{const s=t!==r;return s&&(e.uniform1i(n,r),t=r),s}}function rr(t,e,n,r){let s=null,l=null;return(d,c,v)=>{const w=e(v,n),C=w.length;let I=!1;if(s===null)s=new Float32Array(C),l=C,I=!0;else{gt(l===C,"Uniform length cannot change.");for(let S=0;S<C;++S)if(w[S]!==s[S]){I=!0;break}}return I&&(r(d,t,c,w),s.set(w)),I}}function bi(t,e,n,r){t[e](n,r)}function sa(t,e,n,r){t[e](n,!1,r)}const c5=5120,u5=5121,h5=5122,d5=5123,E2=0,wm=1,f5=2,p5=3,Em=4,m5=5,g5=6,Wr=5126,y5=35664,_5=35665,v5=35666,Ed=5124,x5=35667,b5=35668,w5=35669,Td=5125,E5=36294,T5=36295,S5=36296,A5=35670,P5=35671,C5=35672,I5=35673,k5=35674,M5=35675,L5=35676,R5=35685,O5=35686,D5=35687,z5=35688,F5=35689,B5=35690,jv={[Wr]:[Wr,1,"float"],[y5]:[Wr,2,"vec2"],[_5]:[Wr,3,"vec3"],[v5]:[Wr,4,"vec4"],[Ed]:[Ed,1,"int"],[x5]:[Ed,2,"ivec2"],[b5]:[Ed,3,"ivec3"],[w5]:[Ed,4,"ivec4"],[Td]:[Td,1,"uint"],[E5]:[Td,2,"uvec2"],[T5]:[Td,3,"uvec3"],[S5]:[Td,4,"uvec4"],[A5]:[Wr,1,"bool"],[P5]:[Wr,2,"bvec2"],[C5]:[Wr,3,"bvec3"],[I5]:[Wr,4,"bvec4"],[k5]:[Wr,8,"mat2"],[R5]:[Wr,8,"mat2x3"],[O5]:[Wr,8,"mat2x4"],[M5]:[Wr,12,"mat3"],[D5]:[Wr,12,"mat3x2"],[z5]:[Wr,12,"mat3x4"],[L5]:[Wr,16,"mat4"],[F5]:[Wr,16,"mat4x2"],[B5]:[Wr,16,"mat4x3"]};function N5(t){switch(t){case E2:return E2;case wm:return wm;case p5:return wm;case f5:return wm;case Em:return Em;case m5:return Em;case g5:return Em;default:return gt(!1),0}}function T2(t){const e=jv[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function fC(t,e){switch(t){case c5:case u5:case h5:case d5:t=Wr;break}for(const n in jv){const[r,s,l]=jv[n];if(r===t&&s===e)return{glType:n,name:l}}return null}class U5{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let s=0;s<r;s++){const{name:l,type:d,size:c}=n.getActiveAttrib(e.handle,s),v=n.getAttribLocation(e.handle,l);v>=0&&this._addAttribute(v,l,d,c)}this.attributeInfos.sort((s,l)=>s.location-l.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!mn(n))return;const r=n.getProgramParameter(e.handle,35971);for(let s=0;s<r;s++){const{name:l,type:d,size:c}=n.getTransformFeedbackVarying(e.handle,s);this._addVarying(s,l,d,c)}this.varyingInfos.sort((s,l)=>s.location-l.location)}_addAttribute(e,n,r,s){const{type:l,components:d}=T2(r),c={type:l,size:s*d};this._inferProperties(e,n,c);const v={location:e,name:n,accessor:new xs(c)};this.attributeInfos.push(v),this.attributeInfosByLocation[e]=v,this.attributeInfosByName[v.name]=v}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,s){const{type:l,components:d}=T2(r),c=new xs({type:l,size:s*d}),v={location:e,name:n,accessor:c};this.varyingInfos.push(v),this.varyingInfosByName[v.name]=v}}const S2=4,V5=35981,j5=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class pC extends Ta{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",j5),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:s,varyings:l,bufferMode:d=V5}=e;return this.hash=n||"",this.vs=typeof r=="string"?new g0(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof s=="string"?new y0(this.gl,{id:"".concat(e.id,"-fs"),source:s}):s,gt(this.vs instanceof g0),gt(this.fs instanceof y0),this.uniforms={},this._textureUniforms={},l&&l.length>0&&(Si(this.gl),this.varyings=l,this.gl2.transformFeedbackVaryings(this.handle,l,d)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new U5(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:s,offset:l=0,start:d,end:c,isIndexed:v=!1,indexType:w=5123,instanceCount:C=0,isInstanced:I=C>0,vertexArray:S=null,transformFeedback:z,framebuffer:F,parameters:B={},uniforms:Q,samplers:q}=e;if((Q||q)&&(Mt.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(Q||{})),Mt.priority>=n){const j=F?F.id:"default",G="mode=".concat(ml(this.gl,r)," verts=").concat(s," ")+"instances=".concat(C," indexType=").concat(ml(this.gl,w)," ")+"isInstanced=".concat(I," isIndexed=").concat(v," ")+"Framebuffer=".concat(j);Mt.log(n,G)()}return gt(S),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||s===0||I&&C===0?!1:(S.bindForDraw(s,C,()=>{if(F!==void 0&&(B=Object.assign({},B,{framebuffer:F})),z){const j=N5(r);z.begin(j)}this._bindTextures(),$s(this.gl,B,()=>{v&&I?this.gl2.drawElementsInstanced(r,s,w,l,C):v&&mn(this.gl)&&!isNaN(d)&&!isNaN(c)?this.gl2.drawRangeElements(r,d,c,s,w,l):v?this.gl.drawElements(r,s,w,l):I?this.gl2.drawArraysInstanced(r,l,s,C):this.gl.drawArrays(r,l,s)}),z&&z.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Mt.priority>=2&&s5(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],s=this._uniformSetters[n];if(s){let l=r,d=!1;if(l instanceof Ur&&(l=l.texture),l instanceof Tc)if(d=this.uniforms[n]!==r,d){s.textureIndex===void 0&&(s.textureIndex=this._textureIndexCounter++);const c=l,{textureIndex:v}=s;c.bind(v),l=v,this._textureUniforms[n]=c}else l=s.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(s(l)||d)&&a5(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const s of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new g0({handle:s});break;case 35632:r.fs=new y0({handle:s});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=vl(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),Mt.time(S2,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),Mt.timeEnd(S2,"linkProgram for ".concat(this._getName()))(),e.debug||Mt.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:s}=i5(r.name);let l=e.getUniformLocation(this.handle,s);if(this._uniformSetters[s]=w2(e,l,r),r.size>1)for(let d=0;d<r.size;d++)l=e.getUniformLocation(this.handle,"".concat(s,"[").concat(d,"]")),this._uniformSetters["".concat(s,"[").concat(d,"]")]=w2(e,l,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const G5=34918,$5=34919,W5=35007,H5=36795,q5=35976,X5=35887,Z5=36202;class Rg extends Ta{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=mn(e),s=cC(e,hr.TIMER_QUERY);let l=r||s;for(const d of n)switch(d){case"queries":l=l&&r;break;case"timers":l=l&&s;break;default:gt(!1)}return l}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(W5)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?Z5:X5)}beginTransformFeedbackQuery(){return this.begin(q5)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,$5);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(H5)}getResult(){return this.gl2.getQueryParameter(this.handle,G5)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,s)=>{const l=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(s("Timed out"),this._pollingPromise=null):requestAnimationFrame(l)};requestAnimationFrame(l)}),this._pollingPromise}_createHandle(){return Rg.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class mC extends Ta{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return mn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Si(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,nh(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:s,byteSize:l,byteOffset:d}=this._getBufferParams(n);return r<0?(this.unused[e]=s,Mt.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,s,d,l),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,s;return e instanceof Kn?s=e:(s=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||s.byteLength-n),{buffer:s,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:s}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,s,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3?arguments[3]:void 0;const l=n&&n.handle;return!l||s===void 0?this.gl.bindBufferBase(35982,e,l):this.gl.bindBufferRange(35982,e,l,r,s),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let Tm=null;function Y5(t){return(!Tm||Tm.byteLength<t)&&(Tm=new ArrayBuffer(t)),Tm}function K5(t,e){const n=Y5(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function J5(t){let{target:e,source:n,start:r=0,count:s=1}=t;const l=n.length,d=s*l;let c=0;for(let v=r;c<l;c++)e[v++]=n[c];for(;c<d;)c<d-c?(e.copyWithin(r+c,r,r+c),c*=2):(e.copyWithin(r+c,r,r+d-c),c=d);return e}const Q5="elements must be GL.ELEMENT_ARRAY_BUFFER";class ys extends Ta{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?mn(e)||OP()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new ys(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return ys.MAX_ATTRIBUTES=ys.MAX_ATTRIBUTES||e.getParameter(34921),ys.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:ys._setConstantFloatArray(e,n,r);break;case Int32Array:ys._setConstantIntArray(e,n,r);break;case Uint32Array:ys._setConstantUintArray(e,n,r);break;default:gt(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return ys.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return gt(!e||e.target===34963,Q5),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:s,type:l,stride:d,offset:c,normalized:v,integer:w,divisor:C}=r,{gl:I,gl2:S}=this;return e=Number(e),this.bind(()=>{I.bindBuffer(34962,n.handle),w?(gt(mn(I)),S.vertexAttribIPointer(e,s,l,d,c)):I.vertexAttribPointer(e,s,l,v,d,c),I.enableVertexAttribArray(e),S.vertexAttribDivisor(e,C||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!ys.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),s=r.byteLength*e,l=r.length*e;let d=!this.buffer;if(this.buffer=this.buffer||new Kn(this.gl,s),d=d||this.buffer.reallocate(s),d=d||!this._compareConstantArrayValues(r,this.bufferValue),d){const c=K5(n.constructor,l);J5({target:c,source:r,start:0,count:l}),this.buffer.subData(c),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:gt(!1)}}static _setConstantIntArray(e,n,r){switch(gt(mn(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:gt(!1)}}static _setConstantUintArray(e,n,r){switch(gt(mn(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:gt(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return gt(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const eF="VertexArray: attributes must be Buffers or constants (i.e. typed array)",tF=/^(.+)__LOCATION_([0-9]+)$/,nF=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class rF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new ys(e),tC(this,"VertexArray","v6.0",nF),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:s,accessor:l}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return s>=0&&(this.values[s]=n,this.accessors[s]=l,this.clearDrawParams(),this.vertexArrayObject.setBuffer(s,n,l)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:s,accessor:l}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return s>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[s]=n,this.accessors[s]=l,this.clearDrawParams(),this.vertexArrayObject.enable(s,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new Kn(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof Kn&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof Kn&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let s;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),s=r()}),s}_resolveLocationAndAccessor(e,n,r,s){const l={location:-1,accessor:null},{location:d,name:c}=this._getAttributeIndex(e);if(!Number.isFinite(d)||d<0)return this.unused[e]=n,Mt.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),l;const v=this._getAttributeInfo(c||d);if(!v)return l;const w=this.accessors[d]||{},C=xs.resolve(v.accessor,w,r,s),{size:I,type:S}=C;return gt(Number.isFinite(I)&&Number.isFinite(S)),{location:d,accessor:C}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=tF.exec(e),s=r?r[1]:e,l=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(s)+l,name:s}:{location:-1}}_setAttribute(e,n){if(n instanceof Kn)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof Kn){const r=n[0],s=n[1];this.setBuffer(e,r,s)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof Kn){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(eF)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let s=this.values[0];ArrayBuffer.isView(s)&&this._setConstantAttributeZero(s,r);for(let l=1;l<this.vertexArrayObject.MAX_ATTRIBUTES;l++)s=this.values[l],ArrayBuffer.isView(s)&&this._setConstantAttribute(l,s)}_setConstantAttributeZero(e,n){if(ys.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){ys.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],s=this.accessors[n];if(!r)return;const{divisor:l}=s,d=l>0;if(e.isInstanced=e.isInstanced||d,r instanceof Kn){const c=r;if(d){const v=c.getVertexCount(s);e.instanceCount=Math.min(e.instanceCount,v)}else{const v=c.getVertexCount(s);e.vertexCount=Math.min(e.vertexCount,v)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Mt.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function iF(t,e){const{maxElts:n=16,size:r=1}=e;let s="[";for(let d=0;d<t.length&&d<n;++d)d>0&&(s+=",".concat(d%r===0?" ":"")),s+=Ef(t[d],e);const l=t.length>n?"...":"]";return"".concat(s).concat(l)}function Ef(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return iF(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const s=t.toPrecision(2);return s.indexOf(".0")===s.length-2?s.slice(0,-1):s}function A2(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:s=!1}=t;gt(n);const l=".*_.*",d=".*Matrix",c=n._uniformSetters,v={},w=Object.keys(c).sort();let C=0;for(const z of w)!z.match(l)&&!z.match(d)&&_0({table:v,header:e,uniforms:r,uniformName:z,undefinedOnly:s})&&C++;for(const z of w)z.match(d)&&_0({table:v,header:e,uniforms:r,uniformName:z,undefinedOnly:s})&&C++;for(const z of w)v[z]||_0({table:v,header:e,uniforms:r,uniformName:z,undefinedOnly:s})&&C++;let I=0;const S={};if(!s)for(const z in r){const F=r[z];v[z]||(I++,S[z]={Type:"NOT USED: ".concat(F),[e]:Ef(F)})}return{table:v,count:C,unusedTable:S,unusedCount:I}}function _0(t){let{table:e,header:n,uniforms:r,uniformName:s,undefinedOnly:l}=t;const d=r[s],c=sF(d);return!l||!c?(e[s]={[n]:c?Ef(d):"N/A","Uniform Type":c?d:"NOT PROVIDED"},!0):!1}function sF(t){return t!=null}function oF(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=P2(e,e.elements,null,n));const s=e.values;for(const l in s){const d=e._getAttributeInfo(l);if(d){let c="".concat(l,": ").concat(d.name);const v=e.accessors[d.location];v&&(c="".concat(l,": ").concat(aF(d.name,v))),r[c]=P2(e,s[l],v,n)}}return r}function P2(t,e,n,r){const{gl:s}=t;if(!e)return{[r]:"null","Format ":"N/A"};let l="NOT PROVIDED",d=1,c=0,v=0,w,C,I;if(n&&(l=n.type,d=n.size,l=String(l).replace("Array",""),w=l.indexOf("nt")!==-1),e instanceof Kn){const S=e,{data:z,changed:F}=S.getDebugData();C=F?"*":"",I=z,v=S.byteLength,c=v/z.BYTES_PER_ELEMENT/d;let B;if(n){const Q=n.divisor>0;B="".concat(Q?"I ":"P "," ").concat(c," (x").concat(d,"=").concat(v," bytes ").concat(ml(s,l),")")}else w=!0,B="".concat(v," bytes");return{[r]:"".concat(C).concat(Ef(I,{size:d,isInteger:w})),"Format ":B}}return I=e,d=e.length,l=String(e.constructor.name).replace("Array",""),w=l.indexOf("nt")!==-1,{[r]:"".concat(Ef(I,{size:d,isInteger:w})," (constant)"),"Format ":"".concat(d,"x").concat(l," (constant)")}}function aF(t,e){const{type:n,size:r}=e,s=fC(n,r);return s?"".concat(t," (").concat(s.name,")"):t}function lF(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const s=C2(r);e["in ".concat(s)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const s=C2(r);e["out ".concat(s)]={[n]:JSON.stringify(r.accessor)}}return e}function C2(t){const{type:e,size:n}=t.accessor,r=fC(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const I2=Ea()&&typeof document<"u";let cF=0;class uF{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=Q=>eC(Q),onAddHTML:r=null,onInitialize:s=()=>{},onRender:l=()=>{},onFinalize:d=()=>{},onError:c,gl:v=null,glOptions:w={},debug:C=!1,createFramebuffer:I=!1,autoResizeViewport:S=!0,autoResizeDrawingBuffer:z=!0,stats:F=mc.get("animation-loop-".concat(cF++))}=e;let{useDevicePixels:B=!0}=e;"useDevicePixelRatio"in e&&(Mt.deprecated("useDevicePixelRatio","useDevicePixels")(),B=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:s,onRender:l,onFinalize:d,onError:c,gl:v,glOptions:w,debug:C,createFramebuffer:I},this.gl=v,this.needsRedraw=null,this.timeline=null,this.stats=F,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:S,autoResizeDrawingBuffer:z,useDevicePixels:B}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return gt(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Rg.isSupported(this.gl,["timers"])?new Rg(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return Mt.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{!this._running||(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=I2?new Promise((e,n)=>{if(I2&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):g4(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):m4(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?x1(this.props.gl,e):this.onCreateContext(e),!hy(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");n4(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:s}=this.gl;return s&&s.clientHeight?r=s.clientWidth/s.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&a4(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Ur(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Gf="vs",T1="fs";function Ts(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const v0={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function hF(t){const e={};for(const n in t){const r=t[n],s=dF(r);e[n]=s}return e}function dF(t){let e=k2(t);return e==="object"?t?"type"in t?Object.assign({},t,v0[t.type]):"value"in t?(e=k2(t.value),Object.assign({type:e},t,v0[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},v0[e])}function k2(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const fF="vs",pF="fs";class M2{constructor(e){let{name:n,vs:r,fs:s,dependencies:l=[],uniforms:d,getUniforms:c,deprecations:v=[],defines:w={},inject:C={},vertexShader:I,fragmentShader:S}=e;Ts(typeof n=="string"),this.name=n,this.vs=r||I,this.fs=s||S,this.getModuleUniforms=c,this.dependencies=l,this.deprecations=this._parseDeprecationDefinitions(v),this.defines=w,this.injections=mF(C),d&&(this.uniforms=hF(d))}getModuleSource(e){let n;switch(e){case fF:n=this.vs||"";break;case pF:n=this.fs||"";break;default:Ts(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const s in r){const l=r[s];s in e&&!l.private?(l.validate&&Ts(l.validate(e[s],l),"".concat(this.name,": invalid ").concat(s)),n[s]=e[s]):n[s]=l.value}return n}}function mF(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const s=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[s][n]=r}return e}function gF(t){return yF(yC(t))}function yF(t){const e={},n={};return gC({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,s)=>n[s]-n[r]).map(r=>e[r])}function gC(t){let{modules:e,level:n,moduleMap:r,moduleDepth:s}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const l of e)r[l.name]=l,(s[l.name]===void 0||s[l.name]<n)&&(s[l.name]=n);for(const l of e)l.dependencies&&gC({modules:l.dependencies,level:n+1,moduleMap:r,moduleDepth:s})}function yC(t,e){return t.map(n=>(n instanceof M2||(Ts(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),Ts(n.name,"shader module has no name"),n=new M2(n),n.dependencies=yC(n.dependencies)),n))}function _F(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,s=n.indexOf("Trident/")!==-1;return r||s}const vF=7936,xF=7937,bF=7938,wF=35724,S1={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},cc={};Object.keys(S1).forEach(t=>{cc[t]=t});function EF(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&t._version===2)}function TF(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||vF),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||xF);return{gpuVendor:SF(n,r),vendor:n,renderer:r,version:t.getParameter(bF),shadingLanguageVersion:t.getParameter(wF)}}function SF(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const x0={};function L2(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=S1[e];if(Ts(r,e),!_F(n))return!0;if(e in x0)return x0[e];const s=r[0],l=n.behavior||"enable",d="#extension GL_".concat(s," : ").concat(l,`
void main(void) {}`),c=t.createShader(35633);t.shaderSource(c,d),t.compileShader(c);const v=t.getShaderParameter(c,35713);return t.deleteShader(c),x0[e]=v,v}function AF(t,e){const n=S1[e];Ts(n,e);const r=EF(t)&&n[1]||n[0],s=typeof r=="string"?Boolean(t.getExtension(r)):r;return Ts(s===!1||s===!0),s}function Sm(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>AF(t,n))}function PF(t){switch(TF(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function CF(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return Sm(t,cc.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),Sm(t,cc.GLSL_DERIVATIVES)&&L2(t,cc.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),Sm(t,cc.GLSL_FRAG_DATA)&&L2(t,cc.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),Sm(t,cc.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const IF=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,kF=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,MF={[Gf]:IF,[T1]:kF},Ym="__LUMA_INJECT_DECLARATIONS__",R2=/void\s+main\s*\([^)]*\)\s*\{\n?/,O2=/}\n?[^{}]*$/,b0=[];function D2(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=e===Gf;for(const l in n){const d=n[l];d.sort((v,w)=>v.order-w.order),b0.length=d.length;for(let v=0,w=d.length;v<w;++v)b0[v]=d[v].injection;const c="".concat(b0.join(`
`),`
`);switch(l){case"vs:#decl":s&&(t=t.replace(Ym,c));break;case"vs:#main-start":s&&(t=t.replace(R2,v=>v+c));break;case"vs:#main-end":s&&(t=t.replace(O2,v=>c+v));break;case"fs:#decl":s||(t=t.replace(Ym,c));break;case"fs:#main-start":s||(t=t.replace(R2,v=>v+c));break;case"fs:#main-end":s||(t=t.replace(O2,v=>c+v));break;default:t=t.replace(l,v=>v+c)}}return t=t.replace(Ym,""),r&&(t=t.replace(/\}\s*$/,l=>l+MF[e])),t}function Gv(t){const e={};return Ts(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function rh(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const _C=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],LF=[..._C,[rh("attribute"),"in $1"],[rh("varying"),"out $1"]],RF=[..._C,[rh("varying"),"in $1"]],vC=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],OF=[...vC,[rh("in"),"attribute $1"],[rh("out"),"varying $1"]],DF=[...vC,[rh("in"),"varying $1"]],$v="gl_FragColor",Wv=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,zF=/void\s+main\s*\([^)]*\)\s*\{\n?/;function FF(t,e,n){switch(e){case 300:return n?Og(t,LF):BF(t);case 100:return n?Og(t,OF):NF(t);default:throw new Error("unknown GLSL version ".concat(e))}}function Og(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function BF(t){t=Og(t,RF);const e=t.match(Wv);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat($v,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(zF,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat($v,"\\b"),"g"),n)}return t}function NF(t){t=Og(t,DF);const e=t.match(Wv);if(e){const n=e[1];t=t.replace(Wv,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),$v)}return t}const UF=`

`.concat(Ym,`

`),xC={[Gf]:"vertex",[T1]:"fragment"},VF=`precision highp float;

`;function jF(t,e){const{vs:n,fs:r}=e,s=gF(e.modules||[]);return{gl:t,vs:z2(t,Object.assign({},e,{source:n,type:Gf,modules:s})),fs:z2(t,Object.assign({},e,{source:r,type:T1,modules:s})),getUniforms:GF(s)}}function z2(t,e){let{id:n,source:r,type:s,modules:l,defines:d={},hookFunctions:c=[],inject:v={},transpileToGLSL100:w=!1,prologue:C=!0,log:I}=e;Ts(typeof r=="string","shader source must be a string");const S=s===Gf,z=r.split(`
`);let F=100,B="",Q=r;z[0].indexOf("#version ")===0?(F=300,B=z[0],Q=z.slice(1).join(`
`)):B="#version ".concat(F);const q={};l.forEach(we=>{Object.assign(q,we.getDefines())}),Object.assign(q,d);let j=C?"".concat(B,`
`).concat(WF({id:n,source:r,type:s}),`
`).concat($F({type:s}),`
`).concat(PF(t),`
`).concat(CF(t),`
`).concat(HF(q),`
`).concat(S?"":VF,`
`):"".concat(B,`
`);const G=XF(c),se={},he={},ye={};for(const we in v){const Be=typeof v[we]=="string"?{injection:v[we],order:0}:v[we],Ve=we.match(/^(v|f)s:(#)?([\w-]+)$/);if(Ve){const xe=Ve[2],He=Ve[3];xe?He==="decl"?he[we]=[Be]:ye[we]=[Be]:se[we]=[Be]}else ye[we]=[Be]}for(const we of l){I&&we.checkDeprecations(Q,I);const Be=we.getModuleSource(s,F);j+=Be;const Ve=we.injections[s];for(const xe in Ve){const He=xe.match(/^(v|f)s:#([\w-]+)$/);if(He){const yt=He[2]==="decl"?he:ye;yt[xe]=yt[xe]||[],yt[xe].push(Ve[xe])}else se[xe]=se[xe]||[],se[xe].push(Ve[xe])}}return j+=UF,j=D2(j,s,he),j+=qF(G[s],se),j+=Q,j=D2(j,s,ye),j=FF(j,w?100:F,S),j}function GF(t){return function(n){const r={};for(const s of t){const l=s.getUniforms(n,r);Object.assign(r,l)}return r}}function $F(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(xC[e].toUpperCase(),`
`)}function WF(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(xC[r],`

`):""}function HF(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const s=t[r];(s||Number.isFinite(s))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function qF(t,e){let n="";for(const r in t){const s=t[r];if(n+="void ".concat(s.signature,` {
`),s.header&&(n+="  ".concat(s.header)),e[r]){const l=e[r];l.sort((d,c)=>d.order-c.order);for(const d of l)n+="  ".concat(d.injection,`
`)}s.footer&&(n+="  ".concat(s.footer)),n+=`}
`}return n}function XF(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[s,l]=n.split(":"),d=n.replace(/\(.+/,"");e[s][d]=Object.assign(r,{signature:l})}),e}const ZF="void main() {gl_FragColor = vec4(0);}",bC=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,YF=`#version 300 es
`.concat(bC);function wC(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,s,l]=n;if(!e.includes(r)||!s||!l)return null;const d=l.split(";")[0];return{qualifier:r,type:s,name:d}}function EC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:s}=t;if(!n)return e===300?YF:e>300?"#version ".concat(e,`
`).concat(bC):ZF;const l=QF(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(s,`;
void main() {
  `).concat(s," = ").concat(l,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(l,`;
}`)}function KF(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Ts(!1),null}}function JF(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Ts(!1),null}}function QF(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Ts(!1),null}}const eB=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,tB={name:"fp32",vs:eB,fs:null};function F2(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const ws={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function nB(t,{precision:e=ws.precision}={}){return t=rB(t),"".concat(parseFloat(t.toPrecision(e)))}function ih(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function hi(t,e,n){return sB(t,r=>Math.max(e,Math.min(n,r)))}function Dg(t,e,n){return ih(t)?t.map((r,s)=>Dg(r,e[s],n)):n*e+(1-n)*t}function sh(t,e,n){const r=ws.EPSILON;n&&(ws.EPSILON=n);try{if(t===e)return!0;if(ih(t)&&ih(e)){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(!sh(t[s],e[s]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=ws.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{ws.EPSILON=r}}function rB(t){return Math.round(t/ws.EPSILON)*ws.EPSILON}function iB(t){return t.clone?t.clone():new Array(t.length)}function sB(t,e,n){if(ih(t)){const r=t;n=n||iB(r);for(let s=0;s<n.length&&s<r.length;++s)n[s]=e(t[s],s,n);return n}return e(t)}function oB(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class TC extends oB(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:ih(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(ws)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+nB(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!sh(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let s=0;s<this.ELEMENTS;++s){const l=e[s];this[s]=l+r*(n[s]-l)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(ws.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function aB(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function vs(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function w0(t,e,n=""){if(ws.debug&&!aB(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class lB extends TC{get x(){return this[0]}set x(e){this[0]=vs(e)}get y(){return this[1]}set y(e){this[1]=vs(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const s=this[r]-e[r];n+=s*s}return vs(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return vs(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return F2(e>=0&&e<this.ELEMENTS,"index is out of range"),vs(this[e])}setComponent(e,n){return F2(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var Km=1e-6,oh=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function cB(){var t=new oh(2);return oh!=Float32Array&&(t[0]=0,t[1]=0),t}function zg(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function SC(t,e){return t[0]=-e[0],t[1]=-e[1],t}function AC(t,e,n,r){var s=e[0],l=e[1];return t[0]=s+r*(n[0]-s),t[1]=l+r*(n[1]-l),t}function uB(t,e,n){var r=e[0],s=e[1];return t[0]=n[0]*r+n[4]*s+n[12],t[1]=n[1]*r+n[5]*s+n[13],t}(function(){var t=cB();return function(e,n,r,s,l,d){var c,v;for(n||(n=2),r||(r=0),s?v=Math.min(s*n+r,e.length):v=e.length,c=r;c<v;c+=n)t[0]=e[c],t[1]=e[c+1],l(t,t,d),e[c]=t[0],e[c+1]=t[1];return e}})();function hB(t,e,n){const r=e[0],s=e[1],l=n[3]*r+n[7]*s||1;return t[0]=(n[0]*r+n[4]*s)/l,t[1]=(n[1]*r+n[5]*s)/l,t}function PC(t,e,n){const r=e[0],s=e[1],l=e[2],d=n[3]*r+n[7]*s+n[11]*l||1;return t[0]=(n[0]*r+n[4]*s+n[8]*l)/d,t[1]=(n[1]*r+n[5]*s+n[9]*l)/d,t[2]=(n[2]*r+n[6]*s+n[10]*l)/d,t}function dB(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[2]*s,t[1]=n[1]*r+n[3]*s,t[2]=e[2],t}function fB(){var t=new oh(3);return oh!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function pB(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function mB(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function gB(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function yB(t,e,n){var r=e[0],s=e[1],l=e[2],d=n[0],c=n[1],v=n[2];return t[0]=s*v-l*c,t[1]=l*d-r*v,t[2]=r*c-s*d,t}function CC(t,e,n){var r=e[0],s=e[1],l=e[2],d=n[3]*r+n[7]*s+n[11]*l+n[15];return d=d||1,t[0]=(n[0]*r+n[4]*s+n[8]*l+n[12])/d,t[1]=(n[1]*r+n[5]*s+n[9]*l+n[13])/d,t[2]=(n[2]*r+n[6]*s+n[10]*l+n[14])/d,t}function _B(t,e,n){var r=e[0],s=e[1],l=e[2];return t[0]=r*n[0]+s*n[3]+l*n[6],t[1]=r*n[1]+s*n[4]+l*n[7],t[2]=r*n[2]+s*n[5]+l*n[8],t}function vB(t,e,n){var r=n[0],s=n[1],l=n[2],d=n[3],c=e[0],v=e[1],w=e[2],C=s*w-l*v,I=l*c-r*w,S=r*v-s*c,z=s*S-l*I,F=l*C-r*S,B=r*I-s*C,Q=d*2;return C*=Q,I*=Q,S*=Q,z*=2,F*=2,B*=2,t[0]=c+C+z,t[1]=v+I+F,t[2]=w+S+B,t}function xB(t,e,n,r){var s=[],l=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],l[0]=s[0],l[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),l[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),t[0]=l[0]+n[0],t[1]=l[1]+n[1],t[2]=l[2]+n[2],t}function bB(t,e,n,r){var s=[],l=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],l[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),l[1]=s[1],l[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),t[0]=l[0]+n[0],t[1]=l[1]+n[1],t[2]=l[2]+n[2],t}function wB(t,e,n,r){var s=[],l=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],l[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),l[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),l[2]=s[2],t[0]=l[0]+n[0],t[1]=l[1]+n[1],t[2]=l[2]+n[2],t}function EB(t,e){var n=t[0],r=t[1],s=t[2],l=e[0],d=e[1],c=e[2],v=Math.sqrt(n*n+r*r+s*s),w=Math.sqrt(l*l+d*d+c*c),C=v*w,I=C&&gB(t,e)/C;return Math.acos(Math.min(Math.max(I,-1),1))}var TB=pB;(function(){var t=fB();return function(e,n,r,s,l,d){var c,v;for(n||(n=3),r||(r=0),s?v=Math.min(s*n+r,e.length):v=e.length,c=r;c<v;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],l(t,t,d),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2];return e}})();const E0=[0,0,0];let Am;class Go extends lB{static get ZERO(){return Am||(Am=new Go(0,0,0),Object.freeze(Am)),Am}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&ih(e)?this.copy(e):(ws.debug&&(vs(e),vs(n),vs(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return ws.debug&&(vs(e.x),vs(e.y),vs(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=vs(e)}angle(e){return EB(this,e)}cross(e){return yB(this,this,e),this.check()}rotateX({radians:e,origin:n=E0}){return xB(this,this,n,e),this.check()}rotateY({radians:e,origin:n=E0}){return bB(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=E0}){return wB(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return CC(this,this,e),this.check()}transformAsVector(e){return PC(this,this,e),this.check()}transformByMatrix3(e){return _B(this,this,e),this.check()}transformByMatrix2(e){return dB(this,this,e),this.check()}transformByQuaternion(e){return vB(this,this,e),this.check()}}class SB extends TC{toString(){let e="[";if(ws.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=vs(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let s=0;s<this.RANK;++s)n[s]=this[r+s];return n}setColumn(e,n){const r=e*this.RANK;for(let s=0;s<this.RANK;++s)this[r+s]=n[s];return this}}function AB(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function PB(t,e){if(t===e){var n=e[1],r=e[2],s=e[3],l=e[6],d=e[7],c=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=l,t[11]=e[14],t[12]=s,t[13]=d,t[14]=c}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Hv(t,e){var n=e[0],r=e[1],s=e[2],l=e[3],d=e[4],c=e[5],v=e[6],w=e[7],C=e[8],I=e[9],S=e[10],z=e[11],F=e[12],B=e[13],Q=e[14],q=e[15],j=n*c-r*d,G=n*v-s*d,se=n*w-l*d,he=r*v-s*c,ye=r*w-l*c,we=s*w-l*v,Be=C*B-I*F,Ve=C*Q-S*F,xe=C*q-z*F,He=I*Q-S*B,wt=I*q-z*B,yt=S*q-z*Q,ot=j*yt-G*wt+se*He+he*xe-ye*Ve+we*Be;return ot?(ot=1/ot,t[0]=(c*yt-v*wt+w*He)*ot,t[1]=(s*wt-r*yt-l*He)*ot,t[2]=(B*we-Q*ye+q*he)*ot,t[3]=(S*ye-I*we-z*he)*ot,t[4]=(v*xe-d*yt-w*Ve)*ot,t[5]=(n*yt-s*xe+l*Ve)*ot,t[6]=(Q*se-F*we-q*G)*ot,t[7]=(C*we-S*se+z*G)*ot,t[8]=(d*wt-c*xe+w*Be)*ot,t[9]=(r*xe-n*wt-l*Be)*ot,t[10]=(F*ye-B*se+q*j)*ot,t[11]=(I*se-C*ye-z*j)*ot,t[12]=(c*Ve-d*He-v*Be)*ot,t[13]=(n*He-r*Ve+s*Be)*ot,t[14]=(B*G-F*he-Q*j)*ot,t[15]=(C*he-I*G+S*j)*ot,t):null}function CB(t){var e=t[0],n=t[1],r=t[2],s=t[3],l=t[4],d=t[5],c=t[6],v=t[7],w=t[8],C=t[9],I=t[10],S=t[11],z=t[12],F=t[13],B=t[14],Q=t[15],q=e*d-n*l,j=e*c-r*l,G=e*v-s*l,se=n*c-r*d,he=n*v-s*d,ye=r*v-s*c,we=w*F-C*z,Be=w*B-I*z,Ve=w*Q-S*z,xe=C*B-I*F,He=C*Q-S*F,wt=I*Q-S*B;return q*wt-j*He+G*xe+se*Ve-he*Be+ye*we}function _c(t,e,n){var r=e[0],s=e[1],l=e[2],d=e[3],c=e[4],v=e[5],w=e[6],C=e[7],I=e[8],S=e[9],z=e[10],F=e[11],B=e[12],Q=e[13],q=e[14],j=e[15],G=n[0],se=n[1],he=n[2],ye=n[3];return t[0]=G*r+se*c+he*I+ye*B,t[1]=G*s+se*v+he*S+ye*Q,t[2]=G*l+se*w+he*z+ye*q,t[3]=G*d+se*C+he*F+ye*j,G=n[4],se=n[5],he=n[6],ye=n[7],t[4]=G*r+se*c+he*I+ye*B,t[5]=G*s+se*v+he*S+ye*Q,t[6]=G*l+se*w+he*z+ye*q,t[7]=G*d+se*C+he*F+ye*j,G=n[8],se=n[9],he=n[10],ye=n[11],t[8]=G*r+se*c+he*I+ye*B,t[9]=G*s+se*v+he*S+ye*Q,t[10]=G*l+se*w+he*z+ye*q,t[11]=G*d+se*C+he*F+ye*j,G=n[12],se=n[13],he=n[14],ye=n[15],t[12]=G*r+se*c+he*I+ye*B,t[13]=G*s+se*v+he*S+ye*Q,t[14]=G*l+se*w+he*z+ye*q,t[15]=G*d+se*C+he*F+ye*j,t}function Fg(t,e,n){var r=n[0],s=n[1],l=n[2],d,c,v,w,C,I,S,z,F,B,Q,q;return e===t?(t[12]=e[0]*r+e[4]*s+e[8]*l+e[12],t[13]=e[1]*r+e[5]*s+e[9]*l+e[13],t[14]=e[2]*r+e[6]*s+e[10]*l+e[14],t[15]=e[3]*r+e[7]*s+e[11]*l+e[15]):(d=e[0],c=e[1],v=e[2],w=e[3],C=e[4],I=e[5],S=e[6],z=e[7],F=e[8],B=e[9],Q=e[10],q=e[11],t[0]=d,t[1]=c,t[2]=v,t[3]=w,t[4]=C,t[5]=I,t[6]=S,t[7]=z,t[8]=F,t[9]=B,t[10]=Q,t[11]=q,t[12]=d*r+C*s+F*l+e[12],t[13]=c*r+I*s+B*l+e[13],t[14]=v*r+S*s+Q*l+e[14],t[15]=w*r+z*s+q*l+e[15]),t}function A1(t,e,n){var r=n[0],s=n[1],l=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*l,t[9]=e[9]*l,t[10]=e[10]*l,t[11]=e[11]*l,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function IB(t,e,n,r){var s=r[0],l=r[1],d=r[2],c=Math.hypot(s,l,d),v,w,C,I,S,z,F,B,Q,q,j,G,se,he,ye,we,Be,Ve,xe,He,wt,yt,ot,zt;return c<Km?null:(c=1/c,s*=c,l*=c,d*=c,v=Math.sin(n),w=Math.cos(n),C=1-w,I=e[0],S=e[1],z=e[2],F=e[3],B=e[4],Q=e[5],q=e[6],j=e[7],G=e[8],se=e[9],he=e[10],ye=e[11],we=s*s*C+w,Be=l*s*C+d*v,Ve=d*s*C-l*v,xe=s*l*C-d*v,He=l*l*C+w,wt=d*l*C+s*v,yt=s*d*C+l*v,ot=l*d*C-s*v,zt=d*d*C+w,t[0]=I*we+B*Be+G*Ve,t[1]=S*we+Q*Be+se*Ve,t[2]=z*we+q*Be+he*Ve,t[3]=F*we+j*Be+ye*Ve,t[4]=I*xe+B*He+G*wt,t[5]=S*xe+Q*He+se*wt,t[6]=z*xe+q*He+he*wt,t[7]=F*xe+j*He+ye*wt,t[8]=I*yt+B*ot+G*zt,t[9]=S*yt+Q*ot+se*zt,t[10]=z*yt+q*ot+he*zt,t[11]=F*yt+j*ot+ye*zt,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function IC(t,e,n){var r=Math.sin(n),s=Math.cos(n),l=e[4],d=e[5],c=e[6],v=e[7],w=e[8],C=e[9],I=e[10],S=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=l*s+w*r,t[5]=d*s+C*r,t[6]=c*s+I*r,t[7]=v*s+S*r,t[8]=w*s-l*r,t[9]=C*s-d*r,t[10]=I*s-c*r,t[11]=S*s-v*r,t}function kB(t,e,n){var r=Math.sin(n),s=Math.cos(n),l=e[0],d=e[1],c=e[2],v=e[3],w=e[8],C=e[9],I=e[10],S=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=l*s-w*r,t[1]=d*s-C*r,t[2]=c*s-I*r,t[3]=v*s-S*r,t[8]=l*r+w*s,t[9]=d*r+C*s,t[10]=c*r+I*s,t[11]=v*r+S*s,t}function kC(t,e,n){var r=Math.sin(n),s=Math.cos(n),l=e[0],d=e[1],c=e[2],v=e[3],w=e[4],C=e[5],I=e[6],S=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=l*s+w*r,t[1]=d*s+C*r,t[2]=c*s+I*r,t[3]=v*s+S*r,t[4]=w*s-l*r,t[5]=C*s-d*r,t[6]=I*s-c*r,t[7]=S*s-v*r,t}function MB(t,e){var n=e[0],r=e[1],s=e[2],l=e[3],d=n+n,c=r+r,v=s+s,w=n*d,C=r*d,I=r*c,S=s*d,z=s*c,F=s*v,B=l*d,Q=l*c,q=l*v;return t[0]=1-I-F,t[1]=C+q,t[2]=S-Q,t[3]=0,t[4]=C-q,t[5]=1-w-F,t[6]=z+B,t[7]=0,t[8]=S+Q,t[9]=z-B,t[10]=1-w-I,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function LB(t,e,n,r,s,l,d){var c=1/(n-e),v=1/(s-r),w=1/(l-d);return t[0]=l*2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l*2*v,t[6]=0,t[7]=0,t[8]=(n+e)*c,t[9]=(s+r)*v,t[10]=(d+l)*w,t[11]=-1,t[12]=0,t[13]=0,t[14]=d*l*2*w,t[15]=0,t}function RB(t,e,n,r,s){var l=1/Math.tan(e/2),d;return t[0]=l/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(d=1/(r-s),t[10]=(s+r)*d,t[14]=2*s*r*d):(t[10]=-1,t[14]=-2*r),t}var OB=RB;function DB(t,e,n,r,s,l,d){var c=1/(e-n),v=1/(r-s),w=1/(l-d);return t[0]=-2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*v,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*w,t[11]=0,t[12]=(e+n)*c,t[13]=(s+r)*v,t[14]=(d+l)*w,t[15]=1,t}var zB=DB;function FB(t,e,n,r){var s,l,d,c,v,w,C,I,S,z,F=e[0],B=e[1],Q=e[2],q=r[0],j=r[1],G=r[2],se=n[0],he=n[1],ye=n[2];return Math.abs(F-se)<Km&&Math.abs(B-he)<Km&&Math.abs(Q-ye)<Km?AB(t):(C=F-se,I=B-he,S=Q-ye,z=1/Math.hypot(C,I,S),C*=z,I*=z,S*=z,s=j*S-G*I,l=G*C-q*S,d=q*I-j*C,z=Math.hypot(s,l,d),z?(z=1/z,s*=z,l*=z,d*=z):(s=0,l=0,d=0),c=I*d-S*l,v=S*s-C*d,w=C*l-I*s,z=Math.hypot(c,v,w),z?(z=1/z,c*=z,v*=z,w*=z):(c=0,v=0,w=0),t[0]=s,t[1]=c,t[2]=C,t[3]=0,t[4]=l,t[5]=v,t[6]=I,t[7]=0,t[8]=d,t[9]=w,t[10]=S,t[11]=0,t[12]=-(s*F+l*B+d*Q),t[13]=-(c*F+v*B+w*Q),t[14]=-(C*F+I*B+S*Q),t[15]=1,t)}function BB(){var t=new oh(4);return oh!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function NB(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function $f(t,e,n){var r=e[0],s=e[1],l=e[2],d=e[3];return t[0]=n[0]*r+n[4]*s+n[8]*l+n[12]*d,t[1]=n[1]*r+n[5]*s+n[9]*l+n[13]*d,t[2]=n[2]*r+n[6]*s+n[10]*l+n[14]*d,t[3]=n[3]*r+n[7]*s+n[11]*l+n[15]*d,t}(function(){var t=BB();return function(e,n,r,s,l,d){var c,v;for(n||(n=4),r||(r=0),s?v=Math.min(s*n+r,e.length):v=e.length,c=r;c<v;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],t[3]=e[c+3],l(t,t,d),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2],e[c+3]=t[3];return e}})();var qv;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(qv||(qv={}));const UB=45*Math.PI/180,VB=1,T0=.1,S0=500,jB=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class qs extends SB{static get IDENTITY(){return $B()}static get ZERO(){return GB()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return qv}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,s,l,d,c,v,w,C,I,S,z,F,B,Q){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this[4]=l,this[5]=d,this[6]=c,this[7]=v,this[8]=w,this[9]=C,this[10]=I,this[11]=S,this[12]=z,this[13]=F,this[14]=B,this[15]=Q,this.check()}setRowMajor(e,n,r,s,l,d,c,v,w,C,I,S,z,F,B,Q){return this[0]=e,this[1]=l,this[2]=w,this[3]=z,this[4]=n,this[5]=d,this[6]=C,this[7]=F,this[8]=r,this[9]=c,this[10]=I,this[11]=B,this[12]=s,this[13]=v,this[14]=S,this[15]=Q,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(jB)}fromObject(e){return this.check()}fromQuaternion(e){return MB(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:s,top:l,near:d=T0,far:c=S0}=e;return c===1/0?WB(this,n,r,s,l,d):LB(this,n,r,s,l,d,c),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:s=[0,1,0]}=e;return FB(this,n,r,s),this.check()}ortho(e){const{left:n,right:r,bottom:s,top:l,near:d=T0,far:c=S0}=e;return zB(this,n,r,s,l,d,c),this.check()}orthographic(e){const{fovy:n=UB,aspect:r=VB,focalDistance:s=1,near:l=T0,far:d=S0}=e;B2(n);const c=n/2,v=s*Math.tan(c),w=v*r;return this.ortho({left:-w,right:w,bottom:-v,top:v,near:l,far:d})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:s=.1,far:l=500}=e;return B2(n),OB(this,n,r,s,l),this.check()}determinant(){return CB(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),s=1/r[0],l=1/r[1],d=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*l,e[2]=this[2]*d,e[3]=0,e[4]=this[4]*s,e[5]=this[5]*l,e[6]=this[6]*d,e[7]=0,e[8]=this[8]*s,e[9]=this[9]*l,e[10]=this[10]*d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),s=1/r[0],l=1/r[1],d=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*l,e[2]=this[2]*d,e[3]=this[4]*s,e[4]=this[5]*l,e[5]=this[6]*d,e[6]=this[8]*s,e[7]=this[9]*l,e[8]=this[10]*d,e}transpose(){return PB(this,this),this.check()}invert(){return Hv(this,this),this.check()}multiplyLeft(e){return _c(this,e,this),this.check()}multiplyRight(e){return _c(this,this,e),this.check()}rotateX(e){return IC(this,this,e),this.check()}rotateY(e){return kB(this,this,e),this.check()}rotateZ(e){return kC(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return IB(this,this,e,n),this.check()}scale(e){return A1(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Fg(this,this,e),this.check()}transform(e,n){return e.length===4?(n=$f(n||[-0,-0,-0,-0],e,this),w0(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let s;switch(r){case 2:s=uB(n||[-0,-0],e,this);break;case 3:s=CC(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return w0(s,e.length),s}transformAsVector(e,n){let r;switch(e.length){case 2:r=hB(n||[-0,-0],e,this);break;case 3:r=PC(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return w0(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let Pm,Cm;function GB(){return Pm||(Pm=new qs([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Pm)),Pm}function $B(){return Cm||(Cm=new qs,Object.freeze(Cm)),Cm}function B2(t){if(t>Math.PI*2)throw Error("expected radians")}function WB(t,e,n,r,s,l){const d=2*l/(n-e),c=2*l/(s-r),v=(n+e)/(n-e),w=(s+r)/(s-r),C=-1,I=-1,S=-2*l;return t[0]=d,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=v,t[9]=w,t[10]=C,t[11]=I,t[12]=0,t[13]=0,t[14]=S,t[15]=0,t}const HB=new Uint8Array([0,255,255,255]),qB={pickingSelectedColor:null,pickingHighlightColor:HB,pickingActive:!1,pickingAttribute:!1};function XB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:qB;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}const ZB=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,YB=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,KB={name:"picking",vs:ZB,fs:YB,getUniforms:XB},JB=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,QB={name:"transform",vs:JB,fs:null};class Wf{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Wf(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:s={},inject:l={},varyings:d=[],bufferMode:c=35981,transpileToGLSL100:v=!1}=e,w=this._getModuleList(e.modules),C=this._getHash(n),I=this._getHash(r),S=w.map(G=>this._getHash(G.name)).sort(),z=d.map(G=>this._getHash(G)),F=Object.keys(s).sort(),B=Object.keys(l).sort(),Q=[],q=[];for(const G of F)Q.push(this._getHash(G)),Q.push(this._getHash(s[G]));for(const G of B)q.push(this._getHash(G)),q.push(this._getHash(l[G]));const j="".concat(C,"/").concat(I,"D").concat(Q.join("/"),"M").concat(S.join("/"),"I").concat(q.join("/"),"V").concat(z.join("/"),"H").concat(this.stateHash,"B").concat(c).concat(v?"T":"");if(!this._programCache[j]){const G=jF(this.gl,{vs:n,fs:r,modules:w,inject:l,defines:s,hookFunctions:this._hookFunctions,transpileToGLSL100:v});this._programCache[j]=new pC(this.gl,{hash:j,vs:G.vs,fs:G.fs,varyings:d,bufferMode:c}),this._getUniforms[j]=G.getUniforms||(se=>{}),this._useCounts[j]=0}return this._useCounts[j]++,this._programCache[j]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let s=0;for(let l=0,d=this._defaultModules.length;l<d;++l){const c=this._defaultModules[l],v=c.name;n[s++]=c,r[v]=!0}for(let l=0,d=e.length;l<d;++l){const c=e[l],v=c.name;r[v]||(n[s++]=c,r[v]=!0)}return n.length=s,n}}const eN={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function tN(t,e,n){const r={};let s=e.indices;for(const l in e.attributes){const d=e.attributes[l],c=nN(l,n);if(l==="indices")s=d;else if(d.constant)r[c]=d.value;else{const v=d.value,w={...d};delete w.value,r[c]=[new Kn(t,v),w],rN(l,w)}}if(s){const l=s.value||s;gt(l instanceof Uint16Array||l instanceof Uint32Array,'attribute array for "indices" must be of integer type');const d={size:1,isIndexed:s.isIndexed===void 0?!0:s.isIndexed};r.indices=[new Kn(t,{data:l,target:34963}),d]}return r}function nN(t,e){const{attributeMap:n=eN}=e||{};return n&&n[t]||t}function rN(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}gt(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const hu=2,iN=1e4,sN="Model needs drawMode and vertexCount",N2=()=>{},oN={};class MC{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=vl("model")}=n;gt(hy(e)),this.id=r,this.gl=e,this.id=n.id||vl("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Wf.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:s,modules:l,defines:d,inject:c,varyings:v,bufferMode:w,transpileToGLSL100:C}=e;this.programProps={program:n,vs:r,fs:s,modules:l,defines:d,inject:c,varyings:v,bufferMode:w,transpileToGLSL100:C},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},gt(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),sN)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:s,modules:l,defines:d,inject:c,varyings:v,bufferMode:w,transpileToGLSL100:C}=e;this.programProps={program:n,vs:r,fs:s,modules:l,defines:d,inject:c,varyings:v,bufferMode:w,transpileToGLSL100:C},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return gt(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return gt(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=tN(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(nh(e))return this;const n={};for(const r in e){const s=e[r];n[r]=s.getValue?s.getValue():s}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return w1(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:s={},attributes:l={},transformFeedback:d=this.transformFeedback,parameters:c={},vertexArray:v=this.vertexArray}=e;this.setAttributes(l),this.updateModuleSettings(n),this.setUniforms(s);let w;Mt.priority>=hu&&(w=this._logDrawCallStart(hu));const C=this.vertexArray.getDrawParams(),{isIndexed:I=C.isIndexed,indexType:S=C.indexType,indexOffset:z=C.indexOffset,vertexArrayInstanced:F=C.isInstanced}=this.props;F&&!this.isInstanced&&Mt.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:B,instanceCount:Q}=this,{onBeforeRender:q=N2,onAfterRender:j=N2}=this.props;q(),this.program.setUniforms(this.uniforms);const G=this.program.draw(Object.assign(oN,e,{logPriority:w,uniforms:null,framebuffer:r,parameters:c,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:v,transformFeedback:d,isIndexed:I,indexType:S,isInstanced:B,instanceCount:Q,offset:I?z:0}));return j(),Mt.priority>=hu&&this._logDrawCallEnd(w,v,r),G}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:s=[]}=e;let{parameters:l}=e;r&&this._setFeedbackBuffers(r),n&&(l=Object.assign({},l,{[35977]:n})),s.forEach(d=>d.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:l}))}finally{s.forEach(d=>d.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Mt.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:s,modules:l,inject:d,defines:c,varyings:v,bufferMode:w,transpileToGLSL100:C}=this.programProps;n=this.programManager.get({vs:r,fs:s,modules:l,inject:d,defines:c,varyings:v,bufferMode:w,transpileToGLSL100:C}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}gt(n instanceof pC,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new rF(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof Kn&&n.delete()}}_setAnimationProps(e){this.animated&&gt(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(nh(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new mC(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:iN;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),Mt.group(hu,">>> DRAWING MODEL ".concat(this.id),{collapsed:Mt.level<=2})(),e}_logDrawCallEnd(e,n,r,s){if(e===void 0)return;const l=oF({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:d,unusedTable:c,unusedCount:v}=A2({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:w,count:C}=A2({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});C>0&&Mt.log("MISSING UNIFORMS",Object.keys(w))(),v>0&&Mt.log("UNUSED UNIFORMS",Object.keys(c))();const I=lF(this.vertexArray.configuration);Mt.table(e,l)(),Mt.table(e,d)(),Mt.table(e+1,I)(),s&&s.log({logLevel:hu,message:"Rendered to ".concat(s.id)}),Mt.groupEnd(hu)()}}class aN{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:s}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:s}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof Kn?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&gt(mn(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const s in this.feedbackMap){const l=this.feedbackMap[s];s in n&&(r[l]=s)}Object.assign(r,e.feedbackBuffers);for(const s in r){const l=r[s];if(typeof l=="string"){const d=n[l],{byteLength:c,usage:v,accessor:w}=d;r[s]=this._createNewBuffer(s,{byteLength:c,usage:v,accessor:w})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:s}=r;e.transformFeedback=new mC(this.gl,{program:s,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),s=this._getNextIndex();this.bindings[s]=this._updateBinding(this.bindings[s],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const s in this.feedbackMap){const l=this.feedbackMap[s];n[s]=e.feedbackBuffers[l],r[l]=e.sourceBuffers[s],gt(r[l]instanceof Kn)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new Kn(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const lN="transform_uSampler_",Bg="transform_uSize_",U2="transform_position";function cN(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:s}=t,d=Object.keys(n).length,c=null;const v={};let w=e,C={};if(d>0||r){const I=w.split(`
`),S=I.slice();if(I.forEach((z,F,B)=>{if(d>0){const Q=pN(z,n);if(Q){const{updatedLine:q,inject:j}=Q;S[F]=q,C=Gv([C,j]),Object.assign(v,Q.samplerTextureMap),d--}}r&&!c&&(c=fN(z,r))}),r){gt(s);const z="".concat(Bg).concat(r),F="uniform vec2 ".concat(z,`;
`),B="     vec2 ".concat(U2," = transform_getPos(").concat(z,`);
     gl_Position = vec4(`).concat(U2,`, 0, 1.);
`);C=Gv([C,{"vs:#decl":F,"vs:#main-start":B}])}w=S.join(`
`)}return{vs:w,targetTextureType:c,inject:C,samplerTextureMap:v}}function uN(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const s={};let l,d;n&&({width:l,height:d}=r,s["".concat(Bg).concat(n)]=[l,d]);for(const c in e)({width:l,height:d}=e[c]),s["".concat(Bg).concat(c)]=[l,d];return s}function hN(t){return wC(t,["attribute","in"])}function dN(t){const e="".concat(lN).concat(t),n="".concat(Bg).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function fN(t,e){const n=wC(t,["varying","out"]);return n&&n.name===e?n.type:null}function pN(t,e){const n={},r=hN(t);if(!r)return null;const{type:s,name:l}=r;if(l&&e[l]){const d="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:c,sizeName:v,uniformDeclerations:w}=dN(l),C=KF(s),I="  ".concat(s," ").concat(l," = transform_getInput(").concat(c,", ").concat(v,").").concat(C,`;
`);return n[c]=l,{updatedLine:d,inject:{"vs:#decl":w,"vs:#main-start":I},samplerTextureMap:n}}return null}const mN={[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},gN="transform_output";class yN{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:s,targetTexture:l}=this.bindings[this.currentIndex],d=Object.assign({},n,e.attributes),c=Object.assign({},e.uniforms),v=Object.assign({},e.parameters);let w=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){d.transform_elementID=this.elementIDBuffer;for(const I in this.samplerTextureMap){const S=this.samplerTextureMap[I];c[I]=r[S]}this._setSourceTextureParameters();const C=uN({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:l});Object.assign(c,C)}return this.hasTargetTexture&&(w=!1,v.viewport=[0,0,s.width,s.height]),{attributes:d,framebuffer:s,uniforms:c,discard:w,parameters:v}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=fy(n);if(!e)return r;const s=r.constructor,l=JF(this.targetTextureType),d=new s(r.length*l/4);let c=0;for(let v=0;v<r.length;v+=4)for(let w=0;w<l;w++)d[c++]=r[v+w];return d}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof Gi)return r;const s=n[r];return s?(this._targetRefTexName=r,this._createNewTexture(s)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:s}=e,l=this._createTargetTexture({sourceTextures:r,textureOrReference:s});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:l}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,s,l)=>{l[s]=s}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new Kn(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),s=this._getNextIndex();this.bindings[s]=this._updateBinding(this.bindings[s],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:s,targetTexture:l}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,s),Object.assign(e.sourceBuffers,r),l){e.targetTexture=l;const{width:d,height:c}=l,{framebuffer:v}=e;v?(v.update({attachments:{[36064]:l},resizeAttachments:!1}),v.resize({width:d,height:c})):e.framebuffer=new Ur(this.gl,{id:"transform-framebuffer",width:d,height:c,attachments:{[36064]:l}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(mN)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=H4(e,{parameters:{[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},pixelStore:{[37440]:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:s,uniforms:l,targetTextureType:d,inject:c,samplerTextureMap:v}=cN({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),w=Gv([e.inject||{},c]);this.targetTextureType=d,this.samplerTextureMap=v;const C=e._fs||EC({version:dC(s),input:this.targetTextureVarying,inputType:d,output:gN}),I=this.hasSourceTextures||this.targetTextureVarying?[QB].concat(e.modules||[]):e.modules;return{vs:s,fs:C,modules:I,uniforms:l,inject:w}}}class P1{static isSupported(e){return mn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();gt(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const s=r.getData(e);if(s)return s}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new MC(n,Object.assign({},e,{fs:e.fs||EC({version:dC(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const s of r)n=s.updateModelProps(n);return n}_buildResourceTransforms(e,n){_N(n)&&(this.bufferTransform=new aN(e,n)),vN(n)&&(this.textureTransform=new yN(e,n)),gt(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const s of r)n=Object.assign(n,s.getDrawOptions(n));return n}}function _N(t){return!!(!nh(t.feedbackBuffers)||!nh(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function vN(t){return!!(!nh(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const V2={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class xN{static get DRAW_MODE(){return V2}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=vl("geometry"),drawMode:r=V2.TRIANGLES,attributes:s={},indices:l=null,vertexCount:d=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(s,l),this.vertexCount=d||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let s=e[r];s=ArrayBuffer.isView(s)?{value:s}:s,gt(ArrayBuffer.isView(s.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!s.size&&(s.size=3),r==="indices"?(gt(!this.indices),this.indices=s):this.attributes[r]=s}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const s in e){const l=e[s],{value:d,size:c,constant:v}=l;!v&&d&&c>=1&&(r=Math.min(r,d.length/c))}return gt(Number.isFinite(r)),r}}let bN=1,wN=1;class LC{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:s=1,repeat:l=1}=e,d=bN++,c={time:0,delay:n,duration:r,rate:s,repeat:l};return this._setChannelTime(c,this.time),this.channels.set(d,c),d}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const s of n)this._setChannelTime(s,this.time);const r=this.animations.values();for(const s of r){const{animation:l,channel:d}=s;l.setTime(this.getTime(d))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=wN++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,s=e.duration*e.repeat;r>=s?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const RC="#define SMOOTH_EDGE_RADIUS 0.5",EN=`
`.concat(RC,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),TN=`
`.concat(RC,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),SN={name:"geometry",vs:EN,fs:TN},Fn={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Fn,"IDENTITY",{get:()=>(Bn.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const No={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Xv={common:0,meters:1,pixels:2},j2={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},Hf={DRAW:"draw",MASK:"mask"},AN=Object.keys(Fn).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Fn[t],";")).join(""),PN=Object.keys(No).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(No[t],";")).join(""),CN=Object.keys(Xv).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Xv[t],";")).join(""),IN="".concat(AN,`
`).concat(PN,`
`).concat(CN,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0; // meters
const float GLOBE_RADIUS = 256.0;

// returns an adjustment factor for uCommonUnitsPerMeter
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {

    // uCommonUnitsPerMeter in low-zoom Web Mercator is non-linear
    // Adjust by 1 / cos(latitude)
    // If geometry.position (vertex in common space) is populated, use it
    // Otherwise use geometry.worldPosition (anchor in world space)
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }

    // latitude from common y: 2.0 * (atan(exp(y / TILE_SIZE * 2.0 * PI - PI)) - PI / 4.0)
    // Taylor series of 1 / cos(latitude)
    // Max error < 0.003
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}

//
// Scaling offsets - scales meters to "world distance"
// Note the scalar version of project_size is for scaling the z component only
//
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}

// Get rotation matrix that aligns the z axis with the given up vector
// Find 3 unit vectors ux, uy, uz that are perpendicular to each other and uz == up
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  // Tangent on XY plane
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}

//
// Projecting normal - transform deltas from current coordinate system to
// normals in the worldspace
//
vec3 project_normal(vec3 vector) {
  // Apply model matrix
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

//
// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]
//
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

//
// Projects positions (defined by project_uCoordinateSystem) to common space (defined by project_uProjectionMode)
//
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;

  // Work around for a Mac+NVIDIA bug https://github.com/visgl/deck.gl/issues/4145
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        // Too far from the projection center for offset mode to be accurate
        // Only use high parts
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.
    position_world.xyz -= project_uCoordinateOrigin;
  }

  // Translation is already added to the high parts
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}

//
// Projects from common space coordinates to clip space.
// Uses project_uViewProjectionMatrix
//
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}

// Returns a clip space offset that corresponds to a given number of screen pixels
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  // UNIT_PIXELS
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function kN(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function py(t){let e={},n;return r=>{for(const s in r)if(!kN(r[s],e[s])){n=t(r),e=r;break}return n}}const G2=[0,0,0,0],MN=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],OC=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],LN=[0,0,0],DC=[0,0,0],RN=py(zN);function zC(t,e,n=DC){n.length<3&&(n=[n[0],n[1],0]);let r=n,s,l=!0;switch(e===Fn.LNGLAT_OFFSETS||e===Fn.METER_OFFSETS?s=n:s=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case No.WEB_MERCATOR:(e===Fn.LNGLAT||e===Fn.CARTESIAN)&&(s=[0,0,0],l=!1);break;case No.WEB_MERCATOR_AUTO_OFFSET:e===Fn.LNGLAT?r=s:e===Fn.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],s=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case No.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case No.GLOBE:l=!1,s=null;break;default:l=!1}return{geospatialOrigin:s,shaderCoordinateOrigin:r,offsetMode:l}}function ON(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:s}=t;let{viewMatrix:l,viewProjectionMatrix:d}=t,c=G2,v=G2,w=t.cameraPosition;const{geospatialOrigin:C,shaderCoordinateOrigin:I,offsetMode:S}=zC(t,e,n);return S&&(v=t.projectPosition(C||I),w=[w[0]-v[0],w[1]-v[1],w[2]-v[2]],v[3]=1,c=$f([],v,d),l=r||l,d=_c([],s,l),d=_c([],d,MN)),{viewMatrix:l,viewProjectionMatrix:d,projectionCenter:c,originCommon:v,cameraPosCommon:w,shaderCoordinateOrigin:I,geospatialOrigin:C}}function DN({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=Fn.DEFAULT,coordinateOrigin:s=DC,autoWrapLongitude:l=!1}){r===Fn.DEFAULT&&(r=t.isGeospatial?Fn.LNGLAT:Fn.CARTESIAN);const d=RN({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:s});return d.project_uWrapLongitude=l,d.project_uModelMatrix=n||OC,d}function zN({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:s,viewProjectionMatrix:l,originCommon:d,cameraPosCommon:c,shaderCoordinateOrigin:v,geospatialOrigin:w}=ON(t,n,r),C=t.getDistanceScales(),I=[t.width*e,t.height*e],S=$f([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,z={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:v,project_uCommonOrigin:d.slice(0,3),project_uCenter:s,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:I,project_uDevicePixelRatio:e,project_uFocalDistance:S,project_uCommonUnitsPerMeter:C.unitsPerMeter,project_uCommonUnitsPerWorldUnit:C.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:LN,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:l,project_uModelMatrix:OC,project_uCameraPosition:c};if(w){const F=t.getDistanceScales(w);switch(n){case Fn.METER_OFFSETS:z.project_uCommonUnitsPerWorldUnit=F.unitsPerMeter,z.project_uCommonUnitsPerWorldUnit2=F.unitsPerMeter2;break;case Fn.LNGLAT:case Fn.LNGLAT_OFFSETS:t._pseudoMeters||(z.project_uCommonUnitsPerMeter=F.unitsPerMeter),z.project_uCommonUnitsPerWorldUnit=F.unitsPerDegree,z.project_uCommonUnitsPerWorldUnit2=F.unitsPerDegree2;break;case Fn.CARTESIAN:z.project_uCommonUnitsPerWorldUnit=[1,1,F.unitsPerMeter[2]],z.project_uCommonUnitsPerWorldUnit2=[0,0,F.unitsPerMeter2[2]];break}}return z}const FN={};function BN(t=FN){return"viewport"in t?DN(t):{}}const C1={name:"project",dependencies:[tB,SN],vs:IN,getUniforms:BN},NN=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,UN={name:"project32",dependencies:[C1],vs:NN};function VN(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function $u(t,e){const n=$f([],e,t);return NB(n,n,1/n[3]),n}function $2(t,e){const n=t%e;return n<0?e+n:n}function Zv(t,e,n){return t<e?e:t>n?n:t}function jN(t){return Math.log(t)*Math.LOG2E}const I1=Math.log2||jN;function ba(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const co=Math.PI,FC=co/4,fo=co/180,Yv=180/co,Tf=512,Kv=4003e4,Im=85.051129,GN=1.5;function $N(t){return I1(t)}function Ng(t){const[e,n]=t;ba(Number.isFinite(e)),ba(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*fo,s=n*fo,l=Tf*(r+co)/(2*co),d=Tf*(co+Math.log(Math.tan(FC+s*.5)))/(2*co);return[l,d]}function ah(t){const[e,n]=t,r=e/Tf*(2*co)-co,s=2*(Math.atan(Math.exp(n/Tf*(2*co)-co))-FC);return[r*Yv,s*Yv]}function WN(t){const{latitude:e}=t;ba(Number.isFinite(e));const n=Math.cos(e*fo);return $N(Kv*n)-9}function Jv(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;ba(Number.isFinite(e)&&Number.isFinite(n));const s=Tf,l=Math.cos(e*fo),d=s/360,c=d/l,v=s/Kv/l,w={unitsPerMeter:[v,v,v],metersPerUnit:[1/v,1/v,1/v],unitsPerDegree:[d,c,v],degreesPerUnit:[1/d,1/c,1/v]};if(r){const C=fo*Math.tan(e*fo)/l,I=d*C/2,S=s/Kv*C,z=S/c*v;w.unitsPerDegree2=[0,I,S],w.unitsPerMeter2=[z,0,z]}return w}function BC(t,e){const[n,r,s]=t,[l,d,c]=e,{unitsPerMeter:v,unitsPerMeter2:w}=Jv({longitude:n,latitude:r,highPrecision:!0}),C=Ng(t);C[0]+=l*(v[0]+w[0]*d),C[1]+=d*(v[1]+w[1]*d);const I=ah(C),S=(s||0)+(c||0);return Number.isFinite(s)||Number.isFinite(c)?[I[0],I[1],S]:I}function HN(t){const{height:e,pitch:n,bearing:r,altitude:s,scale:l,center:d}=t,c=VN();Fg(c,c,[0,0,-s]),IC(c,c,-n*fo),kC(c,c,r*fo);const v=l/e;return A1(c,c,[v,v,v]),d&&Fg(c,c,mB([],d)),c}function qN(t){const{width:e,height:n,altitude:r,pitch:s=0,offset:l,center:d,scale:c,nearZMultiplier:v=1,farZMultiplier:w=1}=t;let{fovy:C=Ug(GN)}=t;r!==void 0&&(C=Ug(r));const I=C*fo,S=s*fo,z=NC(C);let F=z;d&&(F+=d[2]*c/Math.cos(S)/n);const B=I*(.5+(l?l[1]:0)/n),Q=Math.sin(B)*F/Math.sin(Zv(Math.PI/2-S-B,.01,Math.PI-.01)),q=Math.sin(S)*Q+F,j=F*10,G=Math.min(q*w,j);return{fov:I,aspect:e/n,focalDistance:z,near:v,far:G}}function Ug(t){return 2*Math.atan(.5/t)*Yv}function NC(t){return .5/Math.tan(.5*t*fo)}function UC(t,e){const[n,r,s=0]=t;return ba(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(s)),$u(e,[n,r,s,1])}function my(t,e,n=0){const[r,s,l]=t;if(ba(Number.isFinite(r)&&Number.isFinite(s),"invalid pixel coordinate"),Number.isFinite(l))return $u(e,[r,s,l,1]);const d=$u(e,[r,s,0,1]),c=$u(e,[r,s,1,1]),v=d[2],w=c[2],C=v===w?0:((n||0)-v)/(w-v);return AC([],d,c,C)}function VC(t){const{width:e,height:n,bounds:r,minExtent:s=0,maxZoom:l=24,offset:d=[0,0]}=t,[[c,v],[w,C]]=r,I=XN(t.padding),S=Ng([c,Zv(C,-Im,Im)]),z=Ng([w,Zv(v,-Im,Im)]),F=[Math.max(Math.abs(z[0]-S[0]),s),Math.max(Math.abs(z[1]-S[1]),s)],B=[e-I.left-I.right-Math.abs(d[0])*2,n-I.top-I.bottom-Math.abs(d[1])*2];ba(B[0]>0&&B[1]>0);const Q=B[0]/F[0],q=B[1]/F[1],j=(I.right-I.left)/2/Q,G=(I.top-I.bottom)/2/q,se=[(z[0]+S[0])/2+j,(z[1]+S[1])/2+G],he=ah(se),ye=Math.min(l,I1(Math.abs(Math.min(Q,q))));return ba(Number.isFinite(ye)),{longitude:he[0],latitude:he[1],zoom:ye}}function XN(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(ba(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const W2=Math.PI/180;function ZN(t,e=0){const{width:n,height:r,unproject:s}=t,l={targetZ:e},d=s([0,r],l),c=s([n,r],l);let v,w;const C=t.fovy?.5*t.fovy*W2:Math.atan(.5/t.altitude),I=(90-t.pitch)*W2;return C>I-.01?(v=H2(t,0,e),w=H2(t,n,e)):(v=s([0,0],l),w=s([n,0],l)),[d,c,w,v]}function H2(t,e,n){const{pixelUnprojectionMatrix:r}=t,s=$u(r,[e,0,1,1]),l=$u(r,[e,t.height,1,1]),c=(n*t.distanceScales.unitsPerMeter[2]-s[2])/(l[2]-s[2]),v=AC([],s,l,c),w=ah(v);return w.push(n),w}const q2=512;function YN(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:s,latitude:l,zoom:d,bearing:c=0}=t;(s<-180||s>180)&&(s=$2(s+180,360)-180),(c<-180||c>180)&&(c=$2(c+180,360)-180);const v=I1(n/q2);if(d<=v)d=v,l=0;else{const w=n/2/Math.pow(2,d),C=ah([0,w])[1];if(l<C)l=C;else{const I=ah([0,q2-w])[1];l>I&&(l=I)}}return{width:e,height:n,longitude:s,latitude:l,zoom:d,pitch:r,bearing:c}}const KN=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,JN=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,QN=py(i6),e6=py(s6),t6=[0,0,0,1],n6=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function r6(t,e){const[n,r,s]=t,l=my([n,r,s],e);return Number.isFinite(s)?l:[l[0],l[1],0]}function i6({viewport:t,center:e}){return new qs(t.viewProjectionMatrix).invert().transform(e)}function s6({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,s=t.isGeospatial?void 0:1,l=[[0,0,s],[t.width,0,s],[0,t.height,s],[t.width,t.height,s],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(d=>r6(d,r));for(const d of e){const c=d.clone().translate(new Go(t.center).negate()),v=l.map(C=>c.transform(C)),w=new qs().ortho({left:Math.min(...v.map(C=>C[0])),right:Math.max(...v.map(C=>C[0])),bottom:Math.min(...v.map(C=>C[1])),top:Math.max(...v.map(C=>C[1])),near:Math.min(...v.map(C=>-C[2])),far:Math.max(...v.map(C=>-C[2]))});n.push(w.multiplyRight(d))}return n}function o6(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||t6,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},s=QN({viewport:t.viewport,center:e.project_uCenter}),l=[],d=e6({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let c=0;c<t.shadowMatrices.length;c++){const v=d[c],w=v.clone().translate(new Go(t.viewport.center).negate());e.project_uCoordinateSystem===Fn.LNGLAT&&e.project_uProjectionMode===No.WEB_MERCATOR?(d[c]=w,l[c]=s):(d[c]=v.clone().multiplyRight(n6),l[c]=w.transform(s))}for(let c=0;c<d.length;c++)r["shadow_uViewProjectionMatrices[".concat(c,"]")]=d[c],r["shadow_uProjectCenters[".concat(c,"]")]=l[c],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(c)]=t.shadowMaps[c]:r["shadow_uShadowMap".concat(c)]=t.dummyShadowMap;return r}const A0={name:"shadow",dependencies:[C1],vs:KN,fs:JN,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?o6(t,e):{}},a6={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...KB},l6=[C1],c6=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function u6(t){const e=Wf.getDefaultProgramManager(t);for(const n of l6)e.addDefaultModule(n);for(const n of c6)e.addShaderHook(n);return e}const h6=[255,255,255],d6=1;let f6=0;class p6{constructor(e={}){W(this,"id",void 0),W(this,"color",void 0),W(this,"intensity",void 0),W(this,"type","ambient");const{color:n=h6}=e,{intensity:r=d6}=e;this.id=e.id||"ambient-".concat(f6++),this.color=n,this.intensity=r}}const m6=[255,255,255],g6=1,y6=[0,0,-1];let _6=0;class X2{constructor(e={}){W(this,"id",void 0),W(this,"color",void 0),W(this,"intensity",void 0),W(this,"type","directional"),W(this,"direction",void 0),W(this,"shadow",void 0);const{color:n=m6}=e,{intensity:r=g6}=e,{direction:s=y6}=e,{_shadow:l=!1}=e;this.id=e.id||"directional-".concat(_6++),this.color=n,this.intensity=r,this.type="directional",this.direction=new Go(s).normalize().toArray(),this.shadow=l}getProjectedLight(e){return this}}class v6{constructor(e,n={id:"pass"}){W(this,"id",void 0),W(this,"gl",void 0),W(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class gy extends v6{constructor(...e){super(...e),W(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return xa(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:s,views:l,onViewportActive:d,clearStack:c=!0,clearCanvas:v=!0}=e;e.pass=e.pass||"unknown";const w=this.gl;v&&b6(w),c&&(this._lastRenderIndex=-1);const C=[];for(const I of s){const S=l&&l[I.id];d(I);const z=this._getDrawLayerParams(I,e),F=I.subViewports||[I];for(const B of F){const Q=this._drawLayersInViewport(w,{target:n,moduleParameters:r,viewport:B,view:S,pass:e.pass,layers:e.layers},z);C.push(Q)}}return C}_getDrawLayerParams(e,{layers:n,pass:r,layerFilter:s,cullRect:l,effects:d,moduleParameters:c}){const v=[],w=jC(this._lastRenderIndex+1),C={layer:n[0],viewport:e,isPicking:r.startsWith("picking"),renderPass:r,cullRect:l},I={};for(let S=0;S<n.length;S++){const z=n[S],F=this._shouldDrawLayer(z,C,s,I),B={shouldDrawLayer:F};F&&(B.layerRenderIndex=w(z,F),B.moduleParameters=this._getModuleParameters(z,d,r,c),B.layerParameters=this.getLayerParameters(z,S,e)),v[S]=B}return v}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:s,target:l,viewport:d,view:c},v){const w=x6(e,{moduleParameters:r,target:l,viewport:d});if(c&&c.props.clear){const I=c.props.clear===!0?{color:!0,depth:!0}:c.props.clear;$s(e,{scissorTest:!0,scissor:w},()=>w1(e,I))}const C={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};xa(e,{viewport:w});for(let I=0;I<n.length;I++){const S=n[I],{shouldDrawLayer:z,layerRenderIndex:F,moduleParameters:B,layerParameters:Q}=v[I];if(z&&S.props.pickable&&C.pickableCount++,S.isComposite)C.compositeCount++;else if(z){C.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,F),B.viewport=d;try{S._drawLayer({moduleParameters:B,uniforms:{layerIndex:F},parameters:Q})}catch(q){S.raiseError(q,"drawing ".concat(S," to ").concat(s))}}}return C}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,s){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let d=e.parent;for(;d;){if(!d.props.visible||!d.filterSubLayer(n))return!1;n.layer=d,d=d.parent}if(r){const c=n.layer.id;if(c in s||(s[c]=r(n)),!s[c])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,s){var l;const d=Object.assign(Object.create(((l=e.internalState)===null||l===void 0?void 0:l.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:th(this.gl)});if(n)for(const v of n){var c;Object.assign(d,(c=v.getModuleParameters)===null||c===void 0?void 0:c.call(v,e))}return Object.assign(d,this.getModuleParameters(e,n),s)}}function jC(t=0,e={}){const n={},r=(s,l)=>{const d=s.props._offset,c=s.id,v=s.parent&&s.parent.id;let w;if(v&&!(v in e)&&r(s.parent,!1),v in n){const C=n[v]=n[v]||jC(e[v],e);w=C(s,l),n[c]=C}else Number.isFinite(d)?(w=d+(e[v]||0),n[c]=null):w=t;return l&&w>=t&&(t=w+1),e[c]=w,w};return r}function x6(t,{moduleParameters:e,target:n,viewport:r}){const s=n&&n.id!=="default-framebuffer",l=e&&e.devicePixelRatio||th(t),d=s?n.height:t.drawingBufferHeight,c=r;return[c.x*l,d-(c.y+c.height)*l,c.width*l,c.height*l]}function b6(t){const e=t.drawingBufferWidth,n=t.drawingBufferHeight;xa(t,{viewport:[0,0,e,n]}),t.clear(16640)}class w6 extends gy{constructor(e,n){super(e,n),W(this,"shadowMap",void 0),W(this,"depthBuffer",void 0),W(this,"fbo",void 0),this.shadowMap=new Gi(e,{width:1,height:1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.depthBuffer=new Ou(e,{format:33189,width:1,height:1}),this.fbo=new Ur(e,{id:"shadowmap",width:1,height:1,attachments:{[36064]:this.shadowMap,[36096]:this.depthBuffer}})}render(e){const n=this.fbo;$s(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],s=th(this.gl),l=r.width*s,d=r.height*s;(l!==n.width||d!==n.height)&&n.resize({width:l,height:d}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const E6={color:[255,255,255],intensity:1},Z2=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],T6=[0,0,0,200/255];class GC{constructor(e={}){W(this,"id","lighting-effect"),W(this,"props",null),W(this,"shadowColor",T6),W(this,"shadow",void 0),W(this,"ambientLight",null),W(this,"directionalLights",[]),W(this,"pointLights",[]),W(this,"shadowPasses",[]),W(this,"shadowMaps",[]),W(this,"dummyShadowMap",null),W(this,"programManager",void 0),W(this,"shadowMatrices",void 0);for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow)}preRender(e,{layers:n,layerFilter:r,viewports:s,onViewportActive:l,views:d}){if(!!this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Wf.getDefaultProgramManager(e),A0&&this.programManager.addDefaultModule(A0)),this.dummyShadowMap||(this.dummyShadowMap=new Gi(e,{width:1,height:1}));for(let c=0;c<this.shadowPasses.length;c++)this.shadowPasses[c].render({layers:n,layerFilter:r,viewports:s,onViewportActive:l,views:d,moduleParameters:{shadowLightId:c,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(A0),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new qs().lookAt({eye:new Go(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new w6(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new p6(E6),this.directionalLights.push(new X2(Z2[0]),new X2(Z2[1])))}}class S6{constructor(e={}){W(this,"_pool",[]),W(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:s,padding:l=0,copy:d=!1,initialize:c=!1,maxCount:v}){const w=s||e&&e.constructor||Float32Array,C=n*r+l;if(ArrayBuffer.isView(e)){if(C<=e.length)return e;if(C*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new w(e.buffer,0,C)}let I=1/0;v&&(I=v*r+l);const S=this._allocate(w,C,c,I);return e&&d?S.set(e):c||S.fill(0,0,4),this._release(e),S}release(e){this._release(e)}_allocate(e,n,r,s){let l=Math.max(Math.ceil(n*this.opts.overAlloc),1);l>s&&(l=s);const d=this._pool,c=e.BYTES_PER_ELEMENT*l,v=d.findIndex(w=>w.byteLength>=c);if(v>=0){const w=new e(d.splice(v,1)[0],0,l);return r&&w.fill(0),w}return new e(l)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:s}=r,l=n.findIndex(d=>d.byteLength>=s);l<0?n.push(r):(l>0||n.length<this.opts.poolSize)&&n.splice(l,0,r),n.length>this.opts.poolSize&&n.shift()}}const Sf=new S6;function zd(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function A6(t,e){const n=t%e;return n<0?e+n:n}function P6(t){return[t[12],t[13],t[14]]}function C6(t){return{left:du(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:du(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:du(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:du(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:du(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:du(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const Y2=new Go;function du(t,e,n,r){Y2.set(t,e,n);const s=Y2.len();return{distance:r/s,normal:new Go(-t/s,-e/s,-n/s)}}function I6(t){return t-Math.fround(t)}let Sd;function P0(t,e){const{size:n=1,startIndex:r=0}=e,s=e.endIndex!==void 0?e.endIndex:t.length,l=(s-r)/n;Sd=Sf.allocate(Sd,l,{type:Float32Array,size:n*2});let d=r,c=0;for(;d<s;){for(let v=0;v<n;v++){const w=t[d++];Sd[c+v]=w,Sd[c+v+n]=I6(w)}c+=n*2}return Sd.subarray(0,l*n*2)}const k6=Math.PI/180,M6=zd(),K2=[0,0,0],L6={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function R6({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:s,padding:l,near:d,far:c}){const v=t/e,w=n?new qs().orthographic({fovy:r,aspect:v,focalDistance:s,near:d,far:c}):new qs().perspective({fovy:r,aspect:v,near:d,far:c});if(l){const{left:C=0,right:I=0,top:S=0,bottom:z=0}=l,F=hi((C+t-I)/2,0,t)-t/2,B=hi((S+e-z)/2,0,e)-e/2;w[8]-=F*2/t,w[9]+=B*2/e}return w}class Mc{constructor(e={}){W(this,"id",void 0),W(this,"x",void 0),W(this,"y",void 0),W(this,"width",void 0),W(this,"height",void 0),W(this,"padding",void 0),W(this,"isGeospatial",void 0),W(this,"zoom",void 0),W(this,"focalDistance",void 0),W(this,"position",void 0),W(this,"modelMatrix",void 0),W(this,"distanceScales",void 0),W(this,"scale",void 0),W(this,"center",void 0),W(this,"cameraPosition",void 0),W(this,"projectionMatrix",void 0),W(this,"viewMatrix",void 0),W(this,"viewMatrixUncentered",void 0),W(this,"viewMatrixInverse",void 0),W(this,"viewProjectionMatrix",void 0),W(this,"pixelProjectionMatrix",void 0),W(this,"pixelUnprojectionMatrix",void 0),W(this,"resolution",void 0),W(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||L6,this.focalDistance=e.focalDistance||1,this.position=e.position||K2,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?No.WEB_MERCATOR:No.WEB_MERCATOR_AUTO_OFFSET:No.IDENTITY}equals(e){return e instanceof Mc?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&sh(e.projectionMatrix,this.projectionMatrix)&&sh(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),s=UC(r,this.pixelProjectionMatrix),[l,d]=s,c=n?d:this.height-d;return e.length===2?[l,c]:[l,c,s[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[s,l,d]=e,c=n?l:this.height-l,v=r&&r*this.distanceScales.unitsPerMeter[2],w=my([s,c,d],this.pixelUnprojectionMatrix,v),[C,I,S]=this.unprojectPosition(w);return Number.isFinite(d)?[C,I,S]:Number.isFinite(r)?[C,I,r]:[C,I]}projectPosition(e){const[n,r]=this.projectFlat(e),s=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,s]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),s=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,s]}projectFlat(e){if(this.isGeospatial){const n=Ng(e);return n[1]=hi(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?ah(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),s=this.unproject([this.width,0],n),l=this.unproject([0,this.height],n),d=this.unproject([this.width,this.height],n);return[Math.min(r[0],s[0],l[0],d[0]),Math.min(r[1],s[1],l[1],d[1]),Math.max(r[0],s[0],l[0],d[0]),Math.max(r[1],s[1],l[1],d[1])]}getDistanceScales(e){return e?Jv({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:s=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+s}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,C6(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=WN({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||Jv({latitude:r,longitude:n}));const s=Math.pow(2,this.zoom);this.scale=s;const{position:l,modelMatrix:d}=e;let c=K2;if(l&&(c=d?new qs(d).transformAsVector(l,[]):l),this.isGeospatial){const v=this.projectPosition([n,r,0]);this.center=new Go(c).scale(this.distanceScales.unitsPerMeter).add(v)}else this.center=this.projectPosition(c)}_initMatrices(e){const{viewMatrix:n=M6,projectionMatrix:r=null,orthographic:s=!1,fovyRadians:l,fovy:d=75,near:c=.1,far:v=1e3,padding:w=null,focalDistance:C=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new qs().multiplyRight(n).translate(new Go(this.center).negate()),this.projectionMatrix=r||R6({width:this.width,height:this.height,orthographic:s,fovyRadians:l||d*k6,focalDistance:C,padding:w,near:c,far:v});const I=zd();_c(I,I,this.projectionMatrix),_c(I,I,this.viewMatrix),this.viewProjectionMatrix=I,this.viewMatrixInverse=Hv([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=P6(this.viewMatrixInverse);const S=zd(),z=zd();A1(S,S,[this.width/2,-this.height/2,1]),Fg(S,S,[1,-1,0]),_c(z,S,this.viewProjectionMatrix),this.pixelProjectionMatrix=z,this.pixelUnprojectionMatrix=Hv(zd(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Bn.warn("Pixel project matrix not invertible")()}}W(Mc,"displayName","Viewport");const O6=512,D6=4003e4,z6=Math.PI/180;function J2(t){const e=Math.cos(t*z6);return O6/D6/e}class xl extends Mc{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:s=0,pitch:l=0,bearing:d=0,nearZMultiplier:c=.1,farZMultiplier:v=1.01,orthographic:w=!1,projectionMatrix:C,repeat:I=!1,worldOffset:S=0,legacyMeterSizes:z=!1}=e;let{width:F,height:B,altitude:Q=1.5}=e;const q=Math.pow(2,s);F=F||1,B=B||1;let j,G=null;C?(Q=C[5]/2,j=Ug(Q)):(e.fovy?(j=e.fovy,Q=NC(j)):j=Ug(Q),G=qN({width:F,height:B,pitch:l,fovy:j,nearZMultiplier:c,farZMultiplier:v}));let se=HN({height:B,pitch:l,bearing:d,scale:q,altitude:Q});S&&(se=new qs().translate([512*S,0,0]).multiplyLeft(se)),super({...e,width:F,height:B,viewMatrix:se,longitude:r,latitude:n,zoom:s,...G,fovy:j,focalDistance:Q}),W(this,"longitude",void 0),W(this,"latitude",void 0),W(this,"pitch",void 0),W(this,"bearing",void 0),W(this,"altitude",void 0),W(this,"fovy",void 0),W(this,"orthographic",void 0),W(this,"_subViewports",void 0),W(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=s,this.pitch=l,this.bearing=d,this.altitude=Q,this.fovy=j,this.orthographic=w,this._subViewports=I?[]:null,this._pseudoMeters=z,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let s=n;s<=r;s++){const l=s?new xl({...this,worldOffset:s}):this;this._subViewports.push(l)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),s=(e[2]||0)*J2(e[1]);return[n,r,s]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),s=(e[2]||0)/J2(r);return[n,r,s]}addMetersToLngLat(e,n){return BC(e,n)}panByPosition(e,n){const r=my(n,this.pixelUnprojectionMatrix),s=this.projectFlat(e),l=zg([],s,SC([],r)),d=zg([],this.center,l),[c,v]=this.unprojectFlat(d);return{longitude:c,latitude:v}}getBounds(e={}){const n=ZN(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:s}=this,{longitude:l,latitude:d,zoom:c}=VC({width:r,height:s,bounds:e,...n});return new xl({width:r,height:s,longitude:l,latitude:d,zoom:c})}}W(xl,"displayName","WebMercatorViewport");function C0(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof xl){const[s,l,d=0]=t,c=e.getDistanceScales([s,l]);r[2]=d*c.unitsPerMeter[2]}return r}function F6(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:s,fromCoordinateSystem:l,fromCoordinateOrigin:d}=t;return s===Fn.DEFAULT&&(s=e.isGeospatial?Fn.LNGLAT:Fn.CARTESIAN),l===void 0&&(l=s),d===void 0&&(d=r),{viewport:e,coordinateSystem:s,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:l,fromCoordinateOrigin:d}}function $C(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:s,offsetMode:l}){let[d,c,v=0]=t;switch(n&&([d,c,v]=$f([],[d,c,v,1],n)),r){case Fn.LNGLAT:return C0([d,c,v],e,l);case Fn.LNGLAT_OFFSETS:return C0([d+s[0],c+s[1],v+(s[2]||0)],e,l);case Fn.METER_OFFSETS:return C0(BC(s,[d,c,v]),e,l);case Fn.CARTESIAN:default:return e.isGeospatial?[d+s[0],c+s[1],v+s[2]]:e.projectPosition([d,c,v])}}function B6(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:s,modelMatrix:l,fromCoordinateSystem:d,fromCoordinateOrigin:c}=F6(e),{geospatialOrigin:v,shaderCoordinateOrigin:w,offsetMode:C}=zC(n,r,s),I=$C(t,{viewport:n,modelMatrix:l,coordinateSystem:d,coordinateOrigin:c,offsetMode:C});if(C){const S=n.projectPosition(v||w);TB(I,I,S)}return I}const xu={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Vg=Symbol.for("component"),Wu=Symbol.for("asyncPropDefaults"),Sc=Symbol.for("asyncPropOriginal"),ol=Symbol.for("asyncPropResolved");function WC(t,e=()=>!0){return Array.isArray(t)?HC(t,e,[]):e(t)?[t]:[]}function HC(t,e,n){let r=-1;for(;++r<t.length;){const s=t[r];Array.isArray(s)?HC(s,e,n):e(s)&&n.push(s)}return n}function N6({target:t,source:e,start:n=0,count:r=1}){const s=e.length,l=r*s;let d=0;for(let c=n;d<s;d++)t[c++]=e[d];for(;d<l;)d<l-d?(t.copyWithin(n+d,n,n+d),d*=2):(t.copyWithin(n+d,n,n+l-d),d=l);return t}class U6{constructor(e,n,r){W(this,"id",void 0),W(this,"context",void 0),W(this,"isLoaded",void 0),W(this,"persistent",void 0),W(this,"_loadCount",0),W(this,"_subscribers",new Set),W(this,"_data",void 0),W(this,"_loader",void 0),W(this,"_error",void 0),W(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let s=e;typeof e=="string"&&(s=Lg(e)),s instanceof Promise?(this.isLoaded=!1,this._loader=s.then(l=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=l)}).catch(l=>{this._loadCount===r&&(this.isLoaded=!0,this._error=l||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const l of this._subscribers)l.onChange(this.getData())}}class V6{constructor({gl:e,protocol:n}){W(this,"protocol",void 0),W(this,"_context",void 0),W(this,"_resources",void 0),W(this,"_consumers",void 0),W(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:s=!0}){let l=this._resources[e];l?l.setData(n,r):(l=new U6(e,n,this._context),this._resources[e]=l),l.persistent=s}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const s=n[r],l=this._resources[s.resourceId];l&&l.unsubscribe(s)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:s="default"}){const{_resources:l,protocol:d}=this;e.startsWith(d)&&(e=e.replace(d,""),l[e]||this.add({resourceId:e,data:null,persistent:!1}));const c=l[e];if(this._track(r,s,c,n),c)return c.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,s){const l=this._consumers,d=l[e]=l[e]||{},c=d[n]||{},v=c.resourceId&&this._resources[c.resourceId];v&&(v.unsubscribe(c),this.prune()),r&&(d[n]=c,c.onChange=s,c.resourceId=r.id,r.subscribe(c))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const j6="layerManager.setLayers",G6="layerManager.activateViewport";class $6{constructor(e,{deck:n,stats:r,viewport:s,timeline:l}={}){W(this,"layers",void 0),W(this,"context",void 0),W(this,"resourceManager",void 0),W(this,"_lastRenderedLayers",[]),W(this,"_needsRedraw",!1),W(this,"_needsUpdate",!1),W(this,"_nextLayers",null),W(this,"_debug",!1),W(this,"activateViewport",d=>{Ui(G6,this,d),d&&(this.context.viewport=d)}),this.layers=[],this.resourceManager=new V6({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&u6(e),stats:r||new f1({id:"deck.gl"}),viewport:s||new Mc({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:l||new LC,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const s=r.getNeedsRedraw(e);n=n||s}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){Ui(j6,this,n,e),this._lastRenderedLayers=e;const r=WC(e,Boolean);for(const s of r)s.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const d of e)r[d.id]?Bn.warn("Multiple old layers with same id ".concat(d.id))():r[d.id]=d;const s=[];this._updateSublayersRecursively(n,r,s),this._finalizeOldLayers(r);let l=!1;for(const d of s)if(d.hasUniformTransition()){l="Uniform transition in ".concat(d);break}this._needsUpdate=l,this.layers=s}_updateSublayersRecursively(e,n,r){for(const s of e){s.context=this.context;const l=n[s.id];l===null&&Bn.warn("Multiple new layers with same id ".concat(s.id))(),n[s.id]=null;let d=null;try{this._debug&&l!==s&&s.validateProps(),l?(this._transferLayerState(l,s),this._updateLayer(s)):this._initializeLayer(s),r.push(s),d=s.isComposite?s.getSubLayers():null}catch(c){this._handleError("matching",c,s)}d&&this._updateSublayersRecursively(d,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=xu.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=xu.MATCHED,n!==e&&(e.lifecycle=xu.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=xu.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=xu.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function yh(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const n in t){const r=t[n],s=e[n];if(!(r===s||Array.isArray(r)&&Array.isArray(s)&&yh(r,s)))return!1}return!0}class W6{constructor(e){W(this,"width",void 0),W(this,"height",void 0),W(this,"views",void 0),W(this,"viewState",void 0),W(this,"controllers",void 0),W(this,"timeline",void 0),W(this,"_viewports",void 0),W(this,"_viewportMap",void 0),W(this,"_isUpdating",void 0),W(this,"_needsRedraw",void 0),W(this,"_needsUpdate",void 0),W(this,"_eventManager",void 0),W(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),s={x:e[0],y:e[1]};for(let l=r.length-1;l>=0;--l){const d=r[l];if(d.containsPixel(s)){const c=e.slice();return c[0]-=d.x,c[1]-=d.y,d.unproject(c,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=WC(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!yh(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Bn.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:l=>{var d;return(d=this.getView(e.id))===null||d===void 0?void 0:d.makeViewport({viewState:l,width:this.width,height:this.height})}})}_updateController(e,n,r,s){const l=e.controller;if(l){const d={...n,...l,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return s||(s=this._createController(e,d)),s&&s.setProps(d),s}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let s=e.length;s--;){const l=e[s],d=this.getViewState(l),c=l.makeViewport({viewState:d,width:this.width,height:this.height});let v=n[l.id];const w=Boolean(l.controller);w&&!v&&(r=!0),(r||!w)&&v&&(v.finalize(),v=null),this.controllers[l.id]=this._updateController(l,d,c,v),this._viewports.unshift(c)}for(const s in n){const l=n[s];l&&!this.controllers[s]&&l.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,s)=>!e[s].equals(n[s]))}}const H6=/([0-9]+\.?[0-9]*)(%|px)/;function Ya(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=H6.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Ka(t,e){return t.relative?Math.round(t.position*e):t.position}function ui(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class Ac{constructor(e){W(this,"id",void 0),W(this,"viewportInstance",void 0),W(this,"_x",void 0),W(this,"_y",void 0),W(this,"_width",void 0),W(this,"_height",void 0),W(this,"_padding",void 0),W(this,"props",void 0);const{id:n,x:r=0,y:s=0,width:l="100%",height:d="100%",padding:c=null,viewportInstance:v}=e||{};ui(!v||v instanceof Mc),this.viewportInstance=v,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Ya(r),this._y=Ya(s),this._width=Ya(l),this._height=Ya(d),this._padding=c&&{left:Ya(c.left||0),right:Ya(c.right||0),top:Ya(c.top||0),bottom:Ya(c.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&yh(this.props,e.props)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const s=this.getDimensions({width:e,height:n});return new this.ViewportType({...r,...this.props,...s})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Ka(this._x,e),y:Ka(this._y,n),width:Ka(this._width,e),height:Ka(this._height,n)};return this._padding&&(r.padding={left:Ka(this._padding.left,e),top:Ka(this._padding.top,n),right:Ka(this._padding.right,e),bottom:Ka(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class qf{constructor(e){W(this,"_inProgress",void 0),W(this,"_handle",void 0),W(this,"_timeline",void 0),W(this,"time",void 0),W(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:s}=this;this._handle=r.addChannel({delay:r.getTime(),duration:s.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Q2=()=>{},Qv={BREAK:1,SNAP_TO_END:2,IGNORE:3},q6=t=>t,X6=Qv.BREAK;class Z6{constructor(e){W(this,"getControllerState",void 0),W(this,"props",void 0),W(this,"propsInTransition",void 0),W(this,"transition",void 0),W(this,"onViewStateChange",void 0),W(this,"onStateChange",void 0),W(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:s,startProps:l,endProps:d,duration:c,easing:v}}=n,w=v(r/c),C=s.interpolateProps(l,d,w);this.propsInTransition=this.getControllerState({...this.props,...C}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new qf(e.timeline),this.onViewStateChange=e.onViewStateChange||Q2,this.onStateChange=e.onStateChange||Q2}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let s=r;if(this.transition.inProgress){const{interruption:l,endProps:d}=this.transition.settings;s={...r,...l===Qv.SNAP_TO_END?d:this.propsInTransition||r}}this._triggerTransition(s,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&Boolean(r)}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===Qv.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),s=this.getControllerState(n).shortestPathFrom(r),l=n.transitionInterpolator,d=l.getDuration?l.getDuration(e,n):n.transitionDuration;if(d===0)return;const c=l.initializeProps(e,s);this.propsInTransition={};const v={duration:d,easing:n.transitionEasing||q6,interpolator:l,interruption:n.transitionInterruption||X6,startProps:c.start,endProps:c.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(v),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class Y6{constructor(e){W(this,"_propsToCompare",void 0),W(this,"_propsToExtract",void 0),W(this,"_requiredProps",void 0);const{compare:n,extract:r,required:s}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=s}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!sh(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},s={};for(const l of this._propsToExtract)(l in e||l in n)&&(r[l]=e[l],s[l]=n[l]);return this._checkRequiredProps(r),this._checkRequiredProps(s),{start:r,end:s}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){!this._requiredProps||this._requiredProps.forEach(n=>{const r=e[n];ui(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const K6=["longitude","latitude","zoom","bearing","pitch"],J6=["longitude","latitude","zoom"];class k1 extends Y6{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:K6,required:J6},super(r.transitionProps),W(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:s,around:l}=this.opts;if(s&&l){const d=s(e),c=s(n),v=d.unproject(l);r.start.around=l,Object.assign(r.end,{around:c.project(v),aroundPosition:v,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const s={};for(const l of this._propsToExtract)s[l]=Dg(e[l]||0,n[l]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const l=this.opts.makeViewport({...n,...s});Object.assign(s,l.panByPosition(n.aroundPosition,Dg(e.around,n.around,r)))}return s}}const Ja={transitionDuration:0},Q6=300,km=t=>1-(1-t)*(1-t),fu={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},sc={};class qC{constructor(e){W(this,"props",void 0),W(this,"state",{}),W(this,"transitionManager",void 0),W(this,"eventManager",void 0),W(this,"onViewStateChange",void 0),W(this,"onStateChange",void 0),W(this,"makeViewport",void 0),W(this,"_controllerState",void 0),W(this,"_events",{}),W(this,"_interactionState",{isDragging:!1}),W(this,"_customEvents",[]),W(this,"_eventStartBlocked",null),W(this,"_panMove",!1),W(this,"invertPan",!1),W(this,"dragMode","rotate"),W(this,"inertia",0),W(this,"scrollZoom",!0),W(this,"dragPan",!0),W(this,"dragRotate",!0),W(this,"doubleClickZoom",!0),W(this,"touchZoom",!0),W(this,"touchRotate",!1),W(this,"keyboard",!0),this.transitionManager=new Z6({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:s}=e;return[s.x-n,s.y-r]}isPointInBounds(e,n){const{width:r,height:s}=this.props;if(n&&n.handled)return!1;const l=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=s;return l&&n&&n.stopPropagation(),l}isFunctionKeyPressed(e){const{srcEvent:n}=e;return Boolean(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?Q6:0;const{scrollZoom:r=!0,dragPan:s=!0,dragRotate:l=!0,doubleClickZoom:d=!0,touchZoom:c=!0,touchRotate:v=!1,keyboard:w=!0}=e,C=Boolean(this.onViewStateChange);this.toggleEvents(fu.WHEEL,C&&r),this.toggleEvents(fu.PAN,C&&(s||l)),this.toggleEvents(fu.PINCH,C&&(c||v)),this.toggleEvents(fu.TRIPLE_PAN,C&&v),this.toggleEvents(fu.DOUBLE_TAP,C&&d),this.toggleEvents(fu.KEYBOARD,C&&w),this.scrollZoom=r,this.dragPan=s,this.dragRotate=l,this.doubleClickZoom=d,this.touchZoom=c,this.touchRotate=v,this.keyboard=w}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const s={...e.getViewportProps(),...n},l=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),l){const d=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:s,interactionState:this._interactionState,oldViewState:d})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const s=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(s,Ja,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,Ja,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),s=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],l=this.controllerState.pan({pos:s}).panEnd();this.updateViewport(l,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:km},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Ja,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),s=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],l=this.controllerState.rotate({pos:s}).rotateEnd();this.updateViewport(l,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:km},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const{speed:r=.01,smooth:s=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:l}=e;let d=2/(1+Math.exp(-Math.abs(l*r)));l<0&&d!==0&&(d=1/d);const c=this.controllerState.zoom({pos:n,scale:d});return this.updateViewport(c,{...this._getTransitionProps({around:n}),transitionDuration:s?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,Ja,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Ja,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),s=[r[0],r[1]+=e.velocityY*n/2],l=this.controllerState.rotate({pos:s});this.updateViewport(l,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:km},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return sc._startPinchRotation=e.rotation,sc._lastPinchEvent=e,this.updateViewport(r,Ja,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,s=this.getCenter(e);n=n.zoom({pos:s,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:sc._startPinchRotation-r})}return this.updateViewport(n,Ja,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),sc._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=sc;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const s=this.getCenter(e);let l=this.controllerState.rotateEnd();const d=Math.log2(e.scale),c=(d-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),v=Math.pow(2,d+c*n/2);l=l.zoom({pos:s,scale:v}).zoomEnd(),this.updateViewport(l,{...this._getTransitionProps({around:s}),transitionDuration:n,transitionEasing:km},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const s=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(s,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return sc._startPinchRotation=null,sc._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),s=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(s,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:s,rotateSpeedX:l,rotateSpeedY:d}=this.keyboard===!0?{}:this.keyboard,{controllerState:c}=this;let v;const w={};switch(e.srcEvent.code){case"Minus":v=n?c.zoomOut(r).zoomOut(r):c.zoomOut(r),w.isZooming=!0;break;case"Equal":v=n?c.zoomIn(r).zoomIn(r):c.zoomIn(r),w.isZooming=!0;break;case"ArrowLeft":n?(v=c.rotateLeft(l),w.isRotating=!0):(v=c.moveLeft(s),w.isPanning=!0);break;case"ArrowRight":n?(v=c.rotateRight(l),w.isRotating=!0):(v=c.moveRight(s),w.isPanning=!0);break;case"ArrowUp":n?(v=c.rotateUp(d),w.isRotating=!0):(v=c.moveUp(s),w.isPanning=!0);break;case"ArrowDown":n?(v=c.rotateDown(d),w.isRotating=!0):(v=c.moveDown(s),w.isPanning=!0);break;default:return!1}return this.updateViewport(v,this._getTransitionProps(),w),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Ja:e?{...n,transitionInterpolator:new k1({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class XC{constructor(e,n){W(this,"_viewportProps",void 0),W(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const eT=5,eU=1.2;class tU extends XC{constructor(e){const{width:n,height:r,latitude:s,longitude:l,zoom:d,bearing:c=0,pitch:v=0,altitude:w=1.5,position:C=[0,0,0],maxZoom:I=20,minZoom:S=0,maxPitch:z=60,minPitch:F=0,startPanLngLat:B,startZoomLngLat:Q,startRotatePos:q,startBearing:j,startPitch:G,startZoom:se,normalize:he=!0}=e;ui(Number.isFinite(l)),ui(Number.isFinite(s)),ui(Number.isFinite(d)),super({width:n,height:r,latitude:s,longitude:l,zoom:d,bearing:c,pitch:v,altitude:w,maxZoom:I,minZoom:S,maxPitch:z,minPitch:F,normalize:he,position:C},{startPanLngLat:B,startZoomLngLat:Q,startRotatePos:q,startBearing:j,startPitch:G,startZoom:se}),W(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const l=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(l)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:s,startBearing:l,startPitch:d}=this.getState();if(!s||l===void 0||d===void 0)return this;let c;return e?c=this._getNewRotation(e,s,d,l):c={bearing:l+n,pitch:d+r},this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:s,startZoomLngLat:l}=this.getState();if(l||(s=this.getViewportProps().zoom,l=this._unproject(n)||this._unproject(e)),!l)return this;const{maxZoom:d,minZoom:c}=this.getViewportProps();let v=s+Math.log2(r);v=hi(v,c,d);const w=this.makeViewport({...this.getViewportProps(),zoom:v});return this._getUpdatedState({zoom:v,...w.panByPosition(l,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:s,longitude:l}=r;return Math.abs(s-n.bearing)>180&&(r.bearing=s<0?s+360:s-360),Math.abs(l-n.longitude)>180&&(r.longitude=l<0?l+360:l-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:s}=e;e.zoom=hi(s,r,n);const{maxPitch:l,minPitch:d,pitch:c}=e;e.pitch=hi(c,d,l);const{normalize:v=!0}=e;return v&&Object.assign(e,YN(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,s){const l=e[0]-n[0],d=e[1]-n[1],c=e[1],v=n[1],{width:w,height:C}=this.getViewportProps(),I=l/w;let S=0;d>0?Math.abs(C-v)>eT&&(S=d/(v-C)*eU):d<0&&v>eT&&(S=1-c/v),S=hi(S,-1,1);const{minPitch:z,maxPitch:F}=this.getViewportProps(),B=s+180*I;let Q=r;return S>0?Q=r+S*(F-r):S<0&&(Q=r-S*(z-r)),{pitch:Q,bearing:B}}}class nU extends qC{constructor(...e){super(...e),W(this,"ControllerState",tU),W(this,"transition",{transitionDuration:300,transitionInterpolator:new k1({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),W(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class ZC extends Ac{get ViewportType(){return xl}get ControllerType(){return nU}}W(ZC,"displayName","MapView");class rU extends gy{constructor(e,n){super(e,n),W(this,"maskMap",void 0),W(this,"fbo",void 0);const{mapSize:r=2048}=n;this.maskMap=new Gi(e,{width:r,height:r,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.fbo=new Ur(e,{id:"maskmap",width:r,height:r,attachments:{[36064]:this.maskMap}})}render(e){const n=this.gl,r=[!1,!1,!1,!1];return r[e.channel]=!0,$s(n,{clearColor:[255,255,255,255],blend:!0,blendFunc:[0,1],blendEquation:32778,colorMask:r,depthTest:!1},()=>super.render({...e,target:this.fbo,pass:"mask"}))}shouldDrawLayer(e){return e.props.operation===Hf.MASK}delete(){this.fbo.delete(),this.maskMap.delete()}}const iU=new qs().lookAt({eye:[0,0,1]});function sU({width:t,height:e,near:n,far:r,padding:s}){let l=-t/2,d=t/2,c=-e/2,v=e/2;if(s){const{left:w=0,right:C=0,top:I=0,bottom:S=0}=s,z=hi((w+t-C)/2,0,t)-t/2,F=hi((I+e-S)/2,0,e)-e/2;l-=z,d-=z,c+=F,v+=F}return new qs().ortho({left:l,right:d,bottom:c,top:v,near:n,far:r})}class oU extends Mc{constructor(e){const{width:n,height:r,near:s=.1,far:l=1e3,zoom:d=0,target:c=[0,0,0],padding:v=null,flipY:w=!0}=e,C=Array.isArray(d)?d[0]:d,I=Array.isArray(d)?d[1]:d,S=Math.min(C,I),z=Math.pow(2,S);let F;if(C!==I){const B=Math.pow(2,C),Q=Math.pow(2,I);F={unitsPerMeter:[B/z,Q/z,1],metersPerUnit:[z/B,z/Q,1]}}super({...e,longitude:void 0,position:c,viewMatrix:iU.clone().scale([z,z*(w?-1:1),z]),projectionMatrix:sU({width:n||1,height:r||1,padding:v,near:s,far:l}),zoom:S,distanceScales:F})}projectFlat([e,n]){const{unitsPerMeter:r}=this.distanceScales;return[e*r[0],n*r[1]]}unprojectFlat([e,n]){const{metersPerUnit:r}=this.distanceScales;return[e*r[0],n*r[1]]}panByPosition(e,n){const r=my(n,this.pixelUnprojectionMatrix),s=this.projectFlat(e),l=zg([],s,SC([],r)),d=zg([],this.center,l);return{target:this.unprojectFlat(d)}}}class aU extends XC{constructor(e){const{width:n,height:r,rotationX:s=0,rotationOrbit:l=0,target:d=[0,0,0],zoom:c=0,minRotationX:v=-90,maxRotationX:w=90,minZoom:C=-1/0,maxZoom:I=1/0,startPanPosition:S,startRotatePos:z,startRotationX:F,startRotationOrbit:B,startZoomPosition:Q,startZoom:q}=e;super({width:n,height:r,rotationX:s,rotationOrbit:l,target:d,zoom:c,minRotationX:v,maxRotationX:w,minZoom:C,maxZoom:I},{startPanPosition:S,startRotatePos:z,startRotationX:F,startRotationOrbit:B,startZoomPosition:Q,startZoom:q}),W(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:n}){const r=this.getState().startPanPosition||n;if(!r)return this;const l=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(l)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:s,startRotationX:l,startRotationOrbit:d}=this.getState(),{width:c,height:v}=this.getViewportProps();if(!s||l===void 0||d===void 0)return this;let w;if(e){let C=(e[0]-s[0])/c;const I=(e[1]-s[1])/v;(l<-90||l>90)&&(C*=-1),w={rotationX:l+I*180,rotationOrbit:d+C*180}}else w={rotationX:l+r,rotationOrbit:d+n};return this._getUpdatedState(w)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{rotationOrbit:s}=r;return Math.abs(s-n.rotationOrbit)>180&&(r.rotationOrbit=s<0?s+360:s-360),r}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:s,startZoomPosition:l}=this.getState();if(l||(s=this.getViewportProps().zoom,l=this._unproject(n)||this._unproject(e)),!l)return this;const d=this._calculateNewZoom({scale:r,startZoom:s}),c=this.makeViewport({...this.getViewportProps(),zoom:d});return this._getUpdatedState({zoom:d,...c.panByPosition(l,e)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_calculateNewZoom({scale:e,startZoom:n}){const{maxZoom:r,minZoom:s}=this.getViewportProps();n===void 0&&(n=this.getViewportProps().zoom);const l=n+Math.log2(e);return hi(l,s,r)}_panFromCenter(e){const{width:n,height:r,target:s}=this.getViewportProps();return this.pan({startPosition:s,pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:s,maxRotationX:l,minRotationX:d,rotationOrbit:c}=e;return e.zoom=Array.isArray(s)?[hi(s[0],r,n),hi(s[1],r,n)]:hi(s,r,n),e.rotationX=hi(e.rotationX,d,l),(c<-180||c>180)&&(e.rotationOrbit=A6(c+180,360)-180),e}}class lU extends aU{constructor(e){super(e),W(this,"zoomAxis",void 0),this.zoomAxis=e.zoomAxis||"all"}_calculateNewZoom({scale:e,startZoom:n}){const{maxZoom:r,minZoom:s}=this.getViewportProps();n===void 0&&(n=this.getViewportProps().zoom);let l=Math.log2(e);if(Array.isArray(n)){let[d,c]=n;switch(this.zoomAxis){case"X":d=hi(d+l,s,r);break;case"Y":c=hi(c+l,s,r);break;default:let v=Math.min(d+l,c+l);v<s&&(l+=s-v),v=Math.max(d+l,c+l),v>r&&(l+=r-v),d+=l,c+=l}return[d,c]}return hi(n+l,s,r)}}class cU extends qC{constructor(...e){super(...e),W(this,"ControllerState",lU),W(this,"transition",{transitionDuration:300,transitionInterpolator:new k1(["target","zoom"])}),W(this,"dragMode","pan")}_onPanRotate(){return!1}}class YC extends Ac{get ViewportType(){return oU}get ControllerType(){return cU}}W(YC,"displayName","OrthographicView");function uU({layers:t,viewport:e}){let n=null;for(const l of t){const d=l.getBounds();d&&(n?(n[0]=Math.min(n[0],d[0][0]),n[1]=Math.min(n[1],d[0][1]),n[2]=Math.max(n[2],d[1][0]),n[3]=Math.max(n[3],d[1][1])):n=[d[0][0],d[0][1],d[1][0],d[1][1]])}const r=e.getBounds();if(!n)return r;const s=dU(r);return n[2]-n[0]<s[2]-s[0]||n[3]-n[1]<s[3]-s[1]||(n[0]=Math.max(n[0],s[0]),n[1]=Math.max(n[1],s[1]),n[2]=Math.min(n[2],s[2]),n[3]=Math.min(n[3],s[3])),n}function hU({bounds:t,viewport:e,width:n,height:r}){if(t[2]<=t[0]||t[3]<=t[1])return null;const s=1;if(n-=s*2,r-=s*2,e instanceof xl){const{longitude:c,latitude:v,zoom:w}=VC({width:n,height:r,bounds:[[t[0],t[1]],[t[2],t[3]]],maxZoom:20});return new xl({longitude:c,latitude:v,zoom:w,x:s,y:s,width:n,height:r})}const l=[(t[0]+t[2])/2,(t[1]+t[3])/2,0],d=Math.min(20,n/(t[2]-t[0]),r/(t[3]-t[1]));return new YC({x:s,y:s}).makeViewport({width:n,height:r,viewState:{target:l,zoom:Math.log2(d)}})}function dU(t){const e={x:t[2]-t[0],y:t[3]-t[1]},n={x:t[0]+.5*e.x,y:t[1]+.5*e.y};return[n.x-e.x,n.y-e.y,n.x+e.x,n.y+e.y]}class fU{constructor(){W(this,"id","mask-effect"),W(this,"props",null),W(this,"useInPicking",!0),W(this,"dummyMaskMap",void 0),W(this,"channels",[]),W(this,"masks",null),W(this,"maskPass",void 0),W(this,"maskMap",void 0),W(this,"lastViewport",void 0)}preRender(e,{layers:n,layerFilter:r,viewports:s,onViewportActive:l,views:d}){this.dummyMaskMap||(this.dummyMaskMap=new Gi(e,{width:1,height:1}));const c=n.filter(I=>I.props.visible&&I.props.operation===Hf.MASK);if(c.length===0){this.masks=null,this.channels.length=0;return}this.masks={},this.maskPass||(this.maskPass=new rU(e,{id:"default-mask"}),this.maskMap=this.maskPass.maskMap);const v=this._sortMaskChannels(c),w=s[0],C=!this.lastViewport||!this.lastViewport.equals(w);for(const I in v)this._renderChannel(v[I],{layerFilter:r,onViewportActive:l,views:d,viewport:w,viewportChanged:C})}_renderChannel(e,{layerFilter:n,onViewportActive:r,views:s,viewport:l,viewportChanged:d}){const c=this.channels[e.index];if(!c)return;const v=e===c||c.layers.length!==e.layers.length||e.layerBounds.some((w,C)=>w!==c.layerBounds[C]);if(e.bounds=c.bounds,e.maskBounds=c.maskBounds,this.channels[e.index]=e,(v||d)&&(this.lastViewport=l,e.bounds=uU({layers:e.layers,viewport:l}),v||!sh(e.bounds,c.bounds))){const{maskPass:w,maskMap:C}=this,I=hU({bounds:e.bounds,viewport:l,width:C.width,height:C.height});e.maskBounds=I?I.getBounds():[0,0,1,1],w.render({pass:"mask",channel:e.index,layers:e.layers,layerFilter:n,viewports:I?[I]:[],onViewportActive:r,views:s,moduleParameters:{devicePixelRatio:1}})}this.masks[e.id]={index:e.index,bounds:e.maskBounds,coordinateOrigin:e.coordinateOrigin,coordinateSystem:e.coordinateSystem}}_sortMaskChannels(e){const n={};let r=0;for(const s of e){const{id:l}=s.root;let d=n[l];if(!d){if(++r>4){Bn.warn("Too many mask layers. The max supported is 4")();continue}d={id:l,index:this.channels.findIndex(c=>(c==null?void 0:c.id)===l),layers:[],layerBounds:[],coordinateOrigin:s.root.props.coordinateOrigin,coordinateSystem:s.root.props.coordinateSystem},n[l]=d}d.layers.push(s),d.layerBounds.push(s.getBounds())}for(let s=0;s<4;s++){const l=this.channels[s];(!l||!(l.id in n))&&(this.channels[s]=null)}for(const s in n){const l=n[s];l.index<0&&(l.index=this.channels.findIndex(d=>!d),this.channels[l.index]=l)}return n}getModuleParameters(){return{maskMap:this.masks?this.maskMap:this.dummyMaskMap,maskChannels:this.masks}}cleanup(){this.dummyMaskMap&&(this.dummyMaskMap.delete(),this.dummyMaskMap=void 0),this.maskPass&&(this.maskPass.delete(),this.maskPass=void 0,this.maskMap=void 0),this.lastViewport=void 0,this.masks=null,this.channels.length=0}}const pU=new GC;class mU{constructor(){W(this,"effects",void 0),W(this,"_internalEffects",void 0),W(this,"_needsRedraw",void 0),this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!yh(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._internalEffects=e.slice(),this._internalEffects.push(new fU),e.some(n=>n instanceof GC)||this._internalEffects.push(pU)}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}}class gU extends gy{shouldDrawLayer(e){return e.props.operation===Hf.DRAW}}const tT={blendFunc:[1,0,32771,0],blendEquation:32774};class KC extends gy{constructor(...e){super(...e),W(this,"pickZ",void 0),W(this,"_colors",null)}render(e){return e.pickingFBO?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:s,onViewportActive:l,pickingFBO:d,deviceRect:{x:c,y:v,width:w,height:C},cullRect:I,effects:S,pass:z="picking",pickZ:F}){const B=this.gl;this.pickZ=F;const Q=F?null:{byLayer:new Map,byAlpha:[]};this._colors=Q;const q=$s(B,{scissorTest:!0,scissor:[c,v,w,C],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...tT,blend:!F},()=>super.render({target:d,layers:e,layerFilter:n,views:r,viewports:s,onViewportActive:l,cullRect:I,effects:S==null?void 0:S.filter(G=>G.useInPicking),pass:z}));return this._colors=null,{decodePickingColor:Q&&_U.bind(null,Q),stats:q}}shouldDrawLayer(e){return e.props.pickable&&e.props.operation===Hf.DRAW}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const s={...e.props.parameters};return this._colors?(Object.assign(s,tT),s.blend=!0,s.blendColor=yU(this._colors,e,r)):s.blend=!1,s}}function yU(t,e,n){const{byLayer:r,byAlpha:s}=t;let l,d=r.get(e);return d?(d.viewports.push(n),l=d.a):(l=r.size+1,l<=255?(d={a:l,layer:e,viewports:[n]},r.set(e,d),s[l]=d):(Bn.warn("Too many pickable layers, only picking the first 255")(),l=0)),[0,0,0,l/255]}function _U(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const vU="deckRenderer.renderLayers";class xU{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new gU(e),this.pickLayersPass=new KC(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=e.layerFilter||this.layerFilter,e.effects=e.effects||[],e.target=e.target||Ur.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const r=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,s=n.render({...e,target:r});this._postRender(e.effects,e),this.renderCount++,Ui(vU,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){let r=null;for(const s of e)s.preRender(this.gl,n),s.postRender&&(r=s);r&&this._resizeRenderBuffers(),this.lastPostProcessEffect=r}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new Ur(this.gl),new Ur(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,s={inputBuffer:r[0],swapBuffer:r[1],target:null};for(const l of e)if(l.postRender){if(l===this.lastPostProcessEffect){s.target=n.target,l.postRender(this.gl,s);break}const d=l.postRender(this.gl,s);s.inputBuffer=d,s.swapBuffer=d===r[0]?r[1]:r[0]}}}const bU={pickedColor:null,pickedObjectIndex:-1};function wU({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:s,deviceRect:l}){const{x:d,y:c,width:v,height:w}=l;let C=s*s,I=-1,S=0;for(let z=0;z<w;z++){const F=z+c-r,B=F*F;if(B>C)S+=4*v;else for(let Q=0;Q<v;Q++){if(t[S+3]-1>=0){const j=Q+d-n,G=j*j+B;G<=C&&(C=G,I=S)}S+=4}}if(I>=0){const z=t.slice(I,I+4),F=e(z);if(F){const B=Math.floor(I/4/v),Q=I/4-B*v;return{...F,pickedColor:z,pickedX:d+Q,pickedY:c+B}}Bn.error("Picked non-existent layer. Is picking buffer corrupt?")()}return bU}function EU({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const l=t.slice(r,r+4),d=l.join(",");if(!n.has(d)){const c=e(l);c?n.set(d,{...c,color:l}):Bn.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function JC({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:s,z:l}){let d=e[0];e.length>1&&(d=SU((t==null?void 0:t.pickedViewports)||e,{x:r,y:s}));let c;if(d){const v=[r-d.x,s-d.y];l!==void 0&&(v[2]=l),c=d.unproject(v)}return{color:null,layer:null,viewport:d,index:-1,picked:!1,x:r,y:s,pixel:[r,s],coordinate:c,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function TU(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:s}=t,{pickedColor:l,pickedLayer:d,pickedObjectIndex:c}=e,v=d?[d]:[];if(r==="hover"){const I=n.index,S=n.layerId,z=d?d.props.id:null;if(z!==S||c!==I){if(z!==S){const F=s.find(B=>B.props.id===S);F&&v.unshift(F)}n.layerId=z,n.index=c,n.info=null}}const w=JC(t),C=new Map;return C.set(null,w),v.forEach(I=>{let S={...w};I===d&&(S.color=l,S.index=c,S.picked=!0),S=QC({layer:I,info:S,mode:r});const z=S.layer;I===d&&r==="hover"&&(n.info=S),C.set(z.id,S),r==="hover"&&z.updateAutoHighlight(S)}),C}function QC({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function SU(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class AU{constructor(e){W(this,"gl",void 0),W(this,"pickingFBO",void 0),W(this,"depthFBO",void 0),W(this,"pickLayersPass",void 0),W(this,"layerFilter",void 0),W(this,"lastPickedInfo",void 0),W(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new KC(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:s},l=this.lastPickedInfo.info){const d=l&&l.layer&&l.layer.id,c=l&&l.viewport&&l.viewport.id,v=d?r.find(S=>S.id===d):null,w=c&&s.find(S=>S.id===c)||s[0],C=w&&w.unproject([e-w.x,n-w.y]);return{...l,...{x:e,y:n,viewport:w,coordinate:C,layer:v}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new Ur(r),Ur.isSupported(r,{colorBufferFloat:!0}))){const s=new Ur(r);s.attach({[36064]:new Gi(r,{format:mn(r)?34836:6408,type:5126})}),this.depthFBO=s}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>r.isPickable()&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:s,y:l,radius:d=0,depth:c=1,mode:v="query",unproject3D:w,onViewportActive:C,effects:I}){const S=this._getPickable(e),z=th(this.gl);if(!S)return{result:[],emptyInfo:JC({viewports:r,x:s,y:l,pixelRatio:z})};this._resizeBuffer();const F=f0(this.gl,[s,l],!0),B=[F.x+Math.floor(F.width/2),F.y+Math.floor(F.height/2)],Q=Math.round(d*z),{width:q,height:j}=this.pickingFBO,G=this._getPickingRect({deviceX:B[0],deviceY:B[1],deviceRadius:Q,deviceWidth:q,deviceHeight:j}),se={x:s-d,y:l-d,width:d*2+1,height:d*2+1};let he;const ye=[],we=new Set;for(let Be=0;Be<c;Be++){let Ve;if(G){const He=this._drawAndSample({layers:S,views:n,viewports:r,onViewportActive:C,deviceRect:G,cullRect:se,effects:I,pass:"picking:".concat(v)});Ve=wU({...He,deviceX:B[0],deviceY:B[1],deviceRadius:Q,deviceRect:G})}else Ve={pickedColor:null,pickedObjectIndex:-1};let xe;Ve.pickedLayer&&w&&this.depthFBO&&(xe=this._drawAndSample({layers:[Ve.pickedLayer],views:n,viewports:r,onViewportActive:C,deviceRect:{x:Ve.pickedX,y:Ve.pickedY,width:1,height:1},cullRect:se,effects:I,pass:"picking:".concat(v,":z")},!0).pickedColors[0]),Ve.pickedLayer&&Be+1<c&&(we.add(Ve.pickedLayer),Ve.pickedLayer.disablePickingIndex(Ve.pickedObjectIndex)),he=TU({pickInfo:Ve,lastPickedInfo:this.lastPickedInfo,mode:v,layers:S,viewports:r,x:s,y:l,z:xe,pixelRatio:z});for(const He of he.values())He.layer&&ye.push(He);if(!Ve.pickedColor)break}for(const Be of we)Be.restorePickingColors();return{result:ye,emptyInfo:he.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:s,y:l,width:d=1,height:c=1,mode:v="query",maxObjects:w=null,onViewportActive:C,effects:I}){const S=this._getPickable(e);if(!S)return[];this._resizeBuffer();const z=th(this.gl),F=f0(this.gl,[s,l],!0),B=F.x,Q=F.y+F.height,q=f0(this.gl,[s+d,l+c],!0),j=q.x+q.width,G=q.y,se={x:B,y:G,width:j-B,height:Q-G},he=this._drawAndSample({layers:S,views:n,viewports:r,onViewportActive:C,deviceRect:se,cullRect:{x:s,y:l,width:d,height:c},effects:I,pass:"picking:".concat(v)}),ye=EU(he),we=new Map,Be=Number.isFinite(w);for(let Ve=0;Ve<ye.length&&!(Be&&w&&we.size>=w);Ve++){const xe=ye[Ve];let He={color:xe.pickedColor,layer:null,index:xe.pickedObjectIndex,picked:!0,x:s,y:l,pixelRatio:z};He=QC({layer:xe.pickedLayer,info:He,mode:v}),we.has(He.object)||we.set(He.object,He)}return Array.from(we.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:s,deviceRect:l,cullRect:d,effects:c,pass:v},w=!1){const C=w?this.depthFBO:this.pickingFBO,{decodePickingColor:I}=this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:s,pickingFBO:C,deviceRect:l,cullRect:d,effects:c,pass:v,pickZ:w}),{x:S,y:z,width:F,height:B}=l,Q=new(w?Float32Array:Uint8Array)(F*B*4);return fy(C,{sourceX:S,sourceY:z,sourceWidth:F,sourceHeight:B,target:Q}),{pickedColors:Q,decodePickingColor:I}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:s,deviceHeight:l}){const d=Math.max(0,e-r),c=Math.max(0,n-r),v=Math.min(s,e+r+1)-d,w=Math.min(l,n+r+1)-c;return v<=0||w<=0?null:{x:d,y:c,width:v,height:w}}}const PU={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class CU{constructor(e){W(this,"el",null),W(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,PU),n.appendChild(this.el))}setTooltip(e,n,r){const s=this.el;if(!!s){if(typeof e=="string")s.innerText=e;else if(e)e.text&&(s.innerText=e.text),e.html&&(s.innerHTML=e.html),e.className&&(s.className=e.className),Object.assign(s.style,e.style);else{this.isVisible=!1,s.style.display="none";return}this.isVisible=!0,s.style.display="block",s.style.transform="translate(".concat(n,"px, ").concat(r,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}var _h={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,s){var l=["","webkit","Moz","MS","ms","o"],d=n.createElement("div"),c="function",v=Math.round,w=Math.abs,C=Date.now;function I(X,ee,de){return setTimeout(G(X,de),ee)}function S(X,ee,de){return Array.isArray(X)?(z(X,de[ee],de),!0):!1}function z(X,ee,de){var Ce;if(!!X)if(X.forEach)X.forEach(ee,de);else if(X.length!==s)for(Ce=0;Ce<X.length;)ee.call(de,X[Ce],Ce,X),Ce++;else for(Ce in X)X.hasOwnProperty(Ce)&&ee.call(de,X[Ce],Ce,X)}function F(X,ee,de){var Ce="DEPRECATED METHOD: "+ee+`
`+de+` AT 
`;return function(){var $e=new Error("get-stack-trace"),ft=$e&&$e.stack?$e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",en=e.console&&(e.console.warn||e.console.log);return en&&en.call(e.console,Ce,ft),X.apply(this,arguments)}}var B;typeof Object.assign!="function"?B=function(ee){if(ee===s||ee===null)throw new TypeError("Cannot convert undefined or null to object");for(var de=Object(ee),Ce=1;Ce<arguments.length;Ce++){var $e=arguments[Ce];if($e!==s&&$e!==null)for(var ft in $e)$e.hasOwnProperty(ft)&&(de[ft]=$e[ft])}return de}:B=Object.assign;var Q=F(function(ee,de,Ce){for(var $e=Object.keys(de),ft=0;ft<$e.length;)(!Ce||Ce&&ee[$e[ft]]===s)&&(ee[$e[ft]]=de[$e[ft]]),ft++;return ee},"extend","Use `assign`."),q=F(function(ee,de){return Q(ee,de,!0)},"merge","Use `assign`.");function j(X,ee,de){var Ce=ee.prototype,$e;$e=X.prototype=Object.create(Ce),$e.constructor=X,$e._super=Ce,de&&B($e,de)}function G(X,ee){return function(){return X.apply(ee,arguments)}}function se(X,ee){return typeof X==c?X.apply(ee&&ee[0]||s,ee):X}function he(X,ee){return X===s?ee:X}function ye(X,ee,de){z(xe(ee),function(Ce){X.addEventListener(Ce,de,!1)})}function we(X,ee,de){z(xe(ee),function(Ce){X.removeEventListener(Ce,de,!1)})}function Be(X,ee){for(;X;){if(X==ee)return!0;X=X.parentNode}return!1}function Ve(X,ee){return X.indexOf(ee)>-1}function xe(X){return X.trim().split(/\s+/g)}function He(X,ee,de){if(X.indexOf&&!de)return X.indexOf(ee);for(var Ce=0;Ce<X.length;){if(de&&X[Ce][de]==ee||!de&&X[Ce]===ee)return Ce;Ce++}return-1}function wt(X){return Array.prototype.slice.call(X,0)}function yt(X,ee,de){for(var Ce=[],$e=[],ft=0;ft<X.length;){var en=ee?X[ft][ee]:X[ft];He($e,en)<0&&Ce.push(X[ft]),$e[ft]=en,ft++}return de&&(ee?Ce=Ce.sort(function(Xt,fr){return Xt[ee]>fr[ee]}):Ce=Ce.sort()),Ce}function ot(X,ee){for(var de,Ce,$e=ee[0].toUpperCase()+ee.slice(1),ft=0;ft<l.length;){if(de=l[ft],Ce=de?de+$e:ee,Ce in X)return Ce;ft++}return s}var zt=1;function Qe(){return zt++}function yn(X){var ee=X.ownerDocument||X;return ee.defaultView||ee.parentWindow||e}var Ne=/mobile|tablet|ip(ad|hone|od)|android/i,et="ontouchstart"in e,_t=ot(e,"PointerEvent")!==s,at=et&&Ne.test(navigator.userAgent),Ot="touch",tn="pen",$t="mouse",cn="kinect",sn=25,Bt=1,fn=2,jt=4,Kt=8,Wn=1,In=2,Vn=4,kr=8,or=16,Hn=In|Vn,Mr=kr|or,jn=Hn|Mr,Jt=["x","y"],On=["clientX","clientY"];function kn(X,ee){var de=this;this.manager=X,this.callback=ee,this.element=X.element,this.target=X.options.inputTarget,this.domHandler=function(Ce){se(X.options.enable,[X])&&de.handler(Ce)},this.init()}kn.prototype={handler:function(){},init:function(){this.evEl&&ye(this.element,this.evEl,this.domHandler),this.evTarget&&ye(this.target,this.evTarget,this.domHandler),this.evWin&&ye(yn(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&we(this.element,this.evEl,this.domHandler),this.evTarget&&we(this.target,this.evTarget,this.domHandler),this.evWin&&we(yn(this.element),this.evWin,this.domHandler)}};function ti(X){var ee,de=X.options.inputClass;return de?ee=de:_t?ee=Ii:at?ee=qi:et?ee=te:ee=Ft,new ee(X,Wt)}function Wt(X,ee,de){var Ce=de.pointers.length,$e=de.changedPointers.length,ft=ee&Bt&&Ce-$e===0,en=ee&(jt|Kt)&&Ce-$e===0;de.isFirst=!!ft,de.isFinal=!!en,ft&&(X.session={}),de.eventType=ee,nn(X,de),X.emit("hammer.input",de),X.recognize(de),X.session.prevInput=de}function nn(X,ee){var de=X.session,Ce=ee.pointers,$e=Ce.length;de.firstInput||(de.firstInput=Ut(ee)),$e>1&&!de.firstMultiple?de.firstMultiple=Ut(ee):$e===1&&(de.firstMultiple=!1);var ft=de.firstInput,en=de.firstMultiple,Jn=en?en.center:ft.center,Xt=ee.center=Re(Ce);ee.timeStamp=C(),ee.deltaTime=ee.timeStamp-ft.timeStamp,ee.angle=Ht(Jn,Xt),ee.distance=Dn(Jn,Xt),Nt(de,ee),ee.offsetDirection=Xr(ee.deltaX,ee.deltaY);var fr=je(ee.deltaTime,ee.deltaX,ee.deltaY);ee.overallVelocityX=fr.x,ee.overallVelocityY=fr.y,ee.overallVelocity=w(fr.x)>w(fr.y)?fr.x:fr.y,ee.scale=en?ni(en.pointers,Ce):1,ee.rotation=en?Vr(en.pointers,Ce):0,ee.maxPointers=de.prevInput?ee.pointers.length>de.prevInput.maxPointers?ee.pointers.length:de.prevInput.maxPointers:ee.pointers.length,Sn(de,ee);var ki=X.element;Be(ee.srcEvent.target,ki)&&(ki=ee.srcEvent.target),ee.target=ki}function Nt(X,ee){var de=ee.center,Ce=X.offsetDelta||{},$e=X.prevDelta||{},ft=X.prevInput||{};(ee.eventType===Bt||ft.eventType===jt)&&($e=X.prevDelta={x:ft.deltaX||0,y:ft.deltaY||0},Ce=X.offsetDelta={x:de.x,y:de.y}),ee.deltaX=$e.x+(de.x-Ce.x),ee.deltaY=$e.y+(de.y-Ce.y)}function Sn(X,ee){var de=X.lastInterval||ee,Ce=ee.timeStamp-de.timeStamp,$e,ft,en,Jn;if(ee.eventType!=Kt&&(Ce>sn||de.velocity===s)){var Xt=ee.deltaX-de.deltaX,fr=ee.deltaY-de.deltaY,ki=je(Ce,Xt,fr);ft=ki.x,en=ki.y,$e=w(ki.x)>w(ki.y)?ki.x:ki.y,Jn=Xr(Xt,fr),X.lastInterval=ee}else $e=de.velocity,ft=de.velocityX,en=de.velocityY,Jn=de.direction;ee.velocity=$e,ee.velocityX=ft,ee.velocityY=en,ee.direction=Jn}function Ut(X){for(var ee=[],de=0;de<X.pointers.length;)ee[de]={clientX:v(X.pointers[de].clientX),clientY:v(X.pointers[de].clientY)},de++;return{timeStamp:C(),pointers:ee,center:Re(ee),deltaX:X.deltaX,deltaY:X.deltaY}}function Re(X){var ee=X.length;if(ee===1)return{x:v(X[0].clientX),y:v(X[0].clientY)};for(var de=0,Ce=0,$e=0;$e<ee;)de+=X[$e].clientX,Ce+=X[$e].clientY,$e++;return{x:v(de/ee),y:v(Ce/ee)}}function je(X,ee,de){return{x:ee/X||0,y:de/X||0}}function Xr(X,ee){return X===ee?Wn:w(X)>=w(ee)?X<0?In:Vn:ee<0?kr:or}function Dn(X,ee,de){de||(de=Jt);var Ce=ee[de[0]]-X[de[0]],$e=ee[de[1]]-X[de[1]];return Math.sqrt(Ce*Ce+$e*$e)}function Ht(X,ee,de){de||(de=Jt);var Ce=ee[de[0]]-X[de[0]],$e=ee[de[1]]-X[de[1]];return Math.atan2($e,Ce)*180/Math.PI}function Vr(X,ee){return Ht(ee[1],ee[0],On)+Ht(X[1],X[0],On)}function ni(X,ee){return Dn(ee[0],ee[1],On)/Dn(X[0],X[1],On)}var ri={mousedown:Bt,mousemove:fn,mouseup:jt},ks="mousedown",Ye="mousemove mouseup";function Ft(){this.evEl=ks,this.evWin=Ye,this.pressed=!1,kn.apply(this,arguments)}j(Ft,kn,{handler:function(ee){var de=ri[ee.type];de&Bt&&ee.button===0&&(this.pressed=!0),de&fn&&ee.which!==1&&(de=jt),this.pressed&&(de&jt&&(this.pressed=!1),this.callback(this.manager,de,{pointers:[ee],changedPointers:[ee],pointerType:$t,srcEvent:ee}))}});var Dt={pointerdown:Bt,pointermove:fn,pointerup:jt,pointercancel:Kt,pointerout:Kt},Tr={2:Ot,3:tn,4:$t,5:cn},os="pointerdown",Rt="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(os="MSPointerDown",Rt="MSPointerMove MSPointerUp MSPointerCancel");function Ii(){this.evEl=os,this.evWin=Rt,kn.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}j(Ii,kn,{handler:function(ee){var de=this.store,Ce=!1,$e=ee.type.toLowerCase().replace("ms",""),ft=Dt[$e],en=Tr[ee.pointerType]||ee.pointerType,Jn=en==Ot,Xt=He(de,ee.pointerId,"pointerId");ft&Bt&&(ee.button===0||Jn)?Xt<0&&(de.push(ee),Xt=de.length-1):ft&(jt|Kt)&&(Ce=!0),!(Xt<0)&&(de[Xt]=ee,this.callback(this.manager,ft,{pointers:de,changedPointers:[ee],pointerType:en,srcEvent:ee}),Ce&&de.splice(Xt,1))}});var _r={touchstart:Bt,touchmove:fn,touchend:jt,touchcancel:Kt},go="touchstart",ar="touchstart touchmove touchend touchcancel";function Lr(){this.evTarget=go,this.evWin=ar,this.started=!1,kn.apply(this,arguments)}j(Lr,kn,{handler:function(ee){var de=_r[ee.type];if(de===Bt&&(this.started=!0),!!this.started){var Ce=xn.call(this,ee,de);de&(jt|Kt)&&Ce[0].length-Ce[1].length===0&&(this.started=!1),this.callback(this.manager,de,{pointers:Ce[0],changedPointers:Ce[1],pointerType:Ot,srcEvent:ee})}}});function xn(X,ee){var de=wt(X.touches),Ce=wt(X.changedTouches);return ee&(jt|Kt)&&(de=yt(de.concat(Ce),"identifier",!0)),[de,Ce]}var yo={touchstart:Bt,touchmove:fn,touchend:jt,touchcancel:Kt},Hi="touchstart touchmove touchend touchcancel";function qi(){this.evTarget=Hi,this.targetIds={},kn.apply(this,arguments)}j(qi,kn,{handler:function(ee){var de=yo[ee.type],Ce=Ys.call(this,ee,de);!Ce||this.callback(this.manager,de,{pointers:Ce[0],changedPointers:Ce[1],pointerType:Ot,srcEvent:ee})}});function Ys(X,ee){var de=wt(X.touches),Ce=this.targetIds;if(ee&(Bt|fn)&&de.length===1)return Ce[de[0].identifier]=!0,[de,de];var $e,ft,en=wt(X.changedTouches),Jn=[],Xt=this.target;if(ft=de.filter(function(fr){return Be(fr.target,Xt)}),ee===Bt)for($e=0;$e<ft.length;)Ce[ft[$e].identifier]=!0,$e++;for($e=0;$e<en.length;)Ce[en[$e].identifier]&&Jn.push(en[$e]),ee&(jt|Kt)&&delete Ce[en[$e].identifier],$e++;if(!!Jn.length)return[yt(ft.concat(Jn),"identifier",!0),Jn]}var _o=2500,Ms=25;function te(){kn.apply(this,arguments);var X=G(this.handler,this);this.touch=new qi(this.manager,X),this.mouse=new Ft(this.manager,X),this.primaryTouch=null,this.lastTouches=[]}j(te,kn,{handler:function(ee,de,Ce){var $e=Ce.pointerType==Ot,ft=Ce.pointerType==$t;if(!(ft&&Ce.sourceCapabilities&&Ce.sourceCapabilities.firesTouchEvents)){if($e)R.call(this,de,Ce);else if(ft&&K.call(this,Ce))return;this.callback(ee,de,Ce)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function R(X,ee){X&Bt?(this.primaryTouch=ee.changedPointers[0].identifier,U.call(this,ee)):X&(jt|Kt)&&U.call(this,ee)}function U(X){var ee=X.changedPointers[0];if(ee.identifier===this.primaryTouch){var de={x:ee.clientX,y:ee.clientY};this.lastTouches.push(de);var Ce=this.lastTouches,$e=function(){var ft=Ce.indexOf(de);ft>-1&&Ce.splice(ft,1)};setTimeout($e,_o)}}function K(X){for(var ee=X.srcEvent.clientX,de=X.srcEvent.clientY,Ce=0;Ce<this.lastTouches.length;Ce++){var $e=this.lastTouches[Ce],ft=Math.abs(ee-$e.x),en=Math.abs(de-$e.y);if(ft<=Ms&&en<=Ms)return!0}return!1}var J=ot(d.style,"touchAction"),ue=J!==s,me="compute",fe="auto",ce="manipulation",ge="none",Me="pan-x",Ue="pan-y",ke=nt();function ht(X,ee){this.manager=X,this.set(ee)}ht.prototype={set:function(X){X==me&&(X=this.compute()),ue&&this.manager.element.style&&ke[X]&&(this.manager.element.style[J]=X),this.actions=X.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var X=[];return z(this.manager.recognizers,function(ee){se(ee.options.enable,[ee])&&(X=X.concat(ee.getTouchAction()))}),pt(X.join(" "))},preventDefaults:function(X){var ee=X.srcEvent,de=X.offsetDirection;if(this.manager.session.prevented){ee.preventDefault();return}var Ce=this.actions,$e=Ve(Ce,ge)&&!ke[ge],ft=Ve(Ce,Ue)&&!ke[Ue],en=Ve(Ce,Me)&&!ke[Me];if($e){var Jn=X.pointers.length===1,Xt=X.distance<2,fr=X.deltaTime<250;if(Jn&&Xt&&fr)return}if(!(en&&ft)&&($e||ft&&de&Hn||en&&de&Mr))return this.preventSrc(ee)},preventSrc:function(X){this.manager.session.prevented=!0,X.preventDefault()}};function pt(X){if(Ve(X,ge))return ge;var ee=Ve(X,Me),de=Ve(X,Ue);return ee&&de?ge:ee||de?ee?Me:Ue:Ve(X,ce)?ce:fe}function nt(){if(!ue)return!1;var X={},ee=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(de){X[de]=ee?e.CSS.supports("touch-action",de):!0}),X}var At=1,xt=2,qt=4,It=8,Lt=It,Qt=16,on=32;function Mn(X){this.options=B({},this.defaults,X||{}),this.id=Qe(),this.manager=null,this.options.enable=he(this.options.enable,!0),this.state=At,this.simultaneous={},this.requireFail=[]}Mn.prototype={defaults:{},set:function(X){return B(this.options,X),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(X){if(S(X,"recognizeWith",this))return this;var ee=this.simultaneous;return X=as(X,this),ee[X.id]||(ee[X.id]=X,X.recognizeWith(this)),this},dropRecognizeWith:function(X){return S(X,"dropRecognizeWith",this)?this:(X=as(X,this),delete this.simultaneous[X.id],this)},requireFailure:function(X){if(S(X,"requireFailure",this))return this;var ee=this.requireFail;return X=as(X,this),He(ee,X)===-1&&(ee.push(X),X.requireFailure(this)),this},dropRequireFailure:function(X){if(S(X,"dropRequireFailure",this))return this;X=as(X,this);var ee=He(this.requireFail,X);return ee>-1&&this.requireFail.splice(ee,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(X){return!!this.simultaneous[X.id]},emit:function(X){var ee=this,de=this.state;function Ce($e){ee.manager.emit($e,X)}de<It&&Ce(ee.options.event+Ln(de)),Ce(ee.options.event),X.additionalEvent&&Ce(X.additionalEvent),de>=It&&Ce(ee.options.event+Ln(de))},tryEmit:function(X){if(this.canEmit())return this.emit(X);this.state=on},canEmit:function(){for(var X=0;X<this.requireFail.length;){if(!(this.requireFail[X].state&(on|At)))return!1;X++}return!0},recognize:function(X){var ee=B({},X);if(!se(this.options.enable,[this,ee])){this.reset(),this.state=on;return}this.state&(Lt|Qt|on)&&(this.state=At),this.state=this.process(ee),this.state&(xt|qt|It|Qt)&&this.tryEmit(ee)},process:function(X){},getTouchAction:function(){},reset:function(){}};function Ln(X){return X&Qt?"cancel":X&It?"end":X&qt?"move":X&xt?"start":""}function Sr(X){return X==or?"down":X==kr?"up":X==In?"left":X==Vn?"right":""}function as(X,ee){var de=ee.manager;return de?de.get(X):X}function jr(){Mn.apply(this,arguments)}j(jr,Mn,{defaults:{pointers:1},attrTest:function(X){var ee=this.options.pointers;return ee===0||X.pointers.length===ee},process:function(X){var ee=this.state,de=X.eventType,Ce=ee&(xt|qt),$e=this.attrTest(X);return Ce&&(de&Kt||!$e)?ee|Qt:Ce||$e?de&jt?ee|It:ee&xt?ee|qt:xt:on}});function pn(){jr.apply(this,arguments),this.pX=null,this.pY=null}j(pn,jr,{defaults:{event:"pan",threshold:10,pointers:1,direction:jn},getTouchAction:function(){var X=this.options.direction,ee=[];return X&Hn&&ee.push(Ue),X&Mr&&ee.push(Me),ee},directionTest:function(X){var ee=this.options,de=!0,Ce=X.distance,$e=X.direction,ft=X.deltaX,en=X.deltaY;return $e&ee.direction||(ee.direction&Hn?($e=ft===0?Wn:ft<0?In:Vn,de=ft!=this.pX,Ce=Math.abs(X.deltaX)):($e=en===0?Wn:en<0?kr:or,de=en!=this.pY,Ce=Math.abs(X.deltaY))),X.direction=$e,de&&Ce>ee.threshold&&$e&ee.direction},attrTest:function(X){return jr.prototype.attrTest.call(this,X)&&(this.state&xt||!(this.state&xt)&&this.directionTest(X))},emit:function(X){this.pX=X.deltaX,this.pY=X.deltaY;var ee=Sr(X.direction);ee&&(X.additionalEvent=this.options.event+ee),this._super.emit.call(this,X)}});function $o(){jr.apply(this,arguments)}j($o,jr,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ge]},attrTest:function(X){return this._super.attrTest.call(this,X)&&(Math.abs(X.scale-1)>this.options.threshold||this.state&xt)},emit:function(X){if(X.scale!==1){var ee=X.scale<1?"in":"out";X.additionalEvent=this.options.event+ee}this._super.emit.call(this,X)}});function Wo(){Mn.apply(this,arguments),this._timer=null,this._input=null}j(Wo,Mn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[fe]},process:function(X){var ee=this.options,de=X.pointers.length===ee.pointers,Ce=X.distance<ee.threshold,$e=X.deltaTime>ee.time;if(this._input=X,!Ce||!de||X.eventType&(jt|Kt)&&!$e)this.reset();else if(X.eventType&Bt)this.reset(),this._timer=I(function(){this.state=Lt,this.tryEmit()},ee.time,this);else if(X.eventType&jt)return Lt;return on},reset:function(){clearTimeout(this._timer)},emit:function(X){this.state===Lt&&(X&&X.eventType&jt?this.manager.emit(this.options.event+"up",X):(this._input.timeStamp=C(),this.manager.emit(this.options.event,this._input)))}});function Pa(){jr.apply(this,arguments)}j(Pa,jr,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ge]},attrTest:function(X){return this._super.attrTest.call(this,X)&&(Math.abs(X.rotation)>this.options.threshold||this.state&xt)}});function Ca(){jr.apply(this,arguments)}j(Ca,jr,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Hn|Mr,pointers:1},getTouchAction:function(){return pn.prototype.getTouchAction.call(this)},attrTest:function(X){var ee=this.options.direction,de;return ee&(Hn|Mr)?de=X.overallVelocity:ee&Hn?de=X.overallVelocityX:ee&Mr&&(de=X.overallVelocityY),this._super.attrTest.call(this,X)&&ee&X.offsetDirection&&X.distance>this.options.threshold&&X.maxPointers==this.options.pointers&&w(de)>this.options.velocity&&X.eventType&jt},emit:function(X){var ee=Sr(X.offsetDirection);ee&&this.manager.emit(this.options.event+ee,X),this.manager.emit(this.options.event,X)}});function vo(){Mn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}j(vo,Mn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ce]},process:function(X){var ee=this.options,de=X.pointers.length===ee.pointers,Ce=X.distance<ee.threshold,$e=X.deltaTime<ee.time;if(this.reset(),X.eventType&Bt&&this.count===0)return this.failTimeout();if(Ce&&$e&&de){if(X.eventType!=jt)return this.failTimeout();var ft=this.pTime?X.timeStamp-this.pTime<ee.interval:!0,en=!this.pCenter||Dn(this.pCenter,X.center)<ee.posThreshold;this.pTime=X.timeStamp,this.pCenter=X.center,!en||!ft?this.count=1:this.count+=1,this._input=X;var Jn=this.count%ee.taps;if(Jn===0)return this.hasRequireFailures()?(this._timer=I(function(){this.state=Lt,this.tryEmit()},ee.interval,this),xt):Lt}return on},failTimeout:function(){return this._timer=I(function(){this.state=on},this.options.interval,this),on},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Lt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ls(X,ee){return ee=ee||{},ee.recognizers=he(ee.recognizers,ls.defaults.preset),new Ma(X,ee)}ls.VERSION="2.0.7",ls.defaults={domEvents:!1,touchAction:me,enable:!0,inputTarget:null,inputClass:null,preset:[[Pa,{enable:!1}],[$o,{enable:!1},["rotate"]],[Ca,{direction:Hn}],[pn,{direction:Hn},["swipe"]],[vo],[vo,{event:"doubletap",taps:2},["tap"]],[Wo]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Ia=1,ka=2;function Ma(X,ee){this.options=B({},ls.defaults,ee||{}),this.options.inputTarget=this.options.inputTarget||X,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=X,this.input=ti(this),this.touchAction=new ht(this,this.options.touchAction),Ll(this,!0),z(this.options.recognizers,function(de){var Ce=this.add(new de[0](de[1]));de[2]&&Ce.recognizeWith(de[2]),de[3]&&Ce.requireFailure(de[3])},this)}Ma.prototype={set:function(X){return B(this.options,X),X.touchAction&&this.touchAction.update(),X.inputTarget&&(this.input.destroy(),this.input.target=X.inputTarget,this.input.init()),this},stop:function(X){this.session.stopped=X?ka:Ia},recognize:function(X){var ee=this.session;if(!ee.stopped){this.touchAction.preventDefaults(X);var de,Ce=this.recognizers,$e=ee.curRecognizer;(!$e||$e&&$e.state&Lt)&&($e=ee.curRecognizer=null);for(var ft=0;ft<Ce.length;)de=Ce[ft],ee.stopped!==ka&&(!$e||de==$e||de.canRecognizeWith($e))?de.recognize(X):de.reset(),!$e&&de.state&(xt|qt|It)&&($e=ee.curRecognizer=de),ft++}},get:function(X){if(X instanceof Mn)return X;for(var ee=this.recognizers,de=0;de<ee.length;de++)if(ee[de].options.event==X)return ee[de];return null},add:function(X){if(S(X,"add",this))return this;var ee=this.get(X.options.event);return ee&&this.remove(ee),this.recognizers.push(X),X.manager=this,this.touchAction.update(),X},remove:function(X){if(S(X,"remove",this))return this;if(X=this.get(X),X){var ee=this.recognizers,de=He(ee,X);de!==-1&&(ee.splice(de,1),this.touchAction.update())}return this},on:function(X,ee){if(X!==s&&ee!==s){var de=this.handlers;return z(xe(X),function(Ce){de[Ce]=de[Ce]||[],de[Ce].push(ee)}),this}},off:function(X,ee){if(X!==s){var de=this.handlers;return z(xe(X),function(Ce){ee?de[Ce]&&de[Ce].splice(He(de[Ce],ee),1):delete de[Ce]}),this}},emit:function(X,ee){this.options.domEvents&&Oc(X,ee);var de=this.handlers[X]&&this.handlers[X].slice();if(!(!de||!de.length)){ee.type=X,ee.preventDefault=function(){ee.srcEvent.preventDefault()};for(var Ce=0;Ce<de.length;)de[Ce](ee),Ce++}},destroy:function(){this.element&&Ll(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Ll(X,ee){var de=X.element;if(!!de.style){var Ce;z(X.options.cssProps,function($e,ft){Ce=ot(de.style,ft),ee?(X.oldCssProps[Ce]=de.style[Ce],de.style[Ce]=$e):de.style[Ce]=X.oldCssProps[Ce]||""}),ee||(X.oldCssProps={})}}function Oc(X,ee){var de=n.createEvent("Event");de.initEvent(X,!0,!0),de.gesture=ee,ee.target.dispatchEvent(de)}B(ls,{INPUT_START:Bt,INPUT_MOVE:fn,INPUT_END:jt,INPUT_CANCEL:Kt,STATE_POSSIBLE:At,STATE_BEGAN:xt,STATE_CHANGED:qt,STATE_ENDED:It,STATE_RECOGNIZED:Lt,STATE_CANCELLED:Qt,STATE_FAILED:on,DIRECTION_NONE:Wn,DIRECTION_LEFT:In,DIRECTION_RIGHT:Vn,DIRECTION_UP:kr,DIRECTION_DOWN:or,DIRECTION_HORIZONTAL:Hn,DIRECTION_VERTICAL:Mr,DIRECTION_ALL:jn,Manager:Ma,Input:kn,TouchAction:ht,TouchInput:qi,MouseInput:Ft,PointerEventInput:Ii,TouchMouseInput:te,SingleTouchInput:Lr,Recognizer:Mn,AttrRecognizer:jr,Tap:vo,Pan:pn,Swipe:Ca,Pinch:$o,Rotate:Pa,Press:Wo,on:ye,off:we,each:z,merge:q,extend:Q,assign:B,inherit:j,bindFn:G,prefixed:ot});var Ks=typeof e<"u"?e:typeof self<"u"?self:{};Ks.Hammer=ls,typeof s=="function"&&s.amd?s(function(){return ls}):t.exports?t.exports=ls:e[r]=ls})(window,document,"Hammer")})(_h);const IU=_h.exports,Mo=mS({__proto__:null,default:IU},[_h.exports]),eI=1,tI=2,ex=4,kU={mousedown:eI,mousemove:tI,mouseup:ex};function MU(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function LU(t){const e=t.prototype.handler;t.prototype.handler=function(r){const s=this.store;r.button>0&&r.type==="pointerdown"&&(MU(s,l=>l.pointerId===r.pointerId)||s.push(r)),e.call(this,r)}}function RU(t){t.prototype.handler=function(n){let r=kU[n.type];r&eI&&n.button>=0&&(this.pressed=!0),r&tI&&n.which===0&&(r=ex),this.pressed&&(r&ex&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}LU(_h.exports.PointerEventInput);RU(_h.exports.MouseInput);const OU=_h.exports.Manager;class yy{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const DU=Mo?[[Mo.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Mo.Rotate,{enable:!1}],[Mo.Pinch,{enable:!1}],[Mo.Swipe,{enable:!1}],[Mo.Pan,{threshold:0,enable:!1}],[Mo.Press,{enable:!1}],[Mo.Tap,{event:"doubletap",taps:2,enable:!1}],[Mo.Tap,{event:"anytap",enable:!1}],[Mo.Tap,{enable:!1}]]:null,nT={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},zU={doubletap:["tap"]},FU={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},M1={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},BU={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},rT={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},NU=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Du=typeof window<"u"?window:global;let tx=!1;try{const t={get passive(){return tx=!0,!0}};Du.addEventListener("test",null,t),Du.removeEventListener("test",null)}catch{tx=!1}const UU=NU.indexOf("firefox")!==-1,{WHEEL_EVENTS:VU}=M1,iT="wheel",sT=4.000244140625,jU=40,GU=.25;class $U extends yy{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{if(!this.options.enable)return;let l=s.deltaY;Du.WheelEvent&&(UU&&s.deltaMode===Du.WheelEvent.DOM_DELTA_PIXEL&&(l/=Du.devicePixelRatio),s.deltaMode===Du.WheelEvent.DOM_DELTA_LINE&&(l*=jU)),l!==0&&l%sT===0&&(l=Math.floor(l/sT)),s.shiftKey&&l&&(l=l*GU),this.callback({type:iT,center:{x:s.clientX,y:s.clientY},delta:-l,srcEvent:s,pointerType:"mouse",target:s.target})},this.events=(this.options.events||[]).concat(VU),this.events.forEach(s=>e.addEventListener(s,this.handleEvent,tx?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===iT&&(this.options.enable=n)}}const{MOUSE_EVENTS:WU}=M1,oT="pointermove",aT="pointerover",lT="pointerout",cT="pointerenter",uT="pointerleave";class HU extends yy{constructor(e,n,r){super(e,n,r),this.handleEvent=l=>{this.handleOverEvent(l),this.handleOutEvent(l),this.handleEnterEvent(l),this.handleLeaveEvent(l),this.handleMoveEvent(l)},this.pressed=!1;const{enable:s}=this.options;this.enableMoveEvent=s,this.enableLeaveEvent=s,this.enableEnterEvent=s,this.enableOutEvent=s,this.enableOverEvent=s,this.events=(this.options.events||[]).concat(WU),this.events.forEach(l=>e.addEventListener(l,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===oT&&(this.enableMoveEvent=n),e===aT&&(this.enableOverEvent=n),e===lT&&(this.enableOutEvent=n),e===cT&&(this.enableEnterEvent=n),e===uT&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(aT,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(lT,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(cT,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(uT,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(oT,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:qU}=M1,hT="keydown",dT="keyup";class XU extends yy{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{const l=s.target||s.srcElement;l.tagName==="INPUT"&&l.type==="text"||l.tagName==="TEXTAREA"||(this.enableDownEvent&&s.type==="keydown"&&this.callback({type:hT,srcEvent:s,key:s.key,target:s.target}),this.enableUpEvent&&s.type==="keyup"&&this.callback({type:dT,srcEvent:s,key:s.key,target:s.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(qU),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===hT&&(this.enableDownEvent=n),e===dT&&(this.enableUpEvent=n)}}const fT="contextmenu";class ZU extends yy{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{!this.options.enable||this.callback({type:fT,center:{x:s.clientX,y:s.clientY},srcEvent:s,pointerType:"mouse",target:s.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===fT&&(this.options.enable=n)}}const nx=1,jg=2,rx=4,YU={pointerdown:nx,pointermove:jg,pointerup:rx,mousedown:nx,mousemove:jg,mouseup:rx},KU=1,JU=2,QU=3,eV=0,tV=1,nV=2,rV=1,iV=2,sV=4;function oV(t){const e=YU[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:s}=t.srcEvent;let l=!1,d=!1,c=!1;return e===rx||e===jg&&!Number.isFinite(n)?(l=s===KU,d=s===JU,c=s===QU):e===jg?(l=Boolean(n&rV),d=Boolean(n&sV),c=Boolean(n&iV)):e===nx&&(l=r===eV,d=r===tV,c=r===nV),{leftButton:l,middleButton:d,rightButton:c}}function aV(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),s=r.width/e.offsetWidth||1,l=r.height/e.offsetHeight||1,d={x:(n.x-r.left-e.clientLeft)/s,y:(n.y-r.top-e.clientTop)/l};return{center:n,offsetCenter:d}}const I0={srcElement:"root",priority:0};class lV{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let s=n.srcEvent.target;for(;s&&s!==r.rootElement;){if(this._emit(r,s),r.handled)return;s=s.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,s=!1,l=!1){const{handlers:d,handlersByElement:c}=this;let v=I0;typeof r=="string"||r&&r.addEventListener?v={...I0,srcElement:r}:r&&(v={...I0,...r});let w=c.get(v.srcElement);w||(w=[],c.set(v.srcElement,w));const C={type:e,handler:n,srcElement:v.srcElement,priority:v.priority};s&&(C.once=!0),l&&(C.passive=!0),d.push(C),this._active=this._active||!C.passive;let I=w.length-1;for(;I>=0&&!(w[I].priority>=C.priority);)I--;w.splice(I+1,0,C)}remove(e,n){const{handlers:r,handlersByElement:s}=this;for(let l=r.length-1;l>=0;l--){const d=r[l];if(d.type===e&&d.handler===n){r.splice(l,1);const c=s.get(d.srcElement);c.splice(c.indexOf(d),1),c.length===0&&s.delete(d.srcElement)}}this._active=r.some(l=>!l.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let s=!1;const l=()=>{e.handled=!0},d=()=>{e.handled=!0,s=!0},c=[];for(let v=0;v<r.length;v++){const{type:w,handler:C,once:I}=r[v];if(C({...e,type:w,stopPropagation:l,stopImmediatePropagation:d}),I&&c.push(r[v]),s)break}for(let v=0;v<c.length;v++){const{type:w,handler:C}=c[v];this.remove(w,C)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...oV(e),...aV(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const cV={events:null,recognizers:null,recognizerOptions:{},Manager:OU,touchAction:"none",tabIndex:0};class uV{constructor(e=null,n){this._onBasicInput=s=>{const{srcEvent:l}=s,d=FU[l.type];d&&this.manager.emit(d,s)},this._onOtherEvent=s=>{this.manager.emit(s.type,s)},this.options={...cV,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||DU}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(nT).forEach(s=>{const l=this.manager.get(s);l&&nT[s].forEach(d=>{l.recognizeWith(d)})});for(const s in n.recognizerOptions){const l=this.manager.get(s);if(l){const d=n.recognizerOptions[s];delete d.enable,l.set(d)}}this.wheelInput=new $U(e,this._onOtherEvent,{enable:!1}),this.moveInput=new HU(e,this._onOtherEvent,{enable:!1}),this.keyInput=new XU(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new ZU(e,this._onOtherEvent,{enable:!1});for(const[s,l]of this.events)l.isEmpty()||(this._toggleRecognizer(l.recognizerName,!0),this.manager.on(s,l.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const s=r.get(e);if(s&&s.options.enable!==n){s.set({enable:n});const l=zU[e];l&&!this.options.recognizers&&l.forEach(d=>{const c=r.get(d);n?(c.requireFailure(e),s.dropRequireFailure(d)):c.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,s,l){if(typeof e!="string"){r=n;for(const C in e)this._addEventHandler(C,e[C],r,s,l);return}const{manager:d,events:c}=this,v=rT[e]||e;let w=c.get(v);w||(w=new lV(this),c.set(v,w),w.recognizerName=BU[v]||v,d&&d.on(v,w.handleEvent)),w.add(e,n,r,s,l),w.isEmpty()||this._toggleRecognizer(w.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const d in e)this._removeEventHandler(d,e[d]);return}const{events:r}=this,s=rT[e]||e,l=r.get(s);if(!!l&&(l.remove(e,n),l.isEmpty())){const{recognizerName:d}=l;let c=!1;for(const v of r.values())if(v.recognizerName===d&&!v.isEmpty()){c=!0;break}c||this._toggleRecognizer(d,!1)}}}function oc(){}const hV=({isDragging:t})=>t?"grabbing":"grab",nI={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:oc,onResize:oc,onViewStateChange:oc,onInteractionStateChange:oc,onBeforeRender:oc,onAfterRender:oc,onLoad:oc,onError:t=>Bn.error(t.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:hV,getTooltip:null,debug:!1,drawPickingColors:!1};class _y{constructor(e){W(this,"props",void 0),W(this,"width",0),W(this,"height",0),W(this,"userData",{}),W(this,"canvas",null),W(this,"viewManager",null),W(this,"layerManager",null),W(this,"effectManager",null),W(this,"deckRenderer",null),W(this,"deckPicker",null),W(this,"eventManager",null),W(this,"tooltip",null),W(this,"metrics",void 0),W(this,"animationLoop",void 0),W(this,"stats",void 0),W(this,"viewState",void 0),W(this,"cursorState",void 0),W(this,"_needsRedraw",void 0),W(this,"_pickRequest",void 0),W(this,"_lastPointerDownInfo",null),W(this,"_metricsCounter",void 0),W(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const s=n.offsetCenter;if(!s)return;r.x=s.x,r.y=s.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),W(this,"_onEvent",n=>{const r=j2[n.type],s=n.offsetCenter;if(!r||!s||!this.layerManager)return;const l=this.layerManager.getLayers(),d=this.deckPicker.getLastPickedObject({x:s.x,y:s.y,layers:l,viewports:this.getViewports(s)},this._lastPointerDownInfo),{layer:c}=d,v=c&&(c[r.handler]||c.props[r.handler]),w=this.props[r.handler];let C=!1;v&&(C=v.call(c,d,n)),!C&&w&&w(d,n)}),W(this,"_onPointerDown",n=>{const r=n.offsetCenter,s=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=s.result[0]||s.emptyInfo}),this.props={...nI,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&Bn.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),OP()==="IE"&&Bn.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new f1({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Sf.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,s,l,d,c;if(this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(e=this.layerManager)===null||e===void 0||e.finalize(),this.layerManager=null,(n=this.viewManager)===null||n===void 0||n.finalize(),this.viewManager=null,(r=this.effectManager)===null||r===void 0||r.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(l=this.deckPicker)===null||l===void 0||l.finalize(),this.deckPicker=null,(d=this.eventManager)===null||d===void 0||d.destroy(),this.eventManager=null,(c=this.tooltip)===null||c===void 0||c.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var v;(v=this.canvas.parentElement)===null||v===void 0||v.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Bn.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Bn.removed("onLayerClick","onClick")(),e.initialViewState&&!yh(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),s=this.layerManager.needsRedraw(e),l=this.effectManager.needsRedraw(e),d=this.deckRenderer.needsRedraw(e);return n=n||r||s||l||d,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return ui(this.viewManager),this.viewManager.views}getViewports(e){return ui(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_pick(e,n,r){ui(this.deckPicker);const{stats:s}=this;s.get("Pick Count").incrementCount(),s.get(n).timeStart();const l=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return s.get(n).timeEnd(),l}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),ui(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const l=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=l}if(r||r===0){var s;const l=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((s=e.style)===null||s===void 0?void 0:s.position)||"absolute",this.canvas.style.height=l}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const n=e.clientWidth||e.width,r=e.clientHeight||e.height;if(n!==this.width||r!==this.height){var s;this.width=n,this.height=r,(s=this.viewManager)===null||s===void 0||s.setProps({width:n,height:r}),this.props.onResize({width:n,height:r})}}_createAnimationLoop(e){const{width:n,height:r,gl:s,glOptions:l,debug:d,onError:c,onBeforeRender:v,onAfterRender:w,useDevicePixels:C}=e;return new uF({width:n,height:r,useDevicePixels:C,autoResizeViewport:!1,gl:s,onCreateContext:I=>eC({...l,...I,canvas:this.canvas,debug:d,onContextLost:()=>this._onContextLost()}),onInitialize:I=>this._setGLContext(I.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:v,onAfterRender:w,onError:c})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new ZC({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:s}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let l=s,d=!1;for(const c of r){var n;l=c,d=((n=c.layer)===null||n===void 0?void 0:n.onHover(c,e.event))||d}if(!d&&this.props.onHover&&this.props.onHover(l,e.event),this.props.getTooltip&&this.tooltip){const c=this.props.getTooltip(l);this.tooltip.setTooltip(c,l.x,l.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,x1(e,{enable:!0,copyState:!0})),this.tooltip=new CU(this.canvas),xa(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new LC;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new uV(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const s in j2)this.eventManager.on(s,this._onEvent);this.viewManager=new W6({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new $6(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new mU,this.deckRenderer=new xU(e),this.deckPicker=new AU(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;xa(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Bn.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=mc.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}W(_y,"defaultProps",nI);W(_y,"VERSION",mz.VERSION);class k0{constructor(e,n){W(this,"opts",void 0),W(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:s}=n;let l=r;if(r&&r.length!==s){l=new Float32Array(s);const d=n.elementOffset||0;for(let c=0;c<s;++c)l[c]=r[d+c]}return l}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function dV(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function Jm(t){return t.stride||t.size*t.bytesPerElement}function rI(t,e){e.offset&&Bn.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Jm(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,s=e.elementOffset||0,l=r*n+s*t.bytesPerElement+(t.offset||0);return{...e,offset:l,stride:n}}function fV(t,e){const n=rI(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class pV{constructor(e,n,r){W(this,"gl",void 0),W(this,"id",void 0),W(this,"size",void 0),W(this,"settings",void 0),W(this,"value",void 0),W(this,"doublePrecision",void 0),W(this,"_buffer",void 0),W(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const s=n.logicalType||n.type,l=s===5130;let{defaultValue:d}=n;d=Number.isFinite(d)?[d]:d||new Array(this.size).fill(0);let c;l?c=5126:!s&&n.isIndexed?c=e&&U4(e,hr.ELEMENT_INDEX_UINT32)?5125:5123:c=s||5126;let v=dV(s||c||5126);this.doublePrecision=l,l&&n.fp64===!1&&(v=Float32Array),this.value=null,this.settings={...n,defaultType:v,defaultValue:d,logicalType:s,type:c,size:this.size,bytesPerElement:v.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new Kn(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Jm(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Sf.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},s=this.value instanceof Float64Array,l=fV(this.getAccessor(),n||{});return r[e]=new k0(this,l.high),r["".concat(e,"64Low")]=s?new k0(this,l.low):new Float32Array(this.size),r}if(n){const r=rI(this.getAccessor(),n);return{[e]:new k0(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:s}=this,l=r*s;if(n&&l&&n.length>=l){const d=new Array(s).fill(1/0),c=new Array(s).fill(-1/0);for(let v=0;v<l;)for(let w=0;w<s;w++){const C=n[v++];C<d[w]&&(d[w]=C),C>c[w]&&(c[w]=C)}e=[d,c]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof Kn?r={buffer:e}:r=e;const s={...this.settings,...r};if(n.bufferAccessor=s,n.bounds=null,r.constant){let l=r.value;if(l=this._normalizeValue(l,[],0),this.settings.normalized&&(l=this.normalizeConstant(l)),!(!n.constant||!this._areValuesEqual(l,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=l}else if(r.buffer){const l=r.buffer;n.externalBuffer=l,n.constant=!1,this.value=r.value||null;const d=r.value instanceof Float64Array;s.type=r.type||l.accessor.type,s.bytesPerElement=l.accessor.BYTES_PER_ELEMENT*(d?2:1),s.stride=Jm(s)}else if(r.value){this._checkExternalBuffer(r);let l=r.value;n.externalBuffer=null,n.constant=!1,this.value=l,s.bytesPerElement=l.BYTES_PER_ELEMENT,s.stride=Jm(s);const{buffer:d,byteOffset:c}=this;this.doublePrecision&&l instanceof Float64Array&&(l=P0(l,s));const v=l.byteLength+c+s.stride*2;d.byteLength<v&&d.reallocate(v),d.setAccessor(null),d.subData({data:l,offset:c}),s.type=r.type||d.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:s}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?P0(n,{size:this.size,startIndex:r,endIndex:s}):n.subarray(r,s),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,s=r.allocatedValue,l=Sf.allocate(s,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=l;const{buffer:d,byteOffset:c}=this;return d.byteLength<l.byteLength+c&&(d.reallocate(l.byteLength+c),n&&s&&d.subData({data:s instanceof Float64Array?P0(s,this):s,offset:c})),r.allocatedValue=l,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let s=!1;if(this.doublePrecision&&(s=n.BYTES_PER_ELEMENT<4),s)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&Bn.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:s,size:l}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e)return n[r]=s[0],n;switch(l){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:s[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:s[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:s[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:s[0];break;default:let d=l;for(;--d>=0;)n[r+d]=Number.isFinite(e[d])?e[d]:s[d]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let s=0;s<r;s++)if(e[s]!==n[s])return!1;return!0}}const pT=[],mT=[];function iI(t,e=0,n=1/0){let r=pT;const s={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(mT.length=t.length,r=mT):r=pT,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),s.index=e-1),{iterable:r,objectInfo:s}}function sI(t){return t&&t[Symbol.asyncIterator]}function mV(t,e){const{size:n,stride:r,offset:s,startIndices:l,nested:d}=e,c=t.BYTES_PER_ELEMENT,v=r?r/c:n,w=s?s/c:0,C=Math.floor((t.length-w)/v);return(I,{index:S,target:z})=>{if(!l){const q=S*v+w;for(let j=0;j<n;j++)z[j]=t[q+j];return z}const F=l[S],B=l[S+1]||C;let Q;if(d){Q=new Array(B-F);for(let q=F;q<B;q++){const j=q*v+w;z=new Array(n);for(let G=0;G<n;G++)z[G]=t[j+G];Q[q-F]=z}}else if(v===n)Q=t.subarray(F*n+w,B*n+w);else{Q=new t.constructor((B-F)*n);let q=0;for(let j=F;j<B;j++){const G=j*v+w;for(let se=0;se<n;se++)Q[q++]=t[G+se]}}return Q}}const gV=[],Qm=[[0,1/0]];function yV(t,e){if(t===Qm||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let s=0;for(let l=0;l<r;l++){const d=t[l];d[1]<e[0]?(n.push(d),s=l+1):d[0]>e[1]?n.push(d):e=[Math.min(d[0],e[0]),Math.max(d[1],e[1])]}return n.splice(s,0,e),n}function M0(t){const{source:e,target:n,start:r=0,size:s,getData:l}=t,d=t.end||n.length,c=e.length,v=d-r;if(c>v){n.set(e.subarray(0,v),r);return}if(n.set(e,r),!l)return;let w=c;for(;w<v;){const C=l(w,e);for(let I=0;I<s;I++)n[r+w]=C[I]||0,w++}}function _V({source:t,target:e,size:n,getData:r,sourceStartIndices:s,targetStartIndices:l}){if(!Array.isArray(l))return M0({source:t,target:e,size:n,getData:r}),e;let d=0,c=0;const v=r&&((C,I)=>r(C+c,I)),w=Math.min(s.length,l.length);for(let C=1;C<w;C++){const I=s[C]*n,S=l[C]*n;M0({source:t.subarray(d,I),target:e,start:c,end:S,size:n,getData:v}),d=I,c=S}return c<e.length&&M0({source:[],target:e,start:c,size:n,getData:v}),e}const vV={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function oI(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...vV[n],...e,...t,type:n}}function aI(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function lI(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function cI(t){t.push(t.shift())}function L1(t,e){const{doublePrecision:n,settings:r,value:s,size:l}=t,d=n&&s instanceof Float64Array?2:1;return(r.noAlloc?s.length:e*l)*d}function uI({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:s,getData:l=d=>d}){const d=n.doublePrecision&&n.value instanceof Float64Array?2:1,c=n.size*d,v=n.byteOffset,w=n.startIndices,C=s&&w,I=L1(n,e),S=n.isConstant;if(!C&&r>=I)return;const z=S?n.value:n.getBuffer().getData({srcByteOffset:v});if(n.settings.normalized&&!S){const q=l;l=(j,G)=>n.normalizeConstant(q(j,G))}const F=S?(q,j)=>l(z,j):(q,j)=>l(z.subarray(q,q+c),j),B=t.getData({length:r}),Q=new Float32Array(I);_V({source:B,target:Q,sourceStartIndices:s,targetStartIndices:w,size:c,getData:F}),t.byteLength<Q.byteLength+v&&t.reallocate(Q.byteLength+v),t.subData({data:Q,offset:v})}class R1 extends pV{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:Qm}),W(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,s=Array.isArray(n)?e[n.find(l=>e[l])]:e[n];return oI(s,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:s=1/0}=n;this.state.updateRanges=yV(this.state.updateRanges,[r,s])}else this.state.updateRanges=Qm}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=gV}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==Qm),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:s}){if(!this.needsUpdate())return!1;const{state:{updateRanges:l},settings:{update:d,noAlloc:c}}=this;let v=!0;if(d){for(const[w,C]of l)d.call(s,this,{data:n,startRow:w,endRow:C,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[w,C]of l){const I=Number.isFinite(w)?this.getVertexOffset(w):0,S=Number.isFinite(C)?this.getVertexOffset(C):c||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:I,endOffset:S})}this._checkAttributeArray()}else v=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),v}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:s}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(s.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),s.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const d=e;ui(ArrayBuffer.isView(d.value),"invalid ".concat(s.accessor));const c=Boolean(d.size)&&d.size!==this.size;return r.binaryAccessor=mV(d.value,{size:d.size||this.size,stride:d.stride,offset:d.offset,startIndices:n,nested:c}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?n[e]:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:s,props:l,numInstances:d}){if(e.constant)return;const{settings:c,state:v,value:w,size:C,startIndices:I}=e,{accessor:S,transform:z}=c,F=v.binaryAccessor||(typeof S=="function"?S:l[S]);ui(typeof F=="function",'accessor "'.concat(S,'" is not a function'));let B=e.getVertexOffset(r);const{iterable:Q,objectInfo:q}=iI(n,r,s);for(const j of Q){q.index++;let G=F(j,q);if(z&&(G=z.call(this,G)),I){const se=(q.index<I.length-1?I[q.index+1]:d)-I[q.index];if(G&&Array.isArray(G[0])){let he=B;for(const ye of G)e._normalizeValue(ye,w,he),he+=C}else G&&G.length>C?w.set(G,B):(e._normalizeValue(G,q.target,0),N6({target:w,source:q.target,start:B,count:se}));B+=se*C}else e._normalizeValue(G,w,B),B+=C}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class xV{constructor({gl:e,attribute:n,timeline:r}){W(this,"gl",void 0),W(this,"type","interpolation"),W(this,"attributeInTransition",void 0),W(this,"settings",void 0),W(this,"attribute",void 0),W(this,"transition",void 0),W(this,"currentStartIndices",void 0),W(this,"currentLength",void 0),W(this,"transform",void 0),W(this,"buffers",void 0),this.gl=e,this.transition=new qf(r),this.attribute=n,this.attributeInTransition=new R1(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=wV(e,n);const s={byteLength:0,usage:35050};this.buffers=[new Kn(e,s),new Kn(e,s)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:s,attribute:l}=this;cI(s);const d={numInstances:n,attribute:l,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const c of s)uI({buffer:c,...d});this.currentStartIndices=l.startIndices,this.currentLength=L1(l,n),this.attributeInTransition.setData({buffer:s[1],value:l.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/l.size),sourceBuffers:{aFrom:s[0],aTo:aI(r,l)},feedbackBuffers:{vCurrent:s[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:s}=this.transition;let l=s/n;r&&(l=r(l)),this.transform.run({uniforms:{time:l}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const bV=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function wV(t,e){const n=lI(e.size);return new P1(t,{vs:bV,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class EV{constructor({gl:e,attribute:n,timeline:r}){W(this,"gl",void 0),W(this,"type","spring"),W(this,"attributeInTransition",void 0),W(this,"settings",void 0),W(this,"attribute",void 0),W(this,"transition",void 0),W(this,"currentStartIndices",void 0),W(this,"currentLength",void 0),W(this,"texture",void 0),W(this,"framebuffer",void 0),W(this,"transform",void 0),W(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new qf(r),this.attribute=n,this.attributeInTransition=new R1(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=SV(e),this.framebuffer=AV(e,this.texture),this.transform=TV(e,n,this.framebuffer);const s={byteLength:0,usage:35050};this.buffers=[new Kn(e,s),new Kn(e,s),new Kn(e,s)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:s,attribute:l}=this,d={numInstances:n,attribute:l,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const c of s)uI({buffer:c,...d});this.settings=e,this.currentStartIndices=l.startIndices,this.currentLength=L1(l,n),this.attributeInTransition.setData({buffer:s[1],value:l.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/l.size),sourceBuffers:{aTo:aI(r,l)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:s}=this;if(!s.update())return!1;const d=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:d.stiffness,damping:d.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),cI(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),fy(r)[0]>0||s.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function TV(t,e,n){const r=lI(e.size);return new P1(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function SV(t){return new Gi(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function AV(t,e){return new Ur(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{[36064]:e}})}const PV={interpolation:xV,spring:EV};class CV{constructor(e,{id:n,timeline:r}){W(this,"id",void 0),W(this,"isSupported",void 0),W(this,"gl",void 0),W(this,"timeline",void 0),W(this,"transitions",void 0),W(this,"needsRedraw",void 0),W(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=P1.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const s in e){const l=e[s],d=l.getTransitionSetting(n);!d||this._updateAttribute(s,l,d)}for(const s in this.transitions){const l=e[s];(!l||!l.getTransitionSetting(n))&&this._removeTransition(s)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const s=this.transitions[e];let l=!s||s.type!==r.type;if(l){if(!this.isSupported){Bn.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}s&&this._removeTransition(e);const d=PV[r.type];d?this.transitions[e]=new d({attribute:n,timeline:this.timeline,gl:this.gl}):(Bn.error("unsupported transition type '".concat(r.type,"'"))(),l=!1)}(l||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const gT="attributeManager.invalidate",IV="attributeManager.updateStart",kV="attributeManager.updateEnd",MV="attribute.updateStart",LV="attribute.allocate",RV="attribute.updateEnd";class OV{constructor(e,{id:n="attribute-manager",stats:r,timeline:s}={}){W(this,"id",void 0),W(this,"gl",void 0),W(this,"attributes",void 0),W(this,"updateTriggers",void 0),W(this,"needsRedraw",void 0),W(this,"userData",void 0),W(this,"stats",void 0),W(this,"attributeTransitionManager",void 0),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new CV(e,{id:"".concat(n,"-transitions"),timeline:s}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);Ui(gT,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);Ui(gT,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:s,props:l={},buffers:d={},context:c={}}){let v=!1;Ui(IV,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const w in this.attributes){const C=this.attributes[w],I=C.settings.accessor;C.startIndices=r,C.numInstances=n,l[w]&&Bn.removed("props.".concat(w),"data.attributes.".concat(w))(),C.setExternalBuffer(d[w])||C.setBinaryValue(typeof I=="string"?d[I]:void 0,e.startIndices)||typeof I=="string"&&!d[I]&&C.setConstantValue(l[I])||C.needsUpdate()&&(v=!0,this._updateAttribute({attribute:C,numInstances:n,data:e,props:l,context:c})),this.needsRedraw=this.needsRedraw||C.needsRedraw()}v&&Ui(kV,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:s})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,s={...r.getAttributes()};for(const l in n){const d=n[l];d.needsRedraw(e)&&!r.hasAttribute(l)&&(s[l]=d)}return s}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const s in e)n[s]||Object.assign(r,e[s].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const s=e[r];this.attributes[r]=this._createAttribute(r,s,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const s={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new R1(this.gl,s)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(s=>{e[s]||(e[s]=[]),e[s].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:s}=this,l=s[e];return l&&l.forEach(d=>{const c=r[d];c&&c.setNeedsUpdate(c.id,n)}),l}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(Ui(MV,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&Ui(LV,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,Ui(RV,n,r))}}class DV extends qf{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:s,easing:l}}=this,d=l(e/s);this._value=Dg(n,r,d)}}const yT=1e-5;function _T(t,e,n,r,s){const l=e-t,c=(n-e)*s,v=-l*r;return c+v+l+e}function zV(t,e,n,r,s){if(Array.isArray(n)){const l=[];for(let d=0;d<n.length;d++)l[d]=_T(t[d],e[d],n[d],r,s);return l}return _T(t,e,n,r,s)}function vT(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const s=t[r]-e[r];n+=s*s}return Math.sqrt(n)}return Math.abs(t-e)}class FV extends qf{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:s}=this.settings,{_prevValue:l=e,_currValue:d=e}=this;let c=zV(l,d,n,r,s);const v=vT(c,n),w=vT(c,d);v<yT&&w<yT&&(c=n,this.end()),this._prevValue=d,this._currValue=c}}const BV={interpolation:DV,spring:FV};class NV{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,s){const{transitions:l}=this;if(l.has(e)){const v=l.get(e),{value:w=v.settings.fromValue}=v;n=w,this.remove(e)}if(s=oI(s),!s)return;const d=BV[s.type];if(!d){Bn.error("unsupported transition type '".concat(s.type,"'"))();return}const c=new d(this.timeline);c.start({...s,fromValue:n,toValue:r}),l.set(e,c)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function UV(t){const e=O1(t);for(const n in e){const r=e[n],{validate:s}=r;if(s&&!s(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function VV(t,e){const n=hI({newProps:t,oldProps:e,propTypes:O1(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=GV(t,e);let s=!1;return r||(s=$V(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:s,extensionsChanged:WV(t,e),transitionsChanged:jV(t,e)}}function jV(t,e){if(!t.transitions)return!1;const n={},r=O1(t);let s=!1;for(const l in t.transitions){const d=r[l],c=d&&d.type;(c==="number"||c==="color"||c==="array")&&ix(t[l],e[l],d)&&(n[l]=!0,s=!0)}return s?n:!1}function hI({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:s="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(s," changed shallowly");for(const l of Object.keys(t))if(!(l in n)){if(!(l in e))return"".concat(s,".").concat(l," added");const d=ix(t[l],e[l],r[l]);if(d)return"".concat(s,".").concat(l," ").concat(d)}for(const l of Object.keys(e))if(!(l in n)){if(!(l in t))return"".concat(s,".").concat(l," dropped");if(!Object.hasOwnProperty.call(t,l)){const d=ix(t[l],e[l],r[l]);if(d)return"".concat(s,".").concat(l," ").concat(d)}}return!1}function ix(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function GV(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:s}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&s&&(n=s(t.data,e.data)||n),n}function $V(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&xT(t,e,"all"))return{all:!0};const n={};let r=!1;for(const s in t.updateTriggers)s!=="all"&&xT(t,e,s)&&(n[s]=!0,r=!0);return r?n:!1}function WV(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let s=0;s<r.length;s++)if(!r[s].equals(n[s]))return!0;return!1}function xT(t,e,n){let r=t.updateTriggers[n];r=r==null?{}:r;let s=e.updateTriggers[n];return s=s==null?{}:s,hI({oldProps:s,newProps:r,triggerName:n})}function O1(t){const e=t[Vg],n=e&&e.constructor;return n?n._propTypes:{}}const HV="count(): argument not an object",qV="count(): argument not a container";function XV(t){if(!YV(t))throw new Error(HV);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(ZV(t))return Object.keys(t).length;throw new Error(qV)}function ZV(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function YV(t){return t!==null&&typeof t=="object"}function KV(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(s=>s.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const s in e.inject)r[s]=(r[s]||"")+e.inject[s];n.inject=r}return n}const JV={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071},sx={};function QV(t,e){const n=t.context&&t.context.gl;if(!n||!e)return null;if(e instanceof Gi)return e;e.constructor&&e.constructor.name!=="Object"&&(e={data:e});let r=null;e.compressed&&(r={[10241]:e.data.length>1?9985:9729});const s=new Gi(n,{...e,parameters:{...JV,...r,...t.props.textureParameters}});return sx[s.id]=!0,s}function e8(t){!t||!(t instanceof Gi)||sx[t.id]&&(t.delete(),delete sx[t.id])}const t8={boolean:{validate(t,e){return!0},equal(t,e,n){return Boolean(t)===Boolean(e)}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||Af(t)&&(t.length===3||t.length===4)},equal(t,e,n){return L0(t,e)}},accessor:{validate(t,e){const n=Gg(t);return n==="function"||n===Gg(e.value)},equal(t,e,n){return typeof e=="function"?!0:L0(t,e)}},array:{validate(t,e){return e.optional&&!t||Af(t)},equal(t,e,n){return n.compare?L0(t,e):t===e}},object:{equal(t,e,n){return n.compare?yh(t,e):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>QV(n,t),release:t=>{e8(t)}}};function L0(t,e){if(t===e)return!0;if(!Af(t)||!Af(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function n8(t){const e={},n={},r={};for(const[s,l]of Object.entries(t)){const d=l==null?void 0:l.deprecatedFor;if(d)r[s]=Array.isArray(d)?d:[d];else{const c=r8(s,l);e[s]=c,n[s]=c.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function r8(t,e){switch(Gg(e)){case"object":return Ad(t,e);case"array":return Ad(t,{type:"array",value:e,compare:!1});case"boolean":return Ad(t,{type:"boolean",value:e});case"number":return Ad(t,{type:"number",value:e});case"function":return Ad(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Ad(t,e){return"type"in e?{name:t,...t8[e.type],...e}:"value"in e?{name:t,type:Gg(e.value),...e}:{name:t,type:"object",value:e}}function Af(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Gg(t){return Af(t)?"array":t===null?"null":typeof t}function i8(t,e){const n=dI(t.constructor),r=Object.create(n);r[Vg]=t,r[Sc]={},r[ol]={};for(let s=0;s<e.length;++s){const l=e[s];for(const d in l)r[d]=l[d]}return Object.freeze(r),r}function dI(t){const e=$g(t,"_mergedDefaultProps");return e||(s8(t),t._mergedDefaultProps)}function s8(t){if(!t.prototype)return;const n=Object.getPrototypeOf(t),r=dI(n),s=$g(t,"defaultProps")||{},l=n8(s),d=o8(l.defaultProps,r,t),c={...n._propTypes,...l.propTypes};l8(d,c);const v={...n._deprecatedProps,...l.deprecatedProps};a8(d,v),t._mergedDefaultProps=d,t._propTypes=c,t._deprecatedProps=v}function o8(t,e,n){const r=Object.create(null);Object.assign(r,e,t);const s=u8(n);return delete t.id,Object.defineProperties(r,{id:{writable:!0,value:s}}),r}function a8(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const s="".concat(this.id,": ").concat(n);for(const l of e[n])fI(this,l)||(this[l]=r);Bn.deprecated(s,e[n].join("/"))()}})}function l8(t,e){const n={},r={};for(const s in e){const l=e[s],{name:d,value:c}=l;l.async&&(n[d]=c,r[d]=c8(d))}t[Wu]=n,t[Sc]={},Object.defineProperties(t,r)}function c8(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||sI(e)?this[Sc][t]=e:this[ol][t]=e},get(){if(this[ol]){if(t in this[ol])return this[ol][t]||this[Wu][t];if(t in this[Sc]){const e=this[Vg]&&this[Vg].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Wu][t]}}return this[Wu][t]}}}function fI(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function $g(t,e){return fI(t,e)&&t[e]}function u8(t){const e=$g(t,"layerName")||$g(t,"componentName");return e||Bn.once(0,"".concat(t.name,".componentName not specified"))(),e||t.name}let h8=0;class D1{constructor(...e){W(this,"id",void 0),W(this,"props",void 0),W(this,"count",void 0),this.props=i8(this,e),this.id=this.props.id,this.count=h8++}clone(e){const{props:n}=this,r={};for(const s in n[Wu])s in n[ol]?r[s]=n[ol][s]:s in n[Sc]&&(r[s]=n[Sc][s]);return new this.constructor({...n,...r,...e})}}W(D1,"componentName","Component");W(D1,"defaultProps",{});const d8=Object.freeze({});class f8{constructor(e){W(this,"component",void 0),W(this,"onAsyncPropUpdated",void 0),W(this,"asyncProps",void 0),W(this,"oldProps",void 0),W(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps||d8}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return Boolean(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){const n=e[ol]||{},r=e[Sc]||e,s=e[Wu]||{};for(const l in n){const d=n[l];this._createAsyncPropData(l,s[l]),this._updateAsyncProp(l,d),n[l]=this.getAsyncProp(l)}for(const l in r){const d=r[l];this._createAsyncPropData(l,s[l]),this._updateAsyncProp(l,d)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(!!this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(sI(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const s=this.asyncProps[e];s&&r>=s.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),s.resolvedValue=n,s.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const s=r.pendingLoadCount;n.then(l=>{l=this._postProcessValue(r,l),this._setAsyncPropValue(e,l,s),this._onResolve(e,l)}).catch(l=>{this._onError(e,l)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const s=r.pendingLoadCount;let l=[],d=0;for await(const c of n){const{dataTransform:v}=this.component.props;v?l=v(c,l):l=l.concat(c),Object.defineProperty(l,"__diff",{enumerable:!1,value:[{startRow:d,endRow:l.length}]}),d=l.length,this._setAsyncPropValue(e,l,s)}this._onResolve(e,l)}_postProcessValue(e,n){const r=e.type;return r&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const s=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:s&&s[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class p8 extends f8{constructor({attributeManager:e,layer:n}){super(n),W(this,"attributeManager",void 0),W(this,"needsRedraw",void 0),W(this,"needsUpdate",void 0),W(this,"subLayers",void 0),W(this,"usesPickingColorCache",void 0),W(this,"changeFlags",void 0),W(this,"viewport",void 0),W(this,"uniformTransitions",void 0),W(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}_fetch(e,n){const r=this.component.props.fetch;return r?r(n,{propName:e,layer:this.layer}):super._fetch(e,n)}_onResolve(e,n){const r=this.component.props.onDataLoad;e==="data"&&r&&r(n,{propName:e,layer:this.layer})}_onError(e,n){this.layer.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const m8="layer.changeFlag",g8="layer.initialize",y8="layer.update",_8="layer.finalize",v8="layer.matched",bT=2**24-1,x8=Object.freeze([]),b8=py(({oldViewport:t,viewport:e})=>t.equals(e));let Lo=new Uint8ClampedArray(0);const w8={data:{type:"data",value:x8,async:!0},dataComparator:{type:"function",value:null,compare:!1,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:s,signal:l})=>{const{resourceManager:d}=n.context;if(s=s||n.getLoadOptions(),r=r||n.props.loaders,l){var c;s={...s,fetch:{...(c=s)===null||c===void 0?void 0:c.fetch,signal:l}}}let v=d.contains(t);return!v&&!s&&(d.add({resourceId:t,data:Lg(t,r),persistent:!1}),v=!0),v?d.subscribe({resourceId:t,onChange:w=>{var C;return(C=n.internalState)===null||C===void 0?void 0:C.reloadAsyncProp(e,w)},consumerId:n.id,requestId:e}):Lg(t,r,s)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:Hf.DRAW,onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Fn.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100],compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class vy extends D1{constructor(...e){super(...e),W(this,"internalState",null),W(this,"lifecycle",xu.NO_STATE),W(this,"context",void 0),W(this,"state",void 0),W(this,"parent",null)}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){ui(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=$C(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[s,l,d]=UC(r,n.pixelProjectionMatrix);return e.length===2?[s,l]:[s,l,d]}unproject(e){return ui(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){ui(this.internalState);const r=this.internalState.viewport||this.context.viewport;return B6(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Fn.DEFAULT||e===Fn.LNGLAT||e===Fn.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){ui(e instanceof Uint8Array);const[n,r,s]=e;return n+r*256+s*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:XV(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;const n=this.getAttributeManager();if(!n)return null;const{positions:r,instancePositions:s}=n.attributes;return(e=r||s)===null||e===void 0?void 0:e.getBounds()}getShaders(e){for(const n of this.props.extensions)e=KV(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const v of r)n.invalidateAll(v);else n.invalidateAll();const{props:s,oldProps:l}=e,d=Number.isInteger(l.highlightedObjectIndex)||l.pickable,c=Number.isInteger(s.highlightedObjectIndex)||s.pickable;if(d!==c&&n){const{pickingColors:v,instancePickingColors:w}=n.attributes,C=v||w;C&&(c&&C.constant&&(C.constant=!1,n.invalidate(C.id)),!C.value&&!c&&(C.constant=!0,C.value=[0,0,0]))}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:s}=e;return s>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[s]),e}raiseError(e,n){var r,s;if(n&&(e.message="".concat(n,": ").concat(e.message)),!((r=(s=this.props).onError)!==null&&r!==void 0&&r.call(s,e))){var l,d;(l=this.context)===null||l===void 0||(d=l.onError)===null||d===void 0||d.call(l,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!b8({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();!n||(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),s=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:s,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const l=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(l)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const s in n)Object.defineProperty(r,s,{value:n[s]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(Lo.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>bT&&Bn.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Lo=Sf.allocate(Lo,n,{size:3,copy:!0,maxCount:Math.max(n,bT)});const s=Math.floor(Lo.length/3),l=[];for(let d=r;d<s;d++)this.encodePickingColor(d,l),Lo[d*3+0]=l[0],Lo[d*3+1]=l[1],Lo[d*3+2]=l[2]}e.value=Lo.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),s=e.userData.excludeAttributes||{},l=r.getShaderAttributes(n,s);e.setAttributes(l)}disablePickingIndex(e){this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,s=n||r;if(!s)return;const l=s.getVertexOffset(e),d=s.getVertexOffset(e+1);s.buffer.subData({data:new Uint8Array(d-l),offset:l})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;!r||(this.internalState.usesPickingColorCache&&r.value.buffer!==Lo.buffer&&(r.value=Lo.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){ui(!this.internalState),ui(Number.isFinite(this.props.coordinateSystem)),Ui(g8,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new p8({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Bn.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.layer=this,this.internalState.uniformTransitions=new NV(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Ui(v8,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.internalState.layer=this,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Ui(y8,this,e),!e)return;const n=this.props,r=this.context,s=this.internalState,l=r.viewport,d=this._updateUniformTransition();s.propsInTransition=d,r.viewport=s.viewport||l,this.props=d;try{const c=this._getUpdateParams(),v=this.getModels();if(r.gl)this.updateState(c);else try{this.updateState(c)}catch{}for(const C of this.props.extensions)C.updateState.call(this,c,C);const w=this.getModels()[0]!==v[0];this._postUpdate(c,w)}finally{r.viewport=l,this.props=n,this._clearChangeFlags(),s.needsUpdate=!1,s.resetOldProps()}}_finalize(){Ui(_8,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const s=this.props,l=this.context;this.props=this.internalState.propsInTransition||s;const d=this.props.opacity;n.opacity=Math.pow(d,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:c}=this.props,v=c&&c(n)||[0,0];xa(l.gl,{polygonOffset:v}),$s(l.gl,r,()=>{const w={moduleParameters:e,uniforms:n,parameters:r,context:l};for(const C of this.props.extensions)C.draw.call(this,w,C);this.draw(w)})}finally{this.props=s}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const s in e)if(e[s]){let l=!1;switch(s){case"dataChanged":const d=e[s],c=n[s];d&&Array.isArray(c)&&(n.dataChanged=Array.isArray(d)?c.concat(d):d,l=!0);default:n[s]||(n[s]=e[s],l=!0)}l&&Ui(m8,this,s,e)}const r=Boolean(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=VV(e,n);if(r.updateTriggersChanged)for(const l in r.updateTriggersChanged)r.updateTriggersChanged[l]&&this.invalidateAttribute(l);if(r.transitionsChanged)for(const l in r.transitionsChanged){var s;this.internalState.uniformTransitions.add(l,n[l],e[l],(s=e.transitions)===null||s===void 0?void 0:s[l])}return this.setChangeFlags(r)}validateProps(){UV(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new OV(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:s}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:l}=this.state;l==null||l.setInstanceCount(this.getNumInstances());const{autoHighlight:d,highlightedObjectIndex:c,highlightColor:v}=r;if(n||s.autoHighlight!==d||s.highlightedObjectIndex!==c||s.highlightColor!==v){const w={};d||(w.pickingSelectedColor=null),Array.isArray(v)&&(w.pickingHighlightColor=v),Number.isInteger(c)&&(w.pickingSelectedColor=Number.isFinite(c)&&c>=0?this.encodePickingColor(c):null),this.setModuleParameters(w)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags;const r=this.getAttributeManager(),s=r?r.getNeedsRedraw(e):!1;return n=n||s,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}W(vy,"defaultProps",w8);W(vy,"layerName","Layer");const E8=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  // convert size in meters to pixels, then scaled and clamp
 
  // project meters to pixels and clamp to limits 
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );

  // scale icon height to match instanceSize
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;

  // scale and rotate vertex in "pixel" value and convert back to fraction in clipspace
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,T8=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);

  // if colorMode == 0, use pixel color from the texture
  // if colorMode == 1 or rendering picking buffer, use texture as transparency mask
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  // Take the global opacity and the alpha from vColor into account for the alpha component
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,S8=1024,A8=4,wT=()=>{},ET={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071};function P8(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function C8(t,e,n,r){return n===e.width&&r===e.height?e:(t.canvas.height=r,t.canvas.width=n,t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(e,0,0,e.width,e.height,0,0,n,r),t.canvas)}function Pf(t){return t&&(t.id||t.url)}function I8(t,e,n,r){const s=t.width,l=t.height,d=new Gi(t.gl,{width:e,height:n,parameters:r});return z4(t,d,{targetY:0,width:s,height:l}),t.delete(),d}function TT(t,e,n){for(let r=0;r<e.length;r++){const{icon:s,xOffset:l}=e[r],d=Pf(s);t[d]={...s,x:l,y:n}}}function k8({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:s=0,rowHeight:l=0,canvasWidth:d}){let c=[];for(let v=0;v<t.length;v++){const w=t[v],C=Pf(w);if(!n[C]){const{height:I,width:S}=w;r+S+e>d&&(TT(n,c,s),r=0,s=l+s+e,l=0,c=[]),c.push({icon:w,xOffset:r}),r=r+S+e,l=Math.max(l,I)}}return c.length>0&&TT(n,c,s),{mapping:n,rowHeight:l,xOffset:r,yOffset:s,canvasWidth:d,canvasHeight:P8(l+s+e)}}function M8(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:s,objectInfo:l}=iI(t);for(const d of s){l.index++;const c=e(d,l),v=Pf(c);if(!c)throw new Error("Icon is missing.");if(!c.url)throw new Error("Icon url is missing.");!r[v]&&(!n[v]||c.url!==n[v].url)&&(r[v]={...c,source:d,sourceIndex:l.index})}return r}class L8{constructor(e,{onUpdate:n=wT,onError:r=wT}){W(this,"gl",void 0),W(this,"onUpdate",void 0),W(this,"onError",void 0),W(this,"_loadOptions",null),W(this,"_texture",null),W(this,"_externalTexture",null),W(this,"_mapping",{}),W(this,"_textureParameters",null),W(this,"_pendingCount",0),W(this,"_autoPacking",!1),W(this,"_xOffset",0),W(this,"_yOffset",0),W(this,"_rowHeight",0),W(this,"_buffer",A8),W(this,"_canvasWidth",S8),W(this,"_canvasHeight",0),W(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?Pf(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:s,textureParameters:l}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),s&&(this._mapping=s),r){var d;(d=this._texture)===null||d===void 0||d.delete(),this._texture=null,this._externalTexture=r}l&&(this._textureParameters=l)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(M8(e,n,this._mapping)||{});if(r.length>0){const{mapping:s,xOffset:l,yOffset:d,rowHeight:c,canvasHeight:v}=k8({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=c,this._mapping=s,this._xOffset=l,this._yOffset=d,this._canvasHeight=v,this._texture||(this._texture=new Gi(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||ET})),this._texture.height!==this._canvasHeight&&(this._texture=I8(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||ET)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d");for(const r of e)this._pendingCount++,Lg(r.url,XP,this._loadOptions).then(s=>{const l=Pf(r),{x:d,y:c,width:v,height:w}=this._mapping[l],C=C8(n,s,v,w);this._texture.setSubImageData({data:C,x:d,y:c,width:v,height:w}),this._texture.generateMipmap(),this.onUpdate()}).catch(s=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:s})}).finally(()=>{this._pendingCount--})}}const pI=[0,0,0,255],R8={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:pI},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};class z1 extends vy{constructor(...e){super(...e),W(this,"state",void 0)}getShaders(){return super.getShaders({vs:E8,fs:T8,modules:[UN,a6]})}initializeState(){this.state={iconManager:new L8(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:pI},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:s}=e,l=this.getAttributeManager(),{iconAtlas:d,iconMapping:c,data:v,getIcon:w,textureParameters:C}=n,{iconManager:I}=this.state,S=d||this.internalState.isAsyncPropLoading("iconAtlas");if(I.setProps({loadOptions:n.loadOptions,autoPacking:!S,iconAtlas:d,iconMapping:S?c:null,textureParameters:C}),S?r.iconMapping!==n.iconMapping&&l.invalidate("getIcon"):(s.dataChanged||s.updateTriggersChanged&&(s.updateTriggersChanged.all||s.updateTriggersChanged.getIcon))&&I.packIcons(v,w),s.extensionsChanged){var z;const{gl:F}=this.context;(z=this.state.model)===null||z===void 0||z.delete(),this.state.model=this._getModel(F),l.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:s,sizeUnits:l,billboard:d,alphaCutoff:c}=this.props,{iconManager:v}=this.state,w=v.getTexture();w&&this.state.model.setUniforms(e).setUniforms({iconsTexture:w,iconsTextureDim:[w.width,w.height],sizeUnits:Xv[l],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:s,billboard:d,alphaCutoff:c}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new MC(e,{...this.getShaders(),id:this.props.id,geometry:new xN({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const r=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;r?r(e):Bn.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:s=n/2,anchorY:l=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-s,r/2-l]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:s,height:l}=this.state.iconManager.getIconMapping(e);return[n,r,s,l]}}W(z1,"defaultProps",R8);W(z1,"layerName","IconLayer");const O8=typeof window<"u"?Ie.exports.useLayoutEffect:Ie.exports.useEffect,D8=O8;function Wg(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const z8={position:"absolute",zIndex:-1};function mI(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>mI(n,e));if(xy(t)){if(F8(t))return e.style=z8,Ie.exports.cloneElement(t,e);if(B8(t))return Ie.exports.cloneElement(t,e)}return t}function xy(t){return t&&typeof t=="object"&&"type"in t||!1}function F8(t){const e=t.type,n=e&&e.defaultProps;return n&&n.mapStyle}function B8(t){const e=t.type;return e&&e.deckGLViewProps}function ox(t){if(typeof t=="function")return Ie.exports.createElement(Ac,{},t);if(Array.isArray(t))return t.map(ox);if(xy(t)){if(t.type===Ie.exports.Fragment)return ox(t.props.children);if(Wg(t.type,Ac))return t}return t}function N8({children:t,layers:e=[],views:n=null}){const r=[],s=[],l={};return Ie.exports.Children.forEach(ox(t),d=>{if(xy(d)){const c=d.type;if(Wg(c,vy)){const v=U8(c,d.props);s.push(v)}else r.push(d);if(Wg(c,Ac)&&c!==Ac&&d.props.id){const v=new c(d.props);l[v.id]=v}}else d&&r.push(d)}),Object.keys(l).length>0&&(Array.isArray(n)?n.forEach(d=>{l[d.id]=d}):n&&(l[n.id]=n),n=Object.values(l)),e=s.length>0?[...s,...e]:e,{layers:e,children:r,views:n}}function U8(t,e){const n={},r=t.defaultProps||{};for(const s in e)r[s]!==e[s]&&(n[s]=e[s]);return new t(n)}function V8({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const s={},l=r.views[0].id;for(const d of t){let c=l,v=d;xy(d)&&Wg(d.type,Ac)&&(c=d.props.id||l,v=d.props.children);const w=r.getViewport(c),C=r.getViewState(c);if(w){C.padding=w.padding;const{x:I,y:S,width:z,height:F}=w;v=mI(v,{x:I,y:S,width:z,height:F,viewport:w,viewState:C}),s[c]||(s[c]={viewport:w,children:[]}),s[c].children.push(v)}}return Object.keys(s).map(d=>{const{viewport:c,children:v}=s[d],{x:w,y:C,width:I,height:S}=c,z={position:"absolute",left:w,top:C,width:I,height:S},F="view-".concat(d),B=Ie.exports.createElement("div",{key:F,id:F,style:z},...v);if(n){const Q={viewport:c,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:q=>{q.viewId=d,e._onViewStateChange(q)}};return Ie.exports.createElement(n,{key:F,value:Q},B)}return B})}const j8={mixBlendMode:null};function G8({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},s={left:0,top:0};if(n)for(const l in n)l in j8?s[l]=n[l]:r[l]=n[l];return{containerStyle:r,canvasStyle:s}}function $8(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function gI(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function W8(t,e,n){const r=new e({...n,_customRender:s=>{t.redrawReason=s;const l=r.getViewports();t.lastRenderedViewports!==l?t.forceUpdate():gI(t)}});return r}const yI=Ie.exports.forwardRef((t,e)=>{const[n,r]=Ie.exports.useState(0),l=Ie.exports.useRef({control:null,version:n,forceUpdate:()=>r(he=>he+1)}).current,d=Ie.exports.useRef(null),c=Ie.exports.useRef(null),v=Ie.exports.useMemo(()=>N8(t),[t.layers,t.views,t.children]);let w=!0;const C=he=>{var ye;return w&&t.viewState?(l.viewStateUpdateRequested=he,null):(l.viewStateUpdateRequested=null,(ye=t.onViewStateChange)===null||ye===void 0?void 0:ye.call(t,he))},I=he=>{if(w)l.interactionStateUpdateRequested=he;else{var ye;l.interactionStateUpdateRequested=null,(ye=t.onInteractionStateChange)===null||ye===void 0||ye.call(t,he)}},S=Ie.exports.useMemo(()=>{const he={...t,style:null,width:"100%",height:"100%",parent:d.current,canvas:c.current,layers:v.layers,views:v.views,onViewStateChange:C,onInteractionStateChange:I};return delete he._customRender,l.deck&&l.deck.setProps(he),he},[t]);Ie.exports.useEffect(()=>{const he=t.Deck||_y;return l.deck=W8(l,he,{...S,parent:d.current,canvas:c.current}),()=>{var ye;return(ye=l.deck)===null||ye===void 0?void 0:ye.finalize()}},[]),D8(()=>{gI(l);const{viewStateUpdateRequested:he,interactionStateUpdateRequested:ye}=l;he&&C(he),ye&&I(ye)}),Ie.exports.useImperativeHandle(e,()=>$8(l),[]);const z=l.deck&&l.deck.isInitialized?l.deck.getViewports():void 0,{ContextProvider:F,width:B,height:Q,id:q,style:j}=t,{containerStyle:G,canvasStyle:se}=Ie.exports.useMemo(()=>G8({width:B,height:Q,style:j}),[B,Q,j]);if(!l.viewStateUpdateRequested&&l.lastRenderedViewports===z||l.version!==n){l.lastRenderedViewports=z,l.version=n;const he=V8({children:v.children,deck:l.deck,ContextProvider:F}),ye=Ie.exports.createElement("canvas",{key:"canvas",id:q||"deckgl-overlay",ref:c,style:se});l.control=Ie.exports.createElement("div",{id:"".concat(q||"deckgl","-wrapper"),ref:d,style:G},[ye,he])}return w=!1,l.control});yI.defaultProps=_y.defaultProps;const H8=yI,q8={black:"#000",white:"#fff"},Cf=q8,X8={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},pu=X8,Z8={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},mu=Z8,Y8={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},gu=Y8,K8={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},yu=K8,J8={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},_u=J8,Q8={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Pd=Q8,ej={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},tj=ej;function Ze(){return Ze=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ze.apply(this,arguments)}function Un(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,l;for(l=0;l<r.length;l++)s=r[l],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function _I(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var nj=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,rj=_I(function(t){return nj.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91});function ij(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function sj(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var oj=function(){function t(n){var r=this;this._insertTag=function(s){var l;r.tags.length===0?r.insertionPoint?l=r.insertionPoint.nextSibling:r.prepend?l=r.container.firstChild:l=r.before:l=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(s,l),r.tags.push(s)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(sj(this));var s=this.tags[this.tags.length-1];if(this.isSpeedy){var l=ij(s);try{l.insertRule(r,l.cssRules.length)}catch{}}else s.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){return r.parentNode&&r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},t}(),wi="-ms-",Hg="-moz-",Cn="-webkit-",vI="comm",F1="rule",B1="decl",aj="@import",xI="@keyframes",lj=Math.abs,by=String.fromCharCode,cj=Object.assign;function uj(t,e){return ci(t,0)^45?(((e<<2^ci(t,0))<<2^ci(t,1))<<2^ci(t,2))<<2^ci(t,3):0}function bI(t){return t.trim()}function hj(t,e){return(t=e.exec(t))?t[0]:t}function Rn(t,e,n){return t.replace(e,n)}function ax(t,e){return t.indexOf(e)}function ci(t,e){return t.charCodeAt(e)|0}function If(t,e,n){return t.slice(e,n)}function Oo(t){return t.length}function N1(t){return t.length}function Mm(t,e){return e.push(t),t}function dj(t,e){return t.map(e).join("")}var wy=1,lh=1,wI=0,is=0,Br=0,vh="";function Ey(t,e,n,r,s,l,d){return{value:t,root:e,parent:n,type:r,props:s,children:l,line:wy,column:lh,length:d,return:""}}function Cd(t,e){return cj(Ey("",null,null,"",null,null,0),t,{length:-t.length},e)}function fj(){return Br}function pj(){return Br=is>0?ci(vh,--is):0,lh--,Br===10&&(lh=1,wy--),Br}function Ss(){return Br=is<wI?ci(vh,is++):0,lh++,Br===10&&(lh=1,wy++),Br}function jo(){return ci(vh,is)}function eg(){return is}function Xf(t,e){return If(vh,t,e)}function kf(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function EI(t){return wy=lh=1,wI=Oo(vh=t),is=0,[]}function TI(t){return vh="",t}function tg(t){return bI(Xf(is-1,lx(t===91?t+2:t===40?t+1:t)))}function mj(t){for(;(Br=jo())&&Br<33;)Ss();return kf(t)>2||kf(Br)>3?"":" "}function gj(t,e){for(;--e&&Ss()&&!(Br<48||Br>102||Br>57&&Br<65||Br>70&&Br<97););return Xf(t,eg()+(e<6&&jo()==32&&Ss()==32))}function lx(t){for(;Ss();)switch(Br){case t:return is;case 34:case 39:t!==34&&t!==39&&lx(Br);break;case 40:t===41&&lx(t);break;case 92:Ss();break}return is}function yj(t,e){for(;Ss()&&t+Br!==47+10;)if(t+Br===42+42&&jo()===47)break;return"/*"+Xf(e,is-1)+"*"+by(t===47?t:Ss())}function _j(t){for(;!kf(jo());)Ss();return Xf(t,is)}function vj(t){return TI(ng("",null,null,null,[""],t=EI(t),0,[0],t))}function ng(t,e,n,r,s,l,d,c,v){for(var w=0,C=0,I=d,S=0,z=0,F=0,B=1,Q=1,q=1,j=0,G="",se=s,he=l,ye=r,we=G;Q;)switch(F=j,j=Ss()){case 40:if(F!=108&&ci(we,I-1)==58){ax(we+=Rn(tg(j),"&","&\f"),"&\f")!=-1&&(q=-1);break}case 34:case 39:case 91:we+=tg(j);break;case 9:case 10:case 13:case 32:we+=mj(F);break;case 92:we+=gj(eg()-1,7);continue;case 47:switch(jo()){case 42:case 47:Mm(xj(yj(Ss(),eg()),e,n),v);break;default:we+="/"}break;case 123*B:c[w++]=Oo(we)*q;case 125*B:case 59:case 0:switch(j){case 0:case 125:Q=0;case 59+C:z>0&&Oo(we)-I&&Mm(z>32?AT(we+";",r,n,I-1):AT(Rn(we," ","")+";",r,n,I-2),v);break;case 59:we+=";";default:if(Mm(ye=ST(we,e,n,w,C,s,c,G,se=[],he=[],I),l),j===123)if(C===0)ng(we,e,ye,ye,se,l,I,c,he);else switch(S===99&&ci(we,3)===110?100:S){case 100:case 109:case 115:ng(t,ye,ye,r&&Mm(ST(t,ye,ye,0,0,s,c,G,s,se=[],I),he),s,he,I,c,r?se:he);break;default:ng(we,ye,ye,ye,[""],he,0,c,he)}}w=C=z=0,B=q=1,G=we="",I=d;break;case 58:I=1+Oo(we),z=F;default:if(B<1){if(j==123)--B;else if(j==125&&B++==0&&pj()==125)continue}switch(we+=by(j),j*B){case 38:q=C>0?1:(we+="\f",-1);break;case 44:c[w++]=(Oo(we)-1)*q,q=1;break;case 64:jo()===45&&(we+=tg(Ss())),S=jo(),C=I=Oo(G=we+=_j(eg())),j++;break;case 45:F===45&&Oo(we)==2&&(B=0)}}return l}function ST(t,e,n,r,s,l,d,c,v,w,C){for(var I=s-1,S=s===0?l:[""],z=N1(S),F=0,B=0,Q=0;F<r;++F)for(var q=0,j=If(t,I+1,I=lj(B=d[F])),G=t;q<z;++q)(G=bI(B>0?S[q]+" "+j:Rn(j,/&\f/g,S[q])))&&(v[Q++]=G);return Ey(t,e,n,s===0?F1:c,v,w,C)}function xj(t,e,n){return Ey(t,e,n,vI,by(fj()),If(t,2,-2),0)}function AT(t,e,n,r){return Ey(t,e,n,B1,If(t,0,r),If(t,r+1,-1),r)}function Hu(t,e){for(var n="",r=N1(t),s=0;s<r;s++)n+=e(t[s],s,t,e)||"";return n}function bj(t,e,n,r){switch(t.type){case aj:case B1:return t.return=t.return||t.value;case vI:return"";case xI:return t.return=t.value+"{"+Hu(t.children,r)+"}";case F1:t.value=t.props.join(",")}return Oo(n=Hu(t.children,r))?t.return=t.value+"{"+n+"}":""}function wj(t){var e=N1(t);return function(n,r,s,l){for(var d="",c=0;c<e;c++)d+=t[c](n,r,s,l)||"";return d}}function Ej(t){return function(e){e.root||(e=e.return)&&t(e)}}var Tj=function(e,n,r){for(var s=0,l=0;s=l,l=jo(),s===38&&l===12&&(n[r]=1),!kf(l);)Ss();return Xf(e,is)},Sj=function(e,n){var r=-1,s=44;do switch(kf(s)){case 0:s===38&&jo()===12&&(n[r]=1),e[r]+=Tj(is-1,n,r);break;case 2:e[r]+=tg(s);break;case 4:if(s===44){e[++r]=jo()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=by(s)}while(s=Ss());return e},Aj=function(e,n){return TI(Sj(EI(e),n))},PT=new WeakMap,Pj=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,s=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!PT.get(r))&&!s){PT.set(e,!0);for(var l=[],d=Aj(n,l),c=r.props,v=0,w=0;v<d.length;v++)for(var C=0;C<c.length;C++,w++)e.props[w]=l[v]?d[v].replace(/&\f/g,c[C]):c[C]+" "+d[v]}}},Cj=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function SI(t,e){switch(uj(t,e)){case 5103:return Cn+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Cn+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Cn+t+Hg+t+wi+t+t;case 6828:case 4268:return Cn+t+wi+t+t;case 6165:return Cn+t+wi+"flex-"+t+t;case 5187:return Cn+t+Rn(t,/(\w+).+(:[^]+)/,Cn+"box-$1$2"+wi+"flex-$1$2")+t;case 5443:return Cn+t+wi+"flex-item-"+Rn(t,/flex-|-self/,"")+t;case 4675:return Cn+t+wi+"flex-line-pack"+Rn(t,/align-content|flex-|-self/,"")+t;case 5548:return Cn+t+wi+Rn(t,"shrink","negative")+t;case 5292:return Cn+t+wi+Rn(t,"basis","preferred-size")+t;case 6060:return Cn+"box-"+Rn(t,"-grow","")+Cn+t+wi+Rn(t,"grow","positive")+t;case 4554:return Cn+Rn(t,/([^-])(transform)/g,"$1"+Cn+"$2")+t;case 6187:return Rn(Rn(Rn(t,/(zoom-|grab)/,Cn+"$1"),/(image-set)/,Cn+"$1"),t,"")+t;case 5495:case 3959:return Rn(t,/(image-set\([^]*)/,Cn+"$1$`$1");case 4968:return Rn(Rn(t,/(.+:)(flex-)?(.*)/,Cn+"box-pack:$3"+wi+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Cn+t+t;case 4095:case 3583:case 4068:case 2532:return Rn(t,/(.+)-inline(.+)/,Cn+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Oo(t)-1-e>6)switch(ci(t,e+1)){case 109:if(ci(t,e+4)!==45)break;case 102:return Rn(t,/(.+:)(.+)-([^]+)/,"$1"+Cn+"$2-$3$1"+Hg+(ci(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~ax(t,"stretch")?SI(Rn(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(ci(t,e+1)!==115)break;case 6444:switch(ci(t,Oo(t)-3-(~ax(t,"!important")&&10))){case 107:return Rn(t,":",":"+Cn)+t;case 101:return Rn(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Cn+(ci(t,14)===45?"inline-":"")+"box$3$1"+Cn+"$2$3$1"+wi+"$2box$3")+t}break;case 5936:switch(ci(t,e+11)){case 114:return Cn+t+wi+Rn(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Cn+t+wi+Rn(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Cn+t+wi+Rn(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Cn+t+wi+t+t}return t}var Ij=function(e,n,r,s){if(e.length>-1&&!e.return)switch(e.type){case B1:e.return=SI(e.value,e.length);break;case xI:return Hu([Cd(e,{value:Rn(e.value,"@","@"+Cn)})],s);case F1:if(e.length)return dj(e.props,function(l){switch(hj(l,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Hu([Cd(e,{props:[Rn(l,/:(read-\w+)/,":"+Hg+"$1")]})],s);case"::placeholder":return Hu([Cd(e,{props:[Rn(l,/:(plac\w+)/,":"+Cn+"input-$1")]}),Cd(e,{props:[Rn(l,/:(plac\w+)/,":"+Hg+"$1")]}),Cd(e,{props:[Rn(l,/:(plac\w+)/,wi+"input-$1")]})],s)}return""})}},kj=[Ij],Mj=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(B){var Q=B.getAttribute("data-emotion");Q.indexOf(" ")!==-1&&(document.head.appendChild(B),B.setAttribute("data-s",""))})}var s=e.stylisPlugins||kj,l={},d,c=[];d=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(B){for(var Q=B.getAttribute("data-emotion").split(" "),q=1;q<Q.length;q++)l[Q[q]]=!0;c.push(B)});var v,w=[Pj,Cj];{var C,I=[bj,Ej(function(B){C.insert(B)})],S=wj(w.concat(s,I)),z=function(Q){return Hu(vj(Q),S)};v=function(Q,q,j,G){C=j,z(Q?Q+"{"+q.styles+"}":q.styles),G&&(F.inserted[q.name]=!0)}}var F={key:n,sheet:new oj({key:n,container:d,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:l,registered:{},insert:v};return F.sheet.hydrate(c),F},Lj=!0;function Rj(t,e,n){var r="";return n.split(" ").forEach(function(s){t[s]!==void 0?e.push(t[s]+";"):r+=s+" "}),r}var AI=function(e,n,r){var s=e.key+"-"+n.name;(r===!1||Lj===!1)&&e.registered[s]===void 0&&(e.registered[s]=n.styles)},Oj=function(e,n,r){AI(e,n,r);var s=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var l=n;do e.insert(n===l?"."+s:"",l,e.sheet,!0),l=l.next;while(l!==void 0)}};function Dj(t){for(var e=0,n,r=0,s=t.length;s>=4;++r,s-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(s){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var zj={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Fj=/[A-Z]|^ms/g,Bj=/_EMO_([^_]+?)_([^]*?)_EMO_/g,PI=function(e){return e.charCodeAt(1)===45},CT=function(e){return e!=null&&typeof e!="boolean"},R0=_I(function(t){return PI(t)?t:t.replace(Fj,"-$&").toLowerCase()}),IT=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(Bj,function(r,s,l){return Do={name:s,styles:l,next:Do},s})}return zj[e]!==1&&!PI(e)&&typeof n=="number"&&n!==0?n+"px":n};function Mf(t,e,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return Do={name:n.name,styles:n.styles,next:Do},n.name;if(n.styles!==void 0){var r=n.next;if(r!==void 0)for(;r!==void 0;)Do={name:r.name,styles:r.styles,next:Do},r=r.next;var s=n.styles+";";return s}return Nj(t,e,n)}case"function":{if(t!==void 0){var l=Do,d=n(t);return Do=l,Mf(t,e,d)}break}}if(e==null)return n;var c=e[n];return c!==void 0?c:n}function Nj(t,e,n){var r="";if(Array.isArray(n))for(var s=0;s<n.length;s++)r+=Mf(t,e,n[s])+";";else for(var l in n){var d=n[l];if(typeof d!="object")e!=null&&e[d]!==void 0?r+=l+"{"+e[d]+"}":CT(d)&&(r+=R0(l)+":"+IT(l,d)+";");else if(Array.isArray(d)&&typeof d[0]=="string"&&(e==null||e[d[0]]===void 0))for(var c=0;c<d.length;c++)CT(d[c])&&(r+=R0(l)+":"+IT(l,d[c])+";");else{var v=Mf(t,e,d);switch(l){case"animation":case"animationName":{r+=R0(l)+":"+v+";";break}default:r+=l+"{"+v+"}"}}}return r}var kT=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Do,Uj=function(e,n,r){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var s=!0,l="";Do=void 0;var d=e[0];d==null||d.raw===void 0?(s=!1,l+=Mf(r,n,d)):l+=d[0];for(var c=1;c<e.length;c++)l+=Mf(r,n,e[c]),s&&(l+=d[c]);kT.lastIndex=0;for(var v="",w;(w=kT.exec(l))!==null;)v+="-"+w[1];var C=Dj(l)+v;return{name:C,styles:l,next:Do}},Vj=function(e){return e()},jj=Pw["useInsertionEffect"]?Pw["useInsertionEffect"]:!1,Gj=jj||Vj,CI=Ie.exports.createContext(typeof HTMLElement<"u"?Mj({key:"css"}):null);CI.Provider;var $j=function(e){return Ie.exports.forwardRef(function(n,r){var s=Ie.exports.useContext(CI);return e(n,s,r)})},Wj=Ie.exports.createContext({}),Hj=rj,qj=function(e){return e!=="theme"},MT=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?Hj:qj},LT=function(e,n,r){var s;if(n){var l=n.shouldForwardProp;s=e.__emotion_forwardProp&&l?function(d){return e.__emotion_forwardProp(d)&&l(d)}:l}return typeof s!="function"&&r&&(s=e.__emotion_forwardProp),s},Xj=function(e){var n=e.cache,r=e.serialized,s=e.isStringTag;return AI(n,r,s),Gj(function(){return Oj(n,r,s)}),null},Zj=function t(e,n){var r=e.__emotion_real===e,s=r&&e.__emotion_base||e,l,d;n!==void 0&&(l=n.label,d=n.target);var c=LT(e,n,r),v=c||MT(s),w=!v("as");return function(){var C=arguments,I=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(l!==void 0&&I.push("label:"+l+";"),C[0]==null||C[0].raw===void 0)I.push.apply(I,C);else{I.push(C[0][0]);for(var S=C.length,z=1;z<S;z++)I.push(C[z],C[0][z])}var F=$j(function(B,Q,q){var j=w&&B.as||s,G="",se=[],he=B;if(B.theme==null){he={};for(var ye in B)he[ye]=B[ye];he.theme=Ie.exports.useContext(Wj)}typeof B.className=="string"?G=Rj(Q.registered,se,B.className):B.className!=null&&(G=B.className+" ");var we=Uj(I.concat(se),Q.registered,he);G+=Q.key+"-"+we.name,d!==void 0&&(G+=" "+d);var Be=w&&c===void 0?MT(j):v,Ve={};for(var xe in B)w&&xe==="as"||Be(xe)&&(Ve[xe]=B[xe]);return Ve.className=G,Ve.ref=q,Ie.exports.createElement(Ie.exports.Fragment,null,Ie.exports.createElement(Xj,{cache:Q,serialized:we,isStringTag:typeof j=="string"}),Ie.exports.createElement(j,Ve))});return F.displayName=l!==void 0?l:"Styled("+(typeof s=="string"?s:s.displayName||s.name||"Component")+")",F.defaultProps=e.defaultProps,F.__emotion_real=F,F.__emotion_base=s,F.__emotion_styles=I,F.__emotion_forwardProp=c,Object.defineProperty(F,"toString",{value:function(){return"."+d}}),F.withComponent=function(B,Q){return t(B,Ze({},n,Q,{shouldForwardProp:LT(F,Q,!0)})).apply(void 0,I)},F}},Yj=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],cx=Zj.bind();Yj.forEach(function(t){cx[t]=cx(t)});const Kj=cx;var U1={exports:{}},Ty={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jj=Ie.exports,Qj=Symbol.for("react.element"),e9=Symbol.for("react.fragment"),t9=Object.prototype.hasOwnProperty,n9=Jj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r9={key:!0,ref:!0,__self:!0,__source:!0};function II(t,e,n){var r,s={},l=null,d=null;n!==void 0&&(l=""+n),e.key!==void 0&&(l=""+e.key),e.ref!==void 0&&(d=e.ref);for(r in e)t9.call(e,r)&&!r9.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Qj,type:t,key:l,ref:d,props:s,_owner:n9.current}}Ty.Fragment=e9;Ty.jsx=II;Ty.jsxs=II;(function(t){t.exports=Ty})(U1);const hn=U1.exports.jsx,ch=U1.exports.jsxs;/** @license MUI v5.10.16
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function kI(t,e){return Kj(t,e)}const i9=(t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))};function Fd(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function fa(t,e,n={clone:!0}){const r=n.clone?Ze({},t):t;return Fd(t)&&Fd(e)&&Object.keys(e).forEach(s=>{s!=="__proto__"&&(Fd(e[s])&&s in t&&Fd(t[s])?r[s]=fa(t[s],e[s],n):r[s]=e[s])}),r}function uh(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}function po(t){if(typeof t!="string")throw new Error(uh(7));return t.charAt(0).toUpperCase()+t.slice(1)}function RT(...t){return t.reduce((e,n)=>n==null?e:function(...s){e.apply(this,s),n.apply(this,s)},()=>{})}function s9(t,e=166){let n;function r(...s){const l=()=>{t.apply(this,s)};clearTimeout(n),n=setTimeout(l,e)}return r.clear=()=>{clearTimeout(n)},r}function js(t){return t&&t.ownerDocument||document}function pa(t){return js(t).defaultView||window}function ux(t,e){typeof t=="function"?t(e):t&&(t.current=e)}const o9=typeof window<"u"?Ie.exports.useLayoutEffect:Ie.exports.useEffect,Lf=o9;function Qd(t){const e=Ie.exports.useRef(t);return Lf(()=>{e.current=t}),Ie.exports.useCallback((...n)=>(0,e.current)(...n),[])}function Lc(...t){return Ie.exports.useMemo(()=>t.every(e=>e==null)?null:e=>{t.forEach(n=>{ux(n,e)})},t)}function a9(t){const e=t.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}function l9(t,e){const n=Ze({},e);return Object.keys(t).forEach(r=>{n[r]===void 0&&(n[r]=t[r])}),n}function Tl(t,e,n){const r={};return Object.keys(t).forEach(s=>{r[s]=t[s].reduce((l,d)=>(d&&(l.push(e(d)),n&&n[d]&&l.push(n[d])),l),[]).join(" ")}),r}const OT=t=>t,c9=()=>{let t=OT;return{configure(e){t=e},generate(e){return t(e)},reset(){t=OT}}},u9=c9(),h9=u9,d9={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",required:"required",selected:"selected"};function Sa(t,e,n="Mui"){const r=d9[e];return r?`${n}-${r}`:`${h9.generate(t)}-${e}`}function Sl(t,e,n="Mui"){const r={};return e.forEach(s=>{r[s]=Sa(t,s,n)}),r}function ef(t,e){return e?fa(t,e,{clone:!1}):t}const V1={xs:0,sm:600,md:900,lg:1200,xl:1536},DT={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${V1[t]}px)`};function Al(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const l=r.breakpoints||DT;return e.reduce((d,c,v)=>(d[l.up(l.keys[v])]=n(e[v]),d),{})}if(typeof e=="object"){const l=r.breakpoints||DT;return Object.keys(e).reduce((d,c)=>{if(Object.keys(l.values||V1).indexOf(c)!==-1){const v=l.up(c);d[v]=n(e[c],c)}else{const v=c;d[v]=e[v]}return d},{})}return n(e)}function f9(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((r,s)=>{const l=t.up(s);return r[l]={},r},{}))||{}}function p9(t,e){return t.reduce((n,r)=>{const s=n[r];return(!s||Object.keys(s).length===0)&&delete n[r],n},e)}function j1(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((s,l)=>s&&s[l]?s[l]:null,t);if(r!=null)return r}return e.split(".").reduce((r,s)=>r&&r[s]!=null?r[s]:null,t)}function zT(t,e,n,r=n){let s;return typeof t=="function"?s=t(n):Array.isArray(t)?s=t[n]||r:s=j1(t,n)||r,e&&(s=e(s,r)),s}function St(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:s}=t,l=d=>{if(d[e]==null)return null;const c=d[e],v=d.theme,w=j1(v,r)||{};return Al(d,c,I=>{let S=zT(w,s,I);return I===S&&typeof I=="string"&&(S=zT(w,s,`${e}${I==="default"?"":po(I)}`,I)),n===!1?S:{[n]:S}})};return l.propTypes={},l.filterProps=[e],l}function Pl(...t){const e=t.reduce((r,s)=>(s.filterProps.forEach(l=>{r[l]=s}),r),{}),n=r=>Object.keys(r).reduce((s,l)=>e[l]?ef(s,e[l](r)):s,{});return n.propTypes={},n.filterProps=t.reduce((r,s)=>r.concat(s.filterProps),[]),n}function m9(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const g9={m:"margin",p:"padding"},y9={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},FT={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},_9=m9(t=>{if(t.length>2)if(FT[t])t=FT[t];else return[t];const[e,n]=t.split(""),r=g9[e],s=y9[n]||"";return Array.isArray(s)?s.map(l=>r+l):[r+s]}),v9=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],x9=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],MI=[...v9,...x9];function Zf(t,e,n,r){var s;const l=(s=j1(t,e,!1))!=null?s:n;return typeof l=="number"?d=>typeof d=="string"?d:l*d:Array.isArray(l)?d=>typeof d=="string"?d:l[d]:typeof l=="function"?l:()=>{}}function LI(t){return Zf(t,"spacing",8)}function Yf(t,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),r=t(n);return e>=0?r:typeof r=="number"?-r:`-${r}`}function b9(t,e){return n=>t.reduce((r,s)=>(r[s]=Yf(e,n),r),{})}function w9(t,e,n,r){if(e.indexOf(n)===-1)return null;const s=_9(n),l=b9(s,r),d=t[n];return Al(t,d,l)}function E9(t,e){const n=LI(t.theme);return Object.keys(t).map(r=>w9(t,e,r,n)).reduce(ef,{})}function Sy(t){return E9(t,MI)}Sy.propTypes={};Sy.filterProps=MI;function Kf(t){return typeof t!="number"?t:`${t}px solid`}const T9=St({prop:"border",themeKey:"borders",transform:Kf}),S9=St({prop:"borderTop",themeKey:"borders",transform:Kf}),A9=St({prop:"borderRight",themeKey:"borders",transform:Kf}),P9=St({prop:"borderBottom",themeKey:"borders",transform:Kf}),C9=St({prop:"borderLeft",themeKey:"borders",transform:Kf}),I9=St({prop:"borderColor",themeKey:"palette"}),k9=St({prop:"borderTopColor",themeKey:"palette"}),M9=St({prop:"borderRightColor",themeKey:"palette"}),L9=St({prop:"borderBottomColor",themeKey:"palette"}),R9=St({prop:"borderLeftColor",themeKey:"palette"}),G1=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=Zf(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:Yf(e,r)});return Al(t,t.borderRadius,n)}return null};G1.propTypes={};G1.filterProps=["borderRadius"];const O9=Pl(T9,S9,A9,P9,C9,I9,k9,M9,L9,R9,G1),RI=O9,D9=St({prop:"displayPrint",cssProperty:!1,transform:t=>({"@media print":{display:t}})}),z9=St({prop:"display"}),F9=St({prop:"overflow"}),B9=St({prop:"textOverflow"}),N9=St({prop:"visibility"}),U9=St({prop:"whiteSpace"}),OI=Pl(D9,z9,F9,B9,N9,U9),V9=St({prop:"flexBasis"}),j9=St({prop:"flexDirection"}),G9=St({prop:"flexWrap"}),$9=St({prop:"justifyContent"}),W9=St({prop:"alignItems"}),H9=St({prop:"alignContent"}),q9=St({prop:"order"}),X9=St({prop:"flex"}),Z9=St({prop:"flexGrow"}),Y9=St({prop:"flexShrink"}),K9=St({prop:"alignSelf"}),J9=St({prop:"justifyItems"}),Q9=St({prop:"justifySelf"}),eG=Pl(V9,j9,G9,$9,W9,H9,q9,X9,Z9,Y9,K9,J9,Q9),DI=eG,$1=t=>{if(t.gap!==void 0&&t.gap!==null){const e=Zf(t.theme,"spacing",8),n=r=>({gap:Yf(e,r)});return Al(t,t.gap,n)}return null};$1.propTypes={};$1.filterProps=["gap"];const W1=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=Zf(t.theme,"spacing",8),n=r=>({columnGap:Yf(e,r)});return Al(t,t.columnGap,n)}return null};W1.propTypes={};W1.filterProps=["columnGap"];const H1=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=Zf(t.theme,"spacing",8),n=r=>({rowGap:Yf(e,r)});return Al(t,t.rowGap,n)}return null};H1.propTypes={};H1.filterProps=["rowGap"];const tG=St({prop:"gridColumn"}),nG=St({prop:"gridRow"}),rG=St({prop:"gridAutoFlow"}),iG=St({prop:"gridAutoColumns"}),sG=St({prop:"gridAutoRows"}),oG=St({prop:"gridTemplateColumns"}),aG=St({prop:"gridTemplateRows"}),lG=St({prop:"gridTemplateAreas"}),cG=St({prop:"gridArea"}),uG=Pl($1,W1,H1,tG,nG,rG,iG,sG,oG,aG,lG,cG),zI=uG;function q1(t,e){return e==="grey"?e:t}const hG=St({prop:"color",themeKey:"palette",transform:q1}),dG=St({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:q1}),fG=St({prop:"backgroundColor",themeKey:"palette",transform:q1}),pG=Pl(hG,dG,fG),FI=pG,mG=St({prop:"position"}),gG=St({prop:"zIndex",themeKey:"zIndex"}),yG=St({prop:"top"}),_G=St({prop:"right"}),vG=St({prop:"bottom"}),xG=St({prop:"left"}),BI=Pl(mG,gG,yG,_G,vG,xG),bG=St({prop:"boxShadow",themeKey:"shadows"}),NI=bG;function Cl(t){return t<=1&&t!==0?`${t*100}%`:t}const wG=St({prop:"width",transform:Cl}),UI=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var r,s,l;return{maxWidth:((r=t.theme)==null||(s=r.breakpoints)==null||(l=s.values)==null?void 0:l[n])||V1[n]||Cl(n)}};return Al(t,t.maxWidth,e)}return null};UI.filterProps=["maxWidth"];const EG=St({prop:"minWidth",transform:Cl}),TG=St({prop:"height",transform:Cl}),SG=St({prop:"maxHeight",transform:Cl}),AG=St({prop:"minHeight",transform:Cl});St({prop:"size",cssProperty:"width",transform:Cl});St({prop:"size",cssProperty:"height",transform:Cl});const PG=St({prop:"boxSizing"}),CG=Pl(wG,UI,EG,TG,SG,AG,PG),VI=CG,IG=St({prop:"fontFamily",themeKey:"typography"}),kG=St({prop:"fontSize",themeKey:"typography"}),MG=St({prop:"fontStyle",themeKey:"typography"}),LG=St({prop:"fontWeight",themeKey:"typography"}),RG=St({prop:"letterSpacing"}),OG=St({prop:"textTransform"}),DG=St({prop:"lineHeight"}),zG=St({prop:"textAlign"}),FG=St({prop:"typography",cssProperty:!1,themeKey:"typography"}),BG=Pl(FG,IG,kG,MG,LG,RG,DG,zG,OG),jI=BG,BT={borders:RI.filterProps,display:OI.filterProps,flexbox:DI.filterProps,grid:zI.filterProps,positions:BI.filterProps,palette:FI.filterProps,shadows:NI.filterProps,sizing:VI.filterProps,spacing:Sy.filterProps,typography:jI.filterProps},GI={borders:RI,display:OI,flexbox:DI,grid:zI,positions:BI,palette:FI,shadows:NI,sizing:VI,spacing:Sy,typography:jI},NG=Object.keys(BT).reduce((t,e)=>(BT[e].forEach(n=>{t[n]=GI[e]}),t),{});function UG(...t){const e=t.reduce((r,s)=>r.concat(Object.keys(s)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function VG(t,e){return typeof t=="function"?t(e):t}function jG(t=GI){const e=Object.keys(t).reduce((s,l)=>(t[l].filterProps.forEach(d=>{s[d]=t[l]}),s),{});function n(s,l,d){const c={[s]:l,theme:d},v=e[s];return v?v(c):{[s]:l}}function r(s){const{sx:l,theme:d={}}=s||{};if(!l)return null;function c(v){let w=v;if(typeof v=="function")w=v(d);else if(typeof v!="object")return v;if(!w)return null;const C=f9(d.breakpoints),I=Object.keys(C);let S=C;return Object.keys(w).forEach(z=>{const F=VG(w[z],d);if(F!=null)if(typeof F=="object")if(e[z])S=ef(S,n(z,F,d));else{const B=Al({theme:d},F,Q=>({[z]:Q}));UG(B,F)?S[z]=r({sx:F,theme:d}):S=ef(S,B)}else S=ef(S,n(z,F,d))}),p9(I,S)}return Array.isArray(l)?l.map(c):c(l)}return r}const $I=jG();$I.filterProps=["sx"];const WI=$I,GG=["sx"],$G=t=>{const e={systemProps:{},otherProps:{}};return Object.keys(t).forEach(n=>{NG[n]?e.systemProps[n]=t[n]:e.otherProps[n]=t[n]}),e};function HI(t){const{sx:e}=t,n=Un(t,GG),{systemProps:r,otherProps:s}=$G(n);let l;return Array.isArray(e)?l=[r,...e]:typeof e=="function"?l=(...d)=>{const c=e(...d);return Fd(c)?Ze({},r,c):r}:l=Ze({},r,e),Ze({},s,{sx:l})}function qI(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=qI(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function es(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=qI(t))&&(r&&(r+=" "),r+=e);return r}const WG=["values","unit","step"],HG=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>Ze({},n,{[r.key]:r.val}),{})};function qG(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=t,s=Un(t,WG),l=HG(e),d=Object.keys(l);function c(S){return`@media (min-width:${typeof e[S]=="number"?e[S]:S}${n})`}function v(S){return`@media (max-width:${(typeof e[S]=="number"?e[S]:S)-r/100}${n})`}function w(S,z){const F=d.indexOf(z);return`@media (min-width:${typeof e[S]=="number"?e[S]:S}${n}) and (max-width:${(F!==-1&&typeof e[d[F]]=="number"?e[d[F]]:z)-r/100}${n})`}function C(S){return d.indexOf(S)+1<d.length?w(S,d[d.indexOf(S)+1]):c(S)}function I(S){const z=d.indexOf(S);return z===0?c(d[1]):z===d.length-1?v(d[z]):w(S,d[d.indexOf(S)+1]).replace("@media","@media not all and")}return Ze({keys:d,values:l,up:c,down:v,between:w,only:C,not:I,unit:n},s)}const XG={borderRadius:4},ZG=XG;function YG(t=8){if(t.mui)return t;const e=LI({spacing:t}),n=(...r)=>(r.length===0?[1]:r).map(l=>{const d=e(l);return typeof d=="number"?`${d}px`:d}).join(" ");return n.mui=!0,n}const KG=["breakpoints","palette","spacing","shape"];function X1(t={},...e){const{breakpoints:n={},palette:r={},spacing:s,shape:l={}}=t,d=Un(t,KG),c=qG(n),v=YG(s);let w=fa({breakpoints:c,direction:"ltr",components:{},palette:Ze({mode:"light"},r),spacing:v,shape:Ze({},ZG,l)},d);return w=e.reduce((C,I)=>fa(C,I),w),w}const JG=Ie.exports.createContext(null),QG=JG;function e7(){return Ie.exports.useContext(QG)}function t7(t){return Object.keys(t).length===0}function n7(t=null){const e=e7();return!e||t7(e)?t:e}const r7=X1();function Z1(t=r7){return n7(t)}const i7=["className","component"];function s7(t={}){const{defaultTheme:e,defaultClassName:n="MuiBox-root",generateClassName:r,styleFunctionSx:s=WI}=t,l=kI("div",{shouldForwardProp:c=>c!=="theme"&&c!=="sx"&&c!=="as"})(s);return Ie.exports.forwardRef(function(v,w){const C=Z1(e),I=HI(v),{className:S,component:z="div"}=I,F=Un(I,i7);return hn(l,Ze({as:z,ref:w,className:es(S,r?r(n):n),theme:C},F))})}const o7=s7(),a7=o7,l7=["variant"];function NT(t){return t.length===0}function XI(t){const{variant:e}=t,n=Un(t,l7);let r=e||"";return Object.keys(n).sort().forEach(s=>{s==="color"?r+=NT(r)?t[s]:po(t[s]):r+=`${NT(r)?s:po(s)}${po(t[s].toString())}`}),r}const c7=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],u7=["theme"],h7=["theme"];function Id(t){return Object.keys(t).length===0}function d7(t){return typeof t=="string"&&t.charCodeAt(0)>96}const f7=(t,e)=>e.components&&e.components[t]&&e.components[t].styleOverrides?e.components[t].styleOverrides:null,p7=(t,e)=>{let n=[];e&&e.components&&e.components[t]&&e.components[t].variants&&(n=e.components[t].variants);const r={};return n.forEach(s=>{const l=XI(s.props);r[l]=s.style}),r},m7=(t,e,n,r)=>{var s,l;const{ownerState:d={}}=t,c=[],v=n==null||(s=n.components)==null||(l=s[r])==null?void 0:l.variants;return v&&v.forEach(w=>{let C=!0;Object.keys(w.props).forEach(I=>{d[I]!==w.props[I]&&t[I]!==w.props[I]&&(C=!1)}),C&&c.push(e[XI(w.props)])}),c};function rg(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const g7=X1();function y7(t={}){const{defaultTheme:e=g7,rootShouldForwardProp:n=rg,slotShouldForwardProp:r=rg,styleFunctionSx:s=WI}=t,l=d=>{const c=Id(d.theme)?e:d.theme;return s(Ze({},d,{theme:c}))};return l.__mui_systemSx=!0,(d,c={})=>{i9(d,se=>se.filter(he=>!(he!=null&&he.__mui_systemSx)));const{name:v,slot:w,skipVariantsResolver:C,skipSx:I,overridesResolver:S}=c,z=Un(c,c7),F=C!==void 0?C:w&&w!=="Root"||!1,B=I||!1;let Q,q=rg;w==="Root"?q=n:w?q=r:d7(d)&&(q=void 0);const j=kI(d,Ze({shouldForwardProp:q,label:Q},z)),G=(se,...he)=>{const ye=he?he.map(xe=>typeof xe=="function"&&xe.__emotion_real!==xe?He=>{let{theme:wt}=He,yt=Un(He,u7);return xe(Ze({theme:Id(wt)?e:wt},yt))}:xe):[];let we=se;v&&S&&ye.push(xe=>{const He=Id(xe.theme)?e:xe.theme,wt=f7(v,He);if(wt){const yt={};return Object.entries(wt).forEach(([ot,zt])=>{yt[ot]=typeof zt=="function"?zt(Ze({},xe,{theme:He})):zt}),S(xe,yt)}return null}),v&&!F&&ye.push(xe=>{const He=Id(xe.theme)?e:xe.theme;return m7(xe,p7(v,He),He,v)}),B||ye.push(l);const Be=ye.length-he.length;if(Array.isArray(se)&&Be>0){const xe=new Array(Be).fill("");we=[...se,...xe],we.raw=[...se.raw,...xe]}else typeof se=="function"&&se.__emotion_real!==se&&(we=xe=>{let{theme:He}=xe,wt=Un(xe,h7);return se(Ze({theme:Id(He)?e:He},wt))});return j(we,...ye)};return j.withConfig&&(G.withConfig=j.withConfig),G}}function _7(t){const{theme:e,name:n,props:r}=t;return!e||!e.components||!e.components[n]||!e.components[n].defaultProps?r:l9(e.components[n].defaultProps,r)}function ZI({props:t,name:e,defaultTheme:n}){const r=Z1(n);return _7({theme:r,name:e,props:t})}function Y1(t,e=0,n=1){return Math.min(Math.max(e,t),n)}function v7(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,s)=>s<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function Pc(t){if(t.type)return t;if(t.charAt(0)==="#")return Pc(v7(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error(uh(9,t));let r=t.substring(e+1,t.length-1),s;if(n==="color"){if(r=r.split(" "),s=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(s)===-1)throw new Error(uh(10,s))}else r=r.split(",");return r=r.map(l=>parseFloat(l)),{type:n,values:r,colorSpace:s}}function Ay(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.indexOf("rgb")!==-1?r=r.map((s,l)=>l<3?parseInt(s,10):s):e.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.indexOf("color")!==-1?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function x7(t){t=Pc(t);const{values:e}=t,n=e[0],r=e[1]/100,s=e[2]/100,l=r*Math.min(s,1-s),d=(w,C=(w+n/30)%12)=>s-l*Math.max(Math.min(C-3,9-C,1),-1);let c="rgb";const v=[Math.round(d(0)*255),Math.round(d(8)*255),Math.round(d(4)*255)];return t.type==="hsla"&&(c+="a",v.push(e[3])),Ay({type:c,values:v})}function UT(t){t=Pc(t);let e=t.type==="hsl"||t.type==="hsla"?Pc(x7(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function b7(t,e){const n=UT(t),r=UT(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function VT(t,e){return t=Pc(t),e=Y1(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,Ay(t)}function w7(t,e){if(t=Pc(t),e=Y1(e),t.type.indexOf("hsl")!==-1)t.values[2]*=1-e;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]*=1-e;return Ay(t)}function E7(t,e){if(t=Pc(t),e=Y1(e),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*e;else if(t.type.indexOf("rgb")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return Ay(t)}function T7(t,e){return Ze({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},e)}const S7=["mode","contrastThreshold","tonalOffset"],jT={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Cf.white,default:Cf.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},O0={text:{primary:Cf.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Cf.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function GT(t,e,n,r){const s=r.light||r,l=r.dark||r*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=E7(t.main,s):e==="dark"&&(t.dark=w7(t.main,l)))}function A7(t="light"){return t==="dark"?{main:gu[200],light:gu[50],dark:gu[400]}:{main:gu[700],light:gu[400],dark:gu[800]}}function P7(t="light"){return t==="dark"?{main:mu[200],light:mu[50],dark:mu[400]}:{main:mu[500],light:mu[300],dark:mu[700]}}function C7(t="light"){return t==="dark"?{main:pu[500],light:pu[300],dark:pu[700]}:{main:pu[700],light:pu[400],dark:pu[800]}}function I7(t="light"){return t==="dark"?{main:yu[400],light:yu[300],dark:yu[700]}:{main:yu[700],light:yu[500],dark:yu[900]}}function k7(t="light"){return t==="dark"?{main:_u[400],light:_u[300],dark:_u[700]}:{main:_u[800],light:_u[500],dark:_u[900]}}function M7(t="light"){return t==="dark"?{main:Pd[400],light:Pd[300],dark:Pd[700]}:{main:"#ed6c02",light:Pd[500],dark:Pd[900]}}function L7(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2}=t,s=Un(t,S7),l=t.primary||A7(e),d=t.secondary||P7(e),c=t.error||C7(e),v=t.info||I7(e),w=t.success||k7(e),C=t.warning||M7(e);function I(B){return b7(B,O0.text.primary)>=n?O0.text.primary:jT.text.primary}const S=({color:B,name:Q,mainShade:q=500,lightShade:j=300,darkShade:G=700})=>{if(B=Ze({},B),!B.main&&B[q]&&(B.main=B[q]),!B.hasOwnProperty("main"))throw new Error(uh(11,Q?` (${Q})`:"",q));if(typeof B.main!="string")throw new Error(uh(12,Q?` (${Q})`:"",JSON.stringify(B.main)));return GT(B,"light",j,r),GT(B,"dark",G,r),B.contrastText||(B.contrastText=I(B.main)),B},z={dark:O0,light:jT};return fa(Ze({common:Ze({},Cf),mode:e,primary:S({color:l,name:"primary"}),secondary:S({color:d,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:S({color:c,name:"error"}),warning:S({color:C,name:"warning"}),info:S({color:v,name:"info"}),success:S({color:w,name:"success"}),grey:tj,contrastThreshold:n,getContrastText:I,augmentColor:S,tonalOffset:r},z[e]),s)}const R7=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function O7(t){return Math.round(t*1e5)/1e5}const $T={textTransform:"uppercase"},WT='"Roboto", "Helvetica", "Arial", sans-serif';function D7(t,e){const n=typeof e=="function"?e(t):e,{fontFamily:r=WT,fontSize:s=14,fontWeightLight:l=300,fontWeightRegular:d=400,fontWeightMedium:c=500,fontWeightBold:v=700,htmlFontSize:w=16,allVariants:C,pxToRem:I}=n,S=Un(n,R7),z=s/14,F=I||(q=>`${q/w*z}rem`),B=(q,j,G,se,he)=>Ze({fontFamily:r,fontWeight:q,fontSize:F(j),lineHeight:G},r===WT?{letterSpacing:`${O7(se/j)}em`}:{},he,C),Q={h1:B(l,96,1.167,-1.5),h2:B(l,60,1.2,-.5),h3:B(d,48,1.167,0),h4:B(d,34,1.235,.25),h5:B(d,24,1.334,0),h6:B(c,20,1.6,.15),subtitle1:B(d,16,1.75,.15),subtitle2:B(c,14,1.57,.1),body1:B(d,16,1.5,.15),body2:B(d,14,1.43,.15),button:B(c,14,1.75,.4,$T),caption:B(d,12,1.66,.4),overline:B(d,12,2.66,1,$T)};return fa(Ze({htmlFontSize:w,pxToRem:F,fontFamily:r,fontSize:s,fontWeightLight:l,fontWeightRegular:d,fontWeightMedium:c,fontWeightBold:v},Q),S,{clone:!1})}const z7=.2,F7=.14,B7=.12;function ur(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${z7})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${F7})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${B7})`].join(",")}const N7=["none",ur(0,2,1,-1,0,1,1,0,0,1,3,0),ur(0,3,1,-2,0,2,2,0,0,1,5,0),ur(0,3,3,-2,0,3,4,0,0,1,8,0),ur(0,2,4,-1,0,4,5,0,0,1,10,0),ur(0,3,5,-1,0,5,8,0,0,1,14,0),ur(0,3,5,-1,0,6,10,0,0,1,18,0),ur(0,4,5,-2,0,7,10,1,0,2,16,1),ur(0,5,5,-3,0,8,10,1,0,3,14,2),ur(0,5,6,-3,0,9,12,1,0,3,16,2),ur(0,6,6,-3,0,10,14,1,0,4,18,3),ur(0,6,7,-4,0,11,15,1,0,4,20,3),ur(0,7,8,-4,0,12,17,2,0,5,22,4),ur(0,7,8,-4,0,13,19,2,0,5,24,4),ur(0,7,9,-4,0,14,21,2,0,5,26,4),ur(0,8,9,-5,0,15,22,2,0,6,28,5),ur(0,8,10,-5,0,16,24,2,0,6,30,5),ur(0,8,11,-5,0,17,26,2,0,6,32,5),ur(0,9,11,-5,0,18,28,2,0,7,34,6),ur(0,9,12,-6,0,19,29,2,0,7,36,6),ur(0,10,13,-6,0,20,31,3,0,8,38,7),ur(0,10,13,-6,0,21,33,3,0,8,40,7),ur(0,10,14,-6,0,22,35,3,0,8,42,7),ur(0,11,14,-7,0,23,36,3,0,9,44,8),ur(0,11,15,-7,0,24,38,3,0,9,46,8)],U7=N7,V7=["duration","easing","delay"],j7={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},G7={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function HT(t){return`${Math.round(t)}ms`}function $7(t){if(!t)return 0;const e=t/36;return Math.round((4+15*e**.25+e/5)*10)}function W7(t){const e=Ze({},j7,t.easing),n=Ze({},G7,t.duration);return Ze({getAutoHeightDuration:$7,create:(s=["all"],l={})=>{const{duration:d=n.standard,easing:c=e.easeInOut,delay:v=0}=l;return Un(l,V7),(Array.isArray(s)?s:[s]).map(w=>`${w} ${typeof d=="string"?d:HT(d)} ${c} ${typeof v=="string"?v:HT(v)}`).join(",")}},t,{easing:e,duration:n})}const H7={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},q7=H7,X7=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function Z7(t={},...e){const{mixins:n={},palette:r={},transitions:s={},typography:l={}}=t,d=Un(t,X7);if(t.vars)throw new Error(uh(18));const c=L7(r),v=X1(t);let w=fa(v,{mixins:T7(v.breakpoints,n),palette:c,shadows:U7.slice(),typography:D7(c,l),transitions:W7(s),zIndex:Ze({},q7)});return w=fa(w,d),w=e.reduce((C,I)=>fa(C,I),w),w}const Y7=Z7(),K1=Y7;function Py(){return Z1(K1)}function Il({props:t,name:e}){return ZI({props:t,name:e,defaultTheme:K1})}const YI=t=>rg(t)&&t!=="classes",K7=y7({defaultTheme:K1,rootShouldForwardProp:YI}),Xs=K7,J7=t=>{let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,(e/100).toFixed(2)},qT=J7;function KI(t){return typeof t=="string"}function Q7(t,e,n){return t===void 0||KI(t)?e:Ze({},e,{ownerState:Ze({},e.ownerState,n)})}function e$(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(r=>r.match(/^on[A-Z]/)&&typeof t[r]=="function"&&!e.includes(r)).forEach(r=>{n[r]=t[r]}),n}function hx(t,e){return typeof t=="function"?t(e):t}function XT(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function t$(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:r,externalForwardedProps:s,className:l}=t;if(!e){const z=es(s==null?void 0:s.className,r==null?void 0:r.className,l,n==null?void 0:n.className),F=Ze({},n==null?void 0:n.style,s==null?void 0:s.style,r==null?void 0:r.style),B=Ze({},n,s,r);return z.length>0&&(B.className=z),Object.keys(F).length>0&&(B.style=F),{props:B,internalRef:void 0}}const d=e$(Ze({},s,r)),c=XT(r),v=XT(s),w=e(d),C=es(w==null?void 0:w.className,n==null?void 0:n.className,l,s==null?void 0:s.className,r==null?void 0:r.className),I=Ze({},w==null?void 0:w.style,n==null?void 0:n.style,s==null?void 0:s.style,r==null?void 0:r.style),S=Ze({},w,n,v,c);return C.length>0&&(S.className=C),Object.keys(I).length>0&&(S.style=I),{props:S,internalRef:w.ref}}const n$=["elementType","externalSlotProps","ownerState"];function ZT(t){var e;const{elementType:n,externalSlotProps:r,ownerState:s}=t,l=Un(t,n$),d=hx(r,s),{props:c,internalRef:v}=t$(Ze({},l,{externalSlotProps:d})),w=Lc(v,d==null?void 0:d.ref,(e=t.additionalProps)==null?void 0:e.ref);return Q7(n,Ze({},c,{ref:w}),s)}const r$=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function i$(t){const e=parseInt(t.getAttribute("tabindex"),10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function s$(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=r=>t.ownerDocument.querySelector(`input[type="radio"]${r}`);let n=e(`[name="${t.name}"]:checked`);return n||(n=e(`[name="${t.name}"]`)),n!==t}function o$(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||s$(t))}function a$(t){const e=[],n=[];return Array.from(t.querySelectorAll(r$)).forEach((r,s)=>{const l=i$(r);l===-1||!o$(r)||(l===0?e.push(r):n.push({documentOrder:s,tabIndex:l,node:r}))}),n.sort((r,s)=>r.tabIndex===s.tabIndex?r.documentOrder-s.documentOrder:r.tabIndex-s.tabIndex).map(r=>r.node).concat(e)}function l$(){return!0}function c$(t){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:s=!1,getTabbable:l=a$,isEnabled:d=l$,open:c}=t,v=Ie.exports.useRef(),w=Ie.exports.useRef(null),C=Ie.exports.useRef(null),I=Ie.exports.useRef(null),S=Ie.exports.useRef(null),z=Ie.exports.useRef(!1),F=Ie.exports.useRef(null),B=Lc(e.ref,F),Q=Ie.exports.useRef(null);Ie.exports.useEffect(()=>{!c||!F.current||(z.current=!n)},[n,c]),Ie.exports.useEffect(()=>{if(!c||!F.current)return;const G=js(F.current);return F.current.contains(G.activeElement)||(F.current.hasAttribute("tabIndex")||F.current.setAttribute("tabIndex",-1),z.current&&F.current.focus()),()=>{s||(I.current&&I.current.focus&&(v.current=!0,I.current.focus()),I.current=null)}},[c]),Ie.exports.useEffect(()=>{if(!c||!F.current)return;const G=js(F.current),se=we=>{const{current:Be}=F;if(Be!==null){if(!G.hasFocus()||r||!d()||v.current){v.current=!1;return}if(!Be.contains(G.activeElement)){if(we&&S.current!==we.target||G.activeElement!==S.current)S.current=null;else if(S.current!==null)return;if(!z.current)return;let He=[];if((G.activeElement===w.current||G.activeElement===C.current)&&(He=l(F.current)),He.length>0){var Ve,xe;const wt=Boolean(((Ve=Q.current)==null?void 0:Ve.shiftKey)&&((xe=Q.current)==null?void 0:xe.key)==="Tab"),yt=He[0],ot=He[He.length-1];wt?ot.focus():yt.focus()}else Be.focus()}}},he=we=>{Q.current=we,!(r||!d()||we.key!=="Tab")&&G.activeElement===F.current&&we.shiftKey&&(v.current=!0,C.current.focus())};G.addEventListener("focusin",se),G.addEventListener("keydown",he,!0);const ye=setInterval(()=>{G.activeElement.tagName==="BODY"&&se()},50);return()=>{clearInterval(ye),G.removeEventListener("focusin",se),G.removeEventListener("keydown",he,!0)}},[n,r,s,d,c,l]);const q=G=>{I.current===null&&(I.current=G.relatedTarget),z.current=!0,S.current=G.target;const se=e.props.onFocus;se&&se(G)},j=G=>{I.current===null&&(I.current=G.relatedTarget),z.current=!0};return ch(Ie.exports.Fragment,{children:[hn("div",{tabIndex:c?0:-1,onFocus:j,ref:w,"data-testid":"sentinelStart"}),Ie.exports.cloneElement(e,{ref:B,onFocus:q}),hn("div",{tabIndex:c?0:-1,onFocus:j,ref:C,"data-testid":"sentinelEnd"})]})}function u$(t){return typeof t=="function"?t():t}const h$=Ie.exports.forwardRef(function(e,n){const{children:r,container:s,disablePortal:l=!1}=e,[d,c]=Ie.exports.useState(null),v=Lc(Ie.exports.isValidElement(r)?r.ref:null,n);return Lf(()=>{l||c(u$(s)||document.body)},[s,l]),Lf(()=>{if(d&&!l)return ux(n,d),()=>{ux(n,null)}},[n,d,l]),l?Ie.exports.isValidElement(r)?Ie.exports.cloneElement(r,{ref:v}):r:hn(Ie.exports.Fragment,{children:d&&gl.exports.createPortal(r,d)})}),d$=h$;function f$(t){const e=js(t);return e.body===t?pa(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function tf(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function YT(t){return parseInt(pa(t).getComputedStyle(t).paddingRight,10)||0}function p$(t){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(t.tagName)!==-1,r=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return n||r}function KT(t,e,n,r,s){const l=[e,n,...r];[].forEach.call(t.children,d=>{const c=l.indexOf(d)===-1,v=!p$(d);c&&v&&tf(d,s)})}function D0(t,e){let n=-1;return t.some((r,s)=>e(r)?(n=s,!0):!1),n}function m$(t,e){const n=[],r=t.container;if(!e.disableScrollLock){if(f$(r)){const d=a9(js(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${YT(r)+d}px`;const c=js(r).querySelectorAll(".mui-fixed");[].forEach.call(c,v=>{n.push({value:v.style.paddingRight,property:"padding-right",el:v}),v.style.paddingRight=`${YT(v)+d}px`})}let l;if(r.parentNode instanceof DocumentFragment)l=js(r).body;else{const d=r.parentElement,c=pa(r);l=(d==null?void 0:d.nodeName)==="HTML"&&c.getComputedStyle(d).overflowY==="scroll"?d:r}n.push({value:l.style.overflow,property:"overflow",el:l},{value:l.style.overflowX,property:"overflow-x",el:l},{value:l.style.overflowY,property:"overflow-y",el:l}),l.style.overflow="hidden"}return()=>{n.forEach(({value:l,el:d,property:c})=>{l?d.style.setProperty(c,l):d.style.removeProperty(c)})}}function g$(t){const e=[];return[].forEach.call(t.children,n=>{n.getAttribute("aria-hidden")==="true"&&e.push(n)}),e}class y${constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,n){let r=this.modals.indexOf(e);if(r!==-1)return r;r=this.modals.length,this.modals.push(e),e.modalRef&&tf(e.modalRef,!1);const s=g$(n);KT(n,e.mount,e.modalRef,s,!0);const l=D0(this.containers,d=>d.container===n);return l!==-1?(this.containers[l].modals.push(e),r):(this.containers.push({modals:[e],container:n,restore:null,hiddenSiblings:s}),r)}mount(e,n){const r=D0(this.containers,l=>l.modals.indexOf(e)!==-1),s=this.containers[r];s.restore||(s.restore=m$(s,n))}remove(e,n=!0){const r=this.modals.indexOf(e);if(r===-1)return r;const s=D0(this.containers,d=>d.modals.indexOf(e)!==-1),l=this.containers[s];if(l.modals.splice(l.modals.indexOf(e),1),this.modals.splice(r,1),l.modals.length===0)l.restore&&l.restore(),e.modalRef&&tf(e.modalRef,n),KT(l.container,e.mount,e.modalRef,l.hiddenSiblings,!1),this.containers.splice(s,1);else{const d=l.modals[l.modals.length-1];d.modalRef&&tf(d.modalRef,!1)}return r}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}function _$(t){return Sa("MuiModal",t)}Sl("MuiModal",["root","hidden"]);const v$=["children","classes","closeAfterTransition","component","container","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","manager","onBackdropClick","onClose","onKeyDown","open","onTransitionEnter","onTransitionExited","slotProps","slots"],x$=t=>{const{open:e,exited:n,classes:r}=t;return Tl({root:["root",!e&&n&&"hidden"]},_$,r)};function b$(t){return typeof t=="function"?t():t}function w$(t){return t.children?t.children.props.hasOwnProperty("in"):!1}const E$=new y$,T$=Ie.exports.forwardRef(function(e,n){var r,s;const{children:l,classes:d,closeAfterTransition:c=!1,component:v,container:w,disableAutoFocus:C=!1,disableEnforceFocus:I=!1,disableEscapeKeyDown:S=!1,disablePortal:z=!1,disableRestoreFocus:F=!1,disableScrollLock:B=!1,hideBackdrop:Q=!1,keepMounted:q=!1,manager:j=E$,onBackdropClick:G,onClose:se,onKeyDown:he,open:ye,onTransitionEnter:we,onTransitionExited:Be,slotProps:Ve={},slots:xe={}}=e,He=Un(e,v$),[wt,yt]=Ie.exports.useState(!ye),ot=Ie.exports.useRef({}),zt=Ie.exports.useRef(null),Qe=Ie.exports.useRef(null),yn=Lc(Qe,n),Ne=w$(e),et=(r=e["aria-hidden"])!=null?r:!0,_t=()=>js(zt.current),at=()=>(ot.current.modalRef=Qe.current,ot.current.mountNode=zt.current,ot.current),Ot=()=>{j.mount(at(),{disableScrollLock:B}),Qe.current.scrollTop=0},tn=Qd(()=>{const jn=b$(w)||_t().body;j.add(at(),jn),Qe.current&&Ot()}),$t=Ie.exports.useCallback(()=>j.isTopModal(at()),[j]),cn=Qd(jn=>{zt.current=jn,jn&&(ye&&$t()?Ot():tf(Qe.current,et))}),sn=Ie.exports.useCallback(()=>{j.remove(at(),et)},[j,et]);Ie.exports.useEffect(()=>()=>{sn()},[sn]),Ie.exports.useEffect(()=>{ye?tn():(!Ne||!c)&&sn()},[ye,sn,Ne,c,tn]);const Bt=Ze({},e,{classes:d,closeAfterTransition:c,disableAutoFocus:C,disableEnforceFocus:I,disableEscapeKeyDown:S,disablePortal:z,disableRestoreFocus:F,disableScrollLock:B,exited:wt,hideBackdrop:Q,keepMounted:q}),fn=x$(Bt),jt=()=>{yt(!1),we&&we()},Kt=()=>{yt(!0),Be&&Be(),c&&sn()},Wn=jn=>{jn.target===jn.currentTarget&&(G&&G(jn),se&&se(jn,"backdropClick"))},In=jn=>{he&&he(jn),!(jn.key!=="Escape"||!$t())&&(S||(jn.stopPropagation(),se&&se(jn,"escapeKeyDown")))},Vn={};l.props.tabIndex===void 0&&(Vn.tabIndex="-1"),Ne&&(Vn.onEnter=RT(jt,l.props.onEnter),Vn.onExited=RT(Kt,l.props.onExited));const kr=(s=v!=null?v:xe.root)!=null?s:"div",or=ZT({elementType:kr,externalSlotProps:Ve.root,externalForwardedProps:He,additionalProps:{ref:yn,role:"presentation",onKeyDown:In},className:fn.root,ownerState:Bt}),Hn=xe.backdrop,Mr=ZT({elementType:Hn,externalSlotProps:Ve.backdrop,additionalProps:{"aria-hidden":!0,onClick:Wn,open:ye},className:fn.backdrop,ownerState:Bt});return!q&&!ye&&(!Ne||wt)?null:hn(d$,{ref:cn,container:w,disablePortal:z,children:ch(kr,Ze({},or,{children:[!Q&&Hn?hn(Hn,Ze({},Mr)):null,hn(c$,{disableEnforceFocus:I,disableAutoFocus:C,disableRestoreFocus:F,isEnabled:$t,open:ye,children:Ie.exports.cloneElement(l,Vn)})]}))})}),S$=T$;function A$(t){const{children:e,defer:n=!1,fallback:r=null}=t,[s,l]=Ie.exports.useState(!1);return Lf(()=>{n||l(!0)},[n]),Ie.exports.useEffect(()=>{n&&l(!0)},[n]),hn(Ie.exports.Fragment,{children:s?e:r})}function dx(t,e){return dx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},dx(t,e)}function P$(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,dx(t,e)}const JT={disabled:!1},JI=Fu.createContext(null);var C$=function(e){return e.scrollTop},Bd="unmounted",uc="exited",hc="entering",bu="entered",fx="exiting",Aa=function(t){P$(e,t);function e(r,s){var l;l=t.call(this,r,s)||this;var d=s,c=d&&!d.isMounting?r.enter:r.appear,v;return l.appearStatus=null,r.in?c?(v=uc,l.appearStatus=hc):v=bu:r.unmountOnExit||r.mountOnEnter?v=Bd:v=uc,l.state={status:v},l.nextCallback=null,l}e.getDerivedStateFromProps=function(s,l){var d=s.in;return d&&l.status===Bd?{status:uc}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(s){var l=null;if(s!==this.props){var d=this.state.status;this.props.in?d!==hc&&d!==bu&&(l=hc):(d===hc||d===bu)&&(l=fx)}this.updateStatus(!1,l)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var s=this.props.timeout,l,d,c;return l=d=c=s,s!=null&&typeof s!="number"&&(l=s.exit,d=s.enter,c=s.appear!==void 0?s.appear:d),{exit:l,enter:d,appear:c}},n.updateStatus=function(s,l){if(s===void 0&&(s=!1),l!==null)if(this.cancelNextCallback(),l===hc){if(this.props.unmountOnExit||this.props.mountOnEnter){var d=this.props.nodeRef?this.props.nodeRef.current:vm.findDOMNode(this);d&&C$(d)}this.performEnter(s)}else this.performExit();else this.props.unmountOnExit&&this.state.status===uc&&this.setState({status:Bd})},n.performEnter=function(s){var l=this,d=this.props.enter,c=this.context?this.context.isMounting:s,v=this.props.nodeRef?[c]:[vm.findDOMNode(this),c],w=v[0],C=v[1],I=this.getTimeouts(),S=c?I.appear:I.enter;if(!s&&!d||JT.disabled){this.safeSetState({status:bu},function(){l.props.onEntered(w)});return}this.props.onEnter(w,C),this.safeSetState({status:hc},function(){l.props.onEntering(w,C),l.onTransitionEnd(S,function(){l.safeSetState({status:bu},function(){l.props.onEntered(w,C)})})})},n.performExit=function(){var s=this,l=this.props.exit,d=this.getTimeouts(),c=this.props.nodeRef?void 0:vm.findDOMNode(this);if(!l||JT.disabled){this.safeSetState({status:uc},function(){s.props.onExited(c)});return}this.props.onExit(c),this.safeSetState({status:fx},function(){s.props.onExiting(c),s.onTransitionEnd(d.exit,function(){s.safeSetState({status:uc},function(){s.props.onExited(c)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(s,l){l=this.setNextCallback(l),this.setState(s,l)},n.setNextCallback=function(s){var l=this,d=!0;return this.nextCallback=function(c){d&&(d=!1,l.nextCallback=null,s(c))},this.nextCallback.cancel=function(){d=!1},this.nextCallback},n.onTransitionEnd=function(s,l){this.setNextCallback(l);var d=this.props.nodeRef?this.props.nodeRef.current:vm.findDOMNode(this),c=s==null&&!this.props.addEndListener;if(!d||c){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var v=this.props.nodeRef?[this.nextCallback]:[d,this.nextCallback],w=v[0],C=v[1];this.props.addEndListener(w,C)}s!=null&&setTimeout(this.nextCallback,s)},n.render=function(){var s=this.state.status;if(s===Bd)return null;var l=this.props,d=l.children;l.in,l.mountOnEnter,l.unmountOnExit,l.appear,l.enter,l.exit,l.timeout,l.addEndListener,l.onEnter,l.onEntering,l.onEntered,l.onExit,l.onExiting,l.onExited,l.nodeRef;var c=Un(l,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return hn(JI.Provider,{value:null,children:typeof d=="function"?d(s,c):Fu.cloneElement(Fu.Children.only(d),c)})},e}(Fu.Component);Aa.contextType=JI;Aa.propTypes={};function vu(){}Aa.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:vu,onEntering:vu,onEntered:vu,onExit:vu,onExiting:vu,onExited:vu};Aa.UNMOUNTED=Bd;Aa.EXITED=uc;Aa.ENTERING=hc;Aa.ENTERED=bu;Aa.EXITING=fx;const QI=Aa,ek=t=>t.scrollTop;function Rf(t,e){var n,r;const{timeout:s,easing:l,style:d={}}=t;return{duration:(n=d.transitionDuration)!=null?n:typeof s=="number"?s:s[e.mode]||0,easing:(r=d.transitionTimingFunction)!=null?r:typeof l=="object"?l[e.mode]:l,delay:d.transitionDelay}}function I$(t){return Sa("MuiPaper",t)}Sl("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const k$=["className","component","elevation","square","variant"],M$=t=>{const{square:e,elevation:n,variant:r,classes:s}=t,l={root:["root",r,!e&&"rounded",r==="elevation"&&`elevation${n}`]};return Tl(l,I$,s)},L$=Xs("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],!n.square&&e.rounded,n.variant==="elevation"&&e[`elevation${n.elevation}`]]}})(({theme:t,ownerState:e})=>{var n;return Ze({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!e.square&&{borderRadius:t.shape.borderRadius},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.divider}`},e.variant==="elevation"&&Ze({boxShadow:(t.vars||t).shadows[e.elevation]},!t.vars&&t.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${VT("#fff",qT(e.elevation))}, ${VT("#fff",qT(e.elevation))})`},t.vars&&{backgroundImage:(n=t.vars.overlays)==null?void 0:n[e.elevation]}))}),R$=Ie.exports.forwardRef(function(e,n){const r=Il({props:e,name:"MuiPaper"}),{className:s,component:l="div",elevation:d=1,square:c=!1,variant:v="elevation"}=r,w=Un(r,k$),C=Ze({},r,{component:l,elevation:d,square:c,variant:v}),I=M$(C);return hn(L$,Ze({as:l,ownerState:C,className:es(I.root,s),ref:n},w))}),tk=R$;function O$(t){return Sa("MuiTypography",t)}Sl("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const D$=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],z$=t=>{const{align:e,gutterBottom:n,noWrap:r,paragraph:s,variant:l,classes:d}=t,c={root:["root",l,t.align!=="inherit"&&`align${po(e)}`,n&&"gutterBottom",r&&"noWrap",s&&"paragraph"]};return Tl(c,O$,d)},F$=Xs("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.variant&&e[n.variant],n.align!=="inherit"&&e[`align${po(n.align)}`],n.noWrap&&e.noWrap,n.gutterBottom&&e.gutterBottom,n.paragraph&&e.paragraph]}})(({theme:t,ownerState:e})=>Ze({margin:0},e.variant&&t.typography[e.variant],e.align!=="inherit"&&{textAlign:e.align},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.paragraph&&{marginBottom:16})),QT={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},B$={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},N$=t=>B$[t]||t,U$=Ie.exports.forwardRef(function(e,n){const r=Il({props:e,name:"MuiTypography"}),s=N$(r.color),l=HI(Ze({},r,{color:s})),{align:d="inherit",className:c,component:v,gutterBottom:w=!1,noWrap:C=!1,paragraph:I=!1,variant:S="body1",variantMapping:z=QT}=l,F=Un(l,D$),B=Ze({},l,{align:d,color:s,className:c,component:v,gutterBottom:w,noWrap:C,paragraph:I,variant:S,variantMapping:z}),Q=v||(I?"p":z[S]||QT[S])||"span",q=z$(B);return hn(F$,Ze({as:Q,ref:n,ownerState:B,className:es(q.root,c)},F))}),eS=U$,V$=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],j$={entering:{opacity:1},entered:{opacity:1}},G$=Ie.exports.forwardRef(function(e,n){const r=Py(),s={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:l,appear:d=!0,children:c,easing:v,in:w,onEnter:C,onEntered:I,onEntering:S,onExit:z,onExited:F,onExiting:B,style:Q,timeout:q=s,TransitionComponent:j=QI}=e,G=Un(e,V$),se=Ie.exports.useRef(null),he=Lc(se,c.ref,n),ye=ot=>zt=>{if(ot){const Qe=se.current;zt===void 0?ot(Qe):ot(Qe,zt)}},we=ye(S),Be=ye((ot,zt)=>{ek(ot);const Qe=Rf({style:Q,timeout:q,easing:v},{mode:"enter"});ot.style.webkitTransition=r.transitions.create("opacity",Qe),ot.style.transition=r.transitions.create("opacity",Qe),C&&C(ot,zt)}),Ve=ye(I),xe=ye(B),He=ye(ot=>{const zt=Rf({style:Q,timeout:q,easing:v},{mode:"exit"});ot.style.webkitTransition=r.transitions.create("opacity",zt),ot.style.transition=r.transitions.create("opacity",zt),z&&z(ot)}),wt=ye(F);return hn(j,Ze({appear:d,in:w,nodeRef:se,onEnter:Be,onEntered:Ve,onEntering:we,onExit:He,onExited:wt,onExiting:xe,addEndListener:ot=>{l&&l(se.current,ot)},timeout:q},G,{children:(ot,zt)=>Ie.exports.cloneElement(c,Ze({style:Ze({opacity:0,visibility:ot==="exited"&&!w?"hidden":void 0},j$[ot],Q,c.props.style),ref:he},zt))}))}),$$=G$;function W$(t){return Sa("MuiBackdrop",t)}Sl("MuiBackdrop",["root","invisible"]);const H$=["children","component","components","componentsProps","className","invisible","open","slotProps","slots","transitionDuration","TransitionComponent"],q$=t=>{const{classes:e,invisible:n}=t;return Tl({root:["root",n&&"invisible"]},W$,e)},X$=Xs("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.invisible&&e.invisible]}})(({ownerState:t})=>Ze({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"})),Z$=Ie.exports.forwardRef(function(e,n){var r,s,l;const d=Il({props:e,name:"MuiBackdrop"}),{children:c,component:v="div",components:w={},componentsProps:C={},className:I,invisible:S=!1,open:z,slotProps:F={},slots:B={},transitionDuration:Q,TransitionComponent:q=$$}=d,j=Un(d,H$),G=Ze({},d,{component:v,invisible:S}),se=q$(G),he=(r=F.root)!=null?r:C.root;return hn(q,Ze({in:z,timeout:Q},j,{children:hn(X$,Ze({"aria-hidden":!0},he,{as:(s=(l=B.root)!=null?l:w.Root)!=null?s:v,className:es(se.root,I,he==null?void 0:he.className),ownerState:Ze({},G,he==null?void 0:he.ownerState),classes:se,ref:n,children:c}))}))}),Y$=Z$;function K$(t){return Sa("MuiCard",t)}Sl("MuiCard",["root"]);const J$=["className","raised"],Q$=t=>{const{classes:e}=t;return Tl({root:["root"]},K$,e)},eW=Xs(tk,{name:"MuiCard",slot:"Root",overridesResolver:(t,e)=>e.root})(()=>({overflow:"hidden"})),tW=Ie.exports.forwardRef(function(e,n){const r=Il({props:e,name:"MuiCard"}),{className:s,raised:l=!1}=r,d=Un(r,J$),c=Ze({},r,{raised:l}),v=Q$(c);return hn(eW,Ze({className:es(v.root,s),elevation:l?8:void 0,ref:n,ownerState:c},d))}),nW=tW;function rW(t){return Sa("MuiCardContent",t)}Sl("MuiCardContent",["root"]);const iW=["className","component"],sW=t=>{const{classes:e}=t;return Tl({root:["root"]},rW,e)},oW=Xs("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(t,e)=>e.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),aW=Ie.exports.forwardRef(function(e,n){const r=Il({props:e,name:"MuiCardContent"}),{className:s,component:l="div"}=r,d=Un(r,iW),c=Ze({},r,{component:l}),v=sW(c);return hn(oW,Ze({as:l,className:es(v.root,s),ownerState:c,ref:n},d))}),lW=aW;function cW(t){return Sa("MuiCardMedia",t)}Sl("MuiCardMedia",["root","media","img"]);const uW=["children","className","component","image","src","style"],hW=t=>{const{classes:e,isMediaComponent:n,isImageComponent:r}=t;return Tl({root:["root",n&&"media",r&&"img"]},cW,e)},dW=Xs("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t,{isMediaComponent:r,isImageComponent:s}=n;return[e.root,r&&e.media,s&&e.img]}})(({ownerState:t})=>Ze({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},t.isMediaComponent&&{width:"100%"},t.isImageComponent&&{objectFit:"cover"})),fW=["video","audio","picture","iframe","img"],pW=["picture","img"],mW=Ie.exports.forwardRef(function(e,n){const r=Il({props:e,name:"MuiCardMedia"}),{children:s,className:l,component:d="div",image:c,src:v,style:w}=r,C=Un(r,uW),I=fW.indexOf(d)!==-1,S=!I&&c?Ze({backgroundImage:`url("${c}")`},w):w,z=Ze({},r,{component:d,isMediaComponent:I,isImageComponent:pW.indexOf(d)!==-1}),F=hW(z);return hn(dW,Ze({className:es(F.root,l),as:d,role:!I&&c?"img":void 0,ref:n,style:S,ownerState:z,src:I?c||v:void 0},C,{children:s}))}),gW=mW,yW=["BackdropComponent","BackdropProps","closeAfterTransition","children","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","slotProps","slots","theme"],_W=t=>t.classes,vW=Xs("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.open&&n.exited&&e.hidden]}})(({theme:t,ownerState:e})=>Ze({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&e.exited&&{visibility:"hidden"})),xW=Xs(Y$,{name:"MuiModal",slot:"Backdrop",overridesResolver:(t,e)=>e.backdrop})({zIndex:-1}),bW=Ie.exports.forwardRef(function(e,n){var r,s,l,d,c,v;const w=Il({name:"MuiModal",props:e}),{BackdropComponent:C=xW,BackdropProps:I,closeAfterTransition:S=!1,children:z,component:F,components:B={},componentsProps:Q={},disableAutoFocus:q=!1,disableEnforceFocus:j=!1,disableEscapeKeyDown:G=!1,disablePortal:se=!1,disableRestoreFocus:he=!1,disableScrollLock:ye=!1,hideBackdrop:we=!1,keepMounted:Be=!1,slotProps:Ve,slots:xe,theme:He}=w,wt=Un(w,yW),[yt,ot]=Ie.exports.useState(!0),zt={closeAfterTransition:S,disableAutoFocus:q,disableEnforceFocus:j,disableEscapeKeyDown:G,disablePortal:se,disableRestoreFocus:he,disableScrollLock:ye,hideBackdrop:we,keepMounted:Be},Qe=Ze({},w,zt,{exited:yt}),yn=_W(Qe),Ne=(r=(s=xe==null?void 0:xe.root)!=null?s:B.Root)!=null?r:vW,et=(l=(d=xe==null?void 0:xe.backdrop)!=null?d:B.Backdrop)!=null?l:C,_t=(c=Ve==null?void 0:Ve.root)!=null?c:Q.root,at=(v=Ve==null?void 0:Ve.backdrop)!=null?v:Q.backdrop;return hn(S$,Ze({slots:{root:Ne,backdrop:et},slotProps:{root:()=>Ze({},hx(_t,Qe),!KI(Ne)&&{as:F,theme:He}),backdrop:()=>Ze({},I,hx(at,Qe))},onTransitionEnter:()=>ot(!1),onTransitionExited:()=>ot(!0),ref:n},wt,{classes:yn},zt,{children:z}))}),wW=bW,EW=["addEndListener","appear","children","container","direction","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function TW(t,e,n){const r=e.getBoundingClientRect(),s=n&&n.getBoundingClientRect(),l=pa(e);let d;if(e.fakeTransform)d=e.fakeTransform;else{const w=l.getComputedStyle(e);d=w.getPropertyValue("-webkit-transform")||w.getPropertyValue("transform")}let c=0,v=0;if(d&&d!=="none"&&typeof d=="string"){const w=d.split("(")[1].split(")")[0].split(",");c=parseInt(w[4],10),v=parseInt(w[5],10)}return t==="left"?s?`translateX(${s.right+c-r.left}px)`:`translateX(${l.innerWidth+c-r.left}px)`:t==="right"?s?`translateX(-${r.right-s.left-c}px)`:`translateX(-${r.left+r.width-c}px)`:t==="up"?s?`translateY(${s.bottom+v-r.top}px)`:`translateY(${l.innerHeight+v-r.top}px)`:s?`translateY(-${r.top-s.top+r.height-v}px)`:`translateY(-${r.top+r.height-v}px)`}function SW(t){return typeof t=="function"?t():t}function Lm(t,e,n){const r=SW(n),s=TW(t,e,r);s&&(e.style.webkitTransform=s,e.style.transform=s)}const AW=Ie.exports.forwardRef(function(e,n){const r=Py(),s={enter:r.transitions.easing.easeOut,exit:r.transitions.easing.sharp},l={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:d,appear:c=!0,children:v,container:w,direction:C="down",easing:I=s,in:S,onEnter:z,onEntered:F,onEntering:B,onExit:Q,onExited:q,onExiting:j,style:G,timeout:se=l,TransitionComponent:he=QI}=e,ye=Un(e,EW),we=Ie.exports.useRef(null),Be=Lc(v.ref,we,n),Ve=Ne=>et=>{Ne&&(et===void 0?Ne(we.current):Ne(we.current,et))},xe=Ve((Ne,et)=>{Lm(C,Ne,w),ek(Ne),z&&z(Ne,et)}),He=Ve((Ne,et)=>{const _t=Rf({timeout:se,style:G,easing:I},{mode:"enter"});Ne.style.webkitTransition=r.transitions.create("-webkit-transform",Ze({},_t)),Ne.style.transition=r.transitions.create("transform",Ze({},_t)),Ne.style.webkitTransform="none",Ne.style.transform="none",B&&B(Ne,et)}),wt=Ve(F),yt=Ve(j),ot=Ve(Ne=>{const et=Rf({timeout:se,style:G,easing:I},{mode:"exit"});Ne.style.webkitTransition=r.transitions.create("-webkit-transform",et),Ne.style.transition=r.transitions.create("transform",et),Lm(C,Ne,w),Q&&Q(Ne)}),zt=Ve(Ne=>{Ne.style.webkitTransition="",Ne.style.transition="",q&&q(Ne)}),Qe=Ne=>{d&&d(we.current,Ne)},yn=Ie.exports.useCallback(()=>{we.current&&Lm(C,we.current,w)},[C,w]);return Ie.exports.useEffect(()=>{if(S||C==="down"||C==="right")return;const Ne=s9(()=>{we.current&&Lm(C,we.current,w)}),et=pa(we.current);return et.addEventListener("resize",Ne),()=>{Ne.clear(),et.removeEventListener("resize",Ne)}},[C,S,w]),Ie.exports.useEffect(()=>{S||yn()},[S,yn]),hn(he,Ze({nodeRef:we,onEnter:xe,onEntered:wt,onEntering:He,onExit:ot,onExited:zt,onExiting:yt,addEndListener:Qe,appear:c,in:S,timeout:se},ye,{children:(Ne,et)=>Ie.exports.cloneElement(v,Ze({ref:Be,style:Ze({visibility:Ne==="exited"&&!S?"hidden":void 0},G,v.props.style)},et))}))}),PW=AW;function CW(t){return Sa("MuiDrawer",t)}Sl("MuiDrawer",["root","docked","paper","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const IW=["BackdropProps"],kW=["anchor","BackdropProps","children","className","elevation","hideBackdrop","ModalProps","onClose","open","PaperProps","SlideProps","TransitionComponent","transitionDuration","variant"],nk=(t,e)=>{const{ownerState:n}=t;return[e.root,(n.variant==="permanent"||n.variant==="persistent")&&e.docked,e.modal]},MW=t=>{const{classes:e,anchor:n,variant:r}=t,s={root:["root"],docked:[(r==="permanent"||r==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${po(n)}`,r!=="temporary"&&`paperAnchorDocked${po(n)}`]};return Tl(s,CW,e)},LW=Xs(wW,{name:"MuiDrawer",slot:"Root",overridesResolver:nk})(({theme:t})=>({zIndex:(t.vars||t).zIndex.drawer})),tS=Xs("div",{shouldForwardProp:YI,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:nk})({flex:"0 0 auto"}),RW=Xs(tk,{name:"MuiDrawer",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.paper,e[`paperAnchor${po(n.anchor)}`],n.variant!=="temporary"&&e[`paperAnchorDocked${po(n.anchor)}`]]}})(({theme:t,ownerState:e})=>Ze({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(t.vars||t).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0},e.anchor==="left"&&{left:0},e.anchor==="top"&&{top:0,left:0,right:0,height:"auto",maxHeight:"100%"},e.anchor==="right"&&{right:0},e.anchor==="bottom"&&{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},e.anchor==="left"&&e.variant!=="temporary"&&{borderRight:`1px solid ${(t.vars||t).palette.divider}`},e.anchor==="top"&&e.variant!=="temporary"&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`},e.anchor==="right"&&e.variant!=="temporary"&&{borderLeft:`1px solid ${(t.vars||t).palette.divider}`},e.anchor==="bottom"&&e.variant!=="temporary"&&{borderTop:`1px solid ${(t.vars||t).palette.divider}`})),rk={left:"right",right:"left",top:"down",bottom:"up"};function zu(t){return["left","right"].indexOf(t)!==-1}function Nd(t,e){return t.direction==="rtl"&&zu(e)?rk[e]:e}const OW=Ie.exports.forwardRef(function(e,n){const r=Il({props:e,name:"MuiDrawer"}),s=Py(),l={enter:s.transitions.duration.enteringScreen,exit:s.transitions.duration.leavingScreen},{anchor:d="left",BackdropProps:c,children:v,className:w,elevation:C=16,hideBackdrop:I=!1,ModalProps:{BackdropProps:S}={},onClose:z,open:F=!1,PaperProps:B={},SlideProps:Q,TransitionComponent:q=PW,transitionDuration:j=l,variant:G="temporary"}=r,se=Un(r.ModalProps,IW),he=Un(r,kW),ye=Ie.exports.useRef(!1);Ie.exports.useEffect(()=>{ye.current=!0},[]);const we=Nd(s,d),Ve=Ze({},r,{anchor:d,elevation:C,open:F,variant:G},he),xe=MW(Ve),He=hn(RW,Ze({elevation:G==="temporary"?C:0,square:!0},B,{className:es(xe.paper,B.className),ownerState:Ve,children:v}));if(G==="permanent")return hn(tS,Ze({className:es(xe.root,xe.docked,w),ownerState:Ve,ref:n},he,{children:He}));const wt=hn(q,Ze({in:F,direction:rk[we],timeout:j,appear:ye.current},Q,{children:He}));return G==="persistent"?hn(tS,Ze({className:es(xe.root,xe.docked,w),ownerState:Ve,ref:n},he,{children:wt})):hn(LW,Ze({BackdropProps:Ze({},c,S,{transitionDuration:j}),className:es(xe.root,xe.modal,w),open:F,ownerState:Ve,onClose:z,hideBackdrop:I,ref:n},he,se,{children:wt}))}),DW=OW,zW=["anchor","classes","className","width","style"],FW=Xs("div")(({theme:t,ownerState:e})=>Ze({position:"fixed",top:0,left:0,bottom:0,zIndex:t.zIndex.drawer-1},e.anchor==="left"&&{right:"auto"},e.anchor==="right"&&{left:"auto",right:0},e.anchor==="top"&&{bottom:"auto",right:0},e.anchor==="bottom"&&{top:"auto",bottom:0,right:0})),BW=Ie.exports.forwardRef(function(e,n){const{anchor:r,classes:s={},className:l,width:d,style:c}=e,v=Un(e,zW),w=e;return hn(FW,Ze({className:es("PrivateSwipeArea-root",s.root,s[`anchor${po(r)}`],l),ref:n,style:Ze({[zu(r)?"width":"height"]:d},c),ownerState:w},v))}),NW=BW,UW=["BackdropProps"],VW=["anchor","disableBackdropTransition","disableDiscovery","disableSwipeToOpen","hideBackdrop","hysteresis","minFlingVelocity","ModalProps","onClose","onOpen","open","PaperProps","SwipeAreaProps","swipeAreaWidth","transitionDuration","variant"],Rm=3,z0=20;let oa=null;function F0(t,e,n){return t==="right"?n.body.offsetWidth-e[0].pageX:e[0].pageX}function B0(t,e,n){return t==="bottom"?n.innerHeight-e[0].clientY:e[0].clientY}function kd(t,e){return t?e.clientWidth:e.clientHeight}function nS(t,e,n,r){return Math.min(Math.max(n?e-t:r+e-t,0),r)}function jW(t,e){const n=[];for(;t&&t!==e.parentElement;){const r=pa(e).getComputedStyle(t);r.getPropertyValue("position")==="absolute"||r.getPropertyValue("overflow-x")==="hidden"||(t.clientWidth>0&&t.scrollWidth>t.clientWidth||t.clientHeight>0&&t.scrollHeight>t.clientHeight)&&n.push(t),t=t.parentElement}return n}function GW({domTreeShapes:t,start:e,current:n,anchor:r}){const s={scrollPosition:{x:"scrollLeft",y:"scrollTop"},scrollLength:{x:"scrollWidth",y:"scrollHeight"},clientLength:{x:"clientWidth",y:"clientHeight"}};return t.some(l=>{let d=n>=e;(r==="top"||r==="left")&&(d=!d);const c=r==="left"||r==="right"?"x":"y",v=Math.round(l[s.scrollPosition[c]]),w=v>0,C=v+l[s.clientLength[c]]<l[s.scrollLength[c]];return!!(d&&C||!d&&w)})}const $W=typeof navigator<"u"&&/iPad|iPhone|iPod/.test(navigator.userAgent),WW=Ie.exports.forwardRef(function(e,n){const r=ZI({name:"MuiSwipeableDrawer",props:e}),s=Py(),l={enter:s.transitions.duration.enteringScreen,exit:s.transitions.duration.leavingScreen},{anchor:d="left",disableBackdropTransition:c=!1,disableDiscovery:v=!1,disableSwipeToOpen:w=$W,hideBackdrop:C,hysteresis:I=.52,minFlingVelocity:S=450,ModalProps:{BackdropProps:z}={},onClose:F,onOpen:B,open:Q,PaperProps:q={},SwipeAreaProps:j,swipeAreaWidth:G=20,transitionDuration:se=l,variant:he="temporary"}=r,ye=Un(r.ModalProps,UW),we=Un(r,VW),[Be,Ve]=Ie.exports.useState(!1),xe=Ie.exports.useRef({isSwiping:null}),He=Ie.exports.useRef(),wt=Ie.exports.useRef(),yt=Ie.exports.useRef(),ot=Lc(q.ref,yt),zt=Ie.exports.useRef(!1),Qe=Ie.exports.useRef();Lf(()=>{Qe.current=null},[Q]);const yn=Ie.exports.useCallback((at,Ot={})=>{const{mode:tn=null,changeTransition:$t=!0}=Ot,cn=Nd(s,d),sn=["right","bottom"].indexOf(cn)!==-1?1:-1,Bt=zu(d),fn=Bt?`translate(${sn*at}px, 0)`:`translate(0, ${sn*at}px)`,jt=yt.current.style;jt.webkitTransform=fn,jt.transform=fn;let Kt="";if(tn&&(Kt=s.transitions.create("all",Rf({easing:void 0,style:void 0,timeout:se},{mode:tn}))),$t&&(jt.webkitTransition=Kt,jt.transition=Kt),!c&&!C){const Wn=wt.current.style;Wn.opacity=1-at/kd(Bt,yt.current),$t&&(Wn.webkitTransition=Kt,Wn.transition=Kt)}},[d,c,C,s,se]),Ne=Qd(at=>{if(!zt.current)return;if(oa=null,zt.current=!1,gl.exports.flushSync(()=>{Ve(!1)}),!xe.current.isSwiping){xe.current.isSwiping=null;return}xe.current.isSwiping=null;const Ot=Nd(s,d),tn=zu(d);let $t;tn?$t=F0(Ot,at.changedTouches,js(at.currentTarget)):$t=B0(Ot,at.changedTouches,pa(at.currentTarget));const cn=tn?xe.current.startX:xe.current.startY,sn=kd(tn,yt.current),Bt=nS($t,cn,Q,sn),fn=Bt/sn;if(Math.abs(xe.current.velocity)>S&&(Qe.current=Math.abs((sn-Bt)/xe.current.velocity)*1e3),Q){xe.current.velocity>S||fn>I?F():yn(0,{mode:"exit"});return}xe.current.velocity<-S||1-fn>I?B():yn(kd(tn,yt.current),{mode:"enter"})}),et=Qd(at=>{if(!yt.current||!zt.current||oa!==null&&oa!==xe.current)return;const Ot=Nd(s,d),tn=zu(d),$t=F0(Ot,at.touches,js(at.currentTarget)),cn=B0(Ot,at.touches,pa(at.currentTarget));if(Q&&yt.current.contains(at.target)&&oa===null){const Kt=jW(at.target,yt.current);if(GW({domTreeShapes:Kt,start:tn?xe.current.startX:xe.current.startY,current:tn?$t:cn,anchor:d})){oa=!0;return}oa=xe.current}if(xe.current.isSwiping==null){const Kt=Math.abs($t-xe.current.startX),Wn=Math.abs(cn-xe.current.startY),In=tn?Kt>Wn&&Kt>Rm:Wn>Kt&&Wn>Rm;if(In&&at.cancelable&&at.preventDefault(),In===!0||(tn?Wn>Rm:Kt>Rm)){if(xe.current.isSwiping=In,!In){Ne(at);return}xe.current.startX=$t,xe.current.startY=cn,!v&&!Q&&(tn?xe.current.startX-=z0:xe.current.startY-=z0)}}if(!xe.current.isSwiping)return;const sn=kd(tn,yt.current);let Bt=tn?xe.current.startX:xe.current.startY;Q&&!xe.current.paperHit&&(Bt=Math.min(Bt,sn));const fn=nS(tn?$t:cn,Bt,Q,sn);if(Q)if(xe.current.paperHit)fn===0&&(xe.current.startX=$t,xe.current.startY=cn);else if(tn?$t<sn:cn<sn)xe.current.paperHit=!0,xe.current.startX=$t,xe.current.startY=cn;else return;xe.current.lastTranslate===null&&(xe.current.lastTranslate=fn,xe.current.lastTime=performance.now()+1);const jt=(fn-xe.current.lastTranslate)/(performance.now()-xe.current.lastTime)*1e3;xe.current.velocity=xe.current.velocity*.4+jt*.6,xe.current.lastTranslate=fn,xe.current.lastTime=performance.now(),at.cancelable&&at.preventDefault(),yn(fn)}),_t=Qd(at=>{if(at.defaultPrevented||at.defaultMuiPrevented||Q&&(C||!wt.current.contains(at.target))&&!yt.current.contains(at.target))return;const Ot=Nd(s,d),tn=zu(d),$t=F0(Ot,at.touches,js(at.currentTarget)),cn=B0(Ot,at.touches,pa(at.currentTarget));if(!Q){if(w||at.target!==He.current)return;if(tn){if($t>G)return}else if(cn>G)return}at.defaultMuiPrevented=!0,oa=null,xe.current.startX=$t,xe.current.startY=cn,gl.exports.flushSync(()=>{Ve(!0)}),!Q&&yt.current&&yn(kd(tn,yt.current)+(v?15:-z0),{changeTransition:!1}),xe.current.velocity=0,xe.current.lastTime=null,xe.current.lastTranslate=null,xe.current.paperHit=!1,zt.current=!0});return Ie.exports.useEffect(()=>{if(he==="temporary"){const at=js(yt.current);return at.addEventListener("touchstart",_t),at.addEventListener("touchmove",et,{passive:!Q}),at.addEventListener("touchend",Ne),()=>{at.removeEventListener("touchstart",_t),at.removeEventListener("touchmove",et,{passive:!Q}),at.removeEventListener("touchend",Ne)}}},[he,Q,_t,et,Ne]),Ie.exports.useEffect(()=>()=>{oa===xe.current&&(oa=null)},[]),Ie.exports.useEffect(()=>{Q||Ve(!1)},[Q]),ch(Ie.exports.Fragment,{children:[hn(DW,Ze({open:he==="temporary"&&Be?!0:Q,variant:he,ModalProps:Ze({BackdropProps:Ze({},z,{ref:wt})},he==="temporary"&&{keepMounted:!0},ye),hideBackdrop:C,PaperProps:Ze({},q,{style:Ze({pointerEvents:he==="temporary"&&!Q?"none":""},q.style),ref:ot}),anchor:d,transitionDuration:Qe.current||se,onClose:F,ref:n},we)),!w&&he==="temporary"&&hn(A$,{children:hn(NW,Ze({anchor:d,ref:He,width:G},j))})]})}),HW=WW;var ik={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(gS,function(){var n,r,s;function l(c,v){if(!n)n=v;else if(!r)r=v;else{var w="var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk);",C={};n(C),s=v(C),typeof window<"u"&&(s.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}}l(["exports"],function(c){var v=w;function w(a,i,u,f){this.cx=3*a,this.bx=3*(u-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(f-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=i,this.p2x=u,this.p2y=f}function C(a,i,u,f){const g=new v(a,i,u,f);return function(_){return g.solve(_)}}w.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,i){if(i===void 0&&(i=1e-6),a<0)return 0;if(a>1)return 1;for(var u=a,f=0;f<8;f++){var g=this.sampleCurveX(u)-a;if(Math.abs(g)<i)return u;var _=this.sampleCurveDerivativeX(u);if(Math.abs(_)<1e-6)break;u-=g/_}var b=0,T=1;for(u=a,f=0;f<20&&(g=this.sampleCurveX(u),!(Math.abs(g-a)<i));f++)a>g?b=u:T=u,u=.5*(T-b)+b;return u},solve:function(a,i){return this.sampleCurveY(this.solveCurveX(a,i))}};const I=C(.25,.1,.25,1);function S(a,i,u){return Math.min(u,Math.max(i,a))}function z(a,i,u){const f=u-i,g=((a-i)%f+f)%f+i;return g===i?u:g}function F(a,...i){for(const u of i)for(const f in u)a[f]=u[f];return a}let B=1;function Q(a,i){a.forEach(u=>{i[u]&&(i[u]=i[u].bind(i))})}function q(a,i,u){const f={};for(const g in a)f[g]=i.call(u||this,a[g],g,a);return f}function j(a,i,u){const f={};for(const g in a)i.call(u||this,a[g],g,a)&&(f[g]=a[g]);return f}function G(a){return Array.isArray(a)?a.map(G):typeof a=="object"&&a?q(a,G):a}const se={};function he(a){se[a]||(typeof console<"u"&&console.warn(a),se[a]=!0)}function ye(a,i,u){return(u.y-a.y)*(i.x-a.x)>(i.y-a.y)*(u.x-a.x)}function we(a){let i=0;for(let u,f,g=0,_=a.length,b=_-1;g<_;b=g++)u=a[g],f=a[b],i+=(f.x-u.x)*(u.y+f.y);return i}function Be(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ve(a){const i={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,f,g,_)=>{const b=g||_;return i[f]=!b||b.toLowerCase(),""}),i["max-age"]){const u=parseInt(i["max-age"],10);isNaN(u)?delete i["max-age"]:i["max-age"]=u}return i}let xe,He,wt=null;function yt(a){if(wt==null){const i=a.navigator?a.navigator.userAgent:null;wt=!!a.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return wt}function ot(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const zt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(a){const i=requestAnimationFrame(a);return{cancel:()=>cancelAnimationFrame(i)}},getImageData(a,i=0){const u=window.document.createElement("canvas"),f=u.getContext("2d");if(!f)throw new Error("failed to create canvas 2d context");return u.width=a.width,u.height=a.height,f.drawImage(a,0,0,a.width,a.height),f.getImageData(-i,-i,a.width+2*i,a.height+2*i)},resolveURL:a=>(xe||(xe=document.createElement("a")),xe.href=a,xe.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(He==null&&(He=matchMedia("(prefers-reduced-motion: reduce)")),He.matches)}};var Qe=yn;function yn(a,i){this.x=a,this.y=i}yn.prototype={clone:function(){return new yn(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,i){return this.clone()._rotateAround(a,i)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var i=a.x-this.x,u=a.y-this.y;return i*i+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,i){return Math.atan2(this.x*i-this.y*a,this.x*a+this.y*i)},_matMult:function(a){var i=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=i,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var i=Math.cos(a),u=Math.sin(a),f=u*this.x+i*this.y;return this.x=i*this.x-u*this.y,this.y=f,this},_rotateAround:function(a,i){var u=Math.cos(a),f=Math.sin(a),g=i.y+f*(this.x-i.x)+u*(this.y-i.y);return this.x=i.x+u*(this.x-i.x)-f*(this.y-i.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},yn.convert=function(a){return a instanceof yn?a:Array.isArray(a)?new yn(a[0],a[1]):a};const Ne={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},et="mapbox-tiles";let _t,at,Ot=500,tn=50;function $t(){typeof caches>"u"||_t||(_t=caches.open(et))}let cn=1/0;const sn={supported:!1,testSupport:function(a){!jt&&fn&&(Kt?Wn(a):Bt=a)}};let Bt,fn,jt=!1,Kt=!1;function Wn(a){const i=a.createTexture();a.bindTexture(a.TEXTURE_2D,i);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,fn),a.isContextLost())return;sn.supported=!0}catch{}a.deleteTexture(i),jt=!0}typeof document<"u"&&(fn=document.createElement("img"),fn.onload=function(){Bt&&Wn(Bt),Bt=null,Kt=!0},fn.onerror=function(){jt=!0,Bt=null},fn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const In={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(In);class Vn extends Error{constructor(i,u,f,g){super(`AJAXError: ${u} (${i}): ${f}`),this.status=i,this.statusText=u,this.url=f,this.body=g}}const kr=Be()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function or(a,i){const u=new AbortController,f=new Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:kr(),signal:u.signal});let g=!1,_=!1;return a.type==="json"&&f.headers.set("Accept","application/json"),((b,T,A)=>{if(_)return;const M=Date.now();fetch(f).then(O=>O.ok?((N,$,Z)=>{(a.type==="arrayBuffer"?N.arrayBuffer():a.type==="json"?N.json():N.text()).then(Y=>{_||($&&Z&&function(le,ae,be){if($t(),!_t)return;const Pe={status:ae.status,statusText:ae.statusText,headers:new Headers};ae.headers.forEach((Se,Fe)=>Pe.headers.set(Fe,Se));const ve=Ve(ae.headers.get("Cache-Control")||"");ve["no-store"]||(ve["max-age"]&&Pe.headers.set("Expires",new Date(be+1e3*ve["max-age"]).toUTCString()),new Date(Pe.headers.get("Expires")).getTime()-be<42e4||function(Se,Fe){if(at===void 0)try{new Response(new ReadableStream),at=!0}catch{at=!1}at?Fe(Se.body):Se.blob().then(Fe)}(ae,Se=>{const Fe=new Response(Se,Pe);$t(),_t&&_t.then(ze=>ze.put(function(ut){const mt=ut.indexOf("?");return mt<0?ut:ut.slice(0,mt)}(le.url),Fe)).catch(ze=>he(ze.message))}))}(f,$,Z),g=!0,i(null,Y,N.headers.get("Cache-Control"),N.headers.get("Expires")))}).catch(Y=>{_||i(new Error(Y.message))})})(O,null,M):O.blob().then(N=>i(new Vn(O.status,O.statusText,a.url,N)))).catch(O=>{O.code!==20&&i(new Error(O.message))})})(),{cancel:()=>{_=!0,g||u.abort()}}}const Hn=function(a,i){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){if(Be()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,i);if(!Be()){const f=a.url.substring(0,a.url.indexOf("://"));return(Ne.REGISTERED_PROTOCOLS[f]||or)(a,i)}}if(!(/^file:/.test(u=a.url)||/^file:/.test(kr())&&!/^\w+:/.test(u))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return or(a,i);if(Be()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,i,void 0,!0)}var u;return function(f,g){const _=new XMLHttpRequest;_.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(_.responseType="arraybuffer");for(const b in f.headers)_.setRequestHeader(b,f.headers[b]);return f.type==="json"&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials=f.credentials==="include",_.onerror=()=>{g(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||_.status===0)&&_.response!==null){let b=_.response;if(f.type==="json")try{b=JSON.parse(_.response)}catch(T){return g(T)}g(null,b,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else{const b=new Blob([_.response],{type:_.getResponseHeader("Content-Type")});g(new Vn(_.status,_.statusText,f.url,b))}},_.send(f.body),{cancel:()=>_.abort()}}(a,i)},Mr=function(a,i){return Hn(F(a,{type:"arrayBuffer"}),i)};function jn(a){const i=window.document.createElement("a");return i.href=a,i.protocol===window.document.location.protocol&&i.host===window.document.location.host}const Jt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let On,kn;On=[],kn=0;const ti=function(a,i){if(sn.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),kn>=Ne.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:a,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return On.push(_),_}kn++;let u=!1;const f=()=>{if(!u)for(u=!0,kn--;On.length&&kn<Ne.MAX_PARALLEL_IMAGE_REQUESTS;){const _=On.shift(),{requestParameters:b,callback:T,cancelled:A}=_;A||(_.cancel=ti(b,T).cancel)}},g=Mr(a,(_,b,T,A)=>{f(),_?i(_):b&&function(M,O){typeof createImageBitmap=="function"?function(N,$){const Z=new Blob([new Uint8Array(N)],{type:"image/png"});createImageBitmap(Z).then(Y=>{$(null,Y)}).catch(Y=>{$(new Error(`Could not load image because of ${Y.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(M,O):function(N,$){const Z=new Image;Z.onload=()=>{$(null,Z),URL.revokeObjectURL(Z.src),Z.onload=null,window.requestAnimationFrame(()=>{Z.src=Jt})},Z.onerror=()=>$(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Y=new Blob([new Uint8Array(N)],{type:"image/png"});Z.src=N.byteLength?URL.createObjectURL(Y):Jt}(M,O)}(b,(M,O)=>{M!=null?i(M):O!=null&&i(null,O,{cacheControl:T,expires:A})})});return{cancel:()=>{g.cancel(),f()}}};function Wt(a,i,u){u[a]&&u[a].indexOf(i)!==-1||(u[a]=u[a]||[],u[a].push(i))}function nn(a,i,u){if(u&&u[a]){const f=u[a].indexOf(i);f!==-1&&u[a].splice(f,1)}}class Nt{constructor(i,u={}){F(this,u),this.type=i}}class Sn extends Nt{constructor(i,u={}){super("error",F({error:i},u))}}class Ut{on(i,u){return this._listeners=this._listeners||{},Wt(i,u,this._listeners),this}off(i,u){return nn(i,u,this._listeners),nn(i,u,this._oneTimeListeners),this}once(i,u){return this._oneTimeListeners=this._oneTimeListeners||{},Wt(i,u,this._oneTimeListeners),this}fire(i,u){typeof i=="string"&&(i=new Nt(i,u||{}));const f=i.type;if(this.listens(f)){i.target=this;const g=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const T of g)T.call(this,i);const _=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const T of _)nn(f,T,this._oneTimeListeners),T.call(this,i);const b=this._eventedParent;b&&(F(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(i))}else i instanceof Sn&&console.error(i.error);return this}listens(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)}setEventedParent(i,u){return this._eventedParent=i,this._eventedParentData=u,this}}var Re={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class je{constructor(i,u,f,g){this.message=(i?`${i}: `:"")+f,g&&(this.identifier=g),u!=null&&u.__line__&&(this.line=u.__line__)}}function Xr(a){const i=a.value;return i?[new je(a.key,i,"constants have been deprecated as of v8")]:[]}function Dn(a,...i){for(const u of i)for(const f in u)a[f]=u[f];return a}function Ht(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Vr(a){if(Array.isArray(a))return a.map(Vr);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const i={};for(const u in a)i[u]=Vr(a[u]);return i}return Ht(a)}class ni extends Error{constructor(i,u){super(u),this.message=u,this.key=i}}class ri{constructor(i,u=[]){this.parent=i,this.bindings={};for(const[f,g]of u)this.bindings[f]=g}concat(i){return new ri(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const ks={kind:"null"},Ye={kind:"number"},Ft={kind:"string"},Dt={kind:"boolean"},Tr={kind:"color"},os={kind:"object"},Rt={kind:"value"},Ii={kind:"collator"},_r={kind:"formatted"},go={kind:"padding"},ar={kind:"resolvedImage"};function Lr(a,i){return{kind:"array",itemType:a,N:i}}function xn(a){if(a.kind==="array"){const i=xn(a.itemType);return typeof a.N=="number"?`array<${i}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${i}>`}return a.kind}const yo=[ks,Ye,Ft,Dt,Tr,_r,os,Lr(Rt),go,ar];function Hi(a,i){if(i.kind==="error")return null;if(a.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!Hi(a.itemType,i.itemType))&&(typeof a.N!="number"||a.N===i.N))return null}else{if(a.kind===i.kind)return null;if(a.kind==="value"){for(const u of yo)if(!Hi(u,i))return null}}return`Expected ${xn(a)} but found ${xn(i)} instead.`}function qi(a,i){return i.some(u=>u.kind===a.kind)}function Ys(a,i){return i.some(u=>u==="null"?a===null:u==="array"?Array.isArray(a):u==="object"?a&&!Array.isArray(a)&&typeof a=="object":u===typeof a)}var _o,Ms={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function te(a){return(a=Math.round(a))<0?0:a>255?255:a}function R(a){return te(a[a.length-1]==="%"?parseFloat(a)/100*255:parseInt(a))}function U(a){return(i=a[a.length-1]==="%"?parseFloat(a)/100:parseFloat(a))<0?0:i>1?1:i;var i}function K(a,i,u){return u<0?u+=1:u>1&&(u-=1),6*u<1?a+(i-a)*u*6:2*u<1?i:3*u<2?a+(i-a)*(2/3-u)*6:a}try{_o={}.parseCSSColor=function(a){var i,u=a.replace(/ /g,"").toLowerCase();if(u in Ms)return Ms[u].slice();if(u[0]==="#")return u.length===4?(i=parseInt(u.substr(1),16))>=0&&i<=4095?[(3840&i)>>4|(3840&i)>>8,240&i|(240&i)>>4,15&i|(15&i)<<4,1]:null:u.length===7&&(i=parseInt(u.substr(1),16))>=0&&i<=16777215?[(16711680&i)>>16,(65280&i)>>8,255&i,1]:null;var f=u.indexOf("("),g=u.indexOf(")");if(f!==-1&&g+1===u.length){var _=u.substr(0,f),b=u.substr(f+1,g-(f+1)).split(","),T=1;switch(_){case"rgba":if(b.length!==4)return null;T=U(b.pop());case"rgb":return b.length!==3?null:[R(b[0]),R(b[1]),R(b[2]),T];case"hsla":if(b.length!==4)return null;T=U(b.pop());case"hsl":if(b.length!==3)return null;var A=(parseFloat(b[0])%360+360)%360/360,M=U(b[1]),O=U(b[2]),N=O<=.5?O*(M+1):O+M-O*M,$=2*O-N;return[te(255*K($,N,A+1/3)),te(255*K($,N,A)),te(255*K($,N,A-1/3)),T];default:return null}}return null}}catch{}class J{constructor(i,u,f,g=1){this.r=i,this.g=u,this.b=f,this.a=g}static parse(i){if(!i)return;if(i instanceof J)return i;if(typeof i!="string")return;const u=_o(i);return u?new J(u[0]/255*u[3],u[1]/255*u[3],u[2]/255*u[3],u[3]):void 0}toString(){const[i,u,f,g]=this.toArray();return`rgba(${Math.round(i)},${Math.round(u)},${Math.round(f)},${g})`}toArray(){const{r:i,g:u,b:f,a:g}=this;return g===0?[0,0,0,0]:[255*i/g,255*u/g,255*f/g,g]}}J.black=new J(0,0,0,1),J.white=new J(1,1,1,1),J.transparent=new J(0,0,0,0),J.red=new J(1,0,0,1);class ue{constructor(i,u,f){this.sensitivity=i?u?"variant":"case":u?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,u){return this.collator.compare(i,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class me{constructor(i,u,f,g,_){this.text=i,this.image=u,this.scale=f,this.fontStack=g,this.textColor=_}}class fe{constructor(i){this.sections=i}static fromString(i){return new fe([new me(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.name.length!==0)}static factory(i){return i instanceof fe?i:fe.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}}class ce{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof ce)return i;if(typeof i=="number")return new ce([i,i,i,i]);if(Array.isArray(i)&&!(i.length<1||i.length>4)){for(const u of i)if(typeof u!="number")return;switch(i.length){case 1:i=[i[0],i[0],i[0],i[0]];break;case 2:i=[i[0],i[1],i[0],i[1]];break;case 3:i=[i[0],i[1],i[2],i[1]]}return new ce(i)}}toString(){return JSON.stringify(this.values)}}class ge{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new ge({name:i,available:!1}):null}}function Me(a,i,u,f){return typeof a=="number"&&a>=0&&a<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof u=="number"&&u>=0&&u<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[a,i,u,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[a,i,u,f]:[a,i,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ue(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof J||a instanceof ue||a instanceof fe||a instanceof ce||a instanceof ge)return!0;if(Array.isArray(a)){for(const i of a)if(!Ue(i))return!1;return!0}if(typeof a=="object"){for(const i in a)if(!Ue(a[i]))return!1;return!0}return!1}function ke(a){if(a===null)return ks;if(typeof a=="string")return Ft;if(typeof a=="boolean")return Dt;if(typeof a=="number")return Ye;if(a instanceof J)return Tr;if(a instanceof ue)return Ii;if(a instanceof fe)return _r;if(a instanceof ce)return go;if(a instanceof ge)return ar;if(Array.isArray(a)){const i=a.length;let u;for(const f of a){const g=ke(f);if(u){if(u===g)continue;u=Rt;break}u=g}return Lr(u||Rt,i)}return os}function ht(a){const i=typeof a;return a===null?"":i==="string"||i==="number"||i==="boolean"?String(a):a instanceof J||a instanceof fe||a instanceof ce||a instanceof ge?a.toString():JSON.stringify(a)}class pt{constructor(i,u){this.type=i,this.value=u}static parse(i,u){if(i.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!Ue(i[1]))return u.error("invalid value");const f=i[1];let g=ke(f);const _=u.expectedType;return g.kind!=="array"||g.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(g=_),new pt(g,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class nt{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}const At={string:Ft,number:Ye,boolean:Dt,object:os};class xt{constructor(i,u){this.type=i,this.args=u}static parse(i,u){if(i.length<2)return u.error("Expected at least one argument.");let f,g=1;const _=i[0];if(_==="array"){let T,A;if(i.length>2){const M=i[1];if(typeof M!="string"||!(M in At)||M==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);T=At[M],g++}else T=Rt;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return u.error('The length argument to "array" must be a positive integer literal',2);A=i[2],g++}f=Lr(T,A)}else{if(!At[_])throw new Error(`Types doesn't contain name = ${_}`);f=At[_]}const b=[];for(;g<i.length;g++){const T=u.parse(i[g],g,Rt);if(!T)return null;b.push(T)}return new xt(f,b)}evaluate(i){for(let u=0;u<this.args.length;u++){const f=this.args[u].evaluate(i);if(!Hi(this.type,ke(f)))return f;if(u===this.args.length-1)throw new nt(`Expected value to be of type ${xn(this.type)}, but found ${xn(ke(f))} instead.`)}throw new Error}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const qt={"to-boolean":Dt,"to-color":Tr,"to-number":Ye,"to-string":Ft};class It{constructor(i,u){this.type=i,this.args=u}static parse(i,u){if(i.length<2)return u.error("Expected at least one argument.");const f=i[0];if(!qt[f])throw new Error(`Can't parse ${f} as it is not part of the known types`);if((f==="to-boolean"||f==="to-string")&&i.length!==2)return u.error("Expected one argument.");const g=qt[f],_=[];for(let b=1;b<i.length;b++){const T=u.parse(i[b],b,Rt);if(!T)return null;_.push(T)}return new It(g,_)}evaluate(i){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(i));if(this.type.kind==="color"){let u,f;for(const g of this.args){if(u=g.evaluate(i),f=null,u instanceof J)return u;if(typeof u=="string"){const _=i.parseColor(u);if(_)return _}else if(Array.isArray(u)&&(f=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:Me(u[0],u[1],u[2],u[3]),!f))return new J(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new nt(f||`Could not parse color from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}if(this.type.kind==="padding"){let u;for(const f of this.args){u=f.evaluate(i);const g=ce.parse(u);if(g)return g}throw new nt(`Could not parse padding from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}if(this.type.kind==="number"){let u=null;for(const f of this.args){if(u=f.evaluate(i),u===null)return 0;const g=Number(u);if(!isNaN(g))return g}throw new nt(`Could not convert ${JSON.stringify(u)} to number.`)}return this.type.kind==="formatted"?fe.fromString(ht(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?ge.fromString(ht(this.args[0].evaluate(i))):ht(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const Lt=["Unknown","Point","LineString","Polygon"];class Qt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Lt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(i){let u=this._parseColorCache[i];return u||(u=this._parseColorCache[i]=J.parse(i)),u}}class on{constructor(i,u,f,g){this.name=i,this.type=u,this._evaluate=f,this.args=g}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}static parse(i,u){const f=i[0],g=on.definitions[f];if(!g)return u.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(g)?g[0]:g.type,b=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,T=b.filter(([M])=>!Array.isArray(M)||M.length===i.length-1);let A=null;for(const[M,O]of T){A=new $e(u.registry,u.path,null,u.scope);const N=[];let $=!1;for(let Z=1;Z<i.length;Z++){const Y=i[Z],le=Array.isArray(M)?M[Z-1]:M.type,ae=A.parse(Y,1+N.length,le);if(!ae){$=!0;break}N.push(ae)}if(!$)if(Array.isArray(M)&&M.length!==N.length)A.error(`Expected ${M.length} arguments, but found ${N.length} instead.`);else{for(let Z=0;Z<N.length;Z++){const Y=Array.isArray(M)?M[Z]:M.type,le=N[Z];A.concat(Z+1).checkSubtype(Y,le.type)}if(A.errors.length===0)return new on(f,_,O,N)}}if(T.length===1)u.errors.push(...A.errors);else{const M=(T.length?T:b).map(([N])=>{return $=N,Array.isArray($)?`(${$.map(xn).join(", ")})`:`(${xn($.type)}...)`;var $}).join(" | "),O=[];for(let N=1;N<i.length;N++){const $=u.parse(i[N],1+O.length);if(!$)return null;O.push(xn($.type))}u.error(`Expected arguments of type ${M}, but found (${O.join(", ")}) instead.`)}return null}static register(i,u){on.definitions=u;for(const f in u)i[f]=on}}class Mn{constructor(i,u,f){this.type=Ii,this.locale=f,this.caseSensitive=i,this.diacriticSensitive=u}static parse(i,u){if(i.length!==2)return u.error("Expected one argument.");const f=i[1];if(typeof f!="object"||Array.isArray(f))return u.error("Collator options argument must be an object.");const g=u.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,Dt);if(!g)return null;const _=u.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,Dt);if(!_)return null;let b=null;return f.locale&&(b=u.parse(f.locale,1,Ft),!b)?null:new Mn(g,_,b)}evaluate(i){return new ue(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}}const Ln=8192;function Sr(a,i){a[0]=Math.min(a[0],i[0]),a[1]=Math.min(a[1],i[1]),a[2]=Math.max(a[2],i[0]),a[3]=Math.max(a[3],i[1])}function as(a,i){return!(a[0]<=i[0]||a[2]>=i[2]||a[1]<=i[1]||a[3]>=i[3])}function jr(a,i){const u=(180+a[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,g=Math.pow(2,i.z);return[Math.round(u*g*Ln),Math.round(f*g*Ln)]}function pn(a,i,u){const f=a[0]-i[0],g=a[1]-i[1],_=a[0]-u[0],b=a[1]-u[1];return f*b-_*g==0&&f*_<=0&&g*b<=0}function $o(a,i){let u=!1;for(let b=0,T=i.length;b<T;b++){const A=i[b];for(let M=0,O=A.length;M<O-1;M++){if(pn(a,A[M],A[M+1]))return!1;(g=A[M])[1]>(f=a)[1]!=(_=A[M+1])[1]>f[1]&&f[0]<(_[0]-g[0])*(f[1]-g[1])/(_[1]-g[1])+g[0]&&(u=!u)}}var f,g,_;return u}function Wo(a,i){for(let u=0;u<i.length;u++)if($o(a,i[u]))return!0;return!1}function Pa(a,i,u,f){const g=f[0]-u[0],_=f[1]-u[1],b=(a[0]-u[0])*_-g*(a[1]-u[1]),T=(i[0]-u[0])*_-g*(i[1]-u[1]);return b>0&&T<0||b<0&&T>0}function Ca(a,i,u){for(const M of u)for(let O=0;O<M.length-1;++O)if((T=[(b=M[O+1])[0]-(_=M[O])[0],b[1]-_[1]])[0]*(A=[(g=i)[0]-(f=a)[0],g[1]-f[1]])[1]-T[1]*A[0]!=0&&Pa(f,g,_,b)&&Pa(_,b,f,g))return!0;var f,g,_,b,T,A;return!1}function vo(a,i){for(let u=0;u<a.length;++u)if(!$o(a[u],i))return!1;for(let u=0;u<a.length-1;++u)if(Ca(a[u],a[u+1],i))return!1;return!0}function ls(a,i){for(let u=0;u<i.length;u++)if(vo(a,i[u]))return!0;return!1}function Ia(a,i,u){const f=[];for(let g=0;g<a.length;g++){const _=[];for(let b=0;b<a[g].length;b++){const T=jr(a[g][b],u);Sr(i,T),_.push(T)}f.push(_)}return f}function ka(a,i,u){const f=[];for(let g=0;g<a.length;g++){const _=Ia(a[g],i,u);f.push(_)}return f}function Ma(a,i,u,f){if(a[0]<u[0]||a[0]>u[2]){const g=.5*f;let _=a[0]-u[0]>g?-f:u[0]-a[0]>g?f:0;_===0&&(_=a[0]-u[2]>g?-f:u[2]-a[0]>g?f:0),a[0]+=_}Sr(i,a)}function Ll(a,i,u,f){const g=Math.pow(2,f.z)*Ln,_=[f.x*Ln,f.y*Ln],b=[];for(const T of a)for(const A of T){const M=[A.x+_[0],A.y+_[1]];Ma(M,i,u,g),b.push(M)}return b}function Oc(a,i,u,f){const g=Math.pow(2,f.z)*Ln,_=[f.x*Ln,f.y*Ln],b=[];for(const A of a){const M=[];for(const O of A){const N=[O.x+_[0],O.y+_[1]];Sr(i,N),M.push(N)}b.push(M)}if(i[2]-i[0]<=g/2){(T=i)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const A of b)for(const M of A)Ma(M,i,u,g)}var T;return b}class Ks{constructor(i,u){this.type=Dt,this.geojson=i,this.geometries=u}static parse(i,u){if(i.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(Ue(i[1])){const f=i[1];if(f.type==="FeatureCollection")for(let g=0;g<f.features.length;++g){const _=f.features[g].geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new Ks(f,f.features[g].geometry)}else if(f.type==="Feature"){const g=f.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Ks(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Ks(f,f)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],b=u.canonicalID();if(f.type==="Polygon"){const T=Ia(f.coordinates,_,b),A=Ll(u.geometry(),g,_,b);if(!as(g,_))return!1;for(const M of A)if(!$o(M,T))return!1}if(f.type==="MultiPolygon"){const T=ka(f.coordinates,_,b),A=Ll(u.geometry(),g,_,b);if(!as(g,_))return!1;for(const M of A)if(!Wo(M,T))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],b=u.canonicalID();if(f.type==="Polygon"){const T=Ia(f.coordinates,_,b),A=Oc(u.geometry(),g,_,b);if(!as(g,_))return!1;for(const M of A)if(!vo(M,T))return!1}if(f.type==="MultiPolygon"){const T=ka(f.coordinates,_,b),A=Oc(u.geometry(),g,_,b);if(!as(g,_))return!1;for(const M of A)if(!ls(M,T))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function X(a){if(a instanceof on&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof Ks)return!1;let i=!0;return a.eachChild(u=>{i&&!X(u)&&(i=!1)}),i}function ee(a){if(a instanceof on&&a.name==="feature-state")return!1;let i=!0;return a.eachChild(u=>{i&&!ee(u)&&(i=!1)}),i}function de(a,i){if(a instanceof on&&i.indexOf(a.name)>=0)return!1;let u=!0;return a.eachChild(f=>{u&&!de(f,i)&&(u=!1)}),u}class Ce{constructor(i,u){this.type=u.type,this.name=i,this.boundExpression=u}static parse(i,u){if(i.length!==2||typeof i[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const f=i[1];return u.scope.has(f)?new Ce(f,u.scope.get(f)):u.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}}class $e{constructor(i,u=[],f,g=new ri,_=[]){this.registry=i,this.path=u,this.key=u.map(b=>`[${b}]`).join(""),this.scope=g,this.errors=_,this.expectedType=f}parse(i,u,f,g,_={}){return u?this.concat(u,f,g)._parse(i,_):this._parse(i,_)}_parse(i,u){function f(g,_,b){return b==="assert"?new xt(_,[g]):b==="coerce"?new It(_,[g]):g}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=i[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[g];if(_){let b=_.parse(i,this);if(!b)return null;if(this.expectedType){const T=this.expectedType,A=b.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||A.kind!=="value")if(T.kind!=="color"&&T.kind!=="formatted"&&T.kind!=="resolvedImage"||A.kind!=="value"&&A.kind!=="string")if(T.kind!=="padding"||A.kind!=="value"&&A.kind!=="number"&&A.kind!=="array"){if(this.checkSubtype(T,A))return null}else b=f(b,T,u.typeAnnotation||"coerce");else b=f(b,T,u.typeAnnotation||"coerce");else b=f(b,T,u.typeAnnotation||"assert")}if(!(b instanceof pt)&&b.type.kind!=="resolvedImage"&&ft(b)){const T=new Qt;try{b=new pt(b.type,b.evaluate(T))}catch(A){return this.error(A.message),null}}return b}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,u,f){const g=typeof i=="number"?this.path.concat(i):this.path,_=f?this.scope.concat(f):this.scope;return new $e(this.registry,g,u||null,_,this.errors)}error(i,...u){const f=`${this.key}${u.map(g=>`[${g}]`).join("")}`;this.errors.push(new ni(f,i))}checkSubtype(i,u){const f=Hi(i,u);return f&&this.error(f),f}}function ft(a){if(a instanceof Ce)return ft(a.boundExpression);if(a instanceof on&&a.name==="error"||a instanceof Mn||a instanceof Ks)return!1;const i=a instanceof It||a instanceof xt;let u=!0;return a.eachChild(f=>{u=i?u&&ft(f):u&&f instanceof pt}),!!u&&X(a)&&de(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function en(a,i){const u=a.length-1;let f,g,_=0,b=u,T=0;for(;_<=b;)if(T=Math.floor((_+b)/2),f=a[T],g=a[T+1],f<=i){if(T===u||i<g)return T;_=T+1}else{if(!(f>i))throw new nt("Input is not a number.");b=T-1}return 0}class Jn{constructor(i,u,f){this.type=i,this.input=u,this.labels=[],this.outputs=[];for(const[g,_]of f)this.labels.push(g),this.outputs.push(_)}static parse(i,u){if(i.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return u.error("Expected an even number of arguments.");const f=u.parse(i[1],1,Ye);if(!f)return null;const g=[];let _=null;u.expectedType&&u.expectedType.kind!=="value"&&(_=u.expectedType);for(let b=1;b<i.length;b+=2){const T=b===1?-1/0:i[b],A=i[b+1],M=b,O=b+1;if(typeof T!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(g.length&&g[g.length-1][0]>=T)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const N=u.parse(A,O,_);if(!N)return null;_=_||N.type,g.push([T,N])}return new Jn(_,f,g)}evaluate(i){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(i);const g=this.input.evaluate(i);if(g<=u[0])return f[0].evaluate(i);const _=u.length;return g>=u[_-1]?f[_-1].evaluate(i):f[en(u,g)].evaluate(i)}eachChild(i){i(this.input);for(const u of this.outputs)i(u)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function Xt(a,i,u){return a*(1-u)+i*u}var fr=Object.freeze({__proto__:null,number:Xt,color:function(a,i,u){return new J(Xt(a.r,i.r,u),Xt(a.g,i.g,u),Xt(a.b,i.b,u),Xt(a.a,i.a,u))},array:function(a,i,u){return a.map((f,g)=>Xt(f,i[g],u))},padding:function(a,i,u){const f=a.values,g=i.values;return new ce([Xt(f[0],g[0],u),Xt(f[1],g[1],u),Xt(f[2],g[2],u),Xt(f[3],g[3],u)])}});const ki=.95047,tp=1.08883,bh=4/29,Dc=6/29,np=3*Dc*Dc,ky=Math.PI/180,My=180/Math.PI;function wh(a){return a>.008856451679035631?Math.pow(a,1/3):a/np+bh}function Eh(a){return a>Dc?a*a*a:np*(a-bh)}function Th(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function Sh(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function _n(a){const i=Sh(a.r),u=Sh(a.g),f=Sh(a.b),g=wh((.4124564*i+.3575761*u+.1804375*f)/ki),_=wh((.2126729*i+.7151522*u+.072175*f)/1);return{l:116*_-16,a:500*(g-_),b:200*(_-wh((.0193339*i+.119192*u+.9503041*f)/tp)),alpha:a.a}}function rp(a){let i=(a.l+16)/116,u=isNaN(a.a)?i:i+a.a/500,f=isNaN(a.b)?i:i-a.b/200;return i=1*Eh(i),u=ki*Eh(u),f=tp*Eh(f),new J(Th(3.2404542*u-1.5371385*i-.4985314*f),Th(-.969266*u+1.8760108*i+.041556*f),Th(.0556434*u-.2040259*i+1.0572252*f),a.alpha)}function Ly(a,i,u){const f=i-a;return a+u*(f>180||f<-180?f-360*Math.round(f/360):f)}const Rl={forward:_n,reverse:rp,interpolate:function(a,i,u){return{l:Xt(a.l,i.l,u),a:Xt(a.a,i.a,u),b:Xt(a.b,i.b,u),alpha:Xt(a.alpha,i.alpha,u)}}},Ol={forward:function(a){const{l:i,a:u,b:f}=_n(a),g=Math.atan2(f,u)*My;return{h:g<0?g+360:g,c:Math.sqrt(u*u+f*f),l:i,alpha:a.a}},reverse:function(a){const i=a.h*ky,u=a.c;return rp({l:a.l,a:Math.cos(i)*u,b:Math.sin(i)*u,alpha:a.alpha})},interpolate:function(a,i,u){return{h:Ly(a.h,i.h,u),c:Xt(a.c,i.c,u),l:Xt(a.l,i.l,u),alpha:Xt(a.alpha,i.alpha,u)}}};var ip=Object.freeze({__proto__:null,lab:Rl,hcl:Ol});class Mi{constructor(i,u,f,g,_){this.type=i,this.operator=u,this.interpolation=f,this.input=g,this.labels=[],this.outputs=[];for(const[b,T]of _)this.labels.push(b),this.outputs.push(T)}static interpolationFactor(i,u,f,g){let _=0;if(i.name==="exponential")_=Ah(u,i.base,f,g);else if(i.name==="linear")_=Ah(u,1,f,g);else if(i.name==="cubic-bezier"){const b=i.controlPoints;_=new v(b[0],b[1],b[2],b[3]).solve(Ah(u,1,f,g))}return _}static parse(i,u){let[f,g,_,...b]=i;if(!Array.isArray(g)||g.length===0)return u.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const M=g[1];if(typeof M!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:M}}else{if(g[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const M=g.slice(1);if(M.length!==4||M.some(O=>typeof O!="number"||O<0||O>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:M}}}if(i.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(_=u.parse(_,2,Ye),!_)return null;const T=[];let A=null;f==="interpolate-hcl"||f==="interpolate-lab"?A=Tr:u.expectedType&&u.expectedType.kind!=="value"&&(A=u.expectedType);for(let M=0;M<b.length;M+=2){const O=b[M],N=b[M+1],$=M+3,Z=M+4;if(typeof O!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(T.length&&T[T.length-1][0]>=O)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const Y=u.parse(N,Z,A);if(!Y)return null;A=A||Y.type,T.push([O,Y])}return A.kind==="number"||A.kind==="color"||A.kind==="padding"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new Mi(A,f,g,_,T):u.error(`Type ${xn(A)} is not interpolatable.`)}evaluate(i){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(i);const g=this.input.evaluate(i);if(g<=u[0])return f[0].evaluate(i);const _=u.length;if(g>=u[_-1])return f[_-1].evaluate(i);const b=en(u,g),T=Mi.interpolationFactor(this.interpolation,g,u[b],u[b+1]),A=f[b].evaluate(i),M=f[b+1].evaluate(i);return this.operator==="interpolate"?fr[this.type.kind.toLowerCase()](A,M,T):this.operator==="interpolate-hcl"?Ol.reverse(Ol.interpolate(Ol.forward(A),Ol.forward(M),T)):Rl.reverse(Rl.interpolate(Rl.forward(A),Rl.forward(M),T))}eachChild(i){i(this.input);for(const u of this.outputs)i(u)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function Ah(a,i,u,f){const g=f-u,_=a-u;return g===0?0:i===1?_/g:(Math.pow(i,_)-1)/(Math.pow(i,g)-1)}class zc{constructor(i,u){this.type=i,this.args=u}static parse(i,u){if(i.length<2)return u.error("Expectected at least one argument.");let f=null;const g=u.expectedType;g&&g.kind!=="value"&&(f=g);const _=[];for(const T of i.slice(1)){const A=u.parse(T,1+_.length,f,void 0,{typeAnnotation:"omit"});if(!A)return null;f=f||A.type,_.push(A)}if(!f)throw new Error("No output type");const b=g&&_.some(T=>Hi(g,T.type));return new zc(b?Rt:f,_)}evaluate(i){let u,f=null,g=0;for(const _ of this.args)if(g++,f=_.evaluate(i),f&&f instanceof ge&&!f.available&&(u||(u=f.name),f=null,g===this.args.length&&(f=u)),f!==null)break;return f}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}class Fc{constructor(i,u){this.type=u.type,this.bindings=[].concat(i),this.result=u}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const u of this.bindings)i(u[1]);i(this.result)}static parse(i,u){if(i.length<4)return u.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const f=[];for(let _=1;_<i.length-1;_+=2){const b=i[_];if(typeof b!="string")return u.error(`Expected string, but found ${typeof b} instead.`,_);if(/[^a-zA-Z0-9_]/.test(b))return u.error("Variable names must contain only alphanumeric characters or '_'.",_);const T=u.parse(i[_+1],_+1);if(!T)return null;f.push([b,T])}const g=u.parse(i[i.length-1],i.length-1,u.expectedType,f);return g?new Fc(f,g):null}outputDefined(){return this.result.outputDefined()}}class Ph{constructor(i,u,f){this.type=i,this.index=u,this.input=f}static parse(i,u){if(i.length!==3)return u.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const f=u.parse(i[1],1,Ye),g=u.parse(i[2],2,Lr(u.expectedType||Rt));return f&&g?new Ph(g.type.itemType,f,g):null}evaluate(i){const u=this.index.evaluate(i),f=this.input.evaluate(i);if(u<0)throw new nt(`Array index out of bounds: ${u} < 0.`);if(u>=f.length)throw new nt(`Array index out of bounds: ${u} > ${f.length-1}.`);if(u!==Math.floor(u))throw new nt(`Array index must be an integer, but found ${u} instead.`);return f[u]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}}class Ch{constructor(i,u){this.type=Dt,this.needle=i,this.haystack=u}static parse(i,u){if(i.length!==3)return u.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const f=u.parse(i[1],1,Rt),g=u.parse(i[2],2,Rt);return f&&g?qi(f.type,[Dt,Ft,Ye,ks,Rt])?new Ch(f,g):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${xn(f.type)} instead`):null}evaluate(i){const u=this.needle.evaluate(i),f=this.haystack.evaluate(i);if(!f)return!1;if(!Ys(u,["boolean","string","number","null"]))throw new nt(`Expected first argument to be of type boolean, string, number or null, but found ${xn(ke(u))} instead.`);if(!Ys(f,["string","array"]))throw new nt(`Expected second argument to be of type array or string, but found ${xn(ke(f))} instead.`);return f.indexOf(u)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}}class Bc{constructor(i,u,f){this.type=Ye,this.needle=i,this.haystack=u,this.fromIndex=f}static parse(i,u){if(i.length<=2||i.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const f=u.parse(i[1],1,Rt),g=u.parse(i[2],2,Rt);if(!f||!g)return null;if(!qi(f.type,[Dt,Ft,Ye,ks,Rt]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${xn(f.type)} instead`);if(i.length===4){const _=u.parse(i[3],3,Ye);return _?new Bc(f,g,_):null}return new Bc(f,g)}evaluate(i){const u=this.needle.evaluate(i),f=this.haystack.evaluate(i);if(!Ys(u,["boolean","string","number","null"]))throw new nt(`Expected first argument to be of type boolean, string, number or null, but found ${xn(ke(u))} instead.`);if(!Ys(f,["string","array"]))throw new nt(`Expected second argument to be of type array or string, but found ${xn(ke(f))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(i);return f.indexOf(u,g)}return f.indexOf(u)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}}class Ih{constructor(i,u,f,g,_,b){this.inputType=i,this.type=u,this.input=f,this.cases=g,this.outputs=_,this.otherwise=b}static parse(i,u){if(i.length<5)return u.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return u.error("Expected an even number of arguments.");let f,g;u.expectedType&&u.expectedType.kind!=="value"&&(g=u.expectedType);const _={},b=[];for(let M=2;M<i.length-1;M+=2){let O=i[M];const N=i[M+1];Array.isArray(O)||(O=[O]);const $=u.concat(M);if(O.length===0)return $.error("Expected at least one branch label.");for(const Y of O){if(typeof Y!="number"&&typeof Y!="string")return $.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return $.error("Numeric branch labels must be integer values.");if(f){if($.checkSubtype(f,ke(Y)))return null}else f=ke(Y);if(_[String(Y)]!==void 0)return $.error("Branch labels must be unique.");_[String(Y)]=b.length}const Z=u.parse(N,M,g);if(!Z)return null;g=g||Z.type,b.push(Z)}const T=u.parse(i[1],1,Rt);if(!T)return null;const A=u.parse(i[i.length-1],i.length-1,g);return A?T.type.kind!=="value"&&u.concat(1).checkSubtype(f,T.type)?null:new Ih(f,g,T,_,b,A):null}evaluate(i){const u=this.input.evaluate(i);return(ke(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}}class kh{constructor(i,u,f){this.type=i,this.branches=u,this.otherwise=f}static parse(i,u){if(i.length<4)return u.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return u.error("Expected an odd number of arguments.");let f;u.expectedType&&u.expectedType.kind!=="value"&&(f=u.expectedType);const g=[];for(let b=1;b<i.length-1;b+=2){const T=u.parse(i[b],b,Dt);if(!T)return null;const A=u.parse(i[b+1],b+1,f);if(!A)return null;g.push([T,A]),f=f||A.type}const _=u.parse(i[i.length-1],i.length-1,f);if(!_)return null;if(!f)throw new Error("Can't infer output type");return new kh(f,g,_)}evaluate(i){for(const[u,f]of this.branches)if(u.evaluate(i))return f.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[u,f]of this.branches)i(u),i(f);i(this.otherwise)}outputDefined(){return this.branches.every(([i,u])=>u.outputDefined())&&this.otherwise.outputDefined()}}class Nc{constructor(i,u,f,g){this.type=i,this.input=u,this.beginIndex=f,this.endIndex=g}static parse(i,u){if(i.length<=2||i.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const f=u.parse(i[1],1,Rt),g=u.parse(i[2],2,Ye);if(!f||!g)return null;if(!qi(f.type,[Lr(Rt),Ft,Rt]))return u.error(`Expected first argument to be of type array or string, but found ${xn(f.type)} instead`);if(i.length===4){const _=u.parse(i[3],3,Ye);return _?new Nc(f.type,f,g,_):null}return new Nc(f.type,f,g)}evaluate(i){const u=this.input.evaluate(i),f=this.beginIndex.evaluate(i);if(!Ys(u,["string","array"]))throw new nt(`Expected first argument to be of type array or string, but found ${xn(ke(u))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(i);return u.slice(f,g)}return u.slice(f)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}}function sp(a,i){return a==="=="||a==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function op(a,i,u,f){return f.compare(i,u)===0}function La(a,i,u){const f=a!=="=="&&a!=="!=";return class sk{constructor(_,b,T){this.type=Dt,this.lhs=_,this.rhs=b,this.collator=T,this.hasUntypedArgument=_.type.kind==="value"||b.type.kind==="value"}static parse(_,b){if(_.length!==3&&_.length!==4)return b.error("Expected two or three arguments.");const T=_[0];let A=b.parse(_[1],1,Rt);if(!A)return null;if(!sp(T,A.type))return b.concat(1).error(`"${T}" comparisons are not supported for type '${xn(A.type)}'.`);let M=b.parse(_[2],2,Rt);if(!M)return null;if(!sp(T,M.type))return b.concat(2).error(`"${T}" comparisons are not supported for type '${xn(M.type)}'.`);if(A.type.kind!==M.type.kind&&A.type.kind!=="value"&&M.type.kind!=="value")return b.error(`Cannot compare types '${xn(A.type)}' and '${xn(M.type)}'.`);f&&(A.type.kind==="value"&&M.type.kind!=="value"?A=new xt(M.type,[A]):A.type.kind!=="value"&&M.type.kind==="value"&&(M=new xt(A.type,[M])));let O=null;if(_.length===4){if(A.type.kind!=="string"&&M.type.kind!=="string"&&A.type.kind!=="value"&&M.type.kind!=="value")return b.error("Cannot use collator to compare non-string types.");if(O=b.parse(_[3],3,Ii),!O)return null}return new sk(A,M,O)}evaluate(_){const b=this.lhs.evaluate(_),T=this.rhs.evaluate(_);if(f&&this.hasUntypedArgument){const A=ke(b),M=ke(T);if(A.kind!==M.kind||A.kind!=="string"&&A.kind!=="number")throw new nt(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${A.kind}, ${M.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const A=ke(b),M=ke(T);if(A.kind!=="string"||M.kind!=="string")return i(_,b,T)}return this.collator?u(_,b,T,this.collator.evaluate(_)):i(_,b,T)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}const Ry=La("==",function(a,i,u){return i===u},op),Oy=La("!=",function(a,i,u){return i!==u},function(a,i,u,f){return!op(0,i,u,f)}),Dy=La("<",function(a,i,u){return i<u},function(a,i,u,f){return f.compare(i,u)<0}),zy=La(">",function(a,i,u){return i>u},function(a,i,u,f){return f.compare(i,u)>0}),Fy=La("<=",function(a,i,u){return i<=u},function(a,i,u,f){return f.compare(i,u)<=0}),By=La(">=",function(a,i,u){return i>=u},function(a,i,u,f){return f.compare(i,u)>=0});class Mh{constructor(i,u,f,g,_){this.type=Ft,this.number=i,this.locale=u,this.currency=f,this.minFractionDigits=g,this.maxFractionDigits=_}static parse(i,u){if(i.length!==3)return u.error("Expected two arguments.");const f=u.parse(i[1],1,Ye);if(!f)return null;const g=i[2];if(typeof g!="object"||Array.isArray(g))return u.error("NumberFormat options argument must be an object.");let _=null;if(g.locale&&(_=u.parse(g.locale,1,Ft),!_))return null;let b=null;if(g.currency&&(b=u.parse(g.currency,1,Ft),!b))return null;let T=null;if(g["min-fraction-digits"]&&(T=u.parse(g["min-fraction-digits"],1,Ye),!T))return null;let A=null;return g["max-fraction-digits"]&&(A=u.parse(g["max-fraction-digits"],1,Ye),!A)?null:new Mh(f,_,b,T,A)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}}class Uc{constructor(i){this.type=_r,this.sections=i}static parse(i,u){if(i.length<2)return u.error("Expected at least one argument.");const f=i[1];if(!Array.isArray(f)&&typeof f=="object")return u.error("First argument must be an image or text section.");const g=[];let _=!1;for(let b=1;b<=i.length-1;++b){const T=i[b];if(_&&typeof T=="object"&&!Array.isArray(T)){_=!1;let A=null;if(T["font-scale"]&&(A=u.parse(T["font-scale"],1,Ye),!A))return null;let M=null;if(T["text-font"]&&(M=u.parse(T["text-font"],1,Lr(Ft)),!M))return null;let O=null;if(T["text-color"]&&(O=u.parse(T["text-color"],1,Tr),!O))return null;const N=g[g.length-1];N.scale=A,N.font=M,N.textColor=O}else{const A=u.parse(i[b],1,Rt);if(!A)return null;const M=A.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,g.push({content:A,scale:null,font:null,textColor:null})}}return new Uc(g)}evaluate(i){return new fe(this.sections.map(u=>{const f=u.content.evaluate(i);return ke(f)===ar?new me("",f,null,null,null):new me(ht(f),null,u.scale?u.scale.evaluate(i):null,u.font?u.font.evaluate(i).join(","):null,u.textColor?u.textColor.evaluate(i):null)}))}eachChild(i){for(const u of this.sections)i(u.content),u.scale&&i(u.scale),u.font&&i(u.font),u.textColor&&i(u.textColor)}outputDefined(){return!1}}class Lh{constructor(i){this.type=ar,this.input=i}static parse(i,u){if(i.length!==2)return u.error("Expected two arguments.");const f=u.parse(i[1],1,Ft);return f?new Lh(f):u.error("No image name provided.")}evaluate(i){const u=this.input.evaluate(i),f=ge.fromString(u);return f&&i.availableImages&&(f.available=i.availableImages.indexOf(u)>-1),f}eachChild(i){i(this.input)}outputDefined(){return!1}}class Rh{constructor(i){this.type=Ye,this.input=i}static parse(i,u){if(i.length!==2)return u.error(`Expected 1 argument, but found ${i.length-1} instead.`);const f=u.parse(i[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${xn(f.type)} instead.`):new Rh(f):null}evaluate(i){const u=this.input.evaluate(i);if(typeof u=="string"||Array.isArray(u))return u.length;throw new nt(`Expected value to be of type string or array, but found ${xn(ke(u))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}}const Ra={"==":Ry,"!=":Oy,">":zy,"<":Dy,">=":By,"<=":Fy,array:xt,at:Ph,boolean:xt,case:kh,coalesce:zc,collator:Mn,format:Uc,image:Lh,in:Ch,"index-of":Bc,interpolate:Mi,"interpolate-hcl":Mi,"interpolate-lab":Mi,length:Rh,let:Fc,literal:pt,match:Ih,number:xt,"number-format":Mh,object:xt,slice:Nc,step:Jn,string:xt,"to-boolean":It,"to-color":It,"to-number":It,"to-string":It,var:Ce,within:Ks};function ap(a,[i,u,f,g]){i=i.evaluate(a),u=u.evaluate(a),f=f.evaluate(a);const _=g?g.evaluate(a):1,b=Me(i,u,f,_);if(b)throw new nt(b);return new J(i/255*_,u/255*_,f/255*_,_)}function lp(a,i){return a in i}function Vc(a,i){const u=i[a];return u===void 0?null:u}function Ho(a){return{type:a}}function cp(a){return{result:"success",value:a}}function Oa(a){return{result:"error",value:a}}function Gn(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function up(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function ln(a){return!!a.expression&&a.expression.interpolated}function vn(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function zn(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function qn(a){return a}function Dl(a,i){const u=i.type==="color",f=a.stops&&typeof a.stops[0][0]=="object",g=f||!(f||a.property!==void 0),_=a.type||(ln(i)?"exponential":"interval");if(u||i.type==="padding"){const M=u?J.parse:ce.parse;(a=Dn({},a)).stops&&(a.stops=a.stops.map(O=>[O[0],M(O[1])])),a.default=M(a.default?a.default:i.default)}if(a.colorSpace&&a.colorSpace!=="rgb"&&!ip[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let b,T,A;if(_==="exponential")b=hp;else if(_==="interval")b=Uy;else if(_==="categorical"){b=Ny,T=Object.create(null);for(const M of a.stops)T[M[0]]=M[1];A=typeof a.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);b=Vy}if(f){const M={},O=[];for(let Z=0;Z<a.stops.length;Z++){const Y=a.stops[Z],le=Y[0].zoom;M[le]===void 0&&(M[le]={zoom:le,type:a.type,property:a.property,default:a.default,stops:[]},O.push(le)),M[le].stops.push([Y[0].value,Y[1]])}const N=[];for(const Z of O)N.push([M[Z].zoom,Dl(M[Z],i)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:Mi.interpolationFactor.bind(void 0,$),zoomStops:N.map(Z=>Z[0]),evaluate:({zoom:Z},Y)=>hp({stops:N,base:a.base},i,Z).evaluate(Z,Y)}}if(g){const M=_==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:Mi.interpolationFactor.bind(void 0,M),zoomStops:a.stops.map(O=>O[0]),evaluate:({zoom:O})=>b(a,i,O,T,A)}}return{kind:"source",evaluate(M,O){const N=O&&O.properties?O.properties[a.property]:void 0;return N===void 0?Da(a.default,i.default):b(a,i,N,T,A)}}}function Da(a,i,u){return a!==void 0?a:i!==void 0?i:u!==void 0?u:void 0}function Ny(a,i,u,f,g){return Da(typeof u===g?f[u]:void 0,a.default,i.default)}function Uy(a,i,u){if(vn(u)!=="number")return Da(a.default,i.default);const f=a.stops.length;if(f===1||u<=a.stops[0][0])return a.stops[0][1];if(u>=a.stops[f-1][0])return a.stops[f-1][1];const g=en(a.stops.map(_=>_[0]),u);return a.stops[g][1]}function hp(a,i,u){const f=a.base!==void 0?a.base:1;if(vn(u)!=="number")return Da(a.default,i.default);const g=a.stops.length;if(g===1||u<=a.stops[0][0])return a.stops[0][1];if(u>=a.stops[g-1][0])return a.stops[g-1][1];const _=en(a.stops.map(O=>O[0]),u),b=function(O,N,$,Z){const Y=Z-$,le=O-$;return Y===0?0:N===1?le/Y:(Math.pow(N,le)-1)/(Math.pow(N,Y)-1)}(u,f,a.stops[_][0],a.stops[_+1][0]),T=a.stops[_][1],A=a.stops[_+1][1];let M=fr[i.type]||qn;if(a.colorSpace&&a.colorSpace!=="rgb"){const O=ip[a.colorSpace];M=(N,$)=>O.reverse(O.interpolate(O.forward(N),O.forward($),b))}return typeof T.evaluate=="function"?{evaluate(...O){const N=T.evaluate.apply(void 0,O),$=A.evaluate.apply(void 0,O);if(N!==void 0&&$!==void 0)return M(N,$,b)}}:M(T,A,b)}function Vy(a,i,u){switch(i.type){case"color":u=J.parse(u);break;case"formatted":u=fe.fromString(u.toString());break;case"resolvedImage":u=ge.fromString(u.toString());break;case"padding":u=ce.parse(u);break;default:vn(u)===i.type||i.type==="enum"&&i.values[u]||(u=void 0)}return Da(u,a.default,i.default)}on.register(Ra,{error:[{kind:"error"},[Ft],(a,[i])=>{throw new nt(i.evaluate(a))}],typeof:[Ft,[Rt],(a,[i])=>xn(ke(i.evaluate(a)))],"to-rgba":[Lr(Ye,4),[Tr],(a,[i])=>i.evaluate(a).toArray()],rgb:[Tr,[Ye,Ye,Ye],ap],rgba:[Tr,[Ye,Ye,Ye,Ye],ap],has:{type:Dt,overloads:[[[Ft],(a,[i])=>lp(i.evaluate(a),a.properties())],[[Ft,os],(a,[i,u])=>lp(i.evaluate(a),u.evaluate(a))]]},get:{type:Rt,overloads:[[[Ft],(a,[i])=>Vc(i.evaluate(a),a.properties())],[[Ft,os],(a,[i,u])=>Vc(i.evaluate(a),u.evaluate(a))]]},"feature-state":[Rt,[Ft],(a,[i])=>Vc(i.evaluate(a),a.featureState||{})],properties:[os,[],a=>a.properties()],"geometry-type":[Ft,[],a=>a.geometryType()],id:[Rt,[],a=>a.id()],zoom:[Ye,[],a=>a.globals.zoom],"heatmap-density":[Ye,[],a=>a.globals.heatmapDensity||0],"line-progress":[Ye,[],a=>a.globals.lineProgress||0],accumulated:[Rt,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[Ye,Ho(Ye),(a,i)=>{let u=0;for(const f of i)u+=f.evaluate(a);return u}],"*":[Ye,Ho(Ye),(a,i)=>{let u=1;for(const f of i)u*=f.evaluate(a);return u}],"-":{type:Ye,overloads:[[[Ye,Ye],(a,[i,u])=>i.evaluate(a)-u.evaluate(a)],[[Ye],(a,[i])=>-i.evaluate(a)]]},"/":[Ye,[Ye,Ye],(a,[i,u])=>i.evaluate(a)/u.evaluate(a)],"%":[Ye,[Ye,Ye],(a,[i,u])=>i.evaluate(a)%u.evaluate(a)],ln2:[Ye,[],()=>Math.LN2],pi:[Ye,[],()=>Math.PI],e:[Ye,[],()=>Math.E],"^":[Ye,[Ye,Ye],(a,[i,u])=>Math.pow(i.evaluate(a),u.evaluate(a))],sqrt:[Ye,[Ye],(a,[i])=>Math.sqrt(i.evaluate(a))],log10:[Ye,[Ye],(a,[i])=>Math.log(i.evaluate(a))/Math.LN10],ln:[Ye,[Ye],(a,[i])=>Math.log(i.evaluate(a))],log2:[Ye,[Ye],(a,[i])=>Math.log(i.evaluate(a))/Math.LN2],sin:[Ye,[Ye],(a,[i])=>Math.sin(i.evaluate(a))],cos:[Ye,[Ye],(a,[i])=>Math.cos(i.evaluate(a))],tan:[Ye,[Ye],(a,[i])=>Math.tan(i.evaluate(a))],asin:[Ye,[Ye],(a,[i])=>Math.asin(i.evaluate(a))],acos:[Ye,[Ye],(a,[i])=>Math.acos(i.evaluate(a))],atan:[Ye,[Ye],(a,[i])=>Math.atan(i.evaluate(a))],min:[Ye,Ho(Ye),(a,i)=>Math.min(...i.map(u=>u.evaluate(a)))],max:[Ye,Ho(Ye),(a,i)=>Math.max(...i.map(u=>u.evaluate(a)))],abs:[Ye,[Ye],(a,[i])=>Math.abs(i.evaluate(a))],round:[Ye,[Ye],(a,[i])=>{const u=i.evaluate(a);return u<0?-Math.round(-u):Math.round(u)}],floor:[Ye,[Ye],(a,[i])=>Math.floor(i.evaluate(a))],ceil:[Ye,[Ye],(a,[i])=>Math.ceil(i.evaluate(a))],"filter-==":[Dt,[Ft,Rt],(a,[i,u])=>a.properties()[i.value]===u.value],"filter-id-==":[Dt,[Rt],(a,[i])=>a.id()===i.value],"filter-type-==":[Dt,[Ft],(a,[i])=>a.geometryType()===i.value],"filter-<":[Dt,[Ft,Rt],(a,[i,u])=>{const f=a.properties()[i.value],g=u.value;return typeof f==typeof g&&f<g}],"filter-id-<":[Dt,[Rt],(a,[i])=>{const u=a.id(),f=i.value;return typeof u==typeof f&&u<f}],"filter->":[Dt,[Ft,Rt],(a,[i,u])=>{const f=a.properties()[i.value],g=u.value;return typeof f==typeof g&&f>g}],"filter-id->":[Dt,[Rt],(a,[i])=>{const u=a.id(),f=i.value;return typeof u==typeof f&&u>f}],"filter-<=":[Dt,[Ft,Rt],(a,[i,u])=>{const f=a.properties()[i.value],g=u.value;return typeof f==typeof g&&f<=g}],"filter-id-<=":[Dt,[Rt],(a,[i])=>{const u=a.id(),f=i.value;return typeof u==typeof f&&u<=f}],"filter->=":[Dt,[Ft,Rt],(a,[i,u])=>{const f=a.properties()[i.value],g=u.value;return typeof f==typeof g&&f>=g}],"filter-id->=":[Dt,[Rt],(a,[i])=>{const u=a.id(),f=i.value;return typeof u==typeof f&&u>=f}],"filter-has":[Dt,[Rt],(a,[i])=>i.value in a.properties()],"filter-has-id":[Dt,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Dt,[Lr(Ft)],(a,[i])=>i.value.indexOf(a.geometryType())>=0],"filter-id-in":[Dt,[Lr(Rt)],(a,[i])=>i.value.indexOf(a.id())>=0],"filter-in-small":[Dt,[Ft,Lr(Rt)],(a,[i,u])=>u.value.indexOf(a.properties()[i.value])>=0],"filter-in-large":[Dt,[Ft,Lr(Rt)],(a,[i,u])=>function(f,g,_,b){for(;_<=b;){const T=_+b>>1;if(g[T]===f)return!0;g[T]>f?b=T-1:_=T+1}return!1}(a.properties()[i.value],u.value,0,u.value.length-1)],all:{type:Dt,overloads:[[[Dt,Dt],(a,[i,u])=>i.evaluate(a)&&u.evaluate(a)],[Ho(Dt),(a,i)=>{for(const u of i)if(!u.evaluate(a))return!1;return!0}]]},any:{type:Dt,overloads:[[[Dt,Dt],(a,[i,u])=>i.evaluate(a)||u.evaluate(a)],[Ho(Dt),(a,i)=>{for(const u of i)if(u.evaluate(a))return!0;return!1}]]},"!":[Dt,[Dt],(a,[i])=>!i.evaluate(a)],"is-supported-script":[Dt,[Ft],(a,[i])=>{const u=a.globals&&a.globals.isSupportedScript;return!u||u(i.evaluate(a))}],upcase:[Ft,[Ft],(a,[i])=>i.evaluate(a).toUpperCase()],downcase:[Ft,[Ft],(a,[i])=>i.evaluate(a).toLowerCase()],concat:[Ft,Ho(Rt),(a,i)=>i.map(u=>ht(u.evaluate(a))).join("")],"resolved-locale":[Ft,[Ii],(a,[i])=>i.evaluate(a).resolvedLocale()]});class jc{constructor(i,u){this.expression=i,this._warningHistory={},this._evaluator=new Qt,this._defaultValue=u?function(f){return f.type==="color"&&zn(f.default)?new J(0,0,0,0):f.type==="color"?J.parse(f.default)||null:f.type==="padding"?ce.parse(f.default)||null:f.default===void 0?null:f.default}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null}evaluateWithoutErrorHandling(i,u,f,g,_,b){return this._evaluator.globals=i,this._evaluator.feature=u,this._evaluator.featureState=f,this._evaluator.canonical=g,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)}evaluate(i,u,f,g,_,b){this._evaluator.globals=i,this._evaluator.feature=u||null,this._evaluator.featureState=f||null,this._evaluator.canonical=g,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=b||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new nt(`Expected value to be one of ${Object.keys(this._enumValues).map(A=>JSON.stringify(A)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function zl(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Ra}function Fl(a,i){const u=new $e(Ra,[],i?function(g){const _={color:Tr,string:Ft,number:Ye,enum:Ft,boolean:Dt,formatted:_r,padding:go,resolvedImage:ar};return g.type==="array"?Lr(_[g.value]||Rt,g.length):_[g.type]}(i):void 0),f=u.parse(a,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?cp(new jc(f,i)):Oa(u.errors)}class Bl{constructor(i,u){this.kind=i,this._styleExpression=u,this.isStateDependent=i!=="constant"&&!ee(u.expression)}evaluateWithoutErrorHandling(i,u,f,g,_,b){return this._styleExpression.evaluateWithoutErrorHandling(i,u,f,g,_,b)}evaluate(i,u,f,g,_,b){return this._styleExpression.evaluate(i,u,f,g,_,b)}}class Oh{constructor(i,u,f,g){this.kind=i,this.zoomStops=f,this._styleExpression=u,this.isStateDependent=i!=="camera"&&!ee(u.expression),this.interpolationType=g}evaluateWithoutErrorHandling(i,u,f,g,_,b){return this._styleExpression.evaluateWithoutErrorHandling(i,u,f,g,_,b)}evaluate(i,u,f,g,_,b){return this._styleExpression.evaluate(i,u,f,g,_,b)}interpolationFactor(i,u,f){return this.interpolationType?Mi.interpolationFactor(this.interpolationType,i,u,f):0}}function dp(a,i){const u=Fl(a,i);if(u.result==="error")return u;const f=u.value.expression,g=X(f);if(!g&&!Gn(i))return Oa([new ni("","data expressions not supported")]);const _=de(f,["zoom"]);if(!_&&!up(i))return Oa([new ni("","zoom expressions not supported")]);const b=$c(f);return b||_?b instanceof ni?Oa([b]):b instanceof Mi&&!ln(i)?Oa([new ni("",'"interpolate" expressions cannot be used with this property')]):cp(b?new Oh(g?"camera":"composite",u.value,b.labels,b instanceof Mi?b.interpolation:void 0):new Bl(g?"constant":"source",u.value)):Oa([new ni("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Gc{constructor(i,u){this._parameters=i,this._specification=u,Dn(this,Dl(this._parameters,this._specification))}static deserialize(i){return new Gc(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function $c(a){let i=null;if(a instanceof Fc)i=$c(a.result);else if(a instanceof zc){for(const u of a.args)if(i=$c(u),i)break}else(a instanceof Jn||a instanceof Mi)&&a.input instanceof on&&a.input.name==="zoom"&&(i=a);return i instanceof ni||a.eachChild(u=>{const f=$c(u);f instanceof ni?i=f:!i&&f?i=new ni("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&f&&i!==f&&(i=new ni("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function cs(a){const i=a.key,u=a.value,f=a.valueSpec||{},g=a.objectElementValidators||{},_=a.style,b=a.styleSpec;let T=[];const A=vn(u);if(A!=="object")return[new je(i,u,`object expected, ${A} found`)];for(const M in u){const O=M.split(".")[0],N=f[O]||f["*"];let $;if(g[O])$=g[O];else if(f[O])$=Ri;else if(g["*"])$=g["*"];else{if(!f["*"]){T.push(new je(i,u[M],`unknown property "${M}"`));continue}$=Ri}T=T.concat($({key:(i&&`${i}.`)+M,value:u[M],valueSpec:N,style:_,styleSpec:b,object:u,objectKey:M},u))}for(const M in f)g[M]||f[M].required&&f[M].default===void 0&&u[M]===void 0&&T.push(new je(i,u,`missing required property "${M}"`));return T}function fp(a){const i=a.value,u=a.valueSpec,f=a.style,g=a.styleSpec,_=a.key,b=a.arrayElementValidator||Ri;if(vn(i)!=="array")return[new je(_,i,`array expected, ${vn(i)} found`)];if(u.length&&i.length!==u.length)return[new je(_,i,`array length ${u.length} expected, length ${i.length} found`)];if(u["min-length"]&&i.length<u["min-length"])return[new je(_,i,`array length at least ${u["min-length"]} expected, length ${i.length} found`)];let T={type:u.value,values:u.values};g.$version<7&&(T.function=u.function),vn(u.value)==="object"&&(T=u.value);let A=[];for(let M=0;M<i.length;M++)A=A.concat(b({array:i,arrayIndex:M,value:i[M],valueSpec:T,style:f,styleSpec:g,key:`${_}[${M}]`}));return A}function Dh(a){const i=a.key,u=a.value,f=a.valueSpec;let g=vn(u);return g==="number"&&u!=u&&(g="NaN"),g!=="number"?[new je(i,u,`number expected, ${g} found`)]:"minimum"in f&&u<f.minimum?[new je(i,u,`${u} is less than the minimum value ${f.minimum}`)]:"maximum"in f&&u>f.maximum?[new je(i,u,`${u} is greater than the maximum value ${f.maximum}`)]:[]}function pp(a){const i=a.valueSpec,u=Ht(a.value.type);let f,g,_,b={};const T=u!=="categorical"&&a.value.property===void 0,A=!T,M=vn(a.value.stops)==="array"&&vn(a.value.stops[0])==="array"&&vn(a.value.stops[0][0])==="object",O=cs({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(Z){if(u==="identity")return[new je(Z.key,Z.value,'identity function may not have a "stops" property')];let Y=[];const le=Z.value;return Y=Y.concat(fp({key:Z.key,value:le,valueSpec:Z.valueSpec,style:Z.style,styleSpec:Z.styleSpec,arrayElementValidator:N})),vn(le)==="array"&&le.length===0&&Y.push(new je(Z.key,le,"array must have at least one stop")),Y},default:function(Z){return Ri({key:Z.key,value:Z.value,valueSpec:i,style:Z.style,styleSpec:Z.styleSpec})}}});return u==="identity"&&T&&O.push(new je(a.key,a.value,'missing required property "property"')),u==="identity"||a.value.stops||O.push(new je(a.key,a.value,'missing required property "stops"')),u==="exponential"&&a.valueSpec.expression&&!ln(a.valueSpec)&&O.push(new je(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(A&&!Gn(a.valueSpec)?O.push(new je(a.key,a.value,"property functions not supported")):T&&!up(a.valueSpec)&&O.push(new je(a.key,a.value,"zoom functions not supported"))),u!=="categorical"&&!M||a.value.property!==void 0||O.push(new je(a.key,a.value,'"property" property is required')),O;function N(Z){let Y=[];const le=Z.value,ae=Z.key;if(vn(le)!=="array")return[new je(ae,le,`array expected, ${vn(le)} found`)];if(le.length!==2)return[new je(ae,le,`array length 2 expected, length ${le.length} found`)];if(M){if(vn(le[0])!=="object")return[new je(ae,le,`object expected, ${vn(le[0])} found`)];if(le[0].zoom===void 0)return[new je(ae,le,"object stop key must have zoom")];if(le[0].value===void 0)return[new je(ae,le,"object stop key must have value")];if(_&&_>Ht(le[0].zoom))return[new je(ae,le[0].zoom,"stop zoom values must appear in ascending order")];Ht(le[0].zoom)!==_&&(_=Ht(le[0].zoom),g=void 0,b={}),Y=Y.concat(cs({key:`${ae}[0]`,value:le[0],valueSpec:{zoom:{}},style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{zoom:Dh,value:$}}))}else Y=Y.concat($({key:`${ae}[0]`,value:le[0],valueSpec:{},style:Z.style,styleSpec:Z.styleSpec},le));return zl(Vr(le[1]))?Y.concat([new je(`${ae}[1]`,le[1],"expressions are not allowed in function stops.")]):Y.concat(Ri({key:`${ae}[1]`,value:le[1],valueSpec:i,style:Z.style,styleSpec:Z.styleSpec}))}function $(Z,Y){const le=vn(Z.value),ae=Ht(Z.value),be=Z.value!==null?Z.value:Y;if(f){if(le!==f)return[new je(Z.key,be,`${le} stop domain type must match previous stop domain type ${f}`)]}else f=le;if(le!=="number"&&le!=="string"&&le!=="boolean")return[new je(Z.key,be,"stop domain value must be a number, string, or boolean")];if(le!=="number"&&u!=="categorical"){let Pe=`number expected, ${le} found`;return Gn(i)&&u===void 0&&(Pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new je(Z.key,be,Pe)]}return u!=="categorical"||le!=="number"||isFinite(ae)&&Math.floor(ae)===ae?u!=="categorical"&&le==="number"&&g!==void 0&&ae<g?[new je(Z.key,be,"stop domain values must appear in ascending order")]:(g=ae,u==="categorical"&&ae in b?[new je(Z.key,be,"stop domain values must be unique")]:(b[ae]=!0,[])):[new je(Z.key,be,`integer expected, found ${ae}`)]}}function qo(a){const i=(a.expressionContext==="property"?dp:Fl)(Vr(a.value),a.valueSpec);if(i.result==="error")return i.value.map(f=>new je(`${a.key}${f.key}`,a.value,f.message));const u=i.value.expression||i.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!u.outputDefined())return[new je(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!ee(u))return[new je(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!ee(u))return[new je(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!de(u,["zoom","feature-state"]))return[new je(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!X(u))return[new je(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Nl(a){const i=a.key,u=a.value,f=a.valueSpec,g=[];return Array.isArray(f.values)?f.values.indexOf(Ht(u))===-1&&g.push(new je(i,u,`expected one of [${f.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(f.values).indexOf(Ht(u))===-1&&g.push(new je(i,u,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(u)} found`)),g}function za(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const i of a.slice(1))if(!za(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}const jy={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Wc(a){if(a==null)return{filter:()=>!0,needGeometry:!1};za(a)||(a=Ul(a));const i=Fl(a,jy);if(i.result==="error")throw new Error(i.value.map(u=>`${u.key}: ${u.message}`).join(", "));return{filter:(u,f,g)=>i.value.evaluate(u,f,{},g),needGeometry:gp(a)}}function mp(a,i){return a<i?-1:a>i?1:0}function gp(a){if(!Array.isArray(a))return!1;if(a[0]==="within")return!0;for(let i=1;i<a.length;i++)if(gp(a[i]))return!0;return!1}function Ul(a){if(!a)return!0;const i=a[0];return a.length<=1?i!=="any":i==="=="?zh(a[1],a[2],"=="):i==="!="?Fa(zh(a[1],a[2],"==")):i==="<"||i===">"||i==="<="||i===">="?zh(a[1],a[2],i):i==="any"?(u=a.slice(1),["any"].concat(u.map(Ul))):i==="all"?["all"].concat(a.slice(1).map(Ul)):i==="none"?["all"].concat(a.slice(1).map(Ul).map(Fa)):i==="in"?Hc(a[1],a.slice(2)):i==="!in"?Fa(Hc(a[1],a.slice(2))):i==="has"?Vl(a[1]):i==="!has"?Fa(Vl(a[1])):i!=="within"||a;var u}function zh(a,i,u){switch(a){case"$type":return[`filter-type-${u}`,i];case"$id":return[`filter-id-${u}`,i];default:return[`filter-${u}`,a,i]}}function Hc(a,i){if(i.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(u=>typeof u!=typeof i[0])?["filter-in-large",a,["literal",i.sort(mp)]]:["filter-in-small",a,["literal",i]]}}function Vl(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Fa(a){return["!",a]}function jl(a){return za(Vr(a.value))?qo(Dn({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):yp(a)}function yp(a){const i=a.value,u=a.key;if(vn(i)!=="array")return[new je(u,i,`array expected, ${vn(i)} found`)];const f=a.styleSpec;let g,_=[];if(i.length<1)return[new je(u,i,"filter array must have at least 1 element")];switch(_=_.concat(Nl({key:`${u}[0]`,value:i[0],valueSpec:f.filter_operator,style:a.style,styleSpec:a.styleSpec})),Ht(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&Ht(i[1])==="$type"&&_.push(new je(u,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&_.push(new je(u,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(g=vn(i[1]),g!=="string"&&_.push(new je(`${u}[1]`,i[1],`string expected, ${g} found`)));for(let b=2;b<i.length;b++)g=vn(i[b]),Ht(i[1])==="$type"?_=_.concat(Nl({key:`${u}[${b}]`,value:i[b],valueSpec:f.geometry_type,style:a.style,styleSpec:a.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&_.push(new je(`${u}[${b}]`,i[b],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let b=1;b<i.length;b++)_=_.concat(yp({key:`${u}[${b}]`,value:i[b],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":g=vn(i[1]),i.length!==2?_.push(new je(u,i,`filter array for "${i[0]}" operator must have 2 elements`)):g!=="string"&&_.push(new je(`${u}[1]`,i[1],`string expected, ${g} found`));break;case"within":g=vn(i[1]),i.length!==2?_.push(new je(u,i,`filter array for "${i[0]}" operator must have 2 elements`)):g!=="object"&&_.push(new je(`${u}[1]`,i[1],`object expected, ${g} found`))}return _}function Gl(a,i){const u=a.key,f=a.style,g=a.styleSpec,_=a.value,b=a.objectKey,T=g[`${i}_${a.layerType}`];if(!T)return[];const A=b.match(/^(.*)-transition$/);if(i==="paint"&&A&&T[A[1]]&&T[A[1]].transition)return Ri({key:u,value:_,valueSpec:g.transition,style:f,styleSpec:g});const M=a.valueSpec||T[b];if(!M)return[new je(u,_,`unknown property "${b}"`)];let O;if(vn(_)==="string"&&Gn(M)&&!M.tokens&&(O=/^{([^}]+)}$/.exec(_)))return[new je(u,_,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(O[1])} }\`.`)];const N=[];return a.layerType==="symbol"&&(b==="text-field"&&f&&!f.glyphs&&N.push(new je(u,_,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&zn(Vr(_))&&Ht(_.type)==="identity"&&N.push(new je(u,_,'"text-font" does not support identity functions'))),N.concat(Ri({key:a.key,value:_,valueSpec:M,style:f,styleSpec:g,expressionContext:"property",propertyType:i,propertyKey:b}))}function _p(a){return Gl(a,"paint")}function vp(a){return Gl(a,"layout")}function xp(a){let i=[];const u=a.value,f=a.key,g=a.style,_=a.styleSpec;u.type||u.ref||i.push(new je(f,u,'either "type" or "ref" is required'));let b=Ht(u.type);const T=Ht(u.ref);if(u.id){const A=Ht(u.id);for(let M=0;M<a.arrayIndex;M++){const O=g.layers[M];Ht(O.id)===A&&i.push(new je(f,u.id,`duplicate layer id "${u.id}", previously used at line ${O.id.__line__}`))}}if("ref"in u){let A;["type","source","source-layer","filter","layout"].forEach(M=>{M in u&&i.push(new je(f,u[M],`"${M}" is prohibited for ref layers`))}),g.layers.forEach(M=>{Ht(M.id)===T&&(A=M)}),A?A.ref?i.push(new je(f,u.ref,"ref cannot reference another ref layer")):b=Ht(A.type):i.push(new je(f,u.ref,`ref layer "${T}" not found`))}else if(b!=="background")if(u.source){const A=g.sources&&g.sources[u.source],M=A&&Ht(A.type);A?M==="vector"&&b==="raster"?i.push(new je(f,u.source,`layer "${u.id}" requires a raster source`)):M==="raster"&&b!=="raster"?i.push(new je(f,u.source,`layer "${u.id}" requires a vector source`)):M!=="vector"||u["source-layer"]?M==="raster-dem"&&b!=="hillshade"?i.push(new je(f,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):b!=="line"||!u.paint||!u.paint["line-gradient"]||M==="geojson"&&A.lineMetrics||i.push(new je(f,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new je(f,u,`layer "${u.id}" must specify a "source-layer"`)):i.push(new je(f,u.source,`source "${u.source}" not found`))}else i.push(new je(f,u,'missing required property "source"'));return i=i.concat(cs({key:f,value:u,valueSpec:_.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ri({key:`${f}.type`,value:u.type,valueSpec:_.layer.type,style:a.style,styleSpec:a.styleSpec,object:u,objectKey:"type"}),filter:jl,layout:A=>cs({layer:u,key:A.key,value:A.value,style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":M=>vp(Dn({layerType:b},M))}}),paint:A=>cs({layer:u,key:A.key,value:A.value,style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":M=>_p(Dn({layerType:b},M))}})}})),i}function Ba(a){const i=a.value,u=a.key,f=vn(i);return f!=="string"?[new je(u,i,`string expected, ${f} found`)]:[]}const bp={promoteId:function({key:a,value:i}){if(vn(i)==="string")return Ba({key:a,value:i});{const u=[];for(const f in i)u.push(...Ba({key:`${a}.${f}`,value:i[f]}));return u}}};function $l(a){const i=a.value,u=a.key,f=a.styleSpec,g=a.style;if(!i.type)return[new je(u,i,'"type" is required')];const _=Ht(i.type);let b;switch(_){case"vector":case"raster":case"raster-dem":return b=cs({key:u,value:i,valueSpec:f[`source_${_.replace("-","_")}`],style:a.style,styleSpec:f,objectElementValidators:bp}),b;case"geojson":if(b=cs({key:u,value:i,valueSpec:f.source_geojson,style:g,styleSpec:f,objectElementValidators:bp}),i.cluster)for(const T in i.clusterProperties){const[A,M]=i.clusterProperties[T],O=typeof A=="string"?[A,["accumulated"],["get",T]]:A;b.push(...qo({key:`${u}.${T}.map`,value:M,expressionContext:"cluster-map"})),b.push(...qo({key:`${u}.${T}.reduce`,value:O,expressionContext:"cluster-reduce"}))}return b;case"video":return cs({key:u,value:i,valueSpec:f.source_video,style:g,styleSpec:f});case"image":return cs({key:u,value:i,valueSpec:f.source_image,style:g,styleSpec:f});case"canvas":return[new je(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Nl({key:`${u}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:g,styleSpec:f})}}function Wl(a){const i=a.value,u=a.styleSpec,f=u.light,g=a.style;let _=[];const b=vn(i);if(i===void 0)return _;if(b!=="object")return _=_.concat([new je("light",i,`object expected, ${b} found`)]),_;for(const T in i){const A=T.match(/^(.*)-transition$/);_=_.concat(A&&f[A[1]]&&f[A[1]].transition?Ri({key:T,value:i[T],valueSpec:u.transition,style:g,styleSpec:u}):f[T]?Ri({key:T,value:i[T],valueSpec:f[T],style:g,styleSpec:u}):[new je(T,i[T],`unknown property "${T}"`)])}return _}function Li(a){const i=a.value,u=a.styleSpec,f=u.terrain,g=a.style;let _=[];const b=vn(i);if(i===void 0)return _;if(b!=="object")return _=_.concat([new je("terrain",i,`object expected, ${b} found`)]),_;for(const T in i)_=_.concat(f[T]?Ri({key:T,value:i[T],valueSpec:f[T],style:g,styleSpec:u}):[new je(T,i[T],`unknown property "${T}"`)]);return _}const Hl={"*":()=>[],array:fp,boolean:function(a){const i=a.value,u=a.key,f=vn(i);return f!=="boolean"?[new je(u,i,`boolean expected, ${f} found`)]:[]},number:Dh,color:function(a){const i=a.key,u=a.value,f=vn(u);return f!=="string"?[new je(i,u,`color expected, ${f} found`)]:_o(u)===null?[new je(i,u,`color expected, "${u}" found`)]:[]},constants:Xr,enum:Nl,filter:jl,function:pp,layer:xp,object:cs,source:$l,light:Wl,terrain:Li,string:Ba,formatted:function(a){return Ba(a).length===0?[]:qo(a)},resolvedImage:function(a){return Ba(a).length===0?[]:qo(a)},padding:function(a){const i=a.key,u=a.value;if(vn(u)==="array"){if(u.length<1||u.length>4)return[new je(i,u,`padding requires 1 to 4 values; ${u.length} values found`)];const f={type:"number"};let g=[];for(let _=0;_<u.length;_++)g=g.concat(Ri({key:`${i}[${_}]`,value:u[_],valueSpec:f}));return g}return Dh({key:i,value:u,valueSpec:{}})}};function Ri(a){const i=a.value,u=a.valueSpec,f=a.styleSpec;return u.expression&&zn(Ht(i))?pp(a):u.expression&&zl(Vr(i))?qo(a):u.type&&Hl[u.type]?Hl[u.type](a):cs(Dn({},a,{valueSpec:u.type?f[u.type]:u}))}function Gy(a){const i=a.value,u=a.key,f=Ba(a);return f.length||(i.indexOf("{fontstack}")===-1&&f.push(new je(u,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&f.push(new je(u,i,'"glyphs" url must include a "{range}" token'))),f}function xo(a,i=Re){let u=[];return u=u.concat(Ri({key:"",value:a,valueSpec:i.$root,styleSpec:i,style:a,objectElementValidators:{glyphs:Gy,"*":()=>[]}})),a.constants&&(u=u.concat(Xr({key:"constants",value:a.constants,style:a,styleSpec:i}))),wp(u)}function wp(a){return[].concat(a).sort((i,u)=>i.line-u.line)}function Js(a){return function(...i){return wp(a.apply(this,i))}}xo.source=Js($l),xo.light=Js(Wl),xo.terrain=Js(Li),xo.layer=Js(xp),xo.filter=Js(jl),xo.paintProperty=Js(_p),xo.layoutProperty=Js(vp);const ql=xo,Fh=ql.light,$y=ql.paintProperty,Wy=ql.layoutProperty;function qc(a,i){let u=!1;if(i&&i.length)for(const f of i)a.fire(new Sn(new Error(f.message))),u=!0;return u}class Xl{constructor(i,u,f){const g=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;const b=new Int32Array(this.arrayBuffer);i=b[0],this.d=(u=b[1])+2*(f=b[2]);for(let A=0;A<this.d*this.d;A++){const M=b[3+A],O=b[3+A+1];g.push(M===O?null:b.subarray(M,O))}const T=b[3+g.length+1];this.keys=b.subarray(b[3+g.length],T),this.bboxes=b.subarray(T),this.insert=this._insertReadonly}else{this.d=u+2*f;for(let b=0;b<this.d*this.d;b++)g.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=i,this.padding=f,this.scale=u/i,this.uid=0;const _=f/u*i;this.min=-_,this.max=i+_}insert(i,u,f,g,_){this._forEachCell(u,f,g,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(i),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(i,u,f,g,_,b){this.cells[_].push(b)}query(i,u,f,g,_){const b=this.min,T=this.max;if(i<=b&&u<=b&&T<=f&&T<=g&&!_)return Array.prototype.slice.call(this.keys);{const A=[];return this._forEachCell(i,u,f,g,this._queryCell,A,{},_),A}}_queryCell(i,u,f,g,_,b,T,A){const M=this.cells[_];if(M!==null){const O=this.keys,N=this.bboxes;for(let $=0;$<M.length;$++){const Z=M[$];if(T[Z]===void 0){const Y=4*Z;(A?A(N[Y+0],N[Y+1],N[Y+2],N[Y+3]):i<=N[Y+2]&&u<=N[Y+3]&&f>=N[Y+0]&&g>=N[Y+1])?(T[Z]=!0,b.push(O[Z])):T[Z]=!1}}}}_forEachCell(i,u,f,g,_,b,T,A){const M=this._convertToCellCoord(i),O=this._convertToCellCoord(u),N=this._convertToCellCoord(f),$=this._convertToCellCoord(g);for(let Z=M;Z<=N;Z++)for(let Y=O;Y<=$;Y++){const le=this.d*Y+Z;if((!A||A(this._convertFromCellCoord(Z),this._convertFromCellCoord(Y),this._convertFromCellCoord(Z+1),this._convertFromCellCoord(Y+1)))&&_.call(this,i,u,f,g,le,b,T,A))return}}_convertFromCellCoord(i){return(i-this.padding)/this.scale}_convertToCellCoord(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const i=this.cells,u=3+this.cells.length+1+1;let f=0;for(let b=0;b<this.cells.length;b++)f+=this.cells[b].length;const g=new Int32Array(u+f+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let _=u;for(let b=0;b<i.length;b++){const T=i[b];g[3+b]=_,g.set(T,_),_+=T.length}return g[3+i.length]=_,g.set(this.keys,_),_+=this.keys.length,g[3+i.length+1]=_,g.set(this.bboxes,_),_+=this.bboxes.length,g.buffer}static serialize(i,u){const f=i.toArrayBuffer();return u&&u.push(f),{buffer:f}}static deserialize(i){return new Xl(i.buffer)}}const Qs={};function dt(a,i,u={}){if(Qs[a])throw new Error(`${a} is already registered.`);Object.defineProperty(i,"_classRegistryKey",{value:a,writeable:!1}),Qs[a]={klass:i,omit:u.omit||[],shallow:u.shallow||[]}}dt("Object",Object),dt("TransferableGridIndex",Xl),dt("Color",J),dt("Error",Error),dt("AJAXError",Vn),dt("ResolvedImage",ge),dt("StylePropertyFunction",Gc),dt("StyleExpression",jc,{omit:["_evaluator"]}),dt("ZoomDependentExpression",Oh),dt("ZoomConstantExpression",Bl),dt("CompoundExpression",on,{omit:["_evaluate"]});for(const a in Ra)Ra[a]._classRegistryKey||dt(`Expression_${a}`,Ra[a]);function Ep(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Xo(a,i){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob)return a;if(Ep(a)||ot(a))return i&&i.push(a),a;if(ArrayBuffer.isView(a)){const u=a;return i&&i.push(u.buffer),u}if(a instanceof ImageData)return i&&i.push(a.data.buffer),a;if(Array.isArray(a)){const u=[];for(const f of a)u.push(Xo(f,i));return u}if(typeof a=="object"){const u=a.constructor,f=u._classRegistryKey;if(!f)throw new Error("can't serialize object of unregistered class");if(!Qs[f])throw new Error(`${f} is not registered.`);const g=u.serialize?u.serialize(a,i):{};if(u.serialize){if(i&&g===i[i.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const _ in a){if(!a.hasOwnProperty(_)||Qs[f].omit.indexOf(_)>=0)continue;const b=a[_];g[_]=Qs[f].shallow.indexOf(_)>=0?b:Xo(b,i)}a instanceof Error&&(g.message=a.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(g.$name=f),g}throw new Error("can't serialize object of type "+typeof a)}function bo(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||Ep(a)||ot(a)||ArrayBuffer.isView(a)||a instanceof ImageData)return a;if(Array.isArray(a))return a.map(bo);if(typeof a=="object"){const i=a.$name||"Object";if(!Qs[i])throw new Error(`can't deserialize unregistered class ${i}`);const{klass:u}=Qs[i];if(!u)throw new Error(`can't deserialize unregistered class ${i}`);if(u.deserialize)return u.deserialize(a);const f=Object.create(u.prototype);for(const g of Object.keys(a)){if(g==="$name")continue;const _=a[g];f[g]=Qs[i].shallow.indexOf(g)>=0?_:bo(_)}return f}throw new Error("can't deserialize object of type "+typeof a)}class Bh{constructor(){this.first=!0}update(i,u){const f=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=u):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=u),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=f,!0))}}const rt={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Xc(a){for(const i of a)if(Uh(i.charCodeAt(0)))return!0;return!1}function Hy(a){for(const i of a)if(!Nh(i.charCodeAt(0)))return!1;return!0}function Nh(a){return!(rt.Arabic(a)||rt["Arabic Supplement"](a)||rt["Arabic Extended-A"](a)||rt["Arabic Presentation Forms-A"](a)||rt["Arabic Presentation Forms-B"](a))}function Uh(a){return!(a!==746&&a!==747&&(a<4352||!(rt["Bopomofo Extended"](a)||rt.Bopomofo(a)||rt["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||rt["CJK Compatibility Ideographs"](a)||rt["CJK Compatibility"](a)||rt["CJK Radicals Supplement"](a)||rt["CJK Strokes"](a)||!(!rt["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||rt["CJK Unified Ideographs Extension A"](a)||rt["CJK Unified Ideographs"](a)||rt["Enclosed CJK Letters and Months"](a)||rt["Hangul Compatibility Jamo"](a)||rt["Hangul Jamo Extended-A"](a)||rt["Hangul Jamo Extended-B"](a)||rt["Hangul Jamo"](a)||rt["Hangul Syllables"](a)||rt.Hiragana(a)||rt["Ideographic Description Characters"](a)||rt.Kanbun(a)||rt["Kangxi Radicals"](a)||rt["Katakana Phonetic Extensions"](a)||rt.Katakana(a)&&a!==12540||!(!rt["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!rt["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||rt["Unified Canadian Aboriginal Syllabics"](a)||rt["Unified Canadian Aboriginal Syllabics Extended"](a)||rt["Vertical Forms"](a)||rt["Yijing Hexagram Symbols"](a)||rt["Yi Syllables"](a)||rt["Yi Radicals"](a))))}function Tp(a){return!(Uh(a)||function(i){return!!(rt["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||rt["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||rt["Letterlike Symbols"](i)||rt["Number Forms"](i)||rt["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||rt["Control Pictures"](i)&&i!==9251||rt["Optical Character Recognition"](i)||rt["Enclosed Alphanumerics"](i)||rt["Geometric Shapes"](i)||rt["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||rt["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||rt["CJK Symbols and Punctuation"](i)||rt.Katakana(i)||rt["Private Use Area"](i)||rt["CJK Compatibility Forms"](i)||rt["Small Form Variants"](i)||rt["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(a))}function Sp(a){return a>=1424&&a<=2303||rt["Arabic Presentation Forms-A"](a)||rt["Arabic Presentation Forms-B"](a)}function qy(a,i){return!(!i&&Sp(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||rt.Khmer(a))}function Ap(a){for(const i of a)if(Sp(i.charCodeAt(0)))return!0;return!1}const Vh="deferred",jh="loading",Gh="loaded";let $h=null,pi="unavailable",wo=null;const Pp=function(a){a&&typeof a=="string"&&a.indexOf("NetworkError")>-1&&(pi="error"),$h&&$h(a)};function Na(){Wh.fire(new Nt("pluginStateChange",{pluginStatus:pi,pluginURL:wo}))}const Wh=new Ut,Zl=function(){return pi},Cp=function(){if(pi!==Vh||!wo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");pi=jh,Na(),wo&&Mr({url:wo},a=>{a?Pp(a):(pi=Gh,Na())})},Xi={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>pi===Gh||Xi.applyArabicShaping!=null,isLoading:()=>pi===jh,setState(a){if(!Be())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");pi=a.pluginStatus,wo=a.pluginURL},isParsed(){if(!Be())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Xi.applyArabicShaping!=null&&Xi.processBidirectionalText!=null&&Xi.processStyledBidirectionalText!=null},getPluginURL(){if(!Be())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return wo}};class Xn{constructor(i,u){this.zoom=i,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.zoomHistory=u.zoomHistory,this.transition=u.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Bh,this.transition={})}isSupportedScript(i){return function(u,f){for(const g of u)if(!qy(g.charCodeAt(0),f))return!1;return!0}(i,Xi.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,u=i-Math.floor(i),f=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:u+(1-u)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*u}}}class Yl{constructor(i,u){this.property=i,this.value=u,this.expression=function(f,g){if(zn(f))return new Gc(f,g);if(zl(f)){const _=dp(f,g);if(_.result==="error")throw new Error(_.value.map(b=>`${b.key}: ${b.message}`).join(", "));return _.value}{let _=f;return g.type==="color"&&typeof f=="string"?_=J.parse(f):g.type!=="padding"||typeof f!="number"&&!Array.isArray(f)||(_=ce.parse(f)),{kind:"constant",evaluate:()=>_}}}(u===void 0?i.specification.default:u,i.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,u,f){return this.property.possiblyEvaluate(this,i,u,f)}}class Zc{constructor(i){this.property=i,this.value=new Yl(i,void 0)}transitioned(i,u){return new kp(this.property,this.value,u,F({},i.transition,this.transition),i.now)}untransitioned(){return new kp(this.property,this.value,null,{},0)}}class Ip{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return G(this._values[i].value.value)}setValue(i,u){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Zc(this._values[i].property)),this._values[i].value=new Yl(this._values[i].property,u===null?void 0:G(u))}getTransition(i){return G(this._values[i].transition)}setTransition(i,u){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Zc(this._values[i].property)),this._values[i].transition=G(u)||void 0}serialize(){const i={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(i[u]=f);const g=this.getTransition(u);g!==void 0&&(i[`${u}-transition`]=g)}return i}transitioned(i,u){const f=new Mp(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].transitioned(i,u._values[g]);return f}untransitioned(){const i=new Mp(this._properties);for(const u of Object.keys(this._values))i._values[u]=this._values[u].untransitioned();return i}}class kp{constructor(i,u,f,g,_){this.property=i,this.value=u,this.begin=_+g.delay||0,this.end=this.begin+g.duration||0,i.specification.transition&&(g.delay||g.duration)&&(this.prior=f)}possiblyEvaluate(i,u,f){const g=i.now||0,_=this.value.possiblyEvaluate(i,u,f),b=this.prior;if(b){if(g>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(g<this.begin)return b.possiblyEvaluate(i,u,f);{const T=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(i,u,f),_,function(A){if(A<=0)return 0;if(A>=1)return 1;const M=A*A,O=M*A;return 4*(A<.5?O:3*(A-M)+O-.75)}(T))}}return _}}class Mp{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,u,f){const g=new Kl(this._properties);for(const _ of Object.keys(this._values))g._values[_]=this._values[_].possiblyEvaluate(i,u,f);return g}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class Xy{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}getValue(i){return G(this._values[i].value)}setValue(i,u){this._values[i]=new Yl(this._values[i].property,u===null?void 0:G(u))}serialize(){const i={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(i[u]=f)}return i}possiblyEvaluate(i,u,f){const g=new Kl(this._properties);for(const _ of Object.keys(this._values))g._values[_]=this._values[_].possiblyEvaluate(i,u,f);return g}}class Ls{constructor(i,u,f){this.property=i,this.value=u,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,u,f,g){return this.property.evaluate(this.value,this.parameters,i,u,f,g)}}class Kl{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class vt{constructor(i){this.specification=i}possiblyEvaluate(i,u){if(i.isDataDriven())throw new Error("Value should not be data driven");return i.expression.evaluate(u)}interpolate(i,u,f){const g=fr[this.specification.type];return g?g(i,u,f):i}}class kt{constructor(i,u){this.specification=i,this.overrides=u}possiblyEvaluate(i,u,f,g){return new Ls(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(u,null,{},f,g)}:i.expression,u)}interpolate(i,u,f){if(i.value.kind!=="constant"||u.value.kind!=="constant")return i;if(i.value.value===void 0||u.value.value===void 0)return new Ls(this,{kind:"constant",value:void 0},i.parameters);const g=fr[this.specification.type];return g?new Ls(this,{kind:"constant",value:g(i.value.value,u.value.value,f)},i.parameters):i}evaluate(i,u,f,g,_,b){return i.kind==="constant"?i.value:i.evaluate(u,f,g,_,b)}}class Ua extends kt{possiblyEvaluate(i,u,f,g){if(i.value===void 0)return new Ls(this,{kind:"constant",value:void 0},u);if(i.expression.kind==="constant"){const _=i.expression.evaluate(u,null,{},f,g),b=i.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,T=this._calculate(b,b,b,u);return new Ls(this,{kind:"constant",value:T},u)}if(i.expression.kind==="camera"){const _=this._calculate(i.expression.evaluate({zoom:u.zoom-1}),i.expression.evaluate({zoom:u.zoom}),i.expression.evaluate({zoom:u.zoom+1}),u);return new Ls(this,{kind:"constant",value:_},u)}return new Ls(this,i.expression,u)}evaluate(i,u,f,g,_,b){if(i.kind==="source"){const T=i.evaluate(u,f,g,_,b);return this._calculate(T,T,T,u)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(u.zoom)-1},f,g),i.evaluate({zoom:Math.floor(u.zoom)},f,g),i.evaluate({zoom:Math.floor(u.zoom)+1},f,g),u):i.value}_calculate(i,u,f,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:i,to:u}:{from:f,to:u}}interpolate(i){return i}}class Hh{constructor(i){this.specification=i}possiblyEvaluate(i,u,f,g){if(i.value!==void 0){if(i.expression.kind==="constant"){const _=i.expression.evaluate(u,null,{},f,g);return this._calculate(_,_,_,u)}return this._calculate(i.expression.evaluate(new Xn(Math.floor(u.zoom-1),u)),i.expression.evaluate(new Xn(Math.floor(u.zoom),u)),i.expression.evaluate(new Xn(Math.floor(u.zoom+1),u)),u)}}_calculate(i,u,f,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:i,to:u}:{from:f,to:u}}interpolate(i){return i}}class Eo{constructor(i){this.specification=i}possiblyEvaluate(i,u,f,g){return!!i.expression.evaluate(u,null,{},f,g)}interpolate(){return!1}}class Gr{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const u in i){const f=i[u];f.specification.overridable&&this.overridableProperties.push(u);const g=this.defaultPropertyValues[u]=new Yl(f,void 0),_=this.defaultTransitionablePropertyValues[u]=new Zc(f);this.defaultTransitioningPropertyValues[u]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=g.possiblyEvaluate({})}}}dt("DataDrivenProperty",kt),dt("DataConstantProperty",vt),dt("CrossFadedDataDrivenProperty",Ua),dt("CrossFadedProperty",Hh),dt("ColorRampProperty",Eo);const To="-transition";class Rs extends Ut{constructor(i,u){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1},i.type!=="custom"&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),u.layout&&(this._unevaluatedLayout=new Xy(u.layout)),u.paint)){this._transitionablePaint=new Ip(u.paint);for(const f in i.paint)this.setPaintProperty(f,i.paint[f],{validate:!1});for(const f in i.layout)this.setLayoutProperty(f,i.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Kl(u.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,u,f={}){u!=null&&this._validate(Wy,`layers.${this.id}.layout.${i}`,i,u,f)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,u):this.visibility=u)}getPaintProperty(i){return i.endsWith(To)?this._transitionablePaint.getTransition(i.slice(0,-To.length)):this._transitionablePaint.getValue(i)}setPaintProperty(i,u,f={}){if(u!=null&&this._validate($y,`layers.${this.id}.paint.${i}`,i,u,f))return!1;if(i.endsWith(To))return this._transitionablePaint.setTransition(i.slice(0,-To.length),u||void 0),!1;{const g=this._transitionablePaint._values[i],_=g.property.specification["property-type"]==="cross-faded-data-driven",b=g.value.isDataDriven(),T=g.value;this._transitionablePaint.setValue(i,u),this._handleSpecialPaintPropertyUpdate(i);const A=this._transitionablePaint._values[i].value;return A.isDataDriven()||b||_||this._handleOverridablePaintPropertyUpdate(i,T,A)}}_handleSpecialPaintPropertyUpdate(i){}_handleOverridablePaintPropertyUpdate(i,u,f){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,u){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,u)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),j(i,(u,f)=>!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length))}_validate(i,u,f,g,_={}){return(!_||_.validate!==!1)&&qc(this,i.call(ql,{key:u,layerType:this.type,objectKey:f,value:g,styleSpec:Re,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const u=this.paint.get(i);if(u instanceof Ls&&Gn(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}}const Lp={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class So{constructor(i,u){this._structArray=i,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class lr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,u){return i._trim(),u&&(i.isTransferred=!0,u.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const u=Object.create(this.prototype);return u.arrayBuffer=i.arrayBuffer,u.length=i.length,u.capacity=i.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function vr(a,i=1){let u=0,f=0;return{members:a.map(g=>{const _=Lp[g.type].BYTES_PER_ELEMENT,b=u=qh(u,Math.max(i,_)),T=g.components||1;return f=Math.max(f,_),u+=_*T,{name:g.name,type:g.type,components:T,offset:b}}),size:qh(u,Math.max(f,i)),alignment:i}}function qh(a,i){return Math.ceil(a/i)*i}class Zo extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,u){const f=this.length;return this.resize(f+1),this.emplace(f,i,u)}emplace(i,u,f){const g=2*i;return this.int16[g+0]=u,this.int16[g+1]=f,i}}Zo.prototype.bytesPerElement=4,dt("StructArrayLayout2i4",Zo);class m extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,u,f,g){const _=this.length;return this.resize(_+1),this.emplace(_,i,u,f,g)}emplace(i,u,f,g,_){const b=4*i;return this.int16[b+0]=u,this.int16[b+1]=f,this.int16[b+2]=g,this.int16[b+3]=_,i}}m.prototype.bytesPerElement=8,dt("StructArrayLayout4i8",m);class o extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,u,f,g,_,b){const T=this.length;return this.resize(T+1),this.emplace(T,i,u,f,g,_,b)}emplace(i,u,f,g,_,b,T){const A=6*i;return this.int16[A+0]=u,this.int16[A+1]=f,this.int16[A+2]=g,this.int16[A+3]=_,this.int16[A+4]=b,this.int16[A+5]=T,i}}o.prototype.bytesPerElement=12,dt("StructArrayLayout2i4i12",o);class h extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,u,f,g,_,b){const T=this.length;return this.resize(T+1),this.emplace(T,i,u,f,g,_,b)}emplace(i,u,f,g,_,b,T){const A=4*i,M=8*i;return this.int16[A+0]=u,this.int16[A+1]=f,this.uint8[M+4]=g,this.uint8[M+5]=_,this.uint8[M+6]=b,this.uint8[M+7]=T,i}}h.prototype.bytesPerElement=8,dt("StructArrayLayout2i4ub8",h);class p extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,u){const f=this.length;return this.resize(f+1),this.emplace(f,i,u)}emplace(i,u,f){const g=2*i;return this.float32[g+0]=u,this.float32[g+1]=f,i}}p.prototype.bytesPerElement=8,dt("StructArrayLayout2f8",p);class y extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,u,f,g,_,b,T,A,M,O){const N=this.length;return this.resize(N+1),this.emplace(N,i,u,f,g,_,b,T,A,M,O)}emplace(i,u,f,g,_,b,T,A,M,O,N){const $=10*i;return this.uint16[$+0]=u,this.uint16[$+1]=f,this.uint16[$+2]=g,this.uint16[$+3]=_,this.uint16[$+4]=b,this.uint16[$+5]=T,this.uint16[$+6]=A,this.uint16[$+7]=M,this.uint16[$+8]=O,this.uint16[$+9]=N,i}}y.prototype.bytesPerElement=20,dt("StructArrayLayout10ui20",y);class x extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,u,f,g,_,b,T,A,M,O,N,$){const Z=this.length;return this.resize(Z+1),this.emplace(Z,i,u,f,g,_,b,T,A,M,O,N,$)}emplace(i,u,f,g,_,b,T,A,M,O,N,$,Z){const Y=12*i;return this.int16[Y+0]=u,this.int16[Y+1]=f,this.int16[Y+2]=g,this.int16[Y+3]=_,this.uint16[Y+4]=b,this.uint16[Y+5]=T,this.uint16[Y+6]=A,this.uint16[Y+7]=M,this.int16[Y+8]=O,this.int16[Y+9]=N,this.int16[Y+10]=$,this.int16[Y+11]=Z,i}}x.prototype.bytesPerElement=24,dt("StructArrayLayout4i4ui4i24",x);class E extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,i,u,f)}emplace(i,u,f,g){const _=3*i;return this.float32[_+0]=u,this.float32[_+1]=f,this.float32[_+2]=g,i}}E.prototype.bytesPerElement=12,dt("StructArrayLayout3f12",E);class P extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const u=this.length;return this.resize(u+1),this.emplace(u,i)}emplace(i,u){return this.uint32[1*i+0]=u,i}}P.prototype.bytesPerElement=4,dt("StructArrayLayout1ul4",P);class k extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,u,f,g,_,b,T,A,M){const O=this.length;return this.resize(O+1),this.emplace(O,i,u,f,g,_,b,T,A,M)}emplace(i,u,f,g,_,b,T,A,M,O){const N=10*i,$=5*i;return this.int16[N+0]=u,this.int16[N+1]=f,this.int16[N+2]=g,this.int16[N+3]=_,this.int16[N+4]=b,this.int16[N+5]=T,this.uint32[$+3]=A,this.uint16[N+8]=M,this.uint16[N+9]=O,i}}k.prototype.bytesPerElement=20,dt("StructArrayLayout6i1ul2ui20",k);class L extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,u,f,g,_,b){const T=this.length;return this.resize(T+1),this.emplace(T,i,u,f,g,_,b)}emplace(i,u,f,g,_,b,T){const A=6*i;return this.int16[A+0]=u,this.int16[A+1]=f,this.int16[A+2]=g,this.int16[A+3]=_,this.int16[A+4]=b,this.int16[A+5]=T,i}}L.prototype.bytesPerElement=12,dt("StructArrayLayout2i2i2i12",L);class D extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,u,f,g,_){const b=this.length;return this.resize(b+1),this.emplace(b,i,u,f,g,_)}emplace(i,u,f,g,_,b){const T=4*i,A=8*i;return this.float32[T+0]=u,this.float32[T+1]=f,this.float32[T+2]=g,this.int16[A+6]=_,this.int16[A+7]=b,i}}D.prototype.bytesPerElement=16,dt("StructArrayLayout2f1f2i16",D);class V extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,u,f,g){const _=this.length;return this.resize(_+1),this.emplace(_,i,u,f,g)}emplace(i,u,f,g,_){const b=12*i,T=3*i;return this.uint8[b+0]=u,this.uint8[b+1]=f,this.float32[T+1]=g,this.float32[T+2]=_,i}}V.prototype.bytesPerElement=12,dt("StructArrayLayout2ub2f12",V);class H extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,i,u,f)}emplace(i,u,f,g){const _=3*i;return this.uint16[_+0]=u,this.uint16[_+1]=f,this.uint16[_+2]=g,i}}H.prototype.bytesPerElement=6,dt("StructArrayLayout3ui6",H);class ie extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,u,f,g,_,b,T,A,M,O,N,$,Z,Y,le,ae,be){const Pe=this.length;return this.resize(Pe+1),this.emplace(Pe,i,u,f,g,_,b,T,A,M,O,N,$,Z,Y,le,ae,be)}emplace(i,u,f,g,_,b,T,A,M,O,N,$,Z,Y,le,ae,be,Pe){const ve=24*i,Se=12*i,Fe=48*i;return this.int16[ve+0]=u,this.int16[ve+1]=f,this.uint16[ve+2]=g,this.uint16[ve+3]=_,this.uint32[Se+2]=b,this.uint32[Se+3]=T,this.uint32[Se+4]=A,this.uint16[ve+10]=M,this.uint16[ve+11]=O,this.uint16[ve+12]=N,this.float32[Se+7]=$,this.float32[Se+8]=Z,this.uint8[Fe+36]=Y,this.uint8[Fe+37]=le,this.uint8[Fe+38]=ae,this.uint32[Se+10]=be,this.int16[ve+22]=Pe,i}}ie.prototype.bytesPerElement=48,dt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ie);class ne extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,u,f,g,_,b,T,A,M,O,N,$,Z,Y,le,ae,be,Pe,ve,Se,Fe,ze,ut,mt,it,Je,Xe,st){const tt=this.length;return this.resize(tt+1),this.emplace(tt,i,u,f,g,_,b,T,A,M,O,N,$,Z,Y,le,ae,be,Pe,ve,Se,Fe,ze,ut,mt,it,Je,Xe,st)}emplace(i,u,f,g,_,b,T,A,M,O,N,$,Z,Y,le,ae,be,Pe,ve,Se,Fe,ze,ut,mt,it,Je,Xe,st,tt){const We=34*i,Ct=17*i;return this.int16[We+0]=u,this.int16[We+1]=f,this.int16[We+2]=g,this.int16[We+3]=_,this.int16[We+4]=b,this.int16[We+5]=T,this.int16[We+6]=A,this.int16[We+7]=M,this.uint16[We+8]=O,this.uint16[We+9]=N,this.uint16[We+10]=$,this.uint16[We+11]=Z,this.uint16[We+12]=Y,this.uint16[We+13]=le,this.uint16[We+14]=ae,this.uint16[We+15]=be,this.uint16[We+16]=Pe,this.uint16[We+17]=ve,this.uint16[We+18]=Se,this.uint16[We+19]=Fe,this.uint16[We+20]=ze,this.uint16[We+21]=ut,this.uint16[We+22]=mt,this.uint32[Ct+12]=it,this.float32[Ct+13]=Je,this.float32[Ct+14]=Xe,this.float32[Ct+15]=st,this.float32[Ct+16]=tt,i}}ne.prototype.bytesPerElement=68,dt("StructArrayLayout8i15ui1ul4f68",ne);class re extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const u=this.length;return this.resize(u+1),this.emplace(u,i)}emplace(i,u){return this.float32[1*i+0]=u,i}}re.prototype.bytesPerElement=4,dt("StructArrayLayout1f4",re);class pe extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,i,u,f)}emplace(i,u,f,g){const _=3*i;return this.int16[_+0]=u,this.int16[_+1]=f,this.int16[_+2]=g,i}}pe.prototype.bytesPerElement=6,dt("StructArrayLayout3i6",pe);class _e extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,i,u,f)}emplace(i,u,f,g){const _=4*i;return this.uint32[2*i+0]=u,this.uint16[_+2]=f,this.uint16[_+3]=g,i}}_e.prototype.bytesPerElement=8,dt("StructArrayLayout1ul2ui8",_e);class Ee extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,u){const f=this.length;return this.resize(f+1),this.emplace(f,i,u)}emplace(i,u,f){const g=2*i;return this.uint16[g+0]=u,this.uint16[g+1]=f,i}}Ee.prototype.bytesPerElement=4,dt("StructArrayLayout2ui4",Ee);class oe extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const u=this.length;return this.resize(u+1),this.emplace(u,i)}emplace(i,u){return this.uint16[1*i+0]=u,i}}oe.prototype.bytesPerElement=2,dt("StructArrayLayout1ui2",oe);class Ae extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,u,f,g){const _=this.length;return this.resize(_+1),this.emplace(_,i,u,f,g)}emplace(i,u,f,g,_){const b=4*i;return this.float32[b+0]=u,this.float32[b+1]=f,this.float32[b+2]=g,this.float32[b+3]=_,i}}Ae.prototype.bytesPerElement=16,dt("StructArrayLayout4f16",Ae);class Te extends So{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Qe(this.anchorPointX,this.anchorPointY)}}Te.prototype.size=20;class Oe extends k{get(i){return new Te(this,i)}}dt("CollisionBoxArray",Oe);class De extends So{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(i){this._structArray.uint8[this._pos1+37]=i}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(i){this._structArray.uint8[this._pos1+38]=i}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(i){this._structArray.uint32[this._pos4+10]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}De.prototype.size=48;class Ge extends ie{get(i){return new De(this,i)}}dt("PlacedSymbolArray",Ge);class Le extends So{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(i){this._structArray.uint32[this._pos4+12]=i}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}Le.prototype.size=68;class lt extends ne{get(i){return new Le(this,i)}}dt("SymbolInstanceArray",lt);class Ke extends re{getoffsetX(i){return this.float32[1*i+0]}}dt("GlyphOffsetArray",Ke);class ct extends pe{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}dt("SymbolLineVertexArray",ct);class Vt extends So{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Vt.prototype.size=8;class Zt extends _e{get(i){return new Vt(this,i)}}dt("FeatureIndexArray",Zt);class Pt extends Zo{}class wn extends Zo{}class En extends Zo{}class un extends o{}class dn extends h{}class An extends p{}class Rr extends y{}class Os extends x{}class us extends E{}class Ds extends P{}class Ao extends L{}class Zi extends V{}class mi extends H{}class eo extends Ee{}const Yc=vr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ar}=Yc;class rn{constructor(i=[]){this.segments=i}prepareSegment(i,u,f,g){let _=this.segments[this.segments.length-1];return i>rn.MAX_VERTEX_ARRAY_LENGTH&&he(`Max vertices per segment is ${rn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!_||_.vertexLength+i>rn.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==g)&&(_={vertexOffset:u.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},g!==void 0&&(_.sortKey=g),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const i of this.segments)for(const u in i.vaos)i.vaos[u].destroy()}static simpleSegment(i,u,f,g){return new rn([{vertexOffset:i,primitiveOffset:u,vertexLength:f,primitiveLength:g,vaos:{},sortKey:0}])}}function bn(a,i){return 256*(a=S(Math.floor(a),0,255))+S(Math.floor(i),0,255)}rn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,dt("SegmentVector",rn);const Or=vr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Dr={exports:{}},Zn={exports:{}};Zn.exports=function(a,i){var u,f,g,_,b,T,A,M;for(f=a.length-(u=3&a.length),g=i,b=3432918353,T=461845907,M=0;M<f;)A=255&a.charCodeAt(M)|(255&a.charCodeAt(++M))<<8|(255&a.charCodeAt(++M))<<16|(255&a.charCodeAt(++M))<<24,++M,g=27492+(65535&(_=5*(65535&(g=(g^=A=(65535&(A=(A=(65535&A)*b+(((A>>>16)*b&65535)<<16)&4294967295)<<15|A>>>17))*T+(((A>>>16)*T&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(A=0,u){case 3:A^=(255&a.charCodeAt(M+2))<<16;case 2:A^=(255&a.charCodeAt(M+1))<<8;case 1:g^=A=(65535&(A=(A=(65535&(A^=255&a.charCodeAt(M)))*b+(((A>>>16)*b&65535)<<16)&4294967295)<<15|A>>>17))*T+(((A>>>16)*T&65535)<<16)&4294967295}return g^=a.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var Yi={exports:{}};Yi.exports=function(a,i){for(var u,f=a.length,g=i^f,_=0;f>=4;)u=1540483477*(65535&(u=255&a.charCodeAt(_)|(255&a.charCodeAt(++_))<<8|(255&a.charCodeAt(++_))<<16|(255&a.charCodeAt(++_))<<24))+((1540483477*(u>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++_;switch(f){case 3:g^=(255&a.charCodeAt(_+2))<<16;case 2:g^=(255&a.charCodeAt(_+1))<<8;case 1:g=1540483477*(65535&(g^=255&a.charCodeAt(_)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var Yo=Zn.exports,Xh=Yi.exports;Dr.exports=Yo,Dr.exports.murmur3=Yo,Dr.exports.murmur2=Xh;class Va{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,u,f,g){this.ids.push(Rp(i)),this.positions.push(u,f,g)}getPositions(i){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const u=Rp(i);let f=0,g=this.ids.length-1;for(;f<g;){const b=f+g>>1;this.ids[b]>=u?g=b:f=b+1}const _=[];for(;this.ids[f]===u;)_.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return _}static serialize(i,u){const f=new Float64Array(i.ids),g=new Uint32Array(i.positions);return Zh(f,g,0,f.length-1),u&&u.push(f.buffer,g.buffer),{ids:f,positions:g}}static deserialize(i){const u=new Va;return u.ids=i.ids,u.positions=i.positions,u.indexed=!0,u}}function Rp(a){const i=+a;return!isNaN(i)&&i<=Number.MAX_SAFE_INTEGER?i:Dr.exports(String(a))}function Zh(a,i,u,f){for(;u<f;){const g=a[u+f>>1];let _=u-1,b=f+1;for(;;){do _++;while(a[_]<g);do b--;while(a[b]>g);if(_>=b)break;Po(a,_,b),Po(i,3*_,3*b),Po(i,3*_+1,3*b+1),Po(i,3*_+2,3*b+2)}b-u<f-b?(Zh(a,i,u,b),u=b+1):(Zh(a,i,b+1,f),f=b)}}function Po(a,i,u){const f=a[i];a[i]=a[u],a[u]=f}dt("FeaturePositionMap",Va);class Ko{constructor(i,u){this.gl=i.gl,this.location=u}}class Jo extends Ko{constructor(i,u){super(i,u),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class Kc extends Ko{constructor(i,u){super(i,u),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class nb extends Ko{constructor(i,u){super(i,u),this.current=J.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}const aM=new Float32Array(16);function Zy(a){return[bn(255*a.r,255*a.g),bn(255*a.b,255*a.a)]}class Yh{constructor(i,u,f){this.value=i,this.uniformNames=u.map(g=>`u_${g}`),this.type=f}setUniform(i,u,f){i.set(f.constantOr(this.value))}getBinding(i,u,f){return this.type==="color"?new nb(i,u):new Jo(i,u)}}class Jc{constructor(i,u){this.uniformNames=u.map(f=>`u_${f}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,u){this.pixelRatioFrom=u.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=u.tlbr,this.patternTo=i.tlbr}setUniform(i,u,f,g){const _=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;_&&i.set(_)}getBinding(i,u,f){return f.substr(0,9)==="u_pattern"?new Kc(i,u):new Jo(i,u)}}class Qo{constructor(i,u,f,g){this.expression=i,this.type=f,this.maxValue=0,this.paintVertexAttributes=u.map(_=>({name:`a_${_}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(i,u,f,g,_){const b=this.paintVertexArray.length,T=this.expression.evaluate(new Xn(0),u,{},g,[],_);this.paintVertexArray.resize(i),this._setPaintValue(b,i,T)}updatePaintArray(i,u,f,g){const _=this.expression.evaluate({zoom:0},f,g);this._setPaintValue(i,u,_)}_setPaintValue(i,u,f){if(this.type==="color"){const g=Zy(f);for(let _=i;_<u;_++)this.paintVertexArray.emplace(_,g[0],g[1])}else{for(let g=i;g<u;g++)this.paintVertexArray.emplace(g,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class to{constructor(i,u,f,g,_,b){this.expression=i,this.uniformNames=u.map(T=>`u_${T}_t`),this.type=f,this.useIntegerZoom=g,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=u.map(T=>({name:`a_${T}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(i,u,f,g,_){const b=this.expression.evaluate(new Xn(this.zoom),u,{},g,[],_),T=this.expression.evaluate(new Xn(this.zoom+1),u,{},g,[],_),A=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(A,i,b,T)}updatePaintArray(i,u,f,g){const _=this.expression.evaluate({zoom:this.zoom},f,g),b=this.expression.evaluate({zoom:this.zoom+1},f,g);this._setPaintValue(i,u,_,b)}_setPaintValue(i,u,f,g){if(this.type==="color"){const _=Zy(f),b=Zy(g);for(let T=i;T<u;T++)this.paintVertexArray.emplace(T,_[0],_[1],b[0],b[1])}else{for(let _=i;_<u;_++)this.paintVertexArray.emplace(_,f,g);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(g))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,u){const f=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,g=S(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);i.set(g)}getBinding(i,u,f){return new Jo(i,u)}}class ja{constructor(i,u,f,g,_,b){this.expression=i,this.type=u,this.useIntegerZoom=f,this.zoom=g,this.layerId=b,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(i,u,f){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(g,i,u.patterns&&u.patterns[this.layerId],f)}updatePaintArray(i,u,f,g,_){this._setPaintValues(i,u,f.patterns&&f.patterns[this.layerId],_)}_setPaintValues(i,u,f,g){if(!g||!f)return;const{min:_,mid:b,max:T}=f,A=g[_],M=g[b],O=g[T];if(A&&M&&O)for(let N=i;N<u;N++)this.zoomInPaintVertexArray.emplace(N,M.tl[0],M.tl[1],M.br[0],M.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],M.pixelRatio,A.pixelRatio),this.zoomOutPaintVertexArray.emplace(N,M.tl[0],M.tl[1],M.br[0],M.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],M.pixelRatio,O.pixelRatio)}upload(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,Or.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,Or.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class rb{constructor(i,u,f){this.binders={},this._buffers=[];const g=[];for(const _ in i.paint._values){if(!f(_))continue;const b=i.paint.get(_);if(!(b instanceof Ls&&Gn(b.property.specification)))continue;const T=lM(_,i.type),A=b.value,M=b.property.specification.type,O=b.property.useIntegerZoom,N=b.property.specification["property-type"],$=N==="cross-faded"||N==="cross-faded-data-driven";if(A.kind==="constant")this.binders[_]=$?new Jc(A.value,T):new Yh(A.value,T,M),g.push(`/u_${_}`);else if(A.kind==="source"||$){const Z=ib(_,M,"source");this.binders[_]=$?new ja(A,M,O,u,Z,i.id):new Qo(A,T,M,Z),g.push(`/a_${_}`)}else{const Z=ib(_,M,"composite");this.binders[_]=new to(A,T,M,O,u,Z),g.push(`/z_${_}`)}}this.cacheKey=g.sort().join("")}getMaxValue(i){const u=this.binders[i];return u instanceof Qo||u instanceof to?u.maxValue:0}populatePaintArrays(i,u,f,g,_){for(const b in this.binders){const T=this.binders[b];(T instanceof Qo||T instanceof to||T instanceof ja)&&T.populatePaintArray(i,u,f,g,_)}}setConstantPatternPositions(i,u){for(const f in this.binders){const g=this.binders[f];g instanceof Jc&&g.setConstantPatternPositions(i,u)}}updatePaintArrays(i,u,f,g,_){let b=!1;for(const T in i){const A=u.getPositions(T);for(const M of A){const O=f.feature(M.index);for(const N in this.binders){const $=this.binders[N];if(($ instanceof Qo||$ instanceof to||$ instanceof ja)&&$.expression.isStateDependent===!0){const Z=g.paint.get(N);$.expression=Z.value,$.updatePaintArray(M.start,M.end,O,i[T],_),b=!0}}}}return b}defines(){const i=[];for(const u in this.binders){const f=this.binders[u];(f instanceof Yh||f instanceof Jc)&&i.push(...f.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return i}getBinderAttributes(){const i=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof Qo||f instanceof to)for(let g=0;g<f.paintVertexAttributes.length;g++)i.push(f.paintVertexAttributes[g].name);else if(f instanceof ja)for(let g=0;g<Or.members.length;g++)i.push(Or.members[g].name)}return i}getBinderUniforms(){const i=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof Yh||f instanceof Jc||f instanceof to)for(const g of f.uniformNames)i.push(g)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,u){const f=[];for(const g in this.binders){const _=this.binders[g];if(_ instanceof Yh||_ instanceof Jc||_ instanceof to){for(const b of _.uniformNames)if(u[b]){const T=_.getBinding(i,u[b],b);f.push({name:b,property:g,binding:T})}}}return f}setUniforms(i,u,f,g){for(const{name:_,property:b,binding:T}of u)this.binders[b].setUniform(T,g,f.get(b),_)}updatePaintBuffers(i){this._buffers=[];for(const u in this.binders){const f=this.binders[u];if(i&&f instanceof ja){const g=i.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(f instanceof Qo||f instanceof to)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(i){for(const u in this.binders){const f=this.binders[u];(f instanceof Qo||f instanceof to||f instanceof ja)&&f.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const u=this.binders[i];(u instanceof Qo||u instanceof to||u instanceof ja)&&u.destroy()}}}class Jl{constructor(i,u,f=()=>!0){this.programConfigurations={};for(const g of i)this.programConfigurations[g.id]=new rb(g,u,f);this.needsUpload=!1,this._featureMap=new Va,this._bufferOffset=0}populatePaintArrays(i,u,f,g,_,b){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(i,u,g,_,b);u.id!==void 0&&this._featureMap.add(u.id,f,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,u,f,g){for(const _ of f)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(i,this._featureMap,u,_,g)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}function lM(a,i){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${i}-`,"").replace(/-/g,"_")]}function ib(a,i,u){const f={color:{source:p,composite:Ae},number:{source:re,composite:p}},g=function(_){return{"line-pattern":{source:Rr,composite:Rr},"fill-pattern":{source:Rr,composite:Rr},"fill-extrusion-pattern":{source:Rr,composite:Rr}}[_]}(a);return g&&g[u]||f[i][u]}dt("ConstantBinder",Yh),dt("CrossFadedConstantBinder",Jc),dt("SourceExpressionBinder",Qo),dt("CrossFadedCompositeBinder",ja),dt("CompositeExpressionBinder",to),dt("ProgramConfiguration",rb,{omit:["_buffers"]}),dt("ProgramConfigurationSet",Jl);var Pr=8192;const Yy=Math.pow(2,14)-1,sb=-Yy-1;function Ql(a){const i=Pr/a.extent,u=a.loadGeometry();for(let f=0;f<u.length;f++){const g=u[f];for(let _=0;_<g.length;_++){const b=g[_],T=Math.round(b.x*i),A=Math.round(b.y*i);b.x=S(T,sb,Yy),b.y=S(A,sb,Yy),(T<b.x||T>b.x+1||A<b.y||A>b.y+1)&&he("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return u}function ec(a,i){return{type:a.type,id:a.id,properties:a.properties,geometry:i?Ql(a):[]}}function Op(a,i,u,f,g){a.emplaceBack(2*i+(f+1)/2,2*u+(g+1)/2)}class Ky{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(u=>u.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new wn,this.indexArray=new mi,this.segments=new rn,this.programConfigurations=new Jl(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(i,u,f){const g=this.layers[0],_=[];let b=null,T=!1;g.type==="circle"&&(b=g.layout.get("circle-sort-key"),T=!b.isConstant());for(const{feature:A,id:M,index:O,sourceLayerIndex:N}of i){const $=this.layers[0]._featureFilter.needGeometry,Z=ec(A,$);if(!this.layers[0]._featureFilter.filter(new Xn(this.zoom),Z,f))continue;const Y=T?b.evaluate(Z,{},f):void 0,le={id:M,properties:A.properties,type:A.type,sourceLayerIndex:N,index:O,geometry:$?Z.geometry:Ql(A),patterns:{},sortKey:Y};_.push(le)}T&&_.sort((A,M)=>A.sortKey-M.sortKey);for(const A of _){const{geometry:M,index:O,sourceLayerIndex:N}=A,$=i[O].feature;this.addFeature(A,M,O,f),u.featureIndex.insert($,M,O,N,this.index)}}update(i,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,u,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Ar),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,u,f,g){for(const _ of u)for(const b of _){const T=b.x,A=b.y;if(T<0||T>=Pr||A<0||A>=Pr)continue;const M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),O=M.vertexLength;Op(this.layoutVertexArray,T,A,-1,-1),Op(this.layoutVertexArray,T,A,1,-1),Op(this.layoutVertexArray,T,A,1,1),Op(this.layoutVertexArray,T,A,-1,1),this.indexArray.emplaceBack(O,O+1,O+2),this.indexArray.emplaceBack(O,O+3,O+2),M.vertexLength+=4,M.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,{},g)}}function ob(a,i){for(let u=0;u<a.length;u++)if(Qc(i,a[u]))return!0;for(let u=0;u<i.length;u++)if(Qc(a,i[u]))return!0;return!!Jy(a,i)}function cM(a,i,u){return!!Qc(a,i)||!!Qy(i,a,u)}function ab(a,i){if(a.length===1)return cb(i,a[0]);for(let u=0;u<i.length;u++){const f=i[u];for(let g=0;g<f.length;g++)if(Qc(a,f[g]))return!0}for(let u=0;u<a.length;u++)if(cb(i,a[u]))return!0;for(let u=0;u<i.length;u++)if(Jy(a,i[u]))return!0;return!1}function uM(a,i,u){if(a.length>1){if(Jy(a,i))return!0;for(let f=0;f<i.length;f++)if(Qy(i[f],a,u))return!0}for(let f=0;f<a.length;f++)if(Qy(a[f],i,u))return!0;return!1}function Jy(a,i){if(a.length===0||i.length===0)return!1;for(let u=0;u<a.length-1;u++){const f=a[u],g=a[u+1];for(let _=0;_<i.length-1;_++)if(hM(f,g,i[_],i[_+1]))return!0}return!1}function hM(a,i,u,f){return ye(a,u,f)!==ye(i,u,f)&&ye(a,i,u)!==ye(a,i,f)}function Qy(a,i,u){const f=u*u;if(i.length===1)return a.distSqr(i[0])<f;for(let g=1;g<i.length;g++)if(lb(a,i[g-1],i[g])<f)return!0;return!1}function lb(a,i,u){const f=i.distSqr(u);if(f===0)return a.distSqr(i);const g=((a.x-i.x)*(u.x-i.x)+(a.y-i.y)*(u.y-i.y))/f;return a.distSqr(g<0?i:g>1?u:u.sub(i)._mult(g)._add(i))}function cb(a,i){let u,f,g,_=!1;for(let b=0;b<a.length;b++){u=a[b];for(let T=0,A=u.length-1;T<u.length;A=T++)f=u[T],g=u[A],f.y>i.y!=g.y>i.y&&i.x<(g.x-f.x)*(i.y-f.y)/(g.y-f.y)+f.x&&(_=!_)}return _}function Qc(a,i){let u=!1;for(let f=0,g=a.length-1;f<a.length;g=f++){const _=a[f],b=a[g];_.y>i.y!=b.y>i.y&&i.x<(b.x-_.x)*(i.y-_.y)/(b.y-_.y)+_.x&&(u=!u)}return u}function dM(a,i,u){const f=u[0],g=u[2];if(a.x<f.x&&i.x<f.x||a.x>g.x&&i.x>g.x||a.y<f.y&&i.y<f.y||a.y>g.y&&i.y>g.y)return!1;const _=ye(a,i,u[0]);return _!==ye(a,i,u[1])||_!==ye(a,i,u[2])||_!==ye(a,i,u[3])}function Kh(a,i,u){const f=i.paint.get(a).value;return f.kind==="constant"?f.value:u.programConfigurations.get(i.id).getMaxValue(a)}function Dp(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function zp(a,i,u,f,g){if(!i[0]&&!i[1])return a;const _=Qe.convert(i)._mult(g);u==="viewport"&&_._rotate(-f);const b=[];for(let T=0;T<a.length;T++)b.push(a[T].sub(_));return b}dt("CircleBucket",Ky,{omit:["layers"]});const fM=new Gr({"circle-sort-key":new kt(Re.layout_circle["circle-sort-key"])});var pM={paint:new Gr({"circle-radius":new kt(Re.paint_circle["circle-radius"]),"circle-color":new kt(Re.paint_circle["circle-color"]),"circle-blur":new kt(Re.paint_circle["circle-blur"]),"circle-opacity":new kt(Re.paint_circle["circle-opacity"]),"circle-translate":new vt(Re.paint_circle["circle-translate"]),"circle-translate-anchor":new vt(Re.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new vt(Re.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new vt(Re.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new kt(Re.paint_circle["circle-stroke-width"]),"circle-stroke-color":new kt(Re.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new kt(Re.paint_circle["circle-stroke-opacity"])}),layout:fM},gi=1e-6,yi=typeof Float32Array<"u"?Float32Array:Array;function ub(){var a=new yi(9);return yi!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function e_(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function hb(a,i,u){var f=i[0],g=i[1],_=i[2],b=i[3],T=i[4],A=i[5],M=i[6],O=i[7],N=i[8],$=i[9],Z=i[10],Y=i[11],le=i[12],ae=i[13],be=i[14],Pe=i[15],ve=u[0],Se=u[1],Fe=u[2],ze=u[3];return a[0]=ve*f+Se*T+Fe*N+ze*le,a[1]=ve*g+Se*A+Fe*$+ze*ae,a[2]=ve*_+Se*M+Fe*Z+ze*be,a[3]=ve*b+Se*O+Fe*Y+ze*Pe,a[4]=(ve=u[4])*f+(Se=u[5])*T+(Fe=u[6])*N+(ze=u[7])*le,a[5]=ve*g+Se*A+Fe*$+ze*ae,a[6]=ve*_+Se*M+Fe*Z+ze*be,a[7]=ve*b+Se*O+Fe*Y+ze*Pe,a[8]=(ve=u[8])*f+(Se=u[9])*T+(Fe=u[10])*N+(ze=u[11])*le,a[9]=ve*g+Se*A+Fe*$+ze*ae,a[10]=ve*_+Se*M+Fe*Z+ze*be,a[11]=ve*b+Se*O+Fe*Y+ze*Pe,a[12]=(ve=u[12])*f+(Se=u[13])*T+(Fe=u[14])*N+(ze=u[15])*le,a[13]=ve*g+Se*A+Fe*$+ze*ae,a[14]=ve*_+Se*M+Fe*Z+ze*be,a[15]=ve*b+Se*O+Fe*Y+ze*Pe,a}Math.hypot||(Math.hypot=function(){for(var a=0,i=arguments.length;i--;)a+=arguments[i]*arguments[i];return Math.sqrt(a)});var Jh,mM=hb;function db(){var a=new yi(3);return yi!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function fb(a,i,u){var f=new yi(3);return f[0]=a,f[1]=i,f[2]=u,f}function Fp(a,i,u){var f=i[0],g=i[1],_=i[2],b=i[3];return a[0]=u[0]*f+u[4]*g+u[8]*_+u[12]*b,a[1]=u[1]*f+u[5]*g+u[9]*_+u[13]*b,a[2]=u[2]*f+u[6]*g+u[10]*_+u[14]*b,a[3]=u[3]*f+u[7]*g+u[11]*_+u[15]*b,a}function pb(){var a=new yi(4);return yi!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function mb(a,i){const u=Fp([],[a.x,a.y,0,1],i);return new Qe(u[0]/u[3],u[1]/u[3])}db(),Jh=new yi(4),yi!=Float32Array&&(Jh[0]=0,Jh[1]=0,Jh[2]=0,Jh[3]=0),db(),fb(1,0,0),fb(0,1,0),pb(),pb(),ub(),function(){var a;a=new yi(2),yi!=Float32Array&&(a[0]=0,a[1]=0)}();class gb extends Ky{}dt("HeatmapBucket",gb,{omit:["layers"]});var gM={paint:new Gr({"heatmap-radius":new kt(Re.paint_heatmap["heatmap-radius"]),"heatmap-weight":new kt(Re.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new vt(Re.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Eo(Re.paint_heatmap["heatmap-color"]),"heatmap-opacity":new vt(Re.paint_heatmap["heatmap-opacity"])})};function t_(a,{width:i,height:u},f,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==i*u*f)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${i*u*f}`)}else g=new Uint8Array(i*u*f);return a.width=i,a.height=u,a.data=g,a}function yb(a,{width:i,height:u},f){if(i===a.width&&u===a.height)return;const g=t_({},{width:i,height:u},f);n_(a,g,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,i),height:Math.min(a.height,u)},f),a.width=i,a.height=u,a.data=g.data}function n_(a,i,u,f,g,_){if(g.width===0||g.height===0)return i;if(g.width>a.width||g.height>a.height||u.x>a.width-g.width||u.y>a.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>i.width||g.height>i.height||f.x>i.width-g.width||f.y>i.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const b=a.data,T=i.data;if(b===T)throw new Error("srcData equals dstData, so image is already copied");for(let A=0;A<g.height;A++){const M=((u.y+A)*a.width+u.x)*_,O=((f.y+A)*i.width+f.x)*_;for(let N=0;N<g.width*_;N++)T[O+N]=b[M+N]}return i}class Qh{constructor(i,u){t_(this,i,1,u)}resize(i){yb(this,i,1)}clone(){return new Qh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,u,f,g,_){n_(i,u,f,g,_,1)}}class hs{constructor(i,u){t_(this,i,4,u)}resize(i){yb(this,i,4)}replace(i,u){u?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new hs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,u,f,g,_){n_(i,u,f,g,_,4)}}function _b(a){const i={},u=a.resolution||256,f=a.clips?a.clips.length:1,g=a.image||new hs({width:u,height:f});if(Math.log(u)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${u}`);const _=(b,T,A)=>{i[a.evaluationKey]=A;const M=a.expression.evaluate(i);g.data[b+T+0]=Math.floor(255*M.r/M.a),g.data[b+T+1]=Math.floor(255*M.g/M.a),g.data[b+T+2]=Math.floor(255*M.b/M.a),g.data[b+T+3]=Math.floor(255*M.a)};if(a.clips)for(let b=0,T=0;b<f;++b,T+=4*u)for(let A=0,M=0;A<u;A++,M+=4){const O=A/(u-1),{start:N,end:$}=a.clips[b];_(T,M,N*(1-O)+$*O)}else for(let b=0,T=0;b<u;b++,T+=4)_(0,T,b/(u-1));return g}dt("AlphaImage",Qh),dt("RGBAImage",hs);var yM={paint:new Gr({"hillshade-illumination-direction":new vt(Re.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new vt(Re.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new vt(Re.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new vt(Re.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new vt(Re.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new vt(Re.paint_hillshade["hillshade-accent-color"])})};const _M=vr([{name:"a_pos",components:2,type:"Int16"}],4),{members:vM}=_M;var Bp={exports:{}};function Np(a,i,u){u=u||2;var f,g,_,b,T,A,M,O=i&&i.length,N=O?i[0]*u:a.length,$=vb(a,0,N,u,!0),Z=[];if(!$||$.next===$.prev)return Z;if(O&&($=function(le,ae,be,Pe){var ve,Se,Fe,ze=[];for(ve=0,Se=ae.length;ve<Se;ve++)(Fe=vb(le,ae[ve]*Pe,ve<Se-1?ae[ve+1]*Pe:le.length,Pe,!1))===Fe.next&&(Fe.steiner=!0),ze.push(PM(Fe));for(ze.sort(TM),ve=0;ve<ze.length;ve++)be=SM(ze[ve],be);return be}(a,i,$,u)),a.length>80*u){f=_=a[0],g=b=a[1];for(var Y=u;Y<N;Y+=u)(T=a[Y])<f&&(f=T),(A=a[Y+1])<g&&(g=A),T>_&&(_=T),A>b&&(b=A);M=(M=Math.max(_-f,b-g))!==0?32767/M:0}return ed($,Z,u,f,g,M,0),Z}function vb(a,i,u,f,g){var _,b;if(g===s_(a,i,u,f)>0)for(_=i;_<u;_+=f)b=wb(_,a[_],a[_+1],b);else for(_=u-f;_>=i;_-=f)b=wb(_,a[_],a[_+1],b);return b&&Up(b,b.next)&&(nd(b),b=b.next),b}function tc(a,i){if(!a)return a;i||(i=a);var u,f=a;do if(u=!1,f.steiner||!Up(f,f.next)&&pr(f.prev,f,f.next)!==0)f=f.next;else{if(nd(f),(f=i=f.prev)===f.next)break;u=!0}while(u||f!==i);return i}function ed(a,i,u,f,g,_,b){if(a){!b&&_&&function(O,N,$,Z){var Y=O;do Y.z===0&&(Y.z=r_(Y.x,Y.y,N,$,Z)),Y.prevZ=Y.prev,Y.nextZ=Y.next,Y=Y.next;while(Y!==O);Y.prevZ.nextZ=null,Y.prevZ=null,function(le){var ae,be,Pe,ve,Se,Fe,ze,ut,mt=1;do{for(be=le,le=null,Se=null,Fe=0;be;){for(Fe++,Pe=be,ze=0,ae=0;ae<mt&&(ze++,Pe=Pe.nextZ);ae++);for(ut=mt;ze>0||ut>0&&Pe;)ze!==0&&(ut===0||!Pe||be.z<=Pe.z)?(ve=be,be=be.nextZ,ze--):(ve=Pe,Pe=Pe.nextZ,ut--),Se?Se.nextZ=ve:le=ve,ve.prevZ=Se,Se=ve;be=Pe}Se.nextZ=null,mt*=2}while(Fe>1)}(Y)}(a,f,g,_);for(var T,A,M=a;a.prev!==a.next;)if(T=a.prev,A=a.next,_?bM(a,f,g,_):xM(a))i.push(T.i/u|0),i.push(a.i/u|0),i.push(A.i/u|0),nd(a),a=A.next,M=A.next;else if((a=A)===M){b?b===1?ed(a=wM(tc(a),i,u),i,u,f,g,_,2):b===2&&EM(a,i,u,f,g,_):ed(tc(a),i,u,f,g,_,1);break}}}function xM(a){var i=a.prev,u=a,f=a.next;if(pr(i,u,f)>=0)return!1;for(var g=i.x,_=u.x,b=f.x,T=i.y,A=u.y,M=f.y,O=g<_?g<b?g:b:_<b?_:b,N=T<A?T<M?T:M:A<M?A:M,$=g>_?g>b?g:b:_>b?_:b,Z=T>A?T>M?T:M:A>M?A:M,Y=f.next;Y!==i;){if(Y.x>=O&&Y.x<=$&&Y.y>=N&&Y.y<=Z&&eu(g,T,_,A,b,M,Y.x,Y.y)&&pr(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function bM(a,i,u,f){var g=a.prev,_=a,b=a.next;if(pr(g,_,b)>=0)return!1;for(var T=g.x,A=_.x,M=b.x,O=g.y,N=_.y,$=b.y,Z=T<A?T<M?T:M:A<M?A:M,Y=O<N?O<$?O:$:N<$?N:$,le=T>A?T>M?T:M:A>M?A:M,ae=O>N?O>$?O:$:N>$?N:$,be=r_(Z,Y,i,u,f),Pe=r_(le,ae,i,u,f),ve=a.prevZ,Se=a.nextZ;ve&&ve.z>=be&&Se&&Se.z<=Pe;){if(ve.x>=Z&&ve.x<=le&&ve.y>=Y&&ve.y<=ae&&ve!==g&&ve!==b&&eu(T,O,A,N,M,$,ve.x,ve.y)&&pr(ve.prev,ve,ve.next)>=0||(ve=ve.prevZ,Se.x>=Z&&Se.x<=le&&Se.y>=Y&&Se.y<=ae&&Se!==g&&Se!==b&&eu(T,O,A,N,M,$,Se.x,Se.y)&&pr(Se.prev,Se,Se.next)>=0))return!1;Se=Se.nextZ}for(;ve&&ve.z>=be;){if(ve.x>=Z&&ve.x<=le&&ve.y>=Y&&ve.y<=ae&&ve!==g&&ve!==b&&eu(T,O,A,N,M,$,ve.x,ve.y)&&pr(ve.prev,ve,ve.next)>=0)return!1;ve=ve.prevZ}for(;Se&&Se.z<=Pe;){if(Se.x>=Z&&Se.x<=le&&Se.y>=Y&&Se.y<=ae&&Se!==g&&Se!==b&&eu(T,O,A,N,M,$,Se.x,Se.y)&&pr(Se.prev,Se,Se.next)>=0)return!1;Se=Se.nextZ}return!0}function wM(a,i,u){var f=a;do{var g=f.prev,_=f.next.next;!Up(g,_)&&xb(g,f,f.next,_)&&td(g,_)&&td(_,g)&&(i.push(g.i/u|0),i.push(f.i/u|0),i.push(_.i/u|0),nd(f),nd(f.next),f=a=_),f=f.next}while(f!==a);return tc(f)}function EM(a,i,u,f,g,_){var b=a;do{for(var T=b.next.next;T!==b.prev;){if(b.i!==T.i&&CM(b,T)){var A=bb(b,T);return b=tc(b,b.next),A=tc(A,A.next),ed(b,i,u,f,g,_,0),void ed(A,i,u,f,g,_,0)}T=T.next}b=b.next}while(b!==a)}function TM(a,i){return a.x-i.x}function SM(a,i){var u=function(g,_){var b,T=_,A=g.x,M=g.y,O=-1/0;do{if(M<=T.y&&M>=T.next.y&&T.next.y!==T.y){var N=T.x+(M-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(N<=A&&N>O&&(O=N,b=T.x<T.next.x?T:T.next,N===A))return b}T=T.next}while(T!==_);if(!b)return null;var $,Z=b,Y=b.x,le=b.y,ae=1/0;T=b;do A>=T.x&&T.x>=Y&&A!==T.x&&eu(M<le?A:O,M,Y,le,M<le?O:A,M,T.x,T.y)&&($=Math.abs(M-T.y)/(A-T.x),td(T,g)&&($<ae||$===ae&&(T.x>b.x||T.x===b.x&&AM(b,T)))&&(b=T,ae=$)),T=T.next;while(T!==Z);return b}(a,i);if(!u)return i;var f=bb(u,a);return tc(f,f.next),tc(u,u.next)}function AM(a,i){return pr(a.prev,a,i.prev)<0&&pr(i.next,a,a.next)<0}function r_(a,i,u,f,g){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-u)*g|0)|a<<8))|a<<4))|a<<2))|a<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-f)*g|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function PM(a){var i=a,u=a;do(i.x<u.x||i.x===u.x&&i.y<u.y)&&(u=i),i=i.next;while(i!==a);return u}function eu(a,i,u,f,g,_,b,T){return(g-b)*(i-T)>=(a-b)*(_-T)&&(a-b)*(f-T)>=(u-b)*(i-T)&&(u-b)*(_-T)>=(g-b)*(f-T)}function CM(a,i){return a.next.i!==i.i&&a.prev.i!==i.i&&!function(u,f){var g=u;do{if(g.i!==u.i&&g.next.i!==u.i&&g.i!==f.i&&g.next.i!==f.i&&xb(g,g.next,u,f))return!0;g=g.next}while(g!==u);return!1}(a,i)&&(td(a,i)&&td(i,a)&&function(u,f){var g=u,_=!1,b=(u.x+f.x)/2,T=(u.y+f.y)/2;do g.y>T!=g.next.y>T&&g.next.y!==g.y&&b<(g.next.x-g.x)*(T-g.y)/(g.next.y-g.y)+g.x&&(_=!_),g=g.next;while(g!==u);return _}(a,i)&&(pr(a.prev,a,i.prev)||pr(a,i.prev,i))||Up(a,i)&&pr(a.prev,a,a.next)>0&&pr(i.prev,i,i.next)>0)}function pr(a,i,u){return(i.y-a.y)*(u.x-i.x)-(i.x-a.x)*(u.y-i.y)}function Up(a,i){return a.x===i.x&&a.y===i.y}function xb(a,i,u,f){var g=jp(pr(a,i,u)),_=jp(pr(a,i,f)),b=jp(pr(u,f,a)),T=jp(pr(u,f,i));return g!==_&&b!==T||!(g!==0||!Vp(a,u,i))||!(_!==0||!Vp(a,f,i))||!(b!==0||!Vp(u,a,f))||!(T!==0||!Vp(u,i,f))}function Vp(a,i,u){return i.x<=Math.max(a.x,u.x)&&i.x>=Math.min(a.x,u.x)&&i.y<=Math.max(a.y,u.y)&&i.y>=Math.min(a.y,u.y)}function jp(a){return a>0?1:a<0?-1:0}function td(a,i){return pr(a.prev,a,a.next)<0?pr(a,i,a.next)>=0&&pr(a,a.prev,i)>=0:pr(a,i,a.prev)<0||pr(a,a.next,i)<0}function bb(a,i){var u=new i_(a.i,a.x,a.y),f=new i_(i.i,i.x,i.y),g=a.next,_=i.prev;return a.next=i,i.prev=a,u.next=g,g.prev=u,f.next=u,u.prev=f,_.next=f,f.prev=_,f}function wb(a,i,u,f){var g=new i_(a,i,u);return f?(g.next=f.next,g.prev=f,f.next.prev=g,f.next=g):(g.prev=g,g.next=g),g}function nd(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function i_(a,i,u){this.i=a,this.x=i,this.y=u,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function s_(a,i,u,f){for(var g=0,_=i,b=u-f;_<u;_+=f)g+=(a[b]-a[_])*(a[_+1]+a[b+1]),b=_;return g}function IM(a,i,u,f,g){Eb(a,i,u||0,f||a.length-1,g||kM)}function Eb(a,i,u,f,g){for(;f>u;){if(f-u>600){var _=f-u+1,b=i-u+1,T=Math.log(_),A=.5*Math.exp(2*T/3),M=.5*Math.sqrt(T*A*(_-A)/_)*(b-_/2<0?-1:1);Eb(a,i,Math.max(u,Math.floor(i-b*A/_+M)),Math.min(f,Math.floor(i+(_-b)*A/_+M)),g)}var O=a[i],N=u,$=f;for(rd(a,u,i),g(a[f],O)>0&&rd(a,u,f);N<$;){for(rd(a,N,$),N++,$--;g(a[N],O)<0;)N++;for(;g(a[$],O)>0;)$--}g(a[u],O)===0?rd(a,u,$):rd(a,++$,f),$<=i&&(u=$+1),i<=$&&(f=$-1)}}function rd(a,i,u){var f=a[i];a[i]=a[u],a[u]=f}function kM(a,i){return a<i?-1:a>i?1:0}function o_(a,i){const u=a.length;if(u<=1)return[a];const f=[];let g,_;for(let b=0;b<u;b++){const T=we(a[b]);T!==0&&(a[b].area=Math.abs(T),_===void 0&&(_=T<0),_===T<0?(g&&f.push(g),g=[a[b]]):g.push(a[b]))}if(g&&f.push(g),i>1)for(let b=0;b<f.length;b++)f[b].length<=i||(IM(f[b],i,1,f[b].length-1,MM),f[b]=f[b].slice(0,i));return f}function MM(a,i){return i.area-a.area}function a_(a,i,u){const f=u.patternDependencies;let g=!1;for(const _ of i){const b=_.paint.get(`${a}-pattern`);b.isConstant()||(g=!0);const T=b.constantOr(null);T&&(g=!0,f[T.to]=!0,f[T.from]=!0)}return g}function l_(a,i,u,f,g){const _=g.patternDependencies;for(const b of i){const T=b.paint.get(`${a}-pattern`).value;if(T.kind!=="constant"){let A=T.evaluate({zoom:f-1},u,{},g.availableImages),M=T.evaluate({zoom:f},u,{},g.availableImages),O=T.evaluate({zoom:f+1},u,{},g.availableImages);A=A&&A.name?A.name:A,M=M&&M.name?M.name:M,O=O&&O.name?O.name:O,_[A]=!0,_[M]=!0,_[O]=!0,u.patterns[b.id]={min:A,mid:M,max:O}}}return u}Bp.exports=Np,Bp.exports.default=Np,Np.deviation=function(a,i,u,f){var g=i&&i.length,_=Math.abs(s_(a,0,g?i[0]*u:a.length,u));if(g)for(var b=0,T=i.length;b<T;b++)_-=Math.abs(s_(a,i[b]*u,b<T-1?i[b+1]*u:a.length,u));var A=0;for(b=0;b<f.length;b+=3){var M=f[b]*u,O=f[b+1]*u,N=f[b+2]*u;A+=Math.abs((a[M]-a[N])*(a[O+1]-a[M+1])-(a[M]-a[O])*(a[N+1]-a[M+1]))}return _===0&&A===0?0:Math.abs((A-_)/_)},Np.flatten=function(a){for(var i=a[0][0].length,u={vertices:[],holes:[],dimensions:i},f=0,g=0;g<a.length;g++){for(var _=0;_<a[g].length;_++)for(var b=0;b<i;b++)u.vertices.push(a[g][_][b]);g>0&&u.holes.push(f+=a[g-1].length)}return u};class c_{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(u=>u.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new En,this.indexArray=new mi,this.indexArray2=new eo,this.programConfigurations=new Jl(i.layers,i.zoom),this.segments=new rn,this.segments2=new rn,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(i,u,f){this.hasPattern=a_("fill",this.layers,u);const g=this.layers[0].layout.get("fill-sort-key"),_=!g.isConstant(),b=[];for(const{feature:T,id:A,index:M,sourceLayerIndex:O}of i){const N=this.layers[0]._featureFilter.needGeometry,$=ec(T,N);if(!this.layers[0]._featureFilter.filter(new Xn(this.zoom),$,f))continue;const Z=_?g.evaluate($,{},f,u.availableImages):void 0,Y={id:A,properties:T.properties,type:T.type,sourceLayerIndex:O,index:M,geometry:N?$.geometry:Ql(T),patterns:{},sortKey:Z};b.push(Y)}_&&b.sort((T,A)=>T.sortKey-A.sortKey);for(const T of b){const{geometry:A,index:M,sourceLayerIndex:O}=T;if(this.hasPattern){const N=l_("fill",this.layers,T,this.zoom,u);this.patternFeatures.push(N)}else this.addFeature(T,A,M,f,{});u.featureIndex.insert(i[M].feature,A,M,O,this.index)}}update(i,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,u,this.stateDependentLayers,f)}addFeatures(i,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,u,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,vM),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,u,f,g,_){for(const b of o_(u,500)){let T=0;for(const Z of b)T+=Z.length;const A=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),M=A.vertexLength,O=[],N=[];for(const Z of b){if(Z.length===0)continue;Z!==b[0]&&N.push(O.length/2);const Y=this.segments2.prepareSegment(Z.length,this.layoutVertexArray,this.indexArray2),le=Y.vertexLength;this.layoutVertexArray.emplaceBack(Z[0].x,Z[0].y),this.indexArray2.emplaceBack(le+Z.length-1,le),O.push(Z[0].x),O.push(Z[0].y);for(let ae=1;ae<Z.length;ae++)this.layoutVertexArray.emplaceBack(Z[ae].x,Z[ae].y),this.indexArray2.emplaceBack(le+ae-1,le+ae),O.push(Z[ae].x),O.push(Z[ae].y);Y.vertexLength+=Z.length,Y.primitiveLength+=Z.length}const $=Bp.exports(O,N);for(let Z=0;Z<$.length;Z+=3)this.indexArray.emplaceBack(M+$[Z],M+$[Z+1],M+$[Z+2]);A.vertexLength+=T,A.primitiveLength+=$.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,_,g)}}dt("FillBucket",c_,{omit:["layers","patternFeatures"]});const LM=new Gr({"fill-sort-key":new kt(Re.layout_fill["fill-sort-key"])});var RM={paint:new Gr({"fill-antialias":new vt(Re.paint_fill["fill-antialias"]),"fill-opacity":new kt(Re.paint_fill["fill-opacity"]),"fill-color":new kt(Re.paint_fill["fill-color"]),"fill-outline-color":new kt(Re.paint_fill["fill-outline-color"]),"fill-translate":new vt(Re.paint_fill["fill-translate"]),"fill-translate-anchor":new vt(Re.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ua(Re.paint_fill["fill-pattern"])}),layout:LM};const OM=vr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),DM=vr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:zM}=OM;var Ga={},FM=Qe,Tb=tu;function tu(a,i,u,f,g){this.properties={},this.extent=u,this.type=0,this._pbf=a,this._geometry=-1,this._keys=f,this._values=g,a.readFields(BM,this,i)}function BM(a,i,u){a==1?i.id=u.readVarint():a==2?function(f,g){for(var _=f.readVarint()+f.pos;f.pos<_;){var b=g._keys[f.readVarint()],T=g._values[f.readVarint()];g.properties[b]=T}}(u,i):a==3?i.type=u.readVarint():a==4&&(i._geometry=u.pos)}function NM(a){for(var i,u,f=0,g=0,_=a.length,b=_-1;g<_;b=g++)f+=((u=a[b]).x-(i=a[g]).x)*(i.y+u.y);return f}tu.types=["Unknown","Point","LineString","Polygon"],tu.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var i,u=a.readVarint()+a.pos,f=1,g=0,_=0,b=0,T=[];a.pos<u;){if(g<=0){var A=a.readVarint();f=7&A,g=A>>3}if(g--,f===1||f===2)_+=a.readSVarint(),b+=a.readSVarint(),f===1&&(i&&T.push(i),i=[]),i.push(new FM(_,b));else{if(f!==7)throw new Error("unknown command "+f);i&&i.push(i[0].clone())}}return i&&T.push(i),T},tu.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var i=a.readVarint()+a.pos,u=1,f=0,g=0,_=0,b=1/0,T=-1/0,A=1/0,M=-1/0;a.pos<i;){if(f<=0){var O=a.readVarint();u=7&O,f=O>>3}if(f--,u===1||u===2)(g+=a.readSVarint())<b&&(b=g),g>T&&(T=g),(_+=a.readSVarint())<A&&(A=_),_>M&&(M=_);else if(u!==7)throw new Error("unknown command "+u)}return[b,A,T,M]},tu.prototype.toGeoJSON=function(a,i,u){var f,g,_=this.extent*Math.pow(2,u),b=this.extent*a,T=this.extent*i,A=this.loadGeometry(),M=tu.types[this.type];function O(Z){for(var Y=0;Y<Z.length;Y++){var le=Z[Y];Z[Y]=[360*(le.x+b)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(le.y+T)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(f=0;f<A.length;f++)N[f]=A[f][0];O(A=N);break;case 2:for(f=0;f<A.length;f++)O(A[f]);break;case 3:for(A=function(Z){var Y=Z.length;if(Y<=1)return[Z];for(var le,ae,be=[],Pe=0;Pe<Y;Pe++){var ve=NM(Z[Pe]);ve!==0&&(ae===void 0&&(ae=ve<0),ae===ve<0?(le&&be.push(le),le=[Z[Pe]]):le.push(Z[Pe]))}return le&&be.push(le),be}(A),f=0;f<A.length;f++)for(g=0;g<A[f].length;g++)O(A[f][g])}A.length===1?A=A[0]:M="Multi"+M;var $={type:"Feature",geometry:{type:M,coordinates:A},properties:this.properties};return"id"in this&&($.id=this.id),$};var UM=Tb,Sb=Ab;function Ab(a,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(VM,this,i),this.length=this._features.length}function VM(a,i,u){a===15?i.version=u.readVarint():a===1?i.name=u.readString():a===5?i.extent=u.readVarint():a===2?i._features.push(u.pos):a===3?i._keys.push(u.readString()):a===4&&i._values.push(function(f){for(var g=null,_=f.readVarint()+f.pos;f.pos<_;){var b=f.readVarint()>>3;g=b===1?f.readString():b===2?f.readFloat():b===3?f.readDouble():b===4?f.readVarint64():b===5?f.readVarint():b===6?f.readSVarint():b===7?f.readBoolean():null}return g}(u))}Ab.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var i=this._pbf.readVarint()+this._pbf.pos;return new UM(this._pbf,i,this.extent,this._keys,this._values)};var jM=Sb;function GM(a,i,u){if(a===3){var f=new jM(u,u.readVarint()+u.pos);f.length&&(i[f.name]=f)}}Ga.VectorTile=function(a,i){this.layers=a.readFields(GM,{},i)},Ga.VectorTileFeature=Tb,Ga.VectorTileLayer=Sb;const $M=Ga.VectorTileFeature.types,u_=Math.pow(2,13);function id(a,i,u,f,g,_,b,T){a.emplaceBack(i,u,2*Math.floor(f*u_)+b,g*u_*2,_*u_*2,Math.round(T))}class h_{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(u=>u.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new un,this.centroidVertexArray=new Pt,this.indexArray=new mi,this.programConfigurations=new Jl(i.layers,i.zoom),this.segments=new rn,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(i,u,f){this.features=[],this.hasPattern=a_("fill-extrusion",this.layers,u);for(const{feature:g,id:_,index:b,sourceLayerIndex:T}of i){const A=this.layers[0]._featureFilter.needGeometry,M=ec(g,A);if(!this.layers[0]._featureFilter.filter(new Xn(this.zoom),M,f))continue;const O={id:_,sourceLayerIndex:T,index:b,geometry:A?M.geometry:Ql(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(l_("fill-extrusion",this.layers,O,this.zoom,u)):this.addFeature(O,O.geometry,b,f,{}),u.featureIndex.insert(g,O.geometry,b,T,this.index,!0)}}addFeatures(i,u,f){for(const g of this.features){const{geometry:_}=g;this.addFeature(g,_,g.index,u,f)}}update(i,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,u,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,zM),this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,DM.members,!0),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(i,u,f,g,_){const b={x:0,y:0,vertexCount:0};for(const T of o_(u,500)){let A=0;for(const Y of T)A+=Y.length;let M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const Y of T){if(Y.length===0||HM(Y))continue;let le=0;for(let ae=0;ae<Y.length;ae++){const be=Y[ae];if(ae>=1){const Pe=Y[ae-1];if(!WM(be,Pe)){M.vertexLength+4>rn.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ve=be.sub(Pe)._perp()._unit(),Se=Pe.dist(be);le+Se>32768&&(le=0),id(this.layoutVertexArray,be.x,be.y,ve.x,ve.y,0,0,le),id(this.layoutVertexArray,be.x,be.y,ve.x,ve.y,0,1,le),b.x+=2*be.x,b.y+=2*be.y,b.vertexCount+=2,le+=Se,id(this.layoutVertexArray,Pe.x,Pe.y,ve.x,ve.y,0,0,le),id(this.layoutVertexArray,Pe.x,Pe.y,ve.x,ve.y,0,1,le),b.x+=2*Pe.x,b.y+=2*Pe.y,b.vertexCount+=2;const Fe=M.vertexLength;this.indexArray.emplaceBack(Fe,Fe+2,Fe+1),this.indexArray.emplaceBack(Fe+1,Fe+2,Fe+3),M.vertexLength+=4,M.primitiveLength+=2}}}}if(M.vertexLength+A>rn.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray)),$M[i.type]!=="Polygon")continue;const O=[],N=[],$=M.vertexLength;for(const Y of T)if(Y.length!==0){Y!==T[0]&&N.push(O.length/2);for(let le=0;le<Y.length;le++){const ae=Y[le];id(this.layoutVertexArray,ae.x,ae.y,0,0,1,1,0),b.x+=ae.x,b.y+=ae.y,b.vertexCount+=1,O.push(ae.x),O.push(ae.y)}}const Z=Bp.exports(O,N);for(let Y=0;Y<Z.length;Y+=3)this.indexArray.emplaceBack($+Z[Y],$+Z[Y+2],$+Z[Y+1]);M.primitiveLength+=Z.length/3,M.vertexLength+=A}for(let T=0;T<b.vertexCount;T++)this.centroidVertexArray.emplaceBack(Math.floor(b.x/b.vertexCount),Math.floor(b.y/b.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,_,g)}}function WM(a,i){return a.x===i.x&&(a.x<0||a.x>Pr)||a.y===i.y&&(a.y<0||a.y>Pr)}function HM(a){return a.every(i=>i.x<0)||a.every(i=>i.x>Pr)||a.every(i=>i.y<0)||a.every(i=>i.y>Pr)}dt("FillExtrusionBucket",h_,{omit:["layers","features"]});var qM={paint:new Gr({"fill-extrusion-opacity":new vt(Re["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new kt(Re["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new vt(Re["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new vt(Re["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ua(Re["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new kt(Re["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new kt(Re["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new vt(Re["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function sd(a,i){return a.x*i.x+a.y*i.y}function Pb(a,i){if(a.length===1){let u=0;const f=i[u++];let g;for(;!g||f.equals(g);)if(g=i[u++],!g)return 1/0;for(;u<i.length;u++){const _=i[u],b=a[0],T=g.sub(f),A=_.sub(f),M=b.sub(f),O=sd(T,T),N=sd(T,A),$=sd(A,A),Z=sd(M,T),Y=sd(M,A),le=O*$-N*N,ae=($*Z-N*Y)/le,be=(O*Y-N*Z)/le,Pe=f.z*(1-ae-be)+g.z*ae+_.z*be;if(isFinite(Pe))return Pe}return 1/0}{let u=1/0;for(const f of i)u=Math.min(u,f.z);return u}}const XM=vr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:ZM}=XM,YM=vr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:KM}=YM,JM=Ga.VectorTileFeature.types,QM=Math.cos(Math.PI/180*37.5),Cb=Math.pow(2,14)/.5;class d_{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(u=>u.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new dn,this.layoutVertexArray2=new An,this.indexArray=new mi,this.programConfigurations=new Jl(i.layers,i.zoom),this.segments=new rn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(i,u,f){this.hasPattern=a_("line",this.layers,u);const g=this.layers[0].layout.get("line-sort-key"),_=!g.isConstant(),b=[];for(const{feature:T,id:A,index:M,sourceLayerIndex:O}of i){const N=this.layers[0]._featureFilter.needGeometry,$=ec(T,N);if(!this.layers[0]._featureFilter.filter(new Xn(this.zoom),$,f))continue;const Z=_?g.evaluate($,{},f):void 0,Y={id:A,properties:T.properties,type:T.type,sourceLayerIndex:O,index:M,geometry:N?$.geometry:Ql(T),patterns:{},sortKey:Z};b.push(Y)}_&&b.sort((T,A)=>T.sortKey-A.sortKey);for(const T of b){const{geometry:A,index:M,sourceLayerIndex:O}=T;if(this.hasPattern){const N=l_("line",this.layers,T,this.zoom,u);this.patternFeatures.push(N)}else this.addFeature(T,A,M,f,{});u.featureIndex.insert(i[M].feature,A,M,O,this.index)}}update(i,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,u,this.stateDependentLayers,f)}addFeatures(i,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,u,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,KM)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,ZM),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,u,f,g,_){const b=this.layers[0].layout,T=b.get("line-join").evaluate(i,{}),A=b.get("line-cap"),M=b.get("line-miter-limit"),O=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const N of u)this.addLine(N,i,T,A,M,O);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,_,g)}addLine(i,u,f,g,_,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let be=0;be<i.length-1;be++)this.totalDistance+=i[be].dist(i[be+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const T=JM[u.type]==="Polygon";let A=i.length;for(;A>=2&&i[A-1].equals(i[A-2]);)A--;let M=0;for(;M<A-1&&i[M].equals(i[M+1]);)M++;if(A<(T?3:2))return;f==="bevel"&&(_=1.05);const O=this.overscaling<=16?122880/(512*this.overscaling):0,N=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray);let $,Z,Y,le,ae;this.e1=this.e2=-1,T&&($=i[A-2],ae=i[M].sub($)._unit()._perp());for(let be=M;be<A;be++){if(Y=be===A-1?T?i[M+1]:void 0:i[be+1],Y&&i[be].equals(Y))continue;ae&&(le=ae),$&&(Z=$),$=i[be],ae=Y?Y.sub($)._unit()._perp():le,le=le||ae;let Pe=le.add(ae);Pe.x===0&&Pe.y===0||Pe._unit();const ve=le.x*ae.x+le.y*ae.y,Se=Pe.x*ae.x+Pe.y*ae.y,Fe=Se!==0?1/Se:1/0,ze=2*Math.sqrt(2-2*Se),ut=Se<QM&&Z&&Y,mt=le.x*ae.y-le.y*ae.x>0;if(ut&&be>M){const Xe=$.dist(Z);if(Xe>2*O){const st=$.sub($.sub(Z)._mult(O/Xe)._round());this.updateDistance(Z,st),this.addCurrentVertex(st,le,0,0,N),Z=st}}const it=Z&&Y;let Je=it?f:T?"butt":g;if(it&&Je==="round"&&(Fe<b?Je="miter":Fe<=2&&(Je="fakeround")),Je==="miter"&&Fe>_&&(Je="bevel"),Je==="bevel"&&(Fe>2&&(Je="flipbevel"),Fe<_&&(Je="miter")),Z&&this.updateDistance(Z,$),Je==="miter")Pe._mult(Fe),this.addCurrentVertex($,Pe,0,0,N);else if(Je==="flipbevel"){if(Fe>100)Pe=ae.mult(-1);else{const Xe=Fe*le.add(ae).mag()/le.sub(ae).mag();Pe._perp()._mult(Xe*(mt?-1:1))}this.addCurrentVertex($,Pe,0,0,N),this.addCurrentVertex($,Pe.mult(-1),0,0,N)}else if(Je==="bevel"||Je==="fakeround"){const Xe=-Math.sqrt(Fe*Fe-1),st=mt?Xe:0,tt=mt?0:Xe;if(Z&&this.addCurrentVertex($,le,st,tt,N),Je==="fakeround"){const We=Math.round(180*ze/Math.PI/20);for(let Ct=1;Ct<We;Ct++){let bt=Ct/We;if(bt!==.5){const $n=bt-.5;bt+=bt*$n*(bt-1)*((1.0904+ve*(ve*(3.55645-1.43519*ve)-3.2452))*$n*$n+(.848013+ve*(.215638*ve-1.06021)))}const Yt=ae.sub(le)._mult(bt)._add(le)._unit()._mult(mt?-1:1);this.addHalfVertex($,Yt.x,Yt.y,!1,mt,0,N)}}Y&&this.addCurrentVertex($,ae,-st,-tt,N)}else if(Je==="butt")this.addCurrentVertex($,Pe,0,0,N);else if(Je==="square"){const Xe=Z?1:-1;this.addCurrentVertex($,Pe,Xe,Xe,N)}else Je==="round"&&(Z&&(this.addCurrentVertex($,le,0,0,N),this.addCurrentVertex($,le,1,1,N,!0)),Y&&(this.addCurrentVertex($,ae,-1,-1,N,!0),this.addCurrentVertex($,ae,0,0,N)));if(ut&&be<A-1){const Xe=$.dist(Y);if(Xe>2*O){const st=$.add(Y.sub($)._mult(O/Xe)._round());this.updateDistance($,st),this.addCurrentVertex(st,ae,0,0,N),$=st}}}}addCurrentVertex(i,u,f,g,_,b=!1){const T=u.y*g-u.x,A=-u.y-u.x*g;this.addHalfVertex(i,u.x+u.y*f,u.y-u.x*f,b,!1,f,_),this.addHalfVertex(i,T,A,b,!0,-g,_),this.distance>Cb/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(i,u,f,g,_,b))}addHalfVertex({x:i,y:u},f,g,_,b,T,A){const M=.5*(this.lineClips?this.scaledDistance*(Cb-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((i<<1)+(_?1:0),(u<<1)+(b?1:0),Math.round(63*f)+128,Math.round(63*g)+128,1+(T===0?0:T<0?-1:1)|(63&M)<<2,M>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const O=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,O),A.primitiveLength++),b?this.e2=O:this.e1=O}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(i,u){this.distance+=i.dist(u),this.updateScaledDistance()}}dt("LineBucket",d_,{omit:["layers","patternFeatures"]});const e3=new Gr({"line-cap":new vt(Re.layout_line["line-cap"]),"line-join":new kt(Re.layout_line["line-join"]),"line-miter-limit":new vt(Re.layout_line["line-miter-limit"]),"line-round-limit":new vt(Re.layout_line["line-round-limit"]),"line-sort-key":new kt(Re.layout_line["line-sort-key"])});var Ib={paint:new Gr({"line-opacity":new kt(Re.paint_line["line-opacity"]),"line-color":new kt(Re.paint_line["line-color"]),"line-translate":new vt(Re.paint_line["line-translate"]),"line-translate-anchor":new vt(Re.paint_line["line-translate-anchor"]),"line-width":new kt(Re.paint_line["line-width"]),"line-gap-width":new kt(Re.paint_line["line-gap-width"]),"line-offset":new kt(Re.paint_line["line-offset"]),"line-blur":new kt(Re.paint_line["line-blur"]),"line-dasharray":new Hh(Re.paint_line["line-dasharray"]),"line-pattern":new Ua(Re.paint_line["line-pattern"]),"line-gradient":new Eo(Re.paint_line["line-gradient"])}),layout:e3};const kb=new class extends kt{possiblyEvaluate(a,i){return i=new Xn(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(a,i)}evaluate(a,i,u,f){return i=F({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(a,i,u,f)}}(Ib.paint.properties["line-width"].specification);function Mb(a,i){return i>0?i+2*a:a}kb.useIntegerZoom=!0;const t3=vr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),n3=vr([{name:"a_projected_pos",components:3,type:"Float32"}],4);vr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const r3=vr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);vr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Lb=vr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),i3=vr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function s3(a,i,u){return a.sections.forEach(f=>{f.text=function(g,_,b){const T=_.layout.get("text-transform").evaluate(b,{});return T==="uppercase"?g=g.toLocaleUpperCase():T==="lowercase"&&(g=g.toLocaleLowerCase()),Xi.applyArabicShaping&&(g=Xi.applyArabicShaping(g)),g}(f.text,i,u)}),a}vr([{name:"triangle",components:3,type:"Uint16"}]),vr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),vr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),vr([{type:"Float32",name:"offsetX"}]),vr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const od={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var $r=24,f_=Pn,Rb=function(a,i,u,f,g){var _,b,T=8*g-f-1,A=(1<<T)-1,M=A>>1,O=-7,N=u?g-1:0,$=u?-1:1,Z=a[i+N];for(N+=$,_=Z&(1<<-O)-1,Z>>=-O,O+=T;O>0;_=256*_+a[i+N],N+=$,O-=8);for(b=_&(1<<-O)-1,_>>=-O,O+=f;O>0;b=256*b+a[i+N],N+=$,O-=8);if(_===0)_=1-M;else{if(_===A)return b?NaN:1/0*(Z?-1:1);b+=Math.pow(2,f),_-=M}return(Z?-1:1)*b*Math.pow(2,_-f)},Ob=function(a,i,u,f,g,_){var b,T,A,M=8*_-g-1,O=(1<<M)-1,N=O>>1,$=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,Z=f?0:_-1,Y=f?1:-1,le=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(T=isNaN(i)?1:0,b=O):(b=Math.floor(Math.log(i)/Math.LN2),i*(A=Math.pow(2,-b))<1&&(b--,A*=2),(i+=b+N>=1?$/A:$*Math.pow(2,1-N))*A>=2&&(b++,A/=2),b+N>=O?(T=0,b=O):b+N>=1?(T=(i*A-1)*Math.pow(2,g),b+=N):(T=i*Math.pow(2,N-1)*Math.pow(2,g),b=0));g>=8;a[u+Z]=255&T,Z+=Y,T/=256,g-=8);for(b=b<<g|T,M+=g;M>0;a[u+Z]=255&b,Z+=Y,b/=256,M-=8);a[u+Z-Y]|=128*le};function Pn(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Pn.Varint=0,Pn.Fixed64=1,Pn.Bytes=2,Pn.Fixed32=5;var $a,p_=4294967296,Db=1/p_,zb=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ea(a){return a.type===Pn.Bytes?a.readVarint()+a.pos:a.pos+1}function nu(a,i,u){return u?4294967296*i+(a>>>0):4294967296*(i>>>0)+(a>>>0)}function Fb(a,i,u){var f=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));u.realloc(f);for(var g=u.pos-1;g>=a;g--)u.buf[g+f]=u.buf[g]}function o3(a,i){for(var u=0;u<a.length;u++)i.writeVarint(a[u])}function a3(a,i){for(var u=0;u<a.length;u++)i.writeSVarint(a[u])}function l3(a,i){for(var u=0;u<a.length;u++)i.writeFloat(a[u])}function c3(a,i){for(var u=0;u<a.length;u++)i.writeDouble(a[u])}function u3(a,i){for(var u=0;u<a.length;u++)i.writeBoolean(a[u])}function h3(a,i){for(var u=0;u<a.length;u++)i.writeFixed32(a[u])}function d3(a,i){for(var u=0;u<a.length;u++)i.writeSFixed32(a[u])}function f3(a,i){for(var u=0;u<a.length;u++)i.writeFixed64(a[u])}function p3(a,i){for(var u=0;u<a.length;u++)i.writeSFixed64(a[u])}function Gp(a,i){return(a[i]|a[i+1]<<8|a[i+2]<<16)+16777216*a[i+3]}function ru(a,i,u){a[u]=i,a[u+1]=i>>>8,a[u+2]=i>>>16,a[u+3]=i>>>24}function Bb(a,i){return(a[i]|a[i+1]<<8|a[i+2]<<16)+(a[i+3]<<24)}function m3(a,i,u){a===1&&u.readMessage(g3,i)}function g3(a,i,u){if(a===3){const{id:f,bitmap:g,width:_,height:b,left:T,top:A,advance:M}=u.readMessage(y3,{});i.push({id:f,bitmap:new Qh({width:_+6,height:b+6},g),metrics:{width:_,height:b,left:T,top:A,advance:M}})}}function y3(a,i,u){a===1?i.id=u.readVarint():a===2?i.bitmap=u.readBytes():a===3?i.width=u.readVarint():a===4?i.height=u.readVarint():a===5?i.left=u.readSVarint():a===6?i.top=u.readSVarint():a===7&&(i.advance=u.readVarint())}function Nb(a){let i=0,u=0;for(const b of a)i+=b.w*b.h,u=Math.max(u,b.w);a.sort((b,T)=>T.h-b.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),u),h:1/0}];let g=0,_=0;for(const b of a)for(let T=f.length-1;T>=0;T--){const A=f[T];if(!(b.w>A.w||b.h>A.h)){if(b.x=A.x,b.y=A.y,_=Math.max(_,b.y+b.h),g=Math.max(g,b.x+b.w),b.w===A.w&&b.h===A.h){const M=f.pop();T<f.length&&(f[T]=M)}else b.h===A.h?(A.x+=b.w,A.w-=b.w):b.w===A.w?(A.y+=b.h,A.h-=b.h):(f.push({x:A.x+b.w,y:A.y,w:A.w-b.w,h:b.h}),A.y+=b.h,A.h-=b.h);break}}return{w:g,h:_,fill:i/(g*_)||0}}Pn.prototype={destroy:function(){this.buf=null},readFields:function(a,i,u){for(u=u||this.length;this.pos<u;){var f=this.readVarint(),g=f>>3,_=this.pos;this.type=7&f,a(g,i,this),this.pos===_&&this.skip(f)}return i},readMessage:function(a,i){return this.readFields(a,i,this.readVarint()+this.pos)},readFixed32:function(){var a=Gp(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=Bb(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=Gp(this.buf,this.pos)+Gp(this.buf,this.pos+4)*p_;return this.pos+=8,a},readSFixed64:function(){var a=Gp(this.buf,this.pos)+Bb(this.buf,this.pos+4)*p_;return this.pos+=8,a},readFloat:function(){var a=Rb(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=Rb(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var i,u,f=this.buf;return i=127&(u=f[this.pos++]),u<128?i:(i|=(127&(u=f[this.pos++]))<<7,u<128?i:(i|=(127&(u=f[this.pos++]))<<14,u<128?i:(i|=(127&(u=f[this.pos++]))<<21,u<128?i:function(g,_,b){var T,A,M=b.buf;if(T=(112&(A=M[b.pos++]))>>4,A<128||(T|=(127&(A=M[b.pos++]))<<3,A<128)||(T|=(127&(A=M[b.pos++]))<<10,A<128)||(T|=(127&(A=M[b.pos++]))<<17,A<128)||(T|=(127&(A=M[b.pos++]))<<24,A<128)||(T|=(1&(A=M[b.pos++]))<<31,A<128))return nu(g,T,_);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(u=f[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,i=this.pos;return this.pos=a,a-i>=12&&zb?function(u,f,g){return zb.decode(u.subarray(f,g))}(this.buf,i,a):function(u,f,g){for(var _="",b=f;b<g;){var T,A,M,O=u[b],N=null,$=O>239?4:O>223?3:O>191?2:1;if(b+$>g)break;$===1?O<128&&(N=O):$===2?(192&(T=u[b+1]))==128&&(N=(31&O)<<6|63&T)<=127&&(N=null):$===3?(A=u[b+2],(192&(T=u[b+1]))==128&&(192&A)==128&&((N=(15&O)<<12|(63&T)<<6|63&A)<=2047||N>=55296&&N<=57343)&&(N=null)):$===4&&(A=u[b+2],M=u[b+3],(192&(T=u[b+1]))==128&&(192&A)==128&&(192&M)==128&&((N=(15&O)<<18|(63&T)<<12|(63&A)<<6|63&M)<=65535||N>=1114112)&&(N=null)),N===null?(N=65533,$=1):N>65535&&(N-=65536,_+=String.fromCharCode(N>>>10&1023|55296),N=56320|1023&N),_+=String.fromCharCode(N),b+=$}return _}(this.buf,i,a)},readBytes:function(){var a=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,a);return this.pos=a,i},readPackedVarint:function(a,i){if(this.type!==Pn.Bytes)return a.push(this.readVarint(i));var u=ea(this);for(a=a||[];this.pos<u;)a.push(this.readVarint(i));return a},readPackedSVarint:function(a){if(this.type!==Pn.Bytes)return a.push(this.readSVarint());var i=ea(this);for(a=a||[];this.pos<i;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Pn.Bytes)return a.push(this.readBoolean());var i=ea(this);for(a=a||[];this.pos<i;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Pn.Bytes)return a.push(this.readFloat());var i=ea(this);for(a=a||[];this.pos<i;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Pn.Bytes)return a.push(this.readDouble());var i=ea(this);for(a=a||[];this.pos<i;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Pn.Bytes)return a.push(this.readFixed32());var i=ea(this);for(a=a||[];this.pos<i;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Pn.Bytes)return a.push(this.readSFixed32());var i=ea(this);for(a=a||[];this.pos<i;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Pn.Bytes)return a.push(this.readFixed64());var i=ea(this);for(a=a||[];this.pos<i;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Pn.Bytes)return a.push(this.readSFixed64());var i=ea(this);for(a=a||[];this.pos<i;)a.push(this.readSFixed64());return a},skip:function(a){var i=7&a;if(i===Pn.Varint)for(;this.buf[this.pos++]>127;);else if(i===Pn.Bytes)this.pos=this.readVarint()+this.pos;else if(i===Pn.Fixed32)this.pos+=4;else{if(i!==Pn.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(a,i){this.writeVarint(a<<3|i)},realloc:function(a){for(var i=this.length||16;i<this.pos+a;)i*=2;if(i!==this.length){var u=new Uint8Array(i);u.set(this.buf),this.buf=u,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),ru(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),ru(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),ru(this.buf,-1&a,this.pos),ru(this.buf,Math.floor(a*Db),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),ru(this.buf,-1&a,this.pos),ru(this.buf,Math.floor(a*Db),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(i,u){var f,g;if(i>=0?(f=i%4294967296|0,g=i/4294967296|0):(g=~(-i/4294967296),4294967295^(f=~(-i%4294967296))?f=f+1|0:(f=0,g=g+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(_,b,T){T.buf[T.pos++]=127&_|128,_>>>=7,T.buf[T.pos++]=127&_|128,_>>>=7,T.buf[T.pos++]=127&_|128,_>>>=7,T.buf[T.pos++]=127&_|128,T.buf[T.pos]=127&(_>>>=7)}(f,0,u),function(_,b){var T=(7&_)<<4;b.buf[b.pos++]|=T|((_>>>=3)?128:0),_&&(b.buf[b.pos++]=127&_|((_>>>=7)?128:0),_&&(b.buf[b.pos++]=127&_|((_>>>=7)?128:0),_&&(b.buf[b.pos++]=127&_|((_>>>=7)?128:0),_&&(b.buf[b.pos++]=127&_|((_>>>=7)?128:0),_&&(b.buf[b.pos++]=127&_)))))}(g,u)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var i=this.pos;this.pos=function(f,g,_){for(var b,T,A=0;A<g.length;A++){if((b=g.charCodeAt(A))>55295&&b<57344){if(!T){b>56319||A+1===g.length?(f[_++]=239,f[_++]=191,f[_++]=189):T=b;continue}if(b<56320){f[_++]=239,f[_++]=191,f[_++]=189,T=b;continue}b=T-55296<<10|b-56320|65536,T=null}else T&&(f[_++]=239,f[_++]=191,f[_++]=189,T=null);b<128?f[_++]=b:(b<2048?f[_++]=b>>6|192:(b<65536?f[_++]=b>>12|224:(f[_++]=b>>18|240,f[_++]=b>>12&63|128),f[_++]=b>>6&63|128),f[_++]=63&b|128)}return _}(this.buf,a,this.pos);var u=this.pos-i;u>=128&&Fb(i,u,this),this.pos=i-1,this.writeVarint(u),this.pos+=u},writeFloat:function(a){this.realloc(4),Ob(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),Ob(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var i=a.length;this.writeVarint(i),this.realloc(i);for(var u=0;u<i;u++)this.buf[this.pos++]=a[u]},writeRawMessage:function(a,i){this.pos++;var u=this.pos;a(i,this);var f=this.pos-u;f>=128&&Fb(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeMessage:function(a,i,u){this.writeTag(a,Pn.Bytes),this.writeRawMessage(i,u)},writePackedVarint:function(a,i){i.length&&this.writeMessage(a,o3,i)},writePackedSVarint:function(a,i){i.length&&this.writeMessage(a,a3,i)},writePackedBoolean:function(a,i){i.length&&this.writeMessage(a,u3,i)},writePackedFloat:function(a,i){i.length&&this.writeMessage(a,l3,i)},writePackedDouble:function(a,i){i.length&&this.writeMessage(a,c3,i)},writePackedFixed32:function(a,i){i.length&&this.writeMessage(a,h3,i)},writePackedSFixed32:function(a,i){i.length&&this.writeMessage(a,d3,i)},writePackedFixed64:function(a,i){i.length&&this.writeMessage(a,f3,i)},writePackedSFixed64:function(a,i){i.length&&this.writeMessage(a,p3,i)},writeBytesField:function(a,i){this.writeTag(a,Pn.Bytes),this.writeBytes(i)},writeFixed32Field:function(a,i){this.writeTag(a,Pn.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(a,i){this.writeTag(a,Pn.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(a,i){this.writeTag(a,Pn.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(a,i){this.writeTag(a,Pn.Fixed64),this.writeSFixed64(i)},writeVarintField:function(a,i){this.writeTag(a,Pn.Varint),this.writeVarint(i)},writeSVarintField:function(a,i){this.writeTag(a,Pn.Varint),this.writeSVarint(i)},writeStringField:function(a,i){this.writeTag(a,Pn.Bytes),this.writeString(i)},writeFloatField:function(a,i){this.writeTag(a,Pn.Fixed32),this.writeFloat(i)},writeDoubleField:function(a,i){this.writeTag(a,Pn.Fixed64),this.writeDouble(i)},writeBooleanField:function(a,i){this.writeVarintField(a,Boolean(i))}};class m_{constructor(i,{pixelRatio:u,version:f,stretchX:g,stretchY:_,content:b}){this.paddedRect=i,this.pixelRatio=u,this.stretchX=g,this.stretchY=_,this.content=b,this.version=f}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Ub{constructor(i,u){const f={},g={};this.haveRenderCallbacks=[];const _=[];this.addImages(i,f,_),this.addImages(u,g,_);const{w:b,h:T}=Nb(_),A=new hs({width:b||1,height:T||1});for(const M in i){const O=i[M],N=f[M].paddedRect;hs.copy(O.data,A,{x:0,y:0},{x:N.x+1,y:N.y+1},O.data)}for(const M in u){const O=u[M],N=g[M].paddedRect,$=N.x+1,Z=N.y+1,Y=O.data.width,le=O.data.height;hs.copy(O.data,A,{x:0,y:0},{x:$,y:Z},O.data),hs.copy(O.data,A,{x:0,y:le-1},{x:$,y:Z-1},{width:Y,height:1}),hs.copy(O.data,A,{x:0,y:0},{x:$,y:Z+le},{width:Y,height:1}),hs.copy(O.data,A,{x:Y-1,y:0},{x:$-1,y:Z},{width:1,height:le}),hs.copy(O.data,A,{x:0,y:0},{x:$+Y,y:Z},{width:1,height:le})}this.image=A,this.iconPositions=f,this.patternPositions=g}addImages(i,u,f){for(const g in i){const _=i[g],b={x:0,y:0,w:_.data.width+2,h:_.data.height+2};f.push(b),u[g]=new m_(b,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(i,u){i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in i.updatedImages)this.patchUpdatedImage(this.iconPositions[f],i.getImage(f),u),this.patchUpdatedImage(this.patternPositions[f],i.getImage(f),u)}patchUpdatedImage(i,u,f){if(!i||!u||i.version===u.version)return;i.version=u.version;const[g,_]=i.tl;f.update(u.data,void 0,{x:g,y:_})}}dt("ImagePosition",m_),dt("ImageAtlas",Ub),c.WritingMode=void 0,($a=c.WritingMode||(c.WritingMode={}))[$a.none=0]="none",$a[$a.horizontal=1]="horizontal",$a[$a.vertical=2]="vertical",$a[$a.horizontalOnly=3]="horizontalOnly";const $p=-17;class ad{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,u){const f=new ad;return f.scale=i||1,f.fontStack=u,f}static forImage(i){const u=new ad;return u.imageName=i,u}}class iu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,u){const f=new iu;for(let g=0;g<i.sections.length;g++){const _=i.sections[g];_.image?f.addImageSection(_):f.addTextSection(_,u)}return f}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(){this.text=function(i){let u="";for(let f=0;f<i.length;f++){const g=i.charCodeAt(f+1)||null,_=i.charCodeAt(f-1)||null;u+=g&&Tp(g)&&!od[i[f+1]]||_&&Tp(_)&&!od[i[f-1]]||!od[i[f]]?i[f]:od[i[f]]}return u}(this.text)}trim(){let i=0;for(let f=0;f<this.text.length&&Hp[this.text.charCodeAt(f)];f++)i++;let u=this.text.length;for(let f=this.text.length-1;f>=0&&f>=i&&Hp[this.text.charCodeAt(f)];f--)u--;this.text=this.text.substring(i,u),this.sectionIndex=this.sectionIndex.slice(i,u)}substring(i,u){const f=new iu;return f.text=this.text.substring(i,u),f.sectionIndex=this.sectionIndex.slice(i,u),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,u)=>Math.max(i,this.sections[u].scale),0)}addTextSection(i,u){this.text+=i.text,this.sections.push(ad.forText(i.scale,i.fontStack||u));const f=this.sections.length-1;for(let g=0;g<i.text.length;++g)this.sectionIndex.push(f)}addImageSection(i){const u=i.image?i.image.name:"";if(u.length===0)return void he("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(ad.forImage(u)),this.sectionIndex.push(this.sections.length-1)):he("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Wp(a,i,u,f,g,_,b,T,A,M,O,N,$,Z,Y,le){const ae=iu.fromFeature(a,g);let be;N===c.WritingMode.vertical&&ae.verticalizePunctuation();const{processBidirectionalText:Pe,processStyledBidirectionalText:ve}=Xi;if(Pe&&ae.sections.length===1){be=[];const ze=Pe(ae.toString(),g_(ae,M,_,i,f,Z,Y));for(const ut of ze){const mt=new iu;mt.text=ut,mt.sections=ae.sections;for(let it=0;it<ut.length;it++)mt.sectionIndex.push(0);be.push(mt)}}else if(ve){be=[];const ze=ve(ae.text,ae.sectionIndex,g_(ae,M,_,i,f,Z,Y));for(const ut of ze){const mt=new iu;mt.text=ut[0],mt.sectionIndex=ut[1],mt.sections=ae.sections,be.push(mt)}}else be=function(ze,ut){const mt=[],it=ze.text;let Je=0;for(const Xe of ut)mt.push(ze.substring(Je,Xe)),Je=Xe;return Je<it.length&&mt.push(ze.substring(Je,it.length)),mt}(ae,g_(ae,M,_,i,f,Z,Y));const Se=[],Fe={positionedLines:Se,text:ae.toString(),top:O[1],bottom:O[1],left:O[0],right:O[0],writingMode:N,iconsInText:!1,verticalizable:!1};return function(ze,ut,mt,it,Je,Xe,st,tt,We,Ct,bt,Yt){let $n=0,Yn=$p,Cr=0,fs=0;const Zr=tt==="right"?1:tt==="left"?0:.5;let xr=0;for(const br of Je){br.trim();const Kr=br.getMaxScale(),si=(Kr-1)*$r,_i={positionedGlyphs:[],lineOffset:0};ze.positionedLines[xr]=_i;const Di=_i.positionedGlyphs;let zi=0;if(!br.length()){Yn+=Xe,++xr;continue}for(let Fr=0;Fr<br.length();Fr++){const an=br.getSection(Fr),Ki=br.getSectionIndex(Fr),Jr=br.getCharCode(Fr);let oi=0,zs=null,no=null,ro=null,na=$r;const Fs=!(We===c.WritingMode.horizontal||!bt&&!Uh(Jr)||bt&&(Hp[Jr]||(zr=Jr,rt.Arabic(zr)||rt["Arabic Supplement"](zr)||rt["Arabic Extended-A"](zr)||rt["Arabic Presentation Forms-A"](zr)||rt["Arabic Presentation Forms-B"](zr))));if(an.imageName){const ps=it[an.imageName];if(!ps)continue;ro=an.imageName,ze.iconsInText=ze.iconsInText||!0,no=ps.paddedRect;const Fi=ps.displaySize;an.scale=an.scale*$r/Yt,zs={width:Fi[0],height:Fi[1],left:1,top:-3,advance:Fs?Fi[1]:Fi[0]},oi=si+($r-Fi[1]*an.scale),na=zs.advance;const ra=Fs?Fi[0]*an.scale-$r*Kr:Fi[1]*an.scale-$r*Kr;ra>0&&ra>zi&&(zi=ra)}else{const ps=mt[an.fontStack],Fi=ps&&ps[Jr];if(Fi&&Fi.rect)no=Fi.rect,zs=Fi.metrics;else{const ra=ut[an.fontStack],ud=ra&&ra[Jr];if(!ud)continue;zs=ud.metrics}oi=(Kr-an.scale)*$r}Fs?(ze.verticalizable=!0,Di.push({glyph:Jr,imageName:ro,x:$n,y:Yn+oi,vertical:Fs,scale:an.scale,fontStack:an.fontStack,sectionIndex:Ki,metrics:zs,rect:no}),$n+=na*an.scale+Ct):(Di.push({glyph:Jr,imageName:ro,x:$n,y:Yn+oi,vertical:Fs,scale:an.scale,fontStack:an.fontStack,sectionIndex:Ki,metrics:zs,rect:no}),$n+=zs.advance*an.scale+Ct)}Di.length!==0&&(Cr=Math.max($n-Ct,Cr),x3(Di,0,Di.length-1,Zr,zi)),$n=0;const Qn=Xe*Kr+zi;_i.lineOffset=Math.max(zi,si),Yn+=Qn,fs=Math.max(Qn,fs),++xr}var zr;const Yr=Yn-$p,{horizontalAlign:ii,verticalAlign:Oi}=y_(st);(function(br,Kr,si,_i,Di,zi,Qn,Fr,an){const Ki=(Kr-si)*Di;let Jr=0;Jr=zi!==Qn?-Fr*_i-$p:(-_i*an+.5)*Qn;for(const oi of br)for(const zs of oi.positionedGlyphs)zs.x+=Ki,zs.y+=Jr})(ze.positionedLines,Zr,ii,Oi,Cr,fs,Xe,Yr,Je.length),ze.top+=-Oi*Yr,ze.bottom=ze.top+Yr,ze.left+=-ii*Cr,ze.right=ze.left+Cr}(Fe,i,u,f,be,b,T,A,N,M,$,le),!function(ze){for(const ut of ze)if(ut.positionedGlyphs.length!==0)return!1;return!0}(Se)&&Fe}const Hp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_3={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Vb(a,i,u,f,g,_){if(i.imageName){const b=f[i.imageName];return b?b.displaySize[0]*i.scale*$r/_+g:0}{const b=u[i.fontStack],T=b&&b[a];return T?T.metrics.advance*i.scale+g:0}}function jb(a,i,u,f){const g=Math.pow(a-i,2);return f?a<i?g/2:2*g:g+Math.abs(u)*u}function v3(a,i,u){let f=0;return a===10&&(f-=1e4),u&&(f+=150),a!==40&&a!==65288||(f+=50),i!==41&&i!==65289||(f+=50),f}function Gb(a,i,u,f,g,_){let b=null,T=jb(i,u,g,_);for(const A of f){const M=jb(i-A.x,u,g,_)+A.badness;M<=T&&(b=A,T=M)}return{index:a,x:i,priorBreak:b,badness:T}}function $b(a){return a?$b(a.priorBreak).concat(a.index):[]}function g_(a,i,u,f,g,_,b){if(_!=="point")return[];if(!a)return[];const T=[],A=function($,Z,Y,le,ae,be){let Pe=0;for(let ve=0;ve<$.length();ve++){const Se=$.getSection(ve);Pe+=Vb($.getCharCode(ve),Se,le,ae,Z,be)}return Pe/Math.max(1,Math.ceil(Pe/Y))}(a,i,u,f,g,b),M=a.text.indexOf("\u200B")>=0;let O=0;for(let $=0;$<a.length();$++){const Z=a.getSection($),Y=a.getCharCode($);if(Hp[Y]||(O+=Vb(Y,Z,f,g,i,b)),$<a.length()-1){const le=!((N=Y)<11904||!(rt["Bopomofo Extended"](N)||rt.Bopomofo(N)||rt["CJK Compatibility Forms"](N)||rt["CJK Compatibility Ideographs"](N)||rt["CJK Compatibility"](N)||rt["CJK Radicals Supplement"](N)||rt["CJK Strokes"](N)||rt["CJK Symbols and Punctuation"](N)||rt["CJK Unified Ideographs Extension A"](N)||rt["CJK Unified Ideographs"](N)||rt["Enclosed CJK Letters and Months"](N)||rt["Halfwidth and Fullwidth Forms"](N)||rt.Hiragana(N)||rt["Ideographic Description Characters"](N)||rt["Kangxi Radicals"](N)||rt["Katakana Phonetic Extensions"](N)||rt.Katakana(N)||rt["Vertical Forms"](N)||rt["Yi Radicals"](N)||rt["Yi Syllables"](N)));(_3[Y]||le||Z.imageName)&&T.push(Gb($+1,O,A,T,v3(Y,a.getCharCode($+1),le&&M),!1))}}var N;return $b(Gb(a.length(),O,A,T,0,!0))}function y_(a){let i=.5,u=.5;switch(a){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:i,verticalAlign:u}}function x3(a,i,u,f,g){if(!f&&!g)return;const _=a[u],b=(a[u].x+_.metrics.advance*_.scale)*f;for(let T=i;T<=u;T++)a[T].x-=b,a[T].y+=g}function b3(a,i,u){const{horizontalAlign:f,verticalAlign:g}=y_(u),_=i[0]-a.displaySize[0]*f,b=i[1]-a.displaySize[1]*g;return{image:a,top:b,bottom:b+a.displaySize[1],left:_,right:_+a.displaySize[0]}}function Wb(a,i,u,f,g,_){const b=a.image;let T;if(b.content){const ae=b.content,be=b.pixelRatio||1;T=[ae[0]/be,ae[1]/be,b.displaySize[0]-ae[2]/be,b.displaySize[1]-ae[3]/be]}const A=i.left*_,M=i.right*_;let O,N,$,Z;u==="width"||u==="both"?(Z=g[0]+A-f[3],N=g[0]+M+f[1]):(Z=g[0]+(A+M-b.displaySize[0])/2,N=Z+b.displaySize[0]);const Y=i.top*_,le=i.bottom*_;return u==="height"||u==="both"?(O=g[1]+Y-f[0],$=g[1]+le+f[2]):(O=g[1]+(Y+le-b.displaySize[1])/2,$=O+b.displaySize[1]),{image:b,top:O,right:N,bottom:$,left:Z,collisionPadding:T}}const ta=128;function Hb(a,i){const{expression:u}=i;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new Xn(a+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:g}=u;let _=0;for(;_<f.length&&f[_]<=a;)_++;_=Math.max(0,_-1);let b=_;for(;b<f.length&&f[b]<a+1;)b++;b=Math.min(f.length-1,b);const T=f[_],A=f[b];return u.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:A,interpolationType:g}:{kind:"camera",minZoom:T,maxZoom:A,minSize:u.evaluate(new Xn(T)),maxSize:u.evaluate(new Xn(A)),interpolationType:g}}}class Wa extends Qe{constructor(i,u,f,g){super(i,u),this.angle=f,g!==void 0&&(this.segment=g)}clone(){return new Wa(this.x,this.y,this.angle,this.segment)}}function qb(a,i,u,f,g){if(i.segment===void 0)return!0;let _=i,b=i.segment+1,T=0;for(;T>-u/2;){if(b--,b<0)return!1;T-=a[b].dist(_),_=a[b]}T+=a[b].dist(a[b+1]),b++;const A=[];let M=0;for(;T<u/2;){const O=a[b],N=a[b+1];if(!N)return!1;let $=a[b-1].angleTo(O)-O.angleTo(N);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:T,angleDelta:$}),M+=$;T-A[0].distance>f;)M-=A.shift().angleDelta;if(M>g)return!1;b++,T+=O.dist(N)}return!0}function Xb(a){let i=0;for(let u=0;u<a.length-1;u++)i+=a[u].dist(a[u+1]);return i}function Zb(a,i,u){return a?.6*i*u:0}function Yb(a,i){return Math.max(a?a.right-a.left:0,i?i.right-i.left:0)}function w3(a,i,u,f,g,_){const b=Zb(u,g,_),T=Yb(u,f)*_;let A=0;const M=Xb(a)/2;for(let O=0;O<a.length-1;O++){const N=a[O],$=a[O+1],Z=N.dist($);if(A+Z>M){const Y=(M-A)/Z,le=Xt(N.x,$.x,Y),ae=Xt(N.y,$.y,Y),be=new Wa(le,ae,$.angleTo(N),O);return be._round(),!b||qb(a,be,T,b,i)?be:void 0}A+=Z}}function E3(a,i,u,f,g,_,b,T,A){const M=Zb(f,_,b),O=Yb(f,g),N=O*b,$=a[0].x===0||a[0].x===A||a[0].y===0||a[0].y===A;return i-N<i/4&&(i=N+i/4),Kb(a,$?i/2*T%i:(O/2+2*_)*b*T%i,i,M,u,N,$,!1,A)}function Kb(a,i,u,f,g,_,b,T,A){const M=_/2,O=Xb(a);let N=0,$=i-u,Z=[];for(let Y=0;Y<a.length-1;Y++){const le=a[Y],ae=a[Y+1],be=le.dist(ae),Pe=ae.angleTo(le);for(;$+u<N+be;){$+=u;const ve=($-N)/be,Se=Xt(le.x,ae.x,ve),Fe=Xt(le.y,ae.y,ve);if(Se>=0&&Se<A&&Fe>=0&&Fe<A&&$-M>=0&&$+M<=O){const ze=new Wa(Se,Fe,Pe,Y);ze._round(),f&&!qb(a,ze,_,f,g)||Z.push(ze)}}N+=be}return T||Z.length||b||(Z=Kb(a,N/2,u,f,g,_,b,!0,A)),Z}function Jb(a,i,u,f,g){const _=[];for(let b=0;b<a.length;b++){const T=a[b];let A;for(let M=0;M<T.length-1;M++){let O=T[M],N=T[M+1];O.x<i&&N.x<i||(O.x<i?O=new Qe(i,O.y+(i-O.x)/(N.x-O.x)*(N.y-O.y))._round():N.x<i&&(N=new Qe(i,O.y+(i-O.x)/(N.x-O.x)*(N.y-O.y))._round()),O.y<u&&N.y<u||(O.y<u?O=new Qe(O.x+(u-O.y)/(N.y-O.y)*(N.x-O.x),u)._round():N.y<u&&(N=new Qe(O.x+(u-O.y)/(N.y-O.y)*(N.x-O.x),u)._round()),O.x>=f&&N.x>=f||(O.x>=f?O=new Qe(f,O.y+(f-O.x)/(N.x-O.x)*(N.y-O.y))._round():N.x>=f&&(N=new Qe(f,O.y+(f-O.x)/(N.x-O.x)*(N.y-O.y))._round()),O.y>=g&&N.y>=g||(O.y>=g?O=new Qe(O.x+(g-O.y)/(N.y-O.y)*(N.x-O.x),g)._round():N.y>=g&&(N=new Qe(O.x+(g-O.y)/(N.y-O.y)*(N.x-O.x),g)._round()),A&&O.equals(A[A.length-1])||(A=[O],_.push(A)),A.push(N)))))}}return _}function Qb(a,i,u,f){const g=[],_=a.image,b=_.pixelRatio,T=_.paddedRect.w-2,A=_.paddedRect.h-2,M=a.right-a.left,O=a.bottom-a.top,N=_.stretchX||[[0,T]],$=_.stretchY||[[0,A]],Z=(Xe,st)=>Xe+st[1]-st[0],Y=N.reduce(Z,0),le=$.reduce(Z,0),ae=T-Y,be=A-le;let Pe=0,ve=Y,Se=0,Fe=le,ze=0,ut=ae,mt=0,it=be;if(_.content&&f){const Xe=_.content;Pe=qp(N,0,Xe[0]),Se=qp($,0,Xe[1]),ve=qp(N,Xe[0],Xe[2]),Fe=qp($,Xe[1],Xe[3]),ze=Xe[0]-Pe,mt=Xe[1]-Se,ut=Xe[2]-Xe[0]-ve,it=Xe[3]-Xe[1]-Fe}const Je=(Xe,st,tt,We)=>{const Ct=Xp(Xe.stretch-Pe,ve,M,a.left),bt=Zp(Xe.fixed-ze,ut,Xe.stretch,Y),Yt=Xp(st.stretch-Se,Fe,O,a.top),$n=Zp(st.fixed-mt,it,st.stretch,le),Yn=Xp(tt.stretch-Pe,ve,M,a.left),Cr=Zp(tt.fixed-ze,ut,tt.stretch,Y),fs=Xp(We.stretch-Se,Fe,O,a.top),Zr=Zp(We.fixed-mt,it,We.stretch,le),xr=new Qe(Ct,Yt),zr=new Qe(Yn,Yt),Yr=new Qe(Yn,fs),ii=new Qe(Ct,fs),Oi=new Qe(bt/b,$n/b),br=new Qe(Cr/b,Zr/b),Kr=i*Math.PI/180;if(Kr){const Di=Math.sin(Kr),zi=Math.cos(Kr),Qn=[zi,-Di,Di,zi];xr._matMult(Qn),zr._matMult(Qn),ii._matMult(Qn),Yr._matMult(Qn)}const si=Xe.stretch+Xe.fixed,_i=st.stretch+st.fixed;return{tl:xr,tr:zr,bl:ii,br:Yr,tex:{x:_.paddedRect.x+1+si,y:_.paddedRect.y+1+_i,w:tt.stretch+tt.fixed-si,h:We.stretch+We.fixed-_i},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Oi,pixelOffsetBR:br,minFontScaleX:ut/b/M,minFontScaleY:it/b/O,isSDF:u}};if(f&&(_.stretchX||_.stretchY)){const Xe=ew(N,ae,Y),st=ew($,be,le);for(let tt=0;tt<Xe.length-1;tt++){const We=Xe[tt],Ct=Xe[tt+1];for(let bt=0;bt<st.length-1;bt++)g.push(Je(We,st[bt],Ct,st[bt+1]))}}else g.push(Je({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:A+1}));return g}function qp(a,i,u){let f=0;for(const g of a)f+=Math.max(i,Math.min(u,g[1]))-Math.max(i,Math.min(u,g[0]));return f}function ew(a,i,u){const f=[{fixed:-1,stretch:0}];for(const[g,_]of a){const b=f[f.length-1];f.push({fixed:g-b.stretch,stretch:b.stretch}),f.push({fixed:g-b.stretch,stretch:b.stretch+(_-g)})}return f.push({fixed:i+1,stretch:u}),f}function Xp(a,i,u,f){return a/i*u+f}function Zp(a,i,u,f){return a-i*u/f}dt("Anchor",Wa);class Yp{constructor(i,u,f,g,_,b,T,A,M,O){if(this.boxStartIndex=i.length,M){let N=b.top,$=b.bottom;const Z=b.collisionPadding;Z&&(N-=Z[1],$+=Z[3]);let Y=$-N;Y>0&&(Y=Math.max(10,Y),this.circleDiameter=Y)}else{let N=b.top*T-A[0],$=b.bottom*T+A[2],Z=b.left*T-A[3],Y=b.right*T+A[1];const le=b.collisionPadding;if(le&&(Z-=le[0]*T,N-=le[1]*T,Y+=le[2]*T,$+=le[3]*T),O){const ae=new Qe(Z,N),be=new Qe(Y,N),Pe=new Qe(Z,$),ve=new Qe(Y,$),Se=O*Math.PI/180;ae._rotate(Se),be._rotate(Se),Pe._rotate(Se),ve._rotate(Se),Z=Math.min(ae.x,be.x,Pe.x,ve.x),Y=Math.max(ae.x,be.x,Pe.x,ve.x),N=Math.min(ae.y,be.y,Pe.y,ve.y),$=Math.max(ae.y,be.y,Pe.y,ve.y)}i.emplaceBack(u.x,u.y,Z,N,Y,$,f,g,_)}this.boxEndIndex=i.length}}class T3{constructor(i=[],u=S3){if(this.data=i,this.length=this.data.length,this.compare=u,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const i=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:u,compare:f}=this,g=u[i];for(;i>0;){const _=i-1>>1,b=u[_];if(f(g,b)>=0)break;u[i]=b,i=_}u[i]=g}_down(i){const{data:u,compare:f}=this,g=this.length>>1,_=u[i];for(;i<g;){let b=1+(i<<1),T=u[b];const A=b+1;if(A<this.length&&f(u[A],T)<0&&(b=A,T=u[A]),f(T,_)>=0)break;u[i]=T,i=b}u[i]=_}}function S3(a,i){return a<i?-1:a>i?1:0}function A3(a,i=1,u=!1){let f=1/0,g=1/0,_=-1/0,b=-1/0;const T=a[0];for(let Z=0;Z<T.length;Z++){const Y=T[Z];(!Z||Y.x<f)&&(f=Y.x),(!Z||Y.y<g)&&(g=Y.y),(!Z||Y.x>_)&&(_=Y.x),(!Z||Y.y>b)&&(b=Y.y)}const A=Math.min(_-f,b-g);let M=A/2;const O=new T3([],P3);if(A===0)return new Qe(f,g);for(let Z=f;Z<_;Z+=A)for(let Y=g;Y<b;Y+=A)O.push(new su(Z+M,Y+M,M,a));let N=function(Z){let Y=0,le=0,ae=0;const be=Z[0];for(let Pe=0,ve=be.length,Se=ve-1;Pe<ve;Se=Pe++){const Fe=be[Pe],ze=be[Se],ut=Fe.x*ze.y-ze.x*Fe.y;le+=(Fe.x+ze.x)*ut,ae+=(Fe.y+ze.y)*ut,Y+=3*ut}return new su(le/Y,ae/Y,0,Z)}(a),$=O.length;for(;O.length;){const Z=O.pop();(Z.d>N.d||!N.d)&&(N=Z,u&&console.log("found best %d after %d probes",Math.round(1e4*Z.d)/1e4,$)),Z.max-N.d<=i||(M=Z.h/2,O.push(new su(Z.p.x-M,Z.p.y-M,M,a)),O.push(new su(Z.p.x+M,Z.p.y-M,M,a)),O.push(new su(Z.p.x-M,Z.p.y+M,M,a)),O.push(new su(Z.p.x+M,Z.p.y+M,M,a)),$+=4)}return u&&(console.log(`num probes: ${$}`),console.log(`best distance: ${N.d}`)),N.p}function P3(a,i){return i.max-a.max}function su(a,i,u,f){this.p=new Qe(a,i),this.h=u,this.d=function(g,_){let b=!1,T=1/0;for(let A=0;A<_.length;A++){const M=_[A];for(let O=0,N=M.length,$=N-1;O<N;$=O++){const Z=M[O],Y=M[$];Z.y>g.y!=Y.y>g.y&&g.x<(Y.x-Z.x)*(g.y-Z.y)/(Y.y-Z.y)+Z.x&&(b=!b),T=Math.min(T,lb(g,Z,Y))}}return(b?1:-1)*Math.sqrt(T)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}const __=Number.POSITIVE_INFINITY;function tw(a,i){return i[1]!==__?function(u,f,g){let _=0,b=0;switch(f=Math.abs(f),g=Math.abs(g),u){case"top-right":case"top-left":case"top":b=g-7;break;case"bottom-right":case"bottom-left":case"bottom":b=7-g}switch(u){case"top-right":case"bottom-right":case"right":_=-f;break;case"top-left":case"bottom-left":case"left":_=f}return[_,b]}(a,i[0],i[1]):function(u,f){let g=0,_=0;f<0&&(f=0);const b=f/Math.sqrt(2);switch(u){case"top-right":case"top-left":_=b-7;break;case"bottom-right":case"bottom-left":_=7-b;break;case"bottom":_=7-f;break;case"top":_=f-7}switch(u){case"top-right":case"bottom-right":g=-b;break;case"top-left":case"bottom-left":g=b;break;case"left":g=f;break;case"right":g=-f}return[g,_]}(a,i[0])}function v_(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function C3(a,i,u,f,g,_,b,T,A,M,O){let N=_.textMaxSize.evaluate(i,{});N===void 0&&(N=b);const $=a.layers[0].layout,Z=$.get("icon-offset").evaluate(i,{},O),Y=rw(u.horizontal),le=b/24,ae=a.tilePixelRatio*le,be=a.tilePixelRatio*N/24,Pe=a.tilePixelRatio*T,ve=a.tilePixelRatio*$.get("symbol-spacing"),Se=$.get("text-padding")*a.tilePixelRatio,Fe=function(We,Ct,bt,Yt=1){const $n=We.get("icon-padding").evaluate(Ct,{},bt),Yn=$n&&$n.values;return[Yn[0]*Yt,Yn[1]*Yt,Yn[2]*Yt,Yn[3]*Yt]}($,i,O,a.tilePixelRatio),ze=$.get("text-max-angle")/180*Math.PI,ut=$.get("text-rotation-alignment")!=="viewport"&&$.get("symbol-placement")!=="point",mt=$.get("icon-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",it=$.get("symbol-placement"),Je=ve/2,Xe=$.get("icon-text-fit");let st;f&&Xe!=="none"&&(a.allowVerticalPlacement&&u.vertical&&(st=Wb(f,u.vertical,Xe,$.get("icon-text-fit-padding"),Z,le)),Y&&(f=Wb(f,Y,Xe,$.get("icon-text-fit-padding"),Z,le)));const tt=(We,Ct)=>{Ct.x<0||Ct.x>=Pr||Ct.y<0||Ct.y>=Pr||function(bt,Yt,$n,Yn,Cr,fs,Zr,xr,zr,Yr,ii,Oi,br,Kr,si,_i,Di,zi,Qn,Fr,an,Ki,Jr,oi,zs){const no=bt.addToLineVertexArray(Yt,$n);let ro,na,Fs,ps,Fi=0,ra=0,ud=0,vw=0,I_=-1,k_=-1;const ia={};let xw=Dr.exports(""),M_=0,L_=0;if(xr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[M_,L_]=xr.layout.get("text-offset").evaluate(an,{},oi).map(Bi=>Bi*$r):(M_=xr.layout.get("text-radial-offset").evaluate(an,{},oi)*$r,L_=__),bt.allowVerticalPlacement&&Yn.vertical){const Bi=xr.layout.get("text-rotate").evaluate(an,{},oi)+90;Fs=new Yp(zr,Yt,Yr,ii,Oi,Yn.vertical,br,Kr,si,Bi),Zr&&(ps=new Yp(zr,Yt,Yr,ii,Oi,Zr,Di,zi,si,Bi))}if(Cr){const Bi=xr.layout.get("icon-rotate").evaluate(an,{}),Co=xr.layout.get("icon-text-fit")!=="none",hd=Qb(Cr,Bi,Jr,Co),dd=Zr?Qb(Zr,Bi,Jr,Co):void 0;na=new Yp(zr,Yt,Yr,ii,Oi,Cr,Di,zi,!1,Bi),Fi=4*hd.length;const Ew=bt.iconSizeData;let rc=null;Ew.kind==="source"?(rc=[ta*xr.layout.get("icon-size").evaluate(an,{})],rc[0]>Ha&&he(`${bt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Ew.kind==="composite"&&(rc=[ta*Ki.compositeIconSizes[0].evaluate(an,{},oi),ta*Ki.compositeIconSizes[1].evaluate(an,{},oi)],(rc[0]>Ha||rc[1]>Ha)&&he(`${bt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),bt.addSymbols(bt.icon,hd,rc,Fr,Qn,an,c.WritingMode.none,Yt,no.lineStartIndex,no.lineLength,-1,oi),I_=bt.icon.placedSymbolArray.length-1,dd&&(ra=4*dd.length,bt.addSymbols(bt.icon,dd,rc,Fr,Qn,an,c.WritingMode.vertical,Yt,no.lineStartIndex,no.lineLength,-1,oi),k_=bt.icon.placedSymbolArray.length-1)}const bw=Object.keys(Yn.horizontal);for(const Bi of bw){const Co=Yn.horizontal[Bi];if(!ro){xw=Dr.exports(Co.text);const dd=xr.layout.get("text-rotate").evaluate(an,{},oi);ro=new Yp(zr,Yt,Yr,ii,Oi,Co,br,Kr,si,dd)}const hd=Co.positionedLines.length===1;if(ud+=nw(bt,Yt,Co,fs,xr,si,an,_i,no,Yn.vertical?c.WritingMode.horizontal:c.WritingMode.horizontalOnly,hd?bw:[Bi],ia,I_,Ki,oi),hd)break}Yn.vertical&&(vw+=nw(bt,Yt,Yn.vertical,fs,xr,si,an,_i,no,c.WritingMode.vertical,["vertical"],ia,k_,Ki,oi));const V3=ro?ro.boxStartIndex:bt.collisionBoxArray.length,j3=ro?ro.boxEndIndex:bt.collisionBoxArray.length,G3=Fs?Fs.boxStartIndex:bt.collisionBoxArray.length,$3=Fs?Fs.boxEndIndex:bt.collisionBoxArray.length,W3=na?na.boxStartIndex:bt.collisionBoxArray.length,H3=na?na.boxEndIndex:bt.collisionBoxArray.length,q3=ps?ps.boxStartIndex:bt.collisionBoxArray.length,X3=ps?ps.boxEndIndex:bt.collisionBoxArray.length;let io=-1;const tm=(Bi,Co)=>Bi&&Bi.circleDiameter?Math.max(Bi.circleDiameter,Co):Co;io=tm(ro,io),io=tm(Fs,io),io=tm(na,io),io=tm(ps,io);const ww=io>-1?1:0;ww&&(io*=zs/$r),bt.glyphOffsetArray.length>=ou.MAX_GLYPHS&&he("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),an.sortKey!==void 0&&bt.addToSortKeyRanges(bt.symbolInstances.length,an.sortKey),bt.symbolInstances.emplaceBack(Yt.x,Yt.y,ia.right>=0?ia.right:-1,ia.center>=0?ia.center:-1,ia.left>=0?ia.left:-1,ia.vertical||-1,I_,k_,xw,V3,j3,G3,$3,W3,H3,q3,X3,Yr,ud,vw,Fi,ra,ww,0,br,M_,L_,io)}(a,Ct,We,u,f,g,st,a.layers[0],a.collisionBoxArray,i.index,i.sourceLayerIndex,a.index,ae,[Se,Se,Se,Se],ut,A,Pe,Fe,mt,Z,i,_,M,O,b)};if(it==="line")for(const We of Jb(i.geometry,0,0,Pr,Pr)){const Ct=E3(We,ve,ze,u.vertical||Y,f,24,be,a.overscaling,Pr);for(const bt of Ct){const Yt=Y;Yt&&I3(a,Yt.text,Je,bt)||tt(We,bt)}}else if(it==="line-center"){for(const We of i.geometry)if(We.length>1){const Ct=w3(We,ze,u.vertical||Y,f,24,be);Ct&&tt(We,Ct)}}else if(i.type==="Polygon")for(const We of o_(i.geometry,0)){const Ct=A3(We,16);tt(We[0],new Wa(Ct.x,Ct.y,0))}else if(i.type==="LineString")for(const We of i.geometry)tt(We,new Wa(We[0].x,We[0].y,0));else if(i.type==="Point")for(const We of i.geometry)for(const Ct of We)tt([Ct],new Wa(Ct.x,Ct.y,0))}const Ha=32640;function nw(a,i,u,f,g,_,b,T,A,M,O,N,$,Z,Y){const le=function(Pe,ve,Se,Fe,ze,ut,mt,it){const Je=Fe.layout.get("text-rotate").evaluate(ut,{})*Math.PI/180,Xe=[];for(const st of ve.positionedLines)for(const tt of st.positionedGlyphs){if(!tt.rect)continue;const We=tt.rect||{};let Ct=4,bt=!0,Yt=1,$n=0;const Yn=(ze||it)&&tt.vertical,Cr=tt.metrics.advance*tt.scale/2;if(it&&ve.verticalizable){const Qn=(tt.scale-1)*$r,Fr=($r-tt.metrics.width*tt.scale)/2;$n=st.lineOffset/2-(tt.imageName?-Fr:Qn)}if(tt.imageName){const Qn=mt[tt.imageName];bt=Qn.sdf,Yt=Qn.pixelRatio,Ct=1/Yt}const fs=ze?[tt.x+Cr,tt.y]:[0,0];let Zr=ze?[0,0]:[tt.x+Cr+Se[0],tt.y+Se[1]-$n],xr=[0,0];Yn&&(xr=Zr,Zr=[0,0]);const zr=(tt.metrics.left-Ct)*tt.scale-Cr+Zr[0],Yr=(-tt.metrics.top-Ct)*tt.scale+Zr[1],ii=zr+We.w*tt.scale/Yt,Oi=Yr+We.h*tt.scale/Yt,br=new Qe(zr,Yr),Kr=new Qe(ii,Yr),si=new Qe(zr,Oi),_i=new Qe(ii,Oi);if(Yn){const Qn=new Qe(-Cr,Cr-$p),Fr=-Math.PI/2,an=12-Cr,Ki=new Qe(22-an,-(tt.imageName?an:0)),Jr=new Qe(...xr);br._rotateAround(Fr,Qn)._add(Ki)._add(Jr),Kr._rotateAround(Fr,Qn)._add(Ki)._add(Jr),si._rotateAround(Fr,Qn)._add(Ki)._add(Jr),_i._rotateAround(Fr,Qn)._add(Ki)._add(Jr)}if(Je){const Qn=Math.sin(Je),Fr=Math.cos(Je),an=[Fr,-Qn,Qn,Fr];br._matMult(an),Kr._matMult(an),si._matMult(an),_i._matMult(an)}const Di=new Qe(0,0),zi=new Qe(0,0);Xe.push({tl:br,tr:Kr,bl:si,br:_i,tex:We,writingMode:ve.writingMode,glyphOffset:fs,sectionIndex:tt.sectionIndex,isSDF:bt,pixelOffsetTL:Di,pixelOffsetBR:zi,minFontScaleX:0,minFontScaleY:0})}return Xe}(0,u,T,g,_,b,f,a.allowVerticalPlacement),ae=a.textSizeData;let be=null;ae.kind==="source"?(be=[ta*g.layout.get("text-size").evaluate(b,{})],be[0]>Ha&&he(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ae.kind==="composite"&&(be=[ta*Z.compositeTextSizes[0].evaluate(b,{},Y),ta*Z.compositeTextSizes[1].evaluate(b,{},Y)],(be[0]>Ha||be[1]>Ha)&&he(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),a.addSymbols(a.text,le,be,T,_,b,M,i,A.lineStartIndex,A.lineLength,$,Y);for(const Pe of O)N[Pe]=a.text.placedSymbolArray.length-1;return 4*le.length}function rw(a){for(const i in a)return a[i];return null}function I3(a,i,u,f){const g=a.compareText;if(i in g){const _=g[i];for(let b=_.length-1;b>=0;b--)if(f.dist(_[b])<u)return!0}else g[i]=[];return g[i].push(f),!1}const k3=Ga.VectorTileFeature.types,M3=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Kp(a,i,u,f,g,_,b,T,A,M,O,N,$){const Z=T?Math.min(Ha,Math.round(T[0])):0,Y=T?Math.min(Ha,Math.round(T[1])):0;a.emplaceBack(i,u,Math.round(32*f),Math.round(32*g),_,b,(Z<<1)+(A?1:0),Y,16*M,16*O,256*N,256*$)}function x_(a,i,u){a.emplaceBack(i.x,i.y,u),a.emplaceBack(i.x,i.y,u),a.emplaceBack(i.x,i.y,u),a.emplaceBack(i.x,i.y,u)}function L3(a){for(const i of a.sections)if(Ap(i.text))return!0;return!1}class b_{constructor(i){this.layoutVertexArray=new Os,this.indexArray=new mi,this.programConfigurations=i,this.segments=new rn,this.dynamicLayoutVertexArray=new us,this.opacityVertexArray=new Ds,this.placedSymbolArray=new Ge}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(i,u,f,g){this.isEmpty()||(f&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,t3.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,n3.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,M3,!0),this.opacityVertexBuffer.itemSize=1),(f||g)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}dt("SymbolBuffers",b_);class w_{constructor(i,u,f){this.layoutVertexArray=new i,this.layoutAttributes=u,this.indexArray=new f,this.segments=new rn,this.collisionVertexArray=new Zi}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,r3.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}dt("CollisionBuffers",w_);class ou{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(b=>b.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=e_([]),this.placementViewportMatrix=e_([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Hb(this.zoom,u["text-size"]),this.iconSizeData=Hb(this.zoom,u["icon-size"]);const f=this.layers[0].layout,g=f.get("symbol-sort-key"),_=f.get("symbol-z-order");this.canOverlap=T_(f,"text-overlap","text-allow-overlap")!=="never"||T_(f,"icon-overlap","icon-allow-overlap")!=="never"||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(b=>c.WritingMode[b])),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=i.sourceID}createArrays(){this.text=new b_(new Jl(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new b_(new Jl(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new Ke,this.lineVertexArray=new ct,this.symbolInstances=new lt}calculateGlyphDependencies(i,u,f,g,_){for(let b=0;b<i.length;b++)if(u[i.charCodeAt(b)]=!0,(f||g)&&_){const T=od[i.charAt(b)];T&&(u[T.charCodeAt(0)]=!0)}}populate(i,u,f){const g=this.layers[0],_=g.layout,b=_.get("text-font"),T=_.get("text-field"),A=_.get("icon-image"),M=(T.value.kind!=="constant"||T.value.value instanceof fe&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(b.value.kind!=="constant"||b.value.value.length>0),O=A.value.kind!=="constant"||!!A.value.value||Object.keys(A.parameters).length>0,N=_.get("symbol-sort-key");if(this.features=[],!M&&!O)return;const $=u.iconDependencies,Z=u.glyphDependencies,Y=u.availableImages,le=new Xn(this.zoom);for(const{feature:ae,id:be,index:Pe,sourceLayerIndex:ve}of i){const Se=g._featureFilter.needGeometry,Fe=ec(ae,Se);if(!g._featureFilter.filter(le,Fe,f))continue;let ze,ut;if(Se||(Fe.geometry=Ql(ae)),M){const it=g.getValueAndResolveTokens("text-field",Fe,f,Y),Je=fe.factory(it);L3(Je)&&(this.hasRTLText=!0),(!this.hasRTLText||Zl()==="unavailable"||this.hasRTLText&&Xi.isParsed())&&(ze=s3(Je,g,Fe))}if(O){const it=g.getValueAndResolveTokens("icon-image",Fe,f,Y);ut=it instanceof ge?it:ge.fromString(it)}if(!ze&&!ut)continue;const mt=this.sortFeaturesByKey?N.evaluate(Fe,{},f):void 0;if(this.features.push({id:be,text:ze,icon:ut,index:Pe,sourceLayerIndex:ve,geometry:Fe.geometry,properties:ae.properties,type:k3[ae.type],sortKey:mt}),ut&&($[ut.name]=!0),ze){const it=b.evaluate(Fe,{},f).join(","),Je=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(c.WritingMode.vertical)>=0;for(const Xe of ze.sections)if(Xe.image)$[Xe.image.name]=!0;else{const st=Xc(ze.toString()),tt=Xe.fontStack||it,We=Z[tt]=Z[tt]||{};this.calculateGlyphDependencies(Xe.text,We,Je,this.allowVerticalPlacement,st)}}}_.get("symbol-placement")==="line"&&(this.features=function(ae){const be={},Pe={},ve=[];let Se=0;function Fe(it){ve.push(ae[it]),Se++}function ze(it,Je,Xe){const st=Pe[it];return delete Pe[it],Pe[Je]=st,ve[st].geometry[0].pop(),ve[st].geometry[0]=ve[st].geometry[0].concat(Xe[0]),st}function ut(it,Je,Xe){const st=be[Je];return delete be[Je],be[it]=st,ve[st].geometry[0].shift(),ve[st].geometry[0]=Xe[0].concat(ve[st].geometry[0]),st}function mt(it,Je,Xe){const st=Xe?Je[0][Je[0].length-1]:Je[0][0];return`${it}:${st.x}:${st.y}`}for(let it=0;it<ae.length;it++){const Je=ae[it],Xe=Je.geometry,st=Je.text?Je.text.toString():null;if(!st){Fe(it);continue}const tt=mt(st,Xe),We=mt(st,Xe,!0);if(tt in Pe&&We in be&&Pe[tt]!==be[We]){const Ct=ut(tt,We,Xe),bt=ze(tt,We,ve[Ct].geometry);delete be[tt],delete Pe[We],Pe[mt(st,ve[bt].geometry,!0)]=bt,ve[Ct].geometry=null}else tt in Pe?ze(tt,We,Xe):We in be?ut(tt,We,Xe):(Fe(it),be[tt]=Se-1,Pe[We]=Se-1)}return ve.filter(it=>it.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ae,be)=>ae.sortKey-be.sortKey)}update(i,u,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,u,this.layers,f),this.icon.programConfigurations.updatePaintArrays(i,u,this.layers,f))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,u){const f=this.lineVertexArray.length;if(i.segment!==void 0){let g=i.dist(u[i.segment+1]),_=i.dist(u[i.segment]);const b={};for(let T=i.segment+1;T<u.length;T++)b[T]={x:u[T].x,y:u[T].y,tileUnitDistanceFromAnchor:g},T<u.length-1&&(g+=u[T+1].dist(u[T]));for(let T=i.segment||0;T>=0;T--)b[T]={x:u[T].x,y:u[T].y,tileUnitDistanceFromAnchor:_},T>0&&(_+=u[T-1].dist(u[T]));for(let T=0;T<u.length;T++){const A=b[T];this.lineVertexArray.emplaceBack(A.x,A.y,A.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(i,u,f,g,_,b,T,A,M,O,N,$){const Z=i.indexArray,Y=i.layoutVertexArray,le=i.segments.prepareSegment(4*u.length,Y,Z,this.canOverlap?b.sortKey:void 0),ae=this.glyphOffsetArray.length,be=le.vertexLength,Pe=this.allowVerticalPlacement&&T===c.WritingMode.vertical?Math.PI/2:0,ve=b.text&&b.text.sections;for(let Se=0;Se<u.length;Se++){const{tl:Fe,tr:ze,bl:ut,br:mt,tex:it,pixelOffsetTL:Je,pixelOffsetBR:Xe,minFontScaleX:st,minFontScaleY:tt,glyphOffset:We,isSDF:Ct,sectionIndex:bt}=u[Se],Yt=le.vertexLength,$n=We[1];Kp(Y,A.x,A.y,Fe.x,$n+Fe.y,it.x,it.y,f,Ct,Je.x,Je.y,st,tt),Kp(Y,A.x,A.y,ze.x,$n+ze.y,it.x+it.w,it.y,f,Ct,Xe.x,Je.y,st,tt),Kp(Y,A.x,A.y,ut.x,$n+ut.y,it.x,it.y+it.h,f,Ct,Je.x,Xe.y,st,tt),Kp(Y,A.x,A.y,mt.x,$n+mt.y,it.x+it.w,it.y+it.h,f,Ct,Xe.x,Xe.y,st,tt),x_(i.dynamicLayoutVertexArray,A,Pe),Z.emplaceBack(Yt,Yt+1,Yt+2),Z.emplaceBack(Yt+1,Yt+2,Yt+3),le.vertexLength+=4,le.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(We[0]),Se!==u.length-1&&bt===u[Se+1].sectionIndex||i.programConfigurations.populatePaintArrays(Y.length,b,b.index,{},$,ve&&ve[bt])}i.placedSymbolArray.emplaceBack(A.x,A.y,ae,this.glyphOffsetArray.length-ae,be,M,O,A.segment,f?f[0]:0,f?f[1]:0,g[0],g[1],T,0,!1,0,N)}_addCollisionDebugVertex(i,u,f,g,_,b){return u.emplaceBack(0,0),i.emplaceBack(f.x,f.y,g,_,Math.round(b.x),Math.round(b.y))}addCollisionDebugVertices(i,u,f,g,_,b,T){const A=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),M=A.vertexLength,O=_.layoutVertexArray,N=_.collisionVertexArray,$=T.anchorX,Z=T.anchorY;this._addCollisionDebugVertex(O,N,b,$,Z,new Qe(i,u)),this._addCollisionDebugVertex(O,N,b,$,Z,new Qe(f,u)),this._addCollisionDebugVertex(O,N,b,$,Z,new Qe(f,g)),this._addCollisionDebugVertex(O,N,b,$,Z,new Qe(i,g)),A.vertexLength+=4;const Y=_.indexArray;Y.emplaceBack(M,M+1),Y.emplaceBack(M+1,M+2),Y.emplaceBack(M+2,M+3),Y.emplaceBack(M+3,M),A.primitiveLength+=4}addDebugCollisionBoxes(i,u,f,g){for(let _=i;_<u;_++){const b=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(b.x1,b.y1,b.x2,b.y2,g?this.textCollisionBox:this.iconCollisionBox,b.anchorPoint,f)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new w_(Ao,Lb.members,eo),this.iconCollisionBox=new w_(Ao,Lb.members,eo);for(let i=0;i<this.symbolInstances.length;i++){const u=this.symbolInstances.get(i);this.addDebugCollisionBoxes(u.textBoxStartIndex,u.textBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.iconBoxStartIndex,u.iconBoxEndIndex,u,!1),this.addDebugCollisionBoxes(u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u,!1)}}_deserializeCollisionBoxesForSymbol(i,u,f,g,_,b,T,A,M){const O={};for(let N=u;N<f;N++){const $=i.get(N);O.textBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},O.textFeatureIndex=$.featureIndex;break}for(let N=g;N<_;N++){const $=i.get(N);O.verticalTextBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},O.verticalTextFeatureIndex=$.featureIndex;break}for(let N=b;N<T;N++){const $=i.get(N);O.iconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},O.iconFeatureIndex=$.featureIndex;break}for(let N=A;N<M;N++){const $=i.get(N);O.verticalIconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},O.verticalIconFeatureIndex=$.featureIndex;break}return O}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const f=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,u){const f=i.placedSymbolArray.get(u),g=f.vertexStartIndex+4*f.numGlyphs;for(let _=f.vertexStartIndex;_<g;_+=4)i.indexArray.emplaceBack(_,_+1,_+2),i.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(i),f=Math.cos(i),g=[],_=[],b=[];for(let T=0;T<this.symbolInstances.length;++T){b.push(T);const A=this.symbolInstances.get(T);g.push(0|Math.round(u*A.anchorX+f*A.anchorY)),_.push(A.featureIndex)}return b.sort((T,A)=>g[T]-g[A]||_[A]-_[T]),b}addToSortKeyRanges(i,u){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===u?f.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const f=this.symbolInstances.get(u);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach((g,_,b)=>{g>=0&&b.indexOf(g)===_&&this.addIndicesForPlacedSymbol(this.text,g)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}dt("SymbolBucket",ou,{omit:["layers","collisionBoxArray","features","compareText"]}),ou.MAX_GLYPHS=65535,ou.addDynamicAttributes=x_;const R3=new Gr({"symbol-placement":new vt(Re.layout_symbol["symbol-placement"]),"symbol-spacing":new vt(Re.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new vt(Re.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new kt(Re.layout_symbol["symbol-sort-key"]),"symbol-z-order":new vt(Re.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new vt(Re.layout_symbol["icon-allow-overlap"]),"icon-overlap":new vt(Re.layout_symbol["icon-overlap"]),"icon-ignore-placement":new vt(Re.layout_symbol["icon-ignore-placement"]),"icon-optional":new vt(Re.layout_symbol["icon-optional"]),"icon-rotation-alignment":new vt(Re.layout_symbol["icon-rotation-alignment"]),"icon-size":new kt(Re.layout_symbol["icon-size"]),"icon-text-fit":new vt(Re.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new vt(Re.layout_symbol["icon-text-fit-padding"]),"icon-image":new kt(Re.layout_symbol["icon-image"]),"icon-rotate":new kt(Re.layout_symbol["icon-rotate"]),"icon-padding":new kt(Re.layout_symbol["icon-padding"]),"icon-keep-upright":new vt(Re.layout_symbol["icon-keep-upright"]),"icon-offset":new kt(Re.layout_symbol["icon-offset"]),"icon-anchor":new kt(Re.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new vt(Re.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new vt(Re.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new vt(Re.layout_symbol["text-rotation-alignment"]),"text-field":new kt(Re.layout_symbol["text-field"]),"text-font":new kt(Re.layout_symbol["text-font"]),"text-size":new kt(Re.layout_symbol["text-size"]),"text-max-width":new kt(Re.layout_symbol["text-max-width"]),"text-line-height":new vt(Re.layout_symbol["text-line-height"]),"text-letter-spacing":new kt(Re.layout_symbol["text-letter-spacing"]),"text-justify":new kt(Re.layout_symbol["text-justify"]),"text-radial-offset":new kt(Re.layout_symbol["text-radial-offset"]),"text-variable-anchor":new vt(Re.layout_symbol["text-variable-anchor"]),"text-anchor":new kt(Re.layout_symbol["text-anchor"]),"text-max-angle":new vt(Re.layout_symbol["text-max-angle"]),"text-writing-mode":new vt(Re.layout_symbol["text-writing-mode"]),"text-rotate":new kt(Re.layout_symbol["text-rotate"]),"text-padding":new vt(Re.layout_symbol["text-padding"]),"text-keep-upright":new vt(Re.layout_symbol["text-keep-upright"]),"text-transform":new kt(Re.layout_symbol["text-transform"]),"text-offset":new kt(Re.layout_symbol["text-offset"]),"text-allow-overlap":new vt(Re.layout_symbol["text-allow-overlap"]),"text-overlap":new vt(Re.layout_symbol["text-overlap"]),"text-ignore-placement":new vt(Re.layout_symbol["text-ignore-placement"]),"text-optional":new vt(Re.layout_symbol["text-optional"])});var E_={paint:new Gr({"icon-opacity":new kt(Re.paint_symbol["icon-opacity"]),"icon-color":new kt(Re.paint_symbol["icon-color"]),"icon-halo-color":new kt(Re.paint_symbol["icon-halo-color"]),"icon-halo-width":new kt(Re.paint_symbol["icon-halo-width"]),"icon-halo-blur":new kt(Re.paint_symbol["icon-halo-blur"]),"icon-translate":new vt(Re.paint_symbol["icon-translate"]),"icon-translate-anchor":new vt(Re.paint_symbol["icon-translate-anchor"]),"text-opacity":new kt(Re.paint_symbol["text-opacity"]),"text-color":new kt(Re.paint_symbol["text-color"],{runtimeType:Tr,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new kt(Re.paint_symbol["text-halo-color"]),"text-halo-width":new kt(Re.paint_symbol["text-halo-width"]),"text-halo-blur":new kt(Re.paint_symbol["text-halo-blur"]),"text-translate":new vt(Re.paint_symbol["text-translate"]),"text-translate-anchor":new vt(Re.paint_symbol["text-translate-anchor"])}),layout:R3};class iw{constructor(i){if(i.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=i.property.overrides?i.property.overrides.runtimeType:ks,this.defaultValue=i}evaluate(i){if(i.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(i.formattedSection))return u.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}dt("FormatSectionOverride",iw,{omit:["defaultValue"]});class Jp extends Rs{constructor(i){super(i,E_)}recalculate(i,u){if(super.recalculate(i,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const f=this.layout.get("text-writing-mode");if(f){const g=[];for(const _ of f)g.indexOf(_)<0&&g.push(_);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(i,u,f,g){const _=this.layout.get(i).evaluate(u,{},f,g),b=this._unevaluatedLayout._values[i];return b.isDataDriven()||zl(b.value)||!_?_:function(T,A){return A.replace(/{([^{}]+)}/g,(M,O)=>O in T?String(T[O]):"")}(u.properties,_)}createBucket(i){return new ou(i)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const i of E_.paint.overridableProperties){if(!Jp.hasPaintOverride(this.layout,i))continue;const u=this.paint.get(i),f=new iw(u),g=new jc(f,u.property.specification);let _=null;_=u.value.kind==="constant"||u.value.kind==="source"?new Bl("source",g):new Oh("composite",g,u.value.zoomStops),this.paint._values[i]=new Ls(u.property,_,u.parameters)}}_handleOverridablePaintPropertyUpdate(i,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&Jp.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,u){const f=i.get("text-field"),g=E_.paint.properties[u];let _=!1;const b=T=>{for(const A of T)if(g.overrides&&g.overrides.hasOverride(A))return void(_=!0)};if(f.value.kind==="constant"&&f.value.value instanceof fe)b(f.value.value.sections);else if(f.value.kind==="source"){const T=M=>{_||(M instanceof pt&&ke(M.value)===_r?b(M.value.sections):M instanceof Uc?b(M.sections):M.eachChild(T))},A=f.value;A._styleExpression&&T(A._styleExpression.expression)}return _}}function T_(a,i,u){let f="never";const g=a.get(i);return g?f=g:a.get(u)&&(f="always"),f}var O3={paint:new Gr({"background-color":new vt(Re.paint_background["background-color"]),"background-pattern":new Hh(Re.paint_background["background-pattern"]),"background-opacity":new vt(Re.paint_background["background-opacity"])})},D3={paint:new Gr({"raster-opacity":new vt(Re.paint_raster["raster-opacity"]),"raster-hue-rotate":new vt(Re.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new vt(Re.paint_raster["raster-brightness-min"]),"raster-brightness-max":new vt(Re.paint_raster["raster-brightness-max"]),"raster-saturation":new vt(Re.paint_raster["raster-saturation"]),"raster-contrast":new vt(Re.paint_raster["raster-contrast"]),"raster-resampling":new vt(Re.paint_raster["raster-resampling"]),"raster-fade-duration":new vt(Re.paint_raster["raster-fade-duration"])})};class z3 extends Rs{constructor(i){super(i,{}),this.onAdd=u=>{this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},this.onRemove=u=>{this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},this.implementation=i}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const F3={circle:class extends Rs{constructor(a){super(a,pM)}createBucket(a){return new Ky(a)}queryRadius(a){const i=a;return Kh("circle-radius",this,i)+Kh("circle-stroke-width",this,i)+Dp(this.paint.get("circle-translate"))}queryIntersectsFeature(a,i,u,f,g,_,b,T){const A=zp(a,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,b),M=this.paint.get("circle-radius").evaluate(i,u)+this.paint.get("circle-stroke-width").evaluate(i,u),O=this.paint.get("circle-pitch-alignment")==="map",N=O?A:function(Z,Y){return Z.map(le=>mb(le,Y))}(A,T),$=O?M*b:M;for(const Z of f)for(const Y of Z){const le=O?Y:mb(Y,T);let ae=$;const be=Fp([],[Y.x,Y.y,0,1],T);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ae*=be[3]/_.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ae*=_.cameraToCenterDistance/be[3]),cM(N,le,ae))return!0}return!1}},heatmap:class extends Rs{constructor(a){super(a,gM),this._updateColorRamp()}createBucket(a){return new gb(a)}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=_b({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends Rs{constructor(a){super(a,yM)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends Rs{constructor(a){super(a,RM)}recalculate(a,i){super.recalculate(a,i);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new c_(a)}queryRadius(){return Dp(this.paint.get("fill-translate"))}queryIntersectsFeature(a,i,u,f,g,_,b){return ab(zp(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,b),f)}isTileClipped(){return!0}},"fill-extrusion":class extends Rs{constructor(a){super(a,qM)}createBucket(a){return new h_(a)}queryRadius(){return Dp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(a,i,u,f,g,_,b,T){const A=zp(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,b),M=this.paint.get("fill-extrusion-height").evaluate(i,u),O=this.paint.get("fill-extrusion-base").evaluate(i,u),N=function(Z,Y,le,ae){const be=[];for(const Pe of Z){const ve=[Pe.x,Pe.y,0,1];Fp(ve,ve,Y),be.push(new Qe(ve[0]/ve[3],ve[1]/ve[3]))}return be}(A,T),$=function(Z,Y,le,ae){const be=[],Pe=[],ve=ae[8]*Y,Se=ae[9]*Y,Fe=ae[10]*Y,ze=ae[11]*Y,ut=ae[8]*le,mt=ae[9]*le,it=ae[10]*le,Je=ae[11]*le;for(const Xe of Z){const st=[],tt=[];for(const We of Xe){const Ct=We.x,bt=We.y,Yt=ae[0]*Ct+ae[4]*bt+ae[12],$n=ae[1]*Ct+ae[5]*bt+ae[13],Yn=ae[2]*Ct+ae[6]*bt+ae[14],Cr=ae[3]*Ct+ae[7]*bt+ae[15],fs=Yn+Fe,Zr=Cr+ze,xr=Yt+ut,zr=$n+mt,Yr=Yn+it,ii=Cr+Je,Oi=new Qe((Yt+ve)/Zr,($n+Se)/Zr);Oi.z=fs/Zr,st.push(Oi);const br=new Qe(xr/ii,zr/ii);br.z=Yr/ii,tt.push(br)}be.push(st),Pe.push(tt)}return[be,Pe]}(f,O,M,T);return function(Z,Y,le){let ae=1/0;ab(le,Y)&&(ae=Pb(le,Y[0]));for(let be=0;be<Y.length;be++){const Pe=Y[be],ve=Z[be];for(let Se=0;Se<Pe.length-1;Se++){const Fe=Pe[Se],ze=[Fe,Pe[Se+1],ve[Se+1],ve[Se],Fe];ob(le,ze)&&(ae=Math.min(ae,Pb(le,ze)))}}return ae!==1/0&&ae}($[0],$[1],N)}},line:class extends Rs{constructor(a){super(a,Ib),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){a==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Jn,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(a,i){super.recalculate(a,i),this.paint._values["line-floorwidth"]=kb.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new d_(a)}queryRadius(a){const i=a,u=Mb(Kh("line-width",this,i),Kh("line-gap-width",this,i)),f=Kh("line-offset",this,i);return u/2+Math.abs(f)+Dp(this.paint.get("line-translate"))}queryIntersectsFeature(a,i,u,f,g,_,b){const T=zp(a,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,b),A=b/2*Mb(this.paint.get("line-width").evaluate(i,u),this.paint.get("line-gap-width").evaluate(i,u)),M=this.paint.get("line-offset").evaluate(i,u);return M&&(f=function(O,N){const $=[];for(let Z=0;Z<O.length;Z++){const Y=O[Z],le=[];for(let ae=0;ae<Y.length;ae++){const be=Y[ae-1],Pe=Y[ae],ve=Y[ae+1],Se=ae===0?new Qe(0,0):Pe.sub(be)._unit()._perp(),Fe=ae===Y.length-1?new Qe(0,0):ve.sub(Pe)._unit()._perp(),ze=Se._add(Fe)._unit(),ut=ze.x*Fe.x+ze.y*Fe.y;ut!==0&&ze._mult(1/ut),le.push(ze._mult(N)._add(Pe))}$.push(le)}return $}(f,M*b)),function(O,N,$){for(let Z=0;Z<N.length;Z++){const Y=N[Z];if(O.length>=3){for(let le=0;le<Y.length;le++)if(Qc(O,Y[le]))return!0}if(uM(O,Y,$))return!0}return!1}(T,f,A)}isTileClipped(){return!0}},symbol:Jp,background:class extends Rs{constructor(a){super(a,O3)}},raster:class extends Rs{constructor(a){super(a,D3)}}};class B3{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const sw=63710088e-1;class cr{constructor(i,u){if(isNaN(i)||isNaN(u))throw new Error(`Invalid LngLat object: (${i}, ${u})`);if(this.lng=+i,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new cr(z(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const u=Math.PI/180,f=this.lat*u,g=i.lat*u,_=Math.sin(f)*Math.sin(g)+Math.cos(f)*Math.cos(g)*Math.cos((i.lng-this.lng)*u);return sw*Math.acos(Math.min(_,1))}toBounds(i=0){const u=360*i/40075017,f=u/Math.cos(Math.PI/180*this.lat);return new nc(new cr(this.lng-f,this.lat-u),new cr(this.lng+f,this.lat+u))}static convert(i){if(i instanceof cr)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new cr(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new cr(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class nc{constructor(i,u){i&&(u?this.setSouthWest(i).setNorthEast(u):i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))}setNorthEast(i){return this._ne=i instanceof cr?new cr(i.lng,i.lat):cr.convert(i),this}setSouthWest(i){return this._sw=i instanceof cr?new cr(i.lng,i.lat):cr.convert(i),this}extend(i){const u=this._sw,f=this._ne;let g,_;if(i instanceof cr)g=i,_=i;else{if(!(i instanceof nc))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(nc.convert(i)):this.extend(cr.convert(i)):this;if(g=i._sw,_=i._ne,!g||!_)return this}return u||f?(u.lng=Math.min(g.lng,u.lng),u.lat=Math.min(g.lat,u.lat),f.lng=Math.max(_.lng,f.lng),f.lat=Math.max(_.lat,f.lat)):(this._sw=new cr(g.lng,g.lat),this._ne=new cr(_.lng,_.lat)),this}getCenter(){return new cr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new cr(this.getWest(),this.getNorth())}getSouthEast(){return new cr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:u,lat:f}=cr.convert(i);let g=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&g}static convert(i){return i instanceof nc?i:i&&new nc(i)}}const ow=2*Math.PI*sw;function aw(a){return ow*Math.cos(a*Math.PI/180)}function lw(a){return(180+a)/360}function cw(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function uw(a,i){return a/aw(i)}function S_(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}class Qp{constructor(i,u,f=0){this.x=+i,this.y=+u,this.z=+f}static fromLngLat(i,u=0){const f=cr.convert(i);return new Qp(lw(f.lng),cw(f.lat),uw(u,f.lat))}toLngLat(){return new cr(360*this.x-180,S_(this.y))}toAltitude(){return this.z*aw(S_(this.y))}meterInMercatorCoordinateUnits(){return 1/ow*(i=S_(this.y),1/Math.cos(i*Math.PI/180));var i}}function hw(a,i,u){var f=2*Math.PI*6378137/256/Math.pow(2,u);return[a*f-2*Math.PI*6378137/2,i*f-2*Math.PI*6378137/2]}class A_{constructor(i,u,f){if(i<0||i>25||f<0||f>=Math.pow(2,i)||u<0||u>=Math.pow(2,i))throw new Error(`x=${u}, y=${f}, z=${i} outside of bounds. 0<=x<${Math.pow(2,i)}, 0<=y<${Math.pow(2,i)} 0<=z<=25 `);this.z=i,this.x=u,this.y=f,this.key=ld(0,i,i,u,f)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,u,f){const g=(b=this.y,T=this.z,A=hw(256*(_=this.x),256*(b=Math.pow(2,T)-b-1),T),M=hw(256*(_+1),256*(b+1),T),A[0]+","+A[1]+","+M[0]+","+M[1]);var _,b,T,A,M;const O=function(N,$,Z){let Y,le="";for(let ae=N;ae>0;ae--)Y=1<<ae-1,le+=($&Y?1:0)+(Z&Y?2:0);return le}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,u>1?"@2x":"").replace(/{quadkey}/g,O).replace(/{bbox-epsg-3857}/g,g)}isChildOf(i){const u=this.z-i.z;return u>0&&i.x===this.x>>u&&i.y===this.y>>u}getTilePoint(i){const u=Math.pow(2,this.z);return new Qe((i.x*u-this.x)*Pr,(i.y*u-this.y)*Pr)}toString(){return`${this.z}/${this.x}/${this.y}`}}class dw{constructor(i,u){this.wrap=i,this.canonical=u,this.key=ld(i,u.z,u.z,u.x,u.y)}}class ds{constructor(i,u,f,g,_){if(i<f)throw new Error(`overscaledZ should be >= z; overscaledZ = ${i}; z = ${f}`);this.overscaledZ=i,this.wrap=u,this.canonical=new A_(f,+g,+_),this.key=ld(u,i,f,g,_)}clone(){return new ds(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-i;return i>this.canonical.z?new ds(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ds(i,this.wrap,i,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(i,u){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-i;return i>this.canonical.z?ld(this.wrap*+u,i,this.canonical.z,this.canonical.x,this.canonical.y):ld(this.wrap*+u,i,i,this.canonical.x>>f,this.canonical.y>>f)}isChildOf(i){if(i.wrap!==this.wrap)return!1;const u=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>u&&i.canonical.y===this.canonical.y>>u}children(i){if(this.overscaledZ>=i)return[new ds(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,f=2*this.canonical.x,g=2*this.canonical.y;return[new ds(u,this.wrap,u,f,g),new ds(u,this.wrap,u,f+1,g),new ds(u,this.wrap,u,f,g+1),new ds(u,this.wrap,u,f+1,g+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new ds(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new ds(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new dw(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(i){return this.canonical.getTilePoint(new Qp(i.x-this.wrap,i.y))}}function ld(a,i,u,f,g){(a*=2)<0&&(a=-1*a-1);const _=1<<u;return(_*_*a+_*g+f).toString(36)+u.toString(36)+i.toString(36)}dt("CanonicalTileID",A_),dt("OverscaledTileID",ds,{omit:["posMatrix"]});class fw{constructor(i,u,f){if(this.uid=i,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(f&&f!=="mapbox"&&f!=="terrarium")return void he(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=u.height;const g=this.dim=u.height-2;this.data=new Uint32Array(u.data.buffer),this.encoding=f||"mapbox";for(let _=0;_<g;_++)this.data[this._idx(-1,_)]=this.data[this._idx(0,_)],this.data[this._idx(g,_)]=this.data[this._idx(g-1,_)],this.data[this._idx(_,-1)]=this.data[this._idx(_,0)],this.data[this._idx(_,g)]=this.data[this._idx(_,g-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(g,-1)]=this.data[this._idx(g-1,0)],this.data[this._idx(-1,g)]=this.data[this._idx(0,g-1)],this.data[this._idx(g,g)]=this.data[this._idx(g-1,g-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let _=0;_<g;_++)for(let b=0;b<g;b++){const T=this.get(_,b);T>this.max&&(this.max=T),T<this.min&&(this.min=T)}}get(i,u){const f=new Uint8Array(this.data.buffer),g=4*this._idx(i,u);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(f[g],f[g+1],f[g+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(i,u){if(i<-1||i>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(i+1)}_unpackMapbox(i,u,f){return(256*i*256+256*u+f)/10-1e4}_unpackTerrarium(i,u,f){return 256*i+u+f/256-32768}getPixels(){return new hs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(i,u,f){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let g=u*this.dim,_=u*this.dim+this.dim,b=f*this.dim,T=f*this.dim+this.dim;switch(u){case-1:g=_-1;break;case 1:_=g+1}switch(f){case-1:b=T-1;break;case 1:T=b+1}const A=-u*this.dim,M=-f*this.dim;for(let O=b;O<T;O++)for(let N=g;N<_;N++)this.data[this._idx(N,O)]=i.data[this._idx(N+A,O+M)]}}dt("DEMData",fw);class pw{constructor(i){this._stringToNumber={},this._numberToString=[];for(let u=0;u<i.length;u++){const f=i[u];this._stringToNumber[f]=u,this._numberToString[u]=f}}encode(i){return this._stringToNumber[i]}decode(i){if(i>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${i} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[i]}}class mw{constructor(i,u,f,g,_){this.type="Feature",this._vectorTileFeature=i,i._z=u,i._x=f,i._y=g,this.properties=i.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={geometry:this.geometry};for(const u in this)u!=="_geometry"&&u!=="_vectorTileFeature"&&(i[u]=this[u]);return i}}class gw{constructor(i,u){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Xl(Pr,16,0),this.grid3D=new Xl(Pr,16,0),this.featureIndexArray=new Zt,this.promoteId=u}insert(i,u,f,g,_,b){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,g,_);const A=b?this.grid3D:this.grid;for(let M=0;M<u.length;M++){const O=u[M],N=[1/0,1/0,-1/0,-1/0];for(let $=0;$<O.length;$++){const Z=O[$];N[0]=Math.min(N[0],Z.x),N[1]=Math.min(N[1],Z.y),N[2]=Math.max(N[2],Z.x),N[3]=Math.max(N[3],Z.y)}N[0]<Pr&&N[1]<Pr&&N[2]>=0&&N[3]>=0&&A.insert(T,N[0],N[1],N[2],N[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ga.VectorTile(new f_(this.rawTileData)).layers,this.sourceLayerCoder=new pw(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(i,u,f,g){this.loadVTLayers();const _=i.params||{},b=Pr/i.tileSize/i.scale,T=Wc(_.filter),A=i.queryGeometry,M=i.queryPadding*b,O=_w(A),N=this.grid.query(O.minX-M,O.minY-M,O.maxX+M,O.maxY+M),$=_w(i.cameraQueryGeometry),Z=this.grid3D.query($.minX-M,$.minY-M,$.maxX+M,$.maxY+M,(ae,be,Pe,ve)=>function(Se,Fe,ze,ut,mt){for(const Je of Se)if(Fe<=Je.x&&ze<=Je.y&&ut>=Je.x&&mt>=Je.y)return!0;const it=[new Qe(Fe,ze),new Qe(Fe,mt),new Qe(ut,mt),new Qe(ut,ze)];if(Se.length>2){for(const Je of it)if(Qc(Se,Je))return!0}for(let Je=0;Je<Se.length-1;Je++)if(dM(Se[Je],Se[Je+1],it))return!0;return!1}(i.cameraQueryGeometry,ae-M,be-M,Pe+M,ve+M));for(const ae of Z)N.push(ae);N.sort(N3);const Y={};let le;for(let ae=0;ae<N.length;ae++){const be=N[ae];if(be===le)continue;le=be;const Pe=this.featureIndexArray.get(be);let ve=null;this.loadMatchingFeature(Y,Pe.bucketIndex,Pe.sourceLayerIndex,Pe.featureIndex,T,_.layers,_.availableImages,u,f,g,(Se,Fe,ze)=>(ve||(ve=Ql(Se)),Fe.queryIntersectsFeature(A,Se,ze,ve,this.z,i.transform,b,i.pixelPosMatrix)))}return Y}loadMatchingFeature(i,u,f,g,_,b,T,A,M,O,N){const $=this.bucketLayerIDs[u];if(b&&!function(ae,be){for(let Pe=0;Pe<ae.length;Pe++)if(be.indexOf(ae[Pe])>=0)return!0;return!1}(b,$))return;const Z=this.sourceLayerCoder.decode(f),Y=this.vtLayers[Z].feature(g);if(_.needGeometry){const ae=ec(Y,!0);if(!_.filter(new Xn(this.tileID.overscaledZ),ae,this.tileID.canonical))return}else if(!_.filter(new Xn(this.tileID.overscaledZ),Y))return;const le=this.getId(Y,Z);for(let ae=0;ae<$.length;ae++){const be=$[ae];if(b&&b.indexOf(be)<0)continue;const Pe=A[be];if(!Pe)continue;let ve={};le&&O&&(ve=O.getState(Pe.sourceLayer||"_geojsonTileLayer",le));const Se=F({},M[be]);Se.paint=yw(Se.paint,Pe.paint,Y,ve,T),Se.layout=yw(Se.layout,Pe.layout,Y,ve,T);const Fe=!N||N(Y,Pe,ve);if(!Fe)continue;const ze=new mw(Y,this.z,this.x,this.y,le);ze.layer=Se;let ut=i[be];ut===void 0&&(ut=i[be]=[]),ut.push({featureIndex:g,feature:ze,intersectionZ:Fe})}}lookupSymbolFeatures(i,u,f,g,_,b,T,A){const M={};this.loadVTLayers();const O=Wc(_);for(const N of i)this.loadMatchingFeature(M,f,g,N,O,b,T,A,u);return M}hasLayer(i){for(const u of this.bucketLayerIDs)for(const f of u)if(i===f)return!0;return!1}getId(i,u){let f=i.id;return this.promoteId&&(f=i.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[u]],typeof f=="boolean"&&(f=Number(f))),f}}function yw(a,i,u,f,g){return q(a,(_,b)=>{const T=i instanceof Kl?i.get(b):null;return T&&T.evaluate?T.evaluate(u,f,g):T})}function _w(a){let i=1/0,u=1/0,f=-1/0,g=-1/0;for(const _ of a)i=Math.min(i,_.x),u=Math.min(u,_.y),f=Math.max(f,_.x),g=Math.max(g,_.y);return{minX:i,minY:u,maxX:f,maxY:g}}function N3(a,i){return i-a}var P_;dt("FeatureIndex",gw,{omit:["rawTileData","sourceLayerCoder"]}),c.PerformanceMarkers=void 0,(P_=c.PerformanceMarkers||(c.PerformanceMarkers={})).create="create",P_.load="load",P_.fullLoad="fullLoad";let em=null,cd=[];const C_=1e3/30,U3={mark(a){performance.mark(a)},frame(a){const i=a;em!=null&&cd.push(i-em),em=i},clearMetrics(){em=null,cd=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const a in c.PerformanceMarkers)performance.clearMarks(c.PerformanceMarkers[a])},getPerformanceMetrics(){performance.measure("loadTime",c.PerformanceMarkers.create,c.PerformanceMarkers.load),performance.measure("fullLoadTime",c.PerformanceMarkers.create,c.PerformanceMarkers.fullLoad);const a=performance.getEntriesByName("loadTime")[0].duration,i=performance.getEntriesByName("fullLoadTime")[0].duration,u=cd.length,f=1/(cd.reduce((_,b)=>_+b,0)/u/1e3),g=cd.filter(_=>_>C_).reduce((_,b)=>_+(b-C_)/C_,0);return{loadTime:a,fullLoadTime:i,fps:f,percentDroppedFrames:g/(u+g)*100}}};c.AJAXError=Vn,c.ARRAY_TYPE=yi,c.Actor=class{constructor(a,i,u){this.target=a,this.parent=i,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Q(["receive","process"],this),this.invoker=new B3(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Be()?a:window}send(a,i,u,f,g=!1){const _=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[_]=u);const b=yt(this.globalScope)?void 0:[];return this.target.postMessage({id:_,type:a,hasCallback:!!u,targetMapId:f,mustQueue:g,sourceMapId:this.mapId,data:Xo(i,b)},b),{cancel:()=>{u&&delete this.callbacks[_],this.target.postMessage({id:_,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(a){const i=a.data,u=i.id;if(u&&(!i.targetMapId||this.mapId===i.targetMapId))if(i.type==="<cancel>"){delete this.tasks[u];const f=this.cancelCallbacks[u];delete this.cancelCallbacks[u],f&&f()}else Be()||i.mustQueue?(this.tasks[u]=i,this.taskQueue.push(u),this.invoker.trigger()):this.processTask(u,i)}process(){if(!this.taskQueue.length)return;const a=this.taskQueue.shift(),i=this.tasks[a];delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),i&&this.processTask(a,i)}processTask(a,i){if(i.type==="<response>"){const u=this.callbacks[a];delete this.callbacks[a],u&&(i.error?u(bo(i.error)):u(null,bo(i.data)))}else{let u=!1;const f=yt(this.globalScope)?void 0:[],g=i.hasCallback?(T,A)=>{u=!0,delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:T?Xo(T):null,data:Xo(A,f)},f)}:T=>{u=!0};let _=null;const b=bo(i.data);if(this.parent[i.type])_=this.parent[i.type](i.sourceMapId,b,g);else if(this.parent.getWorkerSource){const T=i.type.split(".");_=this.parent.getWorkerSource(i.sourceMapId,T[0],b.source)[T[1]](b,g)}else g(new Error(`Could not find function ${i.type}`));!u&&_&&_.cancel&&(this.cancelCallbacks[a]=_.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},c.AlphaImage=Qh,c.CanonicalTileID=A_,c.CollisionBoxArray=Oe,c.CollisionCircleLayoutArray=class extends D{},c.Color=J,c.DEMData=fw,c.DataConstantProperty=vt,c.DictionaryCoder=pw,c.EXTENT=Pr,c.ErrorEvent=Sn,c.EvaluationParameters=Xn,c.Event=Nt,c.Evented=Ut,c.FeatureIndex=gw,c.FillBucket=c_,c.FillExtrusionBucket=h_,c.GeoJSONFeature=mw,c.ImageAtlas=Ub,c.ImagePosition=m_,c.LineBucket=d_,c.LineStripIndexArray=class extends oe{},c.LngLat=cr,c.LngLatBounds=nc,c.MercatorCoordinate=Qp,c.ONE_EM=$r,c.OverscaledTileID=ds,c.PerformanceUtils=U3,c.PosArray=Pt,c.Properties=Gr,c.QuadTriangleArray=class extends H{},c.RGBAImage=hs,c.RasterBoundsArray=class extends m{},c.RequestPerformance=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},c.ResourceType=In,c.SegmentVector=rn,c.SymbolBucket=ou,c.Transitionable=Ip,c.TriangleIndexArray=mi,c.Uniform1f=Jo,c.Uniform1i=class extends Ko{constructor(a,i){super(a,i),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},c.Uniform2f=class extends Ko{constructor(a,i){super(a,i),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},c.Uniform3f=class extends Ko{constructor(a,i){super(a,i),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},c.Uniform4f=Kc,c.UniformColor=nb,c.UniformMatrix4f=class extends Ko{constructor(a,i){super(a,i),this.current=aM}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let i=1;i<16;i++)if(a[i]!==this.current[i]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},c.UnwrappedTileID=dw,c.ValidationError=je,c.ZoomHistory=Bh,c.add=function(a,i,u){return a[0]=i[0]+u[0],a[1]=i[1]+u[1],a[2]=i[2]+u[2],a},c.addDynamicAttributes=x_,c.asyncAll=function(a,i,u){if(!a.length)return u(null,[]);let f=a.length;const g=new Array(a.length);let _=null;a.forEach((b,T)=>{i(b,(A,M)=>{A&&(_=A),g[T]=M,--f==0&&u(_,g)})})},c.bezier=C,c.bindAll=Q,c.cacheEntryPossiblyAdded=function(a){cn++,cn>tn&&(a.getActor().send("enforceCacheSizeLimit",Ot),cn=0)},c.clamp=S,c.clearTileCache=function(a){const i=caches.delete(et);a&&i.catch(a).then(()=>a())},c.clipLine=Jb,c.clone=function(a){var i=new yi(16);return i[0]=a[0],i[1]=a[1],i[2]=a[2],i[3]=a[3],i[4]=a[4],i[5]=a[5],i[6]=a[6],i[7]=a[7],i[8]=a[8],i[9]=a[9],i[10]=a[10],i[11]=a[11],i[12]=a[12],i[13]=a[13],i[14]=a[14],i[15]=a[15],i},c.clone$1=G,c.clone$2=function(a){var i=new yi(3);return i[0]=a[0],i[1]=a[1],i[2]=a[2],i},c.collisionCircleLayout=i3,c.config=Ne,c.copy=function(a,i){return a[0]=i[0],a[1]=i[1],a[2]=i[2],a[3]=i[3],a[4]=i[4],a[5]=i[5],a[6]=i[6],a[7]=i[7],a[8]=i[8],a[9]=i[9],a[10]=i[10],a[11]=i[11],a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15],a},c.create=function(){var a=new yi(16);return yi!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},c.create$1=ub,c.createExpression=Fl,c.createFilter=Wc,c.createLayout=vr,c.createStyleLayer=function(a){return a.type==="custom"?new z3(a):new F3[a.type](a)},c.cross=function(a,i,u){var f=i[0],g=i[1],_=i[2],b=u[0],T=u[1],A=u[2];return a[0]=g*A-_*T,a[1]=_*b-f*A,a[2]=f*T-g*b,a},c.dot=function(a,i){return a[0]*i[0]+a[1]*i[1]+a[2]*i[2]},c.dot$1=function(a,i){return a[0]*i[0]+a[1]*i[1]+a[2]*i[2]+a[3]*i[3]},c.ease=I,c.emitValidationErrors=qc,c.enforceCacheSizeLimit=function(a){$t(),_t&&_t.then(i=>{i.keys().then(u=>{for(let f=0;f<u.length-a;f++)i.delete(u[f])})})},c.equals=function(a,i){var u=a[0],f=a[1],g=a[2],_=a[3],b=a[4],T=a[5],A=a[6],M=a[7],O=a[8],N=a[9],$=a[10],Z=a[11],Y=a[12],le=a[13],ae=a[14],be=a[15],Pe=i[0],ve=i[1],Se=i[2],Fe=i[3],ze=i[4],ut=i[5],mt=i[6],it=i[7],Je=i[8],Xe=i[9],st=i[10],tt=i[11],We=i[12],Ct=i[13],bt=i[14],Yt=i[15];return Math.abs(u-Pe)<=gi*Math.max(1,Math.abs(u),Math.abs(Pe))&&Math.abs(f-ve)<=gi*Math.max(1,Math.abs(f),Math.abs(ve))&&Math.abs(g-Se)<=gi*Math.max(1,Math.abs(g),Math.abs(Se))&&Math.abs(_-Fe)<=gi*Math.max(1,Math.abs(_),Math.abs(Fe))&&Math.abs(b-ze)<=gi*Math.max(1,Math.abs(b),Math.abs(ze))&&Math.abs(T-ut)<=gi*Math.max(1,Math.abs(T),Math.abs(ut))&&Math.abs(A-mt)<=gi*Math.max(1,Math.abs(A),Math.abs(mt))&&Math.abs(M-it)<=gi*Math.max(1,Math.abs(M),Math.abs(it))&&Math.abs(O-Je)<=gi*Math.max(1,Math.abs(O),Math.abs(Je))&&Math.abs(N-Xe)<=gi*Math.max(1,Math.abs(N),Math.abs(Xe))&&Math.abs($-st)<=gi*Math.max(1,Math.abs($),Math.abs(st))&&Math.abs(Z-tt)<=gi*Math.max(1,Math.abs(Z),Math.abs(tt))&&Math.abs(Y-We)<=gi*Math.max(1,Math.abs(Y),Math.abs(We))&&Math.abs(le-Ct)<=gi*Math.max(1,Math.abs(le),Math.abs(Ct))&&Math.abs(ae-bt)<=gi*Math.max(1,Math.abs(ae),Math.abs(bt))&&Math.abs(be-Yt)<=gi*Math.max(1,Math.abs(be),Math.abs(Yt))},c.evaluateSizeForFeature=function(a,{uSize:i,uSizeT:u},{lowerSize:f,upperSize:g}){return a.kind==="source"?f/ta:a.kind==="composite"?Xt(f/ta,g/ta,u):i},c.evaluateSizeForZoom=function(a,i){let u=0,f=0;if(a.kind==="constant")f=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:g,minZoom:_,maxZoom:b}=a,T=g?S(Mi.interpolationFactor(g,i,_,b),0,1):0;a.kind==="camera"?f=Xt(a.minSize,a.maxSize,T):u=T}return{uSizeT:u,uSize:f}},c.evaluateVariableOffset=tw,c.evented=Wh,c.exported=zt,c.exported$1=sn,c.extend=F,c.filterObject=j,c.fromRotation=function(a,i){var u=Math.sin(i),f=Math.cos(i);return a[0]=f,a[1]=u,a[2]=0,a[3]=-u,a[4]=f,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},c.fromScaling=function(a,i){return a[0]=i[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=i[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=i[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},c.getAnchorAlignment=y_,c.getAnchorJustification=v_,c.getArrayBuffer=Mr,c.getImage=ti,c.getJSON=function(a,i){return Hn(F(a,{type:"json"}),i)},c.getOverlapMode=T_,c.getRTLTextPluginStatus=Zl,c.getReferrer=kr,c.getVideo=function(a,i){const u=window.document.createElement("video");u.muted=!0,u.onloadstart=function(){i(null,u)};for(let f=0;f<a.length;f++){const g=window.document.createElement("source");jn(a[f])||(u.crossOrigin="Anonymous"),g.src=a[f],u.appendChild(g)}return{cancel:()=>{}}},c.identity=e_,c.invert=function(a,i){var u=i[0],f=i[1],g=i[2],_=i[3],b=i[4],T=i[5],A=i[6],M=i[7],O=i[8],N=i[9],$=i[10],Z=i[11],Y=i[12],le=i[13],ae=i[14],be=i[15],Pe=u*T-f*b,ve=u*A-g*b,Se=u*M-_*b,Fe=f*A-g*T,ze=f*M-_*T,ut=g*M-_*A,mt=O*le-N*Y,it=O*ae-$*Y,Je=O*be-Z*Y,Xe=N*ae-$*le,st=N*be-Z*le,tt=$*be-Z*ae,We=Pe*tt-ve*st+Se*Xe+Fe*Je-ze*it+ut*mt;return We?(a[0]=(T*tt-A*st+M*Xe)*(We=1/We),a[1]=(g*st-f*tt-_*Xe)*We,a[2]=(le*ut-ae*ze+be*Fe)*We,a[3]=($*ze-N*ut-Z*Fe)*We,a[4]=(A*Je-b*tt-M*it)*We,a[5]=(u*tt-g*Je+_*it)*We,a[6]=(ae*Se-Y*ut-be*ve)*We,a[7]=(O*ut-$*Se+Z*ve)*We,a[8]=(b*st-T*Je+M*mt)*We,a[9]=(f*Je-u*st-_*mt)*We,a[10]=(Y*ze-le*Se+be*Pe)*We,a[11]=(N*Se-O*ze-Z*Pe)*We,a[12]=(T*it-b*Xe-A*mt)*We,a[13]=(u*Xe-f*it+g*mt)*We,a[14]=(le*ve-Y*Fe-ae*Pe)*We,a[15]=(O*Fe-N*ve+$*Pe)*We,a):null},c.isImageBitmap=ot,c.isSafari=yt,c.isWorker=Be,c.keysDifference=function(a,i){const u=[];for(const f in a)f in i||u.push(f);return u},c.lazyLoadRTLTextPlugin=function(){Xi.isLoading()||Xi.isLoaded()||Zl()!=="deferred"||Cp()},c.makeRequest=Hn,c.mapObject=q,c.mercatorXfromLng=lw,c.mercatorYfromLat=cw,c.mercatorZfromAltitude=uw,c.mul=mM,c.mul$1=function(a,i,u){return a[0]=i[0]*u[0],a[1]=i[1]*u[1],a[2]=i[2]*u[2],a[3]=i[3]*u[3],a},c.multiply=hb,c.nextPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},c.normalize=function(a,i){var u=i[0],f=i[1],g=i[2],_=u*u+f*f+g*g;return _>0&&(_=1/Math.sqrt(_)),a[0]=i[0]*_,a[1]=i[1]*_,a[2]=i[2]*_,a},c.number=Xt,c.ortho=function(a,i,u,f,g,_,b){var T=1/(i-u),A=1/(f-g),M=1/(_-b);return a[0]=-2*T,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*A,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*M,a[11]=0,a[12]=(i+u)*T,a[13]=(g+f)*A,a[14]=(b+_)*M,a[15]=1,a},c.parseCacheControl=Ve,c.parseGlyphPbf=function(a){return new f_(a).readFields(m3,[])},c.pbf=f_,c.performSymbolLayout=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=Pr/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const i=a.bucket.layers[0].layout,u=a.bucket.layers[0]._unevaluatedLayout._values,f={layoutIconSize:u["icon-size"].possiblyEvaluate(new Xn(a.bucket.zoom+1),a.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new Xn(a.bucket.zoom+1),a.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new Xn(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:A,maxZoom:M}=a.bucket.textSizeData;f.compositeTextSizes=[u["text-size"].possiblyEvaluate(new Xn(A),a.canonical),u["text-size"].possiblyEvaluate(new Xn(M),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:A,maxZoom:M}=a.bucket.iconSizeData;f.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new Xn(A),a.canonical),u["icon-size"].possiblyEvaluate(new Xn(M),a.canonical)]}const g=i.get("text-line-height")*$r,_=i.get("text-rotation-alignment")!=="viewport"&&i.get("symbol-placement")!=="point",b=i.get("text-keep-upright"),T=i.get("text-size");for(const A of a.bucket.features){const M=i.get("text-font").evaluate(A,{},a.canonical).join(","),O=T.evaluate(A,{},a.canonical),N=f.layoutTextSize.evaluate(A,{},a.canonical),$=f.layoutIconSize.evaluate(A,{},a.canonical),Z={horizontal:{},vertical:void 0},Y=A.text;let le,ae=[0,0];if(Y){const ve=Y.toString(),Se=i.get("text-letter-spacing").evaluate(A,{},a.canonical)*$r,Fe=Hy(ve)?Se:0,ze=i.get("text-anchor").evaluate(A,{},a.canonical),ut=i.get("text-variable-anchor");if(!ut){const st=i.get("text-radial-offset").evaluate(A,{},a.canonical);ae=st?tw(ze,[st*$r,__]):i.get("text-offset").evaluate(A,{},a.canonical).map(tt=>tt*$r)}let mt=_?"center":i.get("text-justify").evaluate(A,{},a.canonical);const it=i.get("symbol-placement"),Je=it==="point"?i.get("text-max-width").evaluate(A,{},a.canonical)*$r:0,Xe=()=>{a.bucket.allowVerticalPlacement&&Xc(ve)&&(Z.vertical=Wp(Y,a.glyphMap,a.glyphPositions,a.imagePositions,M,Je,g,ze,"left",Fe,ae,c.WritingMode.vertical,!0,it,N,O))};if(!_&&ut){const st=mt==="auto"?ut.map(We=>v_(We)):[mt];let tt=!1;for(let We=0;We<st.length;We++){const Ct=st[We];if(!Z.horizontal[Ct])if(tt)Z.horizontal[Ct]=Z.horizontal[0];else{const bt=Wp(Y,a.glyphMap,a.glyphPositions,a.imagePositions,M,Je,g,"center",Ct,Fe,ae,c.WritingMode.horizontal,!1,it,N,O);bt&&(Z.horizontal[Ct]=bt,tt=bt.positionedLines.length===1)}}Xe()}else{mt==="auto"&&(mt=v_(ze));const st=Wp(Y,a.glyphMap,a.glyphPositions,a.imagePositions,M,Je,g,ze,mt,Fe,ae,c.WritingMode.horizontal,!1,it,N,O);st&&(Z.horizontal[mt]=st),Xe(),Xc(ve)&&_&&b&&(Z.vertical=Wp(Y,a.glyphMap,a.glyphPositions,a.imagePositions,M,Je,g,ze,mt,Fe,ae,c.WritingMode.vertical,!1,it,N,O))}}let be=!1;if(A.icon&&A.icon.name){const ve=a.imageMap[A.icon.name];ve&&(le=b3(a.imagePositions[A.icon.name],i.get("icon-offset").evaluate(A,{},a.canonical),i.get("icon-anchor").evaluate(A,{},a.canonical)),be=!!ve.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=be:a.bucket.sdfIcons!==be&&he("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ve.pixelRatio!==a.bucket.pixelRatio||i.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const Pe=rw(Z.horizontal)||Z.vertical;a.bucket.iconsInText=!!Pe&&Pe.iconsInText,(Pe||le)&&C3(a.bucket,A,Z,le,a.imageMap,f,N,$,ae,be,a.canonical)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},c.perspective=function(a,i,u,f,g){var _,b=1/Math.tan(i/2);return a[0]=b/u,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=b,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,g!=null&&g!==1/0?(a[10]=(g+f)*(_=1/(f-g)),a[14]=2*g*f*_):(a[10]=-1,a[14]=-2*f),a},c.pick=function(a,i){const u={};for(let f=0;f<i.length;f++){const g=i[f];g in a&&(u[g]=a[g])}return u},c.plugin=Xi,c.pointGeometry=Qe,c.polygonIntersectsPolygon=ob,c.potpack=Nb,c.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],c.register=dt,c.registerForPluginStateChange=function(a){return a({pluginStatus:pi,pluginURL:wo}),Wh.on("pluginStateChange",a),a},c.renderColorRamp=_b,c.rotateX=function(a,i,u){var f=Math.sin(u),g=Math.cos(u),_=i[4],b=i[5],T=i[6],A=i[7],M=i[8],O=i[9],N=i[10],$=i[11];return i!==a&&(a[0]=i[0],a[1]=i[1],a[2]=i[2],a[3]=i[3],a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15]),a[4]=_*g+M*f,a[5]=b*g+O*f,a[6]=T*g+N*f,a[7]=A*g+$*f,a[8]=M*g-_*f,a[9]=O*g-b*f,a[10]=N*g-T*f,a[11]=$*g-A*f,a},c.rotateZ=function(a,i,u){var f=Math.sin(u),g=Math.cos(u),_=i[0],b=i[1],T=i[2],A=i[3],M=i[4],O=i[5],N=i[6],$=i[7];return i!==a&&(a[8]=i[8],a[9]=i[9],a[10]=i[10],a[11]=i[11],a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15]),a[0]=_*g+M*f,a[1]=b*g+O*f,a[2]=T*g+N*f,a[3]=A*g+$*f,a[4]=M*g-_*f,a[5]=O*g-b*f,a[6]=N*g-T*f,a[7]=$*g-A*f,a},c.scale=function(a,i,u){var f=u[0],g=u[1],_=u[2];return a[0]=i[0]*f,a[1]=i[1]*f,a[2]=i[2]*f,a[3]=i[3]*f,a[4]=i[4]*g,a[5]=i[5]*g,a[6]=i[6]*g,a[7]=i[7]*g,a[8]=i[8]*_,a[9]=i[9]*_,a[10]=i[10]*_,a[11]=i[11]*_,a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15],a},c.scale$1=function(a,i,u){return a[0]=i[0]*u,a[1]=i[1]*u,a[2]=i[2]*u,a},c.setCacheLimits=function(a,i){Ot=a,tn=i},c.setRTLTextPlugin=function(a,i,u=!1){if(pi===Vh||pi===jh||pi===Gh)throw new Error("setRTLTextPlugin cannot be called multiple times.");wo=zt.resolveURL(a),pi=Vh,$h=i,Na(),u||Cp()},c.spec=Re,c.sphericalToCartesian=function([a,i,u]){return i+=90,i*=Math.PI/180,u*=Math.PI/180,{x:a*Math.cos(i)*Math.sin(u),y:a*Math.sin(i)*Math.sin(u),z:a*Math.cos(u)}},c.sqrLen=function(a){var i=a[0],u=a[1];return i*i+u*u},c.sub=function(a,i,u){return a[0]=i[0]-u[0],a[1]=i[1]-u[1],a[2]=i[2]-u[2],a},c.toEvaluationFeature=ec,c.transformMat3=function(a,i,u){var f=i[0],g=i[1],_=i[2];return a[0]=f*u[0]+g*u[3]+_*u[6],a[1]=f*u[1]+g*u[4]+_*u[7],a[2]=f*u[2]+g*u[5]+_*u[8],a},c.transformMat4=Fp,c.transformMat4$1=function(a,i,u){var f=i[0],g=i[1];return a[0]=u[0]*f+u[4]*g+u[12],a[1]=u[1]*f+u[5]*g+u[13],a},c.translate=function(a,i,u){var f,g,_,b,T,A,M,O,N,$,Z,Y,le=u[0],ae=u[1],be=u[2];return i===a?(a[12]=i[0]*le+i[4]*ae+i[8]*be+i[12],a[13]=i[1]*le+i[5]*ae+i[9]*be+i[13],a[14]=i[2]*le+i[6]*ae+i[10]*be+i[14],a[15]=i[3]*le+i[7]*ae+i[11]*be+i[15]):(g=i[1],_=i[2],b=i[3],T=i[4],A=i[5],M=i[6],O=i[7],N=i[8],$=i[9],Z=i[10],Y=i[11],a[0]=f=i[0],a[1]=g,a[2]=_,a[3]=b,a[4]=T,a[5]=A,a[6]=M,a[7]=O,a[8]=N,a[9]=$,a[10]=Z,a[11]=Y,a[12]=f*le+T*ae+N*be+i[12],a[13]=g*le+A*ae+$*be+i[13],a[14]=_*le+M*ae+Z*be+i[14],a[15]=b*le+O*ae+Y*be+i[15]),a},c.triggerPluginCompletionEvent=Pp,c.unicodeBlockLookup=rt,c.uniqueId=function(){return B++},c.validateCustomStyleLayer=function(a){const i=[],u=a.id;return u===void 0&&i.push({message:`layers.${u}: missing required property "id"`}),a.render===void 0&&i.push({message:`layers.${u}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&i.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),i},c.validateLight=Fh,c.validateStyle=ql,c.vectorTile=Ga,c.warnOnce=he,c.wrap=z}),l(["./shared"],function(c){function v(te){const R=typeof te;if(R==="number"||R==="boolean"||R==="string"||te==null)return JSON.stringify(te);if(Array.isArray(te)){let J="[";for(const ue of te)J+=`${v(ue)},`;return`${J}]`}const U=Object.keys(te).sort();let K="{";for(let J=0;J<U.length;J++)K+=`${JSON.stringify(U[J])}:${v(te[U[J]])},`;return`${K}}`}function w(te){let R="";for(const U of c.refProperties)R+=`/${v(te[U])}`;return R}class C{constructor(R){this.keyCache={},R&&this.replace(R)}replace(R){this._layerConfigs={},this._layers={},this.update(R,[])}update(R,U){for(const J of R){this._layerConfigs[J.id]=J;const ue=this._layers[J.id]=c.createStyleLayer(J);ue._featureFilter=c.createFilter(ue.filter),this.keyCache[J.id]&&delete this.keyCache[J.id]}for(const J of U)delete this.keyCache[J],delete this._layerConfigs[J],delete this._layers[J];this.familiesBySource={};const K=function(J,ue){const me={};for(let ce=0;ce<J.length;ce++){const ge=ue&&ue[J[ce].id]||w(J[ce]);ue&&(ue[J[ce].id]=ge);let Me=me[ge];Me||(Me=me[ge]=[]),Me.push(J[ce])}const fe=[];for(const ce in me)fe.push(me[ce]);return fe}(Object.values(this._layerConfigs),this.keyCache);for(const J of K){const ue=J.map(Ue=>this._layers[Ue.id]),me=ue[0];if(me.visibility==="none")continue;const fe=me.source||"";let ce=this.familiesBySource[fe];ce||(ce=this.familiesBySource[fe]={});const ge=me.sourceLayer||"_geojsonTileLayer";let Me=ce[ge];Me||(Me=ce[ge]=[]),Me.push(ue)}}}class I{constructor(R){const U={},K=[];for(const fe in R){const ce=R[fe],ge=U[fe]={};for(const Me in ce){const Ue=ce[+Me];if(!Ue||Ue.bitmap.width===0||Ue.bitmap.height===0)continue;const ke={x:0,y:0,w:Ue.bitmap.width+2,h:Ue.bitmap.height+2};K.push(ke),ge[Me]={rect:ke,metrics:Ue.metrics}}}const{w:J,h:ue}=c.potpack(K),me=new c.AlphaImage({width:J||1,height:ue||1});for(const fe in R){const ce=R[fe];for(const ge in ce){const Me=ce[+ge];if(!Me||Me.bitmap.width===0||Me.bitmap.height===0)continue;const Ue=U[fe][ge].rect;c.AlphaImage.copy(Me.bitmap,me,{x:0,y:0},{x:Ue.x+1,y:Ue.y+1},Me.bitmap)}}this.image=me,this.positions=U}}c.register("GlyphAtlas",I);class S{constructor(R){this.tileID=new c.OverscaledTileID(R.tileID.overscaledZ,R.tileID.wrap,R.tileID.canonical.z,R.tileID.canonical.x,R.tileID.canonical.y),this.uid=R.uid,this.zoom=R.zoom,this.pixelRatio=R.pixelRatio,this.tileSize=R.tileSize,this.source=R.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=R.showCollisionBoxes,this.collectResourceTiming=!!R.collectResourceTiming,this.returnDependencies=!!R.returnDependencies,this.promoteId=R.promoteId}parse(R,U,K,J,ue){this.status="parsing",this.data=R,this.collisionBoxArray=new c.CollisionBoxArray;const me=new c.DictionaryCoder(Object.keys(R.layers).sort()),fe=new c.FeatureIndex(this.tileID,this.promoteId);fe.bucketLayerIDs=[];const ce={},ge={featureIndex:fe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:K},Me=U.familiesBySource[this.source];for(const It in Me){const Lt=R.layers[It];if(!Lt)continue;Lt.version===1&&c.warnOnce(`Vector tile source "${this.source}" layer "${It}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Qt=me.encode(It),on=[];for(let Mn=0;Mn<Lt.length;Mn++){const Ln=Lt.feature(Mn),Sr=fe.getId(Ln,It);on.push({feature:Ln,id:Sr,index:Mn,sourceLayerIndex:Qt})}for(const Mn of Me[It]){const Ln=Mn[0];Ln.source!==this.source&&c.warnOnce(`layer.source = ${Ln.source} does not equal this.source = ${this.source}`),Ln.minzoom&&this.zoom<Math.floor(Ln.minzoom)||Ln.maxzoom&&this.zoom>=Ln.maxzoom||Ln.visibility!=="none"&&(z(Mn,this.zoom,K),(ce[Ln.id]=Ln.createBucket({index:fe.bucketLayerIDs.length,layers:Mn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Qt,sourceID:this.source})).populate(on,ge,this.tileID.canonical),fe.bucketLayerIDs.push(Mn.map(Sr=>Sr.id)))}}let Ue,ke,ht,pt;const nt=c.mapObject(ge.glyphDependencies,It=>Object.keys(It).map(Number));Object.keys(nt).length?J.send("getGlyphs",{uid:this.uid,stacks:nt},(It,Lt)=>{Ue||(Ue=It,ke=Lt,qt.call(this))}):ke={};const At=Object.keys(ge.iconDependencies);At.length?J.send("getImages",{icons:At,source:this.source,tileID:this.tileID,type:"icons"},(It,Lt)=>{Ue||(Ue=It,ht=Lt,qt.call(this))}):ht={};const xt=Object.keys(ge.patternDependencies);function qt(){if(Ue)return ue(Ue);if(ke&&ht&&pt){const It=new I(ke),Lt=new c.ImageAtlas(ht,pt);for(const Qt in ce){const on=ce[Qt];on instanceof c.SymbolBucket?(z(on.layers,this.zoom,K),c.performSymbolLayout({bucket:on,glyphMap:ke,glyphPositions:It.positions,imageMap:ht,imagePositions:Lt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):on.hasPattern&&(on instanceof c.LineBucket||on instanceof c.FillBucket||on instanceof c.FillExtrusionBucket)&&(z(on.layers,this.zoom,K),on.addFeatures(ge,this.tileID.canonical,Lt.patternPositions))}this.status="done",ue(null,{buckets:Object.values(ce).filter(Qt=>!Qt.isEmpty()),featureIndex:fe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:It.image,imageAtlas:Lt,glyphMap:this.returnDependencies?ke:null,iconMap:this.returnDependencies?ht:null,glyphPositions:this.returnDependencies?It.positions:null})}}xt.length?J.send("getImages",{icons:xt,source:this.source,tileID:this.tileID,type:"patterns"},(It,Lt)=>{Ue||(Ue=It,pt=Lt,qt.call(this))}):pt={},qt.call(this)}}function z(te,R,U){const K=new c.EvaluationParameters(R);for(const J of te)J.recalculate(K,U)}function F(te,R){const U=c.getArrayBuffer(te.request,(K,J,ue,me)=>{K?R(K):J&&R(null,{vectorTile:new c.vectorTile.VectorTile(new c.pbf(J)),rawData:J,cacheControl:ue,expires:me})});return()=>{U.cancel(),R()}}class B{constructor(R,U,K,J){this.actor=R,this.layerIndex=U,this.availableImages=K,this.loadVectorData=J||F,this.loading={},this.loaded={}}loadTile(R,U){const K=R.uid;this.loading||(this.loading={});const J=!!(R&&R.request&&R.request.collectResourceTiming)&&new c.RequestPerformance(R.request),ue=this.loading[K]=new S(R);ue.abort=this.loadVectorData(R,(me,fe)=>{if(delete this.loading[K],me||!fe)return ue.status="done",this.loaded[K]=ue,U(me);const ce=fe.rawData,ge={};fe.expires&&(ge.expires=fe.expires),fe.cacheControl&&(ge.cacheControl=fe.cacheControl);const Me={};if(J){const Ue=J.finish();Ue&&(Me.resourceTiming=JSON.parse(JSON.stringify(Ue)))}ue.vectorTile=fe.vectorTile,ue.parse(fe.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ue,ke)=>{if(Ue||!ke)return U(Ue);U(null,c.extend({rawTileData:ce.slice(0)},ke,ge,Me))}),this.loaded=this.loaded||{},this.loaded[K]=ue})}reloadTile(R,U){const K=this.loaded,J=R.uid,ue=this;if(K&&K[J]){const me=K[J];me.showCollisionBoxes=R.showCollisionBoxes;const fe=(ce,ge)=>{const Me=me.reloadCallback;Me&&(delete me.reloadCallback,me.parse(me.vectorTile,ue.layerIndex,this.availableImages,ue.actor,Me)),U(ce,ge)};me.status==="parsing"?me.reloadCallback=fe:me.status==="done"&&(me.vectorTile?me.parse(me.vectorTile,this.layerIndex,this.availableImages,this.actor,fe):fe())}}abortTile(R,U){const K=this.loading,J=R.uid;K&&K[J]&&K[J].abort&&(K[J].abort(),delete K[J]),U()}removeTile(R,U){const K=this.loaded,J=R.uid;K&&K[J]&&delete K[J],U()}}class Q{constructor(){this.loaded={}}loadTile(R,U){const{uid:K,encoding:J,rawImageData:ue}=R,me=c.isImageBitmap(ue)?this.getImageData(ue):ue,fe=new c.DEMData(K,me,J);this.loaded=this.loaded||{},this.loaded[K]=fe,U(null,fe)}getImageData(R){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(R.width,R.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=R.width,this.offscreenCanvas.height=R.height,this.offscreenCanvasContext.drawImage(R,0,0,R.width,R.height);const U=this.offscreenCanvasContext.getImageData(-1,-1,R.width+2,R.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new c.RGBAImage({width:U.width,height:U.height},U.data)}removeTile(R){const U=this.loaded,K=R.uid;U&&U[K]&&delete U[K]}}var q=function te(R,U){var K,J=R&&R.type;if(J==="FeatureCollection")for(K=0;K<R.features.length;K++)te(R.features[K],U);else if(J==="GeometryCollection")for(K=0;K<R.geometries.length;K++)te(R.geometries[K],U);else if(J==="Feature")te(R.geometry,U);else if(J==="Polygon")j(R.coordinates,U);else if(J==="MultiPolygon")for(K=0;K<R.coordinates.length;K++)j(R.coordinates[K],U);return R};function j(te,R){if(te.length!==0){G(te[0],R);for(var U=1;U<te.length;U++)G(te[U],!R)}}function G(te,R){for(var U=0,K=0,J=0,ue=te.length,me=ue-1;J<ue;me=J++){var fe=(te[J][0]-te[me][0])*(te[me][1]+te[J][1]),ce=U+fe;K+=Math.abs(U)>=Math.abs(fe)?U-ce+fe:fe-ce+U,U=ce}U+K>=0!=!!R&&te.reverse()}const se=c.vectorTile.VectorTileFeature.prototype.toGeoJSON;class he{constructor(R){this._feature=R,this.extent=c.EXTENT,this.type=R.type,this.properties=R.tags,"id"in R&&!isNaN(R.id)&&(this.id=parseInt(R.id,10))}loadGeometry(){if(this._feature.type===1){const R=[];for(const U of this._feature.geometry)R.push([new c.pointGeometry(U[0],U[1])]);return R}{const R=[];for(const U of this._feature.geometry){const K=[];for(const J of U)K.push(new c.pointGeometry(J[0],J[1]));R.push(K)}return R}}toGeoJSON(R,U,K){return se.call(this,R,U,K)}}class ye{constructor(R){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=c.EXTENT,this.length=R.length,this._features=R}feature(R){return new he(this._features[R])}}var we={exports:{}},Be=c.pointGeometry,Ve=c.vectorTile.VectorTileFeature,xe=He;function He(te,R){this.options=R||{},this.features=te,this.length=te.length}function wt(te,R){this.id=typeof te.id=="number"?te.id:void 0,this.type=te.type,this.rawGeometry=te.type===1?[te.geometry]:te.geometry,this.properties=te.tags,this.extent=R||4096}He.prototype.feature=function(te){return new wt(this.features[te],this.options.extent)},wt.prototype.loadGeometry=function(){var te=this.rawGeometry;this.geometry=[];for(var R=0;R<te.length;R++){for(var U=te[R],K=[],J=0;J<U.length;J++)K.push(new Be(U[J][0],U[J][1]));this.geometry.push(K)}return this.geometry},wt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var te=this.geometry,R=1/0,U=-1/0,K=1/0,J=-1/0,ue=0;ue<te.length;ue++)for(var me=te[ue],fe=0;fe<me.length;fe++){var ce=me[fe];R=Math.min(R,ce.x),U=Math.max(U,ce.x),K=Math.min(K,ce.y),J=Math.max(J,ce.y)}return[R,K,U,J]},wt.prototype.toGeoJSON=Ve.prototype.toGeoJSON;var yt=c.pbf,ot=xe;function zt(te){var R=new yt;return function(U,K){for(var J in U.layers)K.writeMessage(3,Qe,U.layers[J])}(te,R),R.finish()}function Qe(te,R){var U;R.writeVarintField(15,te.version||1),R.writeStringField(1,te.name||""),R.writeVarintField(5,te.extent||4096);var K={keys:[],values:[],keycache:{},valuecache:{}};for(U=0;U<te.length;U++)K.feature=te.feature(U),R.writeMessage(2,yn,K);var J=K.keys;for(U=0;U<J.length;U++)R.writeStringField(3,J[U]);var ue=K.values;for(U=0;U<ue.length;U++)R.writeMessage(4,Ot,ue[U])}function yn(te,R){var U=te.feature;U.id!==void 0&&R.writeVarintField(1,U.id),R.writeMessage(2,Ne,te),R.writeVarintField(3,U.type),R.writeMessage(4,at,U)}function Ne(te,R){var U=te.feature,K=te.keys,J=te.values,ue=te.keycache,me=te.valuecache;for(var fe in U.properties){var ce=U.properties[fe],ge=ue[fe];if(ce!==null){ge===void 0&&(K.push(fe),ue[fe]=ge=K.length-1),R.writeVarint(ge);var Me=typeof ce;Me!=="string"&&Me!=="boolean"&&Me!=="number"&&(ce=JSON.stringify(ce));var Ue=Me+":"+ce,ke=me[Ue];ke===void 0&&(J.push(ce),me[Ue]=ke=J.length-1),R.writeVarint(ke)}}}function et(te,R){return(R<<3)+(7&te)}function _t(te){return te<<1^te>>31}function at(te,R){for(var U=te.loadGeometry(),K=te.type,J=0,ue=0,me=U.length,fe=0;fe<me;fe++){var ce=U[fe],ge=1;K===1&&(ge=ce.length),R.writeVarint(et(1,ge));for(var Me=K===3?ce.length-1:ce.length,Ue=0;Ue<Me;Ue++){Ue===1&&K!==1&&R.writeVarint(et(2,Me-1));var ke=ce[Ue].x-J,ht=ce[Ue].y-ue;R.writeVarint(_t(ke)),R.writeVarint(_t(ht)),J+=ke,ue+=ht}K===3&&R.writeVarint(et(7,1))}}function Ot(te,R){var U=typeof te;U==="string"?R.writeStringField(1,te):U==="boolean"?R.writeBooleanField(7,te):U==="number"&&(te%1!=0?R.writeDoubleField(3,te):te<0?R.writeSVarintField(6,te):R.writeVarintField(5,te))}function tn(te,R,U,K,J,ue){if(J-K<=U)return;const me=K+J>>1;$t(te,R,me,K,J,ue%2),tn(te,R,U,K,me-1,ue+1),tn(te,R,U,me+1,J,ue+1)}function $t(te,R,U,K,J,ue){for(;J>K;){if(J-K>600){const ge=J-K+1,Me=U-K+1,Ue=Math.log(ge),ke=.5*Math.exp(2*Ue/3),ht=.5*Math.sqrt(Ue*ke*(ge-ke)/ge)*(Me-ge/2<0?-1:1);$t(te,R,U,Math.max(K,Math.floor(U-Me*ke/ge+ht)),Math.min(J,Math.floor(U+(ge-Me)*ke/ge+ht)),ue)}const me=R[2*U+ue];let fe=K,ce=J;for(cn(te,R,K,U),R[2*J+ue]>me&&cn(te,R,K,J);fe<ce;){for(cn(te,R,fe,ce),fe++,ce--;R[2*fe+ue]<me;)fe++;for(;R[2*ce+ue]>me;)ce--}R[2*K+ue]===me?cn(te,R,K,ce):(ce++,cn(te,R,ce,J)),ce<=U&&(K=ce+1),U<=ce&&(J=ce-1)}}function cn(te,R,U,K){sn(te,U,K),sn(R,2*U,2*K),sn(R,2*U+1,2*K+1)}function sn(te,R,U){const K=te[R];te[R]=te[U],te[U]=K}function Bt(te,R,U,K){const J=te-U,ue=R-K;return J*J+ue*ue}we.exports=zt,we.exports.fromVectorTileJs=zt,we.exports.fromGeojsonVt=function(te,R){R=R||{};var U={};for(var K in te)U[K]=new ot(te[K].features,R),U[K].name=K,U[K].version=R.version,U[K].extent=R.extent;return zt({layers:U})},we.exports.GeoJSONWrapper=ot;const fn=te=>te[0],jt=te=>te[1];class Kt{constructor(R,U=fn,K=jt,J=64,ue=Float64Array){this.nodeSize=J,this.points=R;const me=R.length<65536?Uint16Array:Uint32Array,fe=this.ids=new me(R.length),ce=this.coords=new ue(2*R.length);for(let ge=0;ge<R.length;ge++)fe[ge]=ge,ce[2*ge]=U(R[ge]),ce[2*ge+1]=K(R[ge]);tn(fe,ce,J,0,fe.length-1,0)}range(R,U,K,J){return function(ue,me,fe,ce,ge,Me,Ue){const ke=[0,ue.length-1,0],ht=[];let pt,nt;for(;ke.length;){const At=ke.pop(),xt=ke.pop(),qt=ke.pop();if(xt-qt<=Ue){for(let Qt=qt;Qt<=xt;Qt++)pt=me[2*Qt],nt=me[2*Qt+1],pt>=fe&&pt<=ge&&nt>=ce&&nt<=Me&&ht.push(ue[Qt]);continue}const It=Math.floor((qt+xt)/2);pt=me[2*It],nt=me[2*It+1],pt>=fe&&pt<=ge&&nt>=ce&&nt<=Me&&ht.push(ue[It]);const Lt=(At+1)%2;(At===0?fe<=pt:ce<=nt)&&(ke.push(qt),ke.push(It-1),ke.push(Lt)),(At===0?ge>=pt:Me>=nt)&&(ke.push(It+1),ke.push(xt),ke.push(Lt))}return ht}(this.ids,this.coords,R,U,K,J,this.nodeSize)}within(R,U,K){return function(J,ue,me,fe,ce,ge){const Me=[0,J.length-1,0],Ue=[],ke=ce*ce;for(;Me.length;){const ht=Me.pop(),pt=Me.pop(),nt=Me.pop();if(pt-nt<=ge){for(let Lt=nt;Lt<=pt;Lt++)Bt(ue[2*Lt],ue[2*Lt+1],me,fe)<=ke&&Ue.push(J[Lt]);continue}const At=Math.floor((nt+pt)/2),xt=ue[2*At],qt=ue[2*At+1];Bt(xt,qt,me,fe)<=ke&&Ue.push(J[At]);const It=(ht+1)%2;(ht===0?me-ce<=xt:fe-ce<=qt)&&(Me.push(nt),Me.push(At-1),Me.push(It)),(ht===0?me+ce>=xt:fe+ce>=qt)&&(Me.push(At+1),Me.push(pt),Me.push(It))}return Ue}(this.ids,this.coords,R,U,K,this.nodeSize)}}const Wn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:te=>te},In=Math.fround||(Vn=new Float32Array(1),te=>(Vn[0]=+te,Vn[0]));var Vn;class kr{constructor(R){this.options=ti(Object.create(Wn),R),this.trees=new Array(this.options.maxZoom+1)}load(R){const{log:U,minZoom:K,maxZoom:J,nodeSize:ue}=this.options;U&&console.time("total time");const me=`prepare ${R.length} points`;U&&console.time(me),this.points=R;let fe=[];for(let ce=0;ce<R.length;ce++)R[ce].geometry&&fe.push(Hn(R[ce],ce));this.trees[J+1]=new Kt(fe,Wt,nn,ue,Float32Array),U&&console.timeEnd(me);for(let ce=J;ce>=K;ce--){const ge=+Date.now();fe=this._cluster(fe,ce),this.trees[ce]=new Kt(fe,Wt,nn,ue,Float32Array),U&&console.log("z%d: %d clusters in %dms",ce,fe.length,+Date.now()-ge)}return U&&console.timeEnd("total time"),this}getClusters(R,U){let K=((R[0]+180)%360+360)%360-180;const J=Math.max(-90,Math.min(90,R[1]));let ue=R[2]===180?180:((R[2]+180)%360+360)%360-180;const me=Math.max(-90,Math.min(90,R[3]));if(R[2]-R[0]>=360)K=-180,ue=180;else if(K>ue){const Me=this.getClusters([K,J,180,me],U),Ue=this.getClusters([-180,J,ue,me],U);return Me.concat(Ue)}const fe=this.trees[this._limitZoom(U)],ce=fe.range(Jt(K),On(me),Jt(ue),On(J)),ge=[];for(const Me of ce){const Ue=fe.points[Me];ge.push(Ue.numPoints?Mr(Ue):this.points[Ue.index])}return ge}getChildren(R){const U=this._getOriginId(R),K=this._getOriginZoom(R),J="No cluster with the specified id.",ue=this.trees[K];if(!ue)throw new Error(J);const me=ue.points[U];if(!me)throw new Error(J);const fe=this.options.radius/(this.options.extent*Math.pow(2,K-1)),ce=ue.within(me.x,me.y,fe),ge=[];for(const Me of ce){const Ue=ue.points[Me];Ue.parentId===R&&ge.push(Ue.numPoints?Mr(Ue):this.points[Ue.index])}if(ge.length===0)throw new Error(J);return ge}getLeaves(R,U,K){const J=[];return this._appendLeaves(J,R,U=U||10,K=K||0,0),J}getTile(R,U,K){const J=this.trees[this._limitZoom(R)],ue=Math.pow(2,R),{extent:me,radius:fe}=this.options,ce=fe/me,ge=(K-ce)/ue,Me=(K+1+ce)/ue,Ue={features:[]};return this._addTileFeatures(J.range((U-ce)/ue,ge,(U+1+ce)/ue,Me),J.points,U,K,ue,Ue),U===0&&this._addTileFeatures(J.range(1-ce/ue,ge,1,Me),J.points,ue,K,ue,Ue),U===ue-1&&this._addTileFeatures(J.range(0,ge,ce/ue,Me),J.points,-1,K,ue,Ue),Ue.features.length?Ue:null}getClusterExpansionZoom(R){let U=this._getOriginZoom(R)-1;for(;U<=this.options.maxZoom;){const K=this.getChildren(R);if(U++,K.length!==1)break;R=K[0].properties.cluster_id}return U}_appendLeaves(R,U,K,J,ue){const me=this.getChildren(U);for(const fe of me){const ce=fe.properties;if(ce&&ce.cluster?ue+ce.point_count<=J?ue+=ce.point_count:ue=this._appendLeaves(R,ce.cluster_id,K,J,ue):ue<J?ue++:R.push(fe),R.length===K)break}return ue}_addTileFeatures(R,U,K,J,ue,me){for(const fe of R){const ce=U[fe],ge=ce.numPoints;let Me,Ue,ke;if(ge)Me=jn(ce),Ue=ce.x,ke=ce.y;else{const nt=this.points[ce.index];Me=nt.properties,Ue=Jt(nt.geometry.coordinates[0]),ke=On(nt.geometry.coordinates[1])}const ht={type:1,geometry:[[Math.round(this.options.extent*(Ue*ue-K)),Math.round(this.options.extent*(ke*ue-J))]],tags:Me};let pt;ge?pt=ce.id:this.options.generateId?pt=ce.index:this.points[ce.index].id&&(pt=this.points[ce.index].id),pt!==void 0&&(ht.id=pt),me.features.push(ht)}}_limitZoom(R){return Math.max(this.options.minZoom,Math.min(Math.floor(+R),this.options.maxZoom+1))}_cluster(R,U){const K=[],{radius:J,extent:ue,reduce:me,minPoints:fe}=this.options,ce=J/(ue*Math.pow(2,U));for(let ge=0;ge<R.length;ge++){const Me=R[ge];if(Me.zoom<=U)continue;Me.zoom=U;const Ue=this.trees[U+1],ke=Ue.within(Me.x,Me.y,ce),ht=Me.numPoints||1;let pt=ht;for(const nt of ke){const At=Ue.points[nt];At.zoom>U&&(pt+=At.numPoints||1)}if(pt>ht&&pt>=fe){let nt=Me.x*ht,At=Me.y*ht,xt=me&&ht>1?this._map(Me,!0):null;const qt=(ge<<5)+(U+1)+this.points.length;for(const It of ke){const Lt=Ue.points[It];if(Lt.zoom<=U)continue;Lt.zoom=U;const Qt=Lt.numPoints||1;nt+=Lt.x*Qt,At+=Lt.y*Qt,Lt.parentId=qt,me&&(xt||(xt=this._map(Me,!0)),me(xt,this._map(Lt)))}Me.parentId=qt,K.push(or(nt/pt,At/pt,qt,pt,xt))}else if(K.push(Me),pt>1)for(const nt of ke){const At=Ue.points[nt];At.zoom<=U||(At.zoom=U,K.push(At))}}return K}_getOriginId(R){return R-this.points.length>>5}_getOriginZoom(R){return(R-this.points.length)%32}_map(R,U){if(R.numPoints)return U?ti({},R.properties):R.properties;const K=this.points[R.index].properties,J=this.options.map(K);return U&&J===K?ti({},J):J}}function or(te,R,U,K,J){return{x:In(te),y:In(R),zoom:1/0,id:U,parentId:-1,numPoints:K,properties:J}}function Hn(te,R){const[U,K]=te.geometry.coordinates;return{x:In(Jt(U)),y:In(On(K)),zoom:1/0,index:R,parentId:-1}}function Mr(te){return{type:"Feature",id:te.id,properties:jn(te),geometry:{type:"Point",coordinates:[(R=te.x,360*(R-.5)),kn(te.y)]}};var R}function jn(te){const R=te.numPoints,U=R>=1e4?`${Math.round(R/1e3)}k`:R>=1e3?Math.round(R/100)/10+"k":R;return ti(ti({},te.properties),{cluster:!0,cluster_id:te.id,point_count:R,point_count_abbreviated:U})}function Jt(te){return te/360+.5}function On(te){const R=Math.sin(te*Math.PI/180),U=.5-.25*Math.log((1+R)/(1-R))/Math.PI;return U<0?0:U>1?1:U}function kn(te){const R=(180-360*te)*Math.PI/180;return 360*Math.atan(Math.exp(R))/Math.PI-90}function ti(te,R){for(const U in R)te[U]=R[U];return te}function Wt(te){return te.x}function nn(te){return te.y}function Nt(te,R,U,K){for(var J,ue=K,me=U-R>>1,fe=U-R,ce=te[R],ge=te[R+1],Me=te[U],Ue=te[U+1],ke=R+3;ke<U;ke+=3){var ht=Sn(te[ke],te[ke+1],ce,ge,Me,Ue);if(ht>ue)J=ke,ue=ht;else if(ht===ue){var pt=Math.abs(ke-me);pt<fe&&(J=ke,fe=pt)}}ue>K&&(J-R>3&&Nt(te,R,J,K),te[J+2]=ue,U-J>3&&Nt(te,J,U,K))}function Sn(te,R,U,K,J,ue){var me=J-U,fe=ue-K;if(me!==0||fe!==0){var ce=((te-U)*me+(R-K)*fe)/(me*me+fe*fe);ce>1?(U=J,K=ue):ce>0&&(U+=me*ce,K+=fe*ce)}return(me=te-U)*me+(fe=R-K)*fe}function Ut(te,R,U,K){var J={id:te===void 0?null:te,type:R,geometry:U,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ue){var me=ue.geometry,fe=ue.type;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")Re(ue,me);else if(fe==="Polygon"||fe==="MultiLineString")for(var ce=0;ce<me.length;ce++)Re(ue,me[ce]);else if(fe==="MultiPolygon")for(ce=0;ce<me.length;ce++)for(var ge=0;ge<me[ce].length;ge++)Re(ue,me[ce][ge])}(J),J}function Re(te,R){for(var U=0;U<R.length;U+=3)te.minX=Math.min(te.minX,R[U]),te.minY=Math.min(te.minY,R[U+1]),te.maxX=Math.max(te.maxX,R[U]),te.maxY=Math.max(te.maxY,R[U+1])}function je(te,R,U,K){if(R.geometry){var J=R.geometry.coordinates,ue=R.geometry.type,me=Math.pow(U.tolerance/((1<<U.maxZoom)*U.extent),2),fe=[],ce=R.id;if(U.promoteId?ce=R.properties[U.promoteId]:U.generateId&&(ce=K||0),ue==="Point")Xr(J,fe);else if(ue==="MultiPoint")for(var ge=0;ge<J.length;ge++)Xr(J[ge],fe);else if(ue==="LineString")Dn(J,fe,me,!1);else if(ue==="MultiLineString"){if(U.lineMetrics){for(ge=0;ge<J.length;ge++)Dn(J[ge],fe=[],me,!1),te.push(Ut(ce,"LineString",fe,R.properties));return}Ht(J,fe,me,!1)}else if(ue==="Polygon")Ht(J,fe,me,!0);else{if(ue!=="MultiPolygon"){if(ue==="GeometryCollection"){for(ge=0;ge<R.geometry.geometries.length;ge++)je(te,{id:ce,geometry:R.geometry.geometries[ge],properties:R.properties},U,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ge=0;ge<J.length;ge++){var Me=[];Ht(J[ge],Me,me,!0),fe.push(Me)}}te.push(Ut(ce,ue,fe,R.properties))}}function Xr(te,R){R.push(Vr(te[0])),R.push(ni(te[1])),R.push(0)}function Dn(te,R,U,K){for(var J,ue,me=0,fe=0;fe<te.length;fe++){var ce=Vr(te[fe][0]),ge=ni(te[fe][1]);R.push(ce),R.push(ge),R.push(0),fe>0&&(me+=K?(J*ge-ce*ue)/2:Math.sqrt(Math.pow(ce-J,2)+Math.pow(ge-ue,2))),J=ce,ue=ge}var Me=R.length-3;R[2]=1,Nt(R,0,Me,U),R[Me+2]=1,R.size=Math.abs(me),R.start=0,R.end=R.size}function Ht(te,R,U,K){for(var J=0;J<te.length;J++){var ue=[];Dn(te[J],ue,U,K),R.push(ue)}}function Vr(te){return te/360+.5}function ni(te){var R=Math.sin(te*Math.PI/180),U=.5-.25*Math.log((1+R)/(1-R))/Math.PI;return U<0?0:U>1?1:U}function ri(te,R,U,K,J,ue,me,fe){if(K/=R,ue>=(U/=R)&&me<K)return te;if(me<U||ue>=K)return null;for(var ce=[],ge=0;ge<te.length;ge++){var Me=te[ge],Ue=Me.geometry,ke=Me.type,ht=J===0?Me.minX:Me.minY,pt=J===0?Me.maxX:Me.maxY;if(ht>=U&&pt<K)ce.push(Me);else if(!(pt<U||ht>=K)){var nt=[];if(ke==="Point"||ke==="MultiPoint")ks(Ue,nt,U,K,J);else if(ke==="LineString")Ye(Ue,nt,U,K,J,!1,fe.lineMetrics);else if(ke==="MultiLineString")Dt(Ue,nt,U,K,J,!1);else if(ke==="Polygon")Dt(Ue,nt,U,K,J,!0);else if(ke==="MultiPolygon")for(var At=0;At<Ue.length;At++){var xt=[];Dt(Ue[At],xt,U,K,J,!0),xt.length&&nt.push(xt)}if(nt.length){if(fe.lineMetrics&&ke==="LineString"){for(At=0;At<nt.length;At++)ce.push(Ut(Me.id,ke,nt[At],Me.tags));continue}ke!=="LineString"&&ke!=="MultiLineString"||(nt.length===1?(ke="LineString",nt=nt[0]):ke="MultiLineString"),ke!=="Point"&&ke!=="MultiPoint"||(ke=nt.length===3?"Point":"MultiPoint"),ce.push(Ut(Me.id,ke,nt,Me.tags))}}}return ce.length?ce:null}function ks(te,R,U,K,J){for(var ue=0;ue<te.length;ue+=3){var me=te[ue+J];me>=U&&me<=K&&(R.push(te[ue]),R.push(te[ue+1]),R.push(te[ue+2]))}}function Ye(te,R,U,K,J,ue,me){for(var fe,ce,ge=Ft(te),Me=J===0?os:Rt,Ue=te.start,ke=0;ke<te.length-3;ke+=3){var ht=te[ke],pt=te[ke+1],nt=te[ke+2],At=te[ke+3],xt=te[ke+4],qt=J===0?ht:pt,It=J===0?At:xt,Lt=!1;me&&(fe=Math.sqrt(Math.pow(ht-At,2)+Math.pow(pt-xt,2))),qt<U?It>U&&(ce=Me(ge,ht,pt,At,xt,U),me&&(ge.start=Ue+fe*ce)):qt>K?It<K&&(ce=Me(ge,ht,pt,At,xt,K),me&&(ge.start=Ue+fe*ce)):Tr(ge,ht,pt,nt),It<U&&qt>=U&&(ce=Me(ge,ht,pt,At,xt,U),Lt=!0),It>K&&qt<=K&&(ce=Me(ge,ht,pt,At,xt,K),Lt=!0),!ue&&Lt&&(me&&(ge.end=Ue+fe*ce),R.push(ge),ge=Ft(te)),me&&(Ue+=fe)}var Qt=te.length-3;ht=te[Qt],pt=te[Qt+1],nt=te[Qt+2],(qt=J===0?ht:pt)>=U&&qt<=K&&Tr(ge,ht,pt,nt),Qt=ge.length-3,ue&&Qt>=3&&(ge[Qt]!==ge[0]||ge[Qt+1]!==ge[1])&&Tr(ge,ge[0],ge[1],ge[2]),ge.length&&R.push(ge)}function Ft(te){var R=[];return R.size=te.size,R.start=te.start,R.end=te.end,R}function Dt(te,R,U,K,J,ue){for(var me=0;me<te.length;me++)Ye(te[me],R,U,K,J,ue,!1)}function Tr(te,R,U,K){te.push(R),te.push(U),te.push(K)}function os(te,R,U,K,J,ue){var me=(ue-R)/(K-R);return te.push(ue),te.push(U+(J-U)*me),te.push(1),me}function Rt(te,R,U,K,J,ue){var me=(ue-U)/(J-U);return te.push(R+(K-R)*me),te.push(ue),te.push(1),me}function Ii(te,R){for(var U=[],K=0;K<te.length;K++){var J,ue=te[K],me=ue.type;if(me==="Point"||me==="MultiPoint"||me==="LineString")J=_r(ue.geometry,R);else if(me==="MultiLineString"||me==="Polygon"){J=[];for(var fe=0;fe<ue.geometry.length;fe++)J.push(_r(ue.geometry[fe],R))}else if(me==="MultiPolygon")for(J=[],fe=0;fe<ue.geometry.length;fe++){for(var ce=[],ge=0;ge<ue.geometry[fe].length;ge++)ce.push(_r(ue.geometry[fe][ge],R));J.push(ce)}U.push(Ut(ue.id,me,J,ue.tags))}return U}function _r(te,R){var U=[];U.size=te.size,te.start!==void 0&&(U.start=te.start,U.end=te.end);for(var K=0;K<te.length;K+=3)U.push(te[K]+R,te[K+1],te[K+2]);return U}function go(te,R){if(te.transformed)return te;var U,K,J,ue=1<<te.z,me=te.x,fe=te.y;for(U=0;U<te.features.length;U++){var ce=te.features[U],ge=ce.geometry,Me=ce.type;if(ce.geometry=[],Me===1)for(K=0;K<ge.length;K+=2)ce.geometry.push(ar(ge[K],ge[K+1],R,ue,me,fe));else for(K=0;K<ge.length;K++){var Ue=[];for(J=0;J<ge[K].length;J+=2)Ue.push(ar(ge[K][J],ge[K][J+1],R,ue,me,fe));ce.geometry.push(Ue)}}return te.transformed=!0,te}function ar(te,R,U,K,J,ue){return[Math.round(U*(te*K-J)),Math.round(U*(R*K-ue))]}function Lr(te,R,U,K,J){for(var ue=R===J.maxZoom?0:J.tolerance/((1<<R)*J.extent),me={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:U,y:K,z:R,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},fe=0;fe<te.length;fe++){me.numFeatures++,xn(me,te[fe],ue,J);var ce=te[fe].minX,ge=te[fe].minY,Me=te[fe].maxX,Ue=te[fe].maxY;ce<me.minX&&(me.minX=ce),ge<me.minY&&(me.minY=ge),Me>me.maxX&&(me.maxX=Me),Ue>me.maxY&&(me.maxY=Ue)}return me}function xn(te,R,U,K){var J=R.geometry,ue=R.type,me=[];if(ue==="Point"||ue==="MultiPoint")for(var fe=0;fe<J.length;fe+=3)me.push(J[fe]),me.push(J[fe+1]),te.numPoints++,te.numSimplified++;else if(ue==="LineString")yo(me,J,te,U,!1,!1);else if(ue==="MultiLineString"||ue==="Polygon")for(fe=0;fe<J.length;fe++)yo(me,J[fe],te,U,ue==="Polygon",fe===0);else if(ue==="MultiPolygon")for(var ce=0;ce<J.length;ce++){var ge=J[ce];for(fe=0;fe<ge.length;fe++)yo(me,ge[fe],te,U,!0,fe===0)}if(me.length){var Me=R.tags||null;if(ue==="LineString"&&K.lineMetrics){for(var Ue in Me={},R.tags)Me[Ue]=R.tags[Ue];Me.mapbox_clip_start=J.start/J.size,Me.mapbox_clip_end=J.end/J.size}var ke={geometry:me,type:ue==="Polygon"||ue==="MultiPolygon"?3:ue==="LineString"||ue==="MultiLineString"?2:1,tags:Me};R.id!==null&&(ke.id=R.id),te.features.push(ke)}}function yo(te,R,U,K,J,ue){var me=K*K;if(K>0&&R.size<(J?me:K))U.numPoints+=R.length/3;else{for(var fe=[],ce=0;ce<R.length;ce+=3)(K===0||R[ce+2]>me)&&(U.numSimplified++,fe.push(R[ce]),fe.push(R[ce+1])),U.numPoints++;J&&function(ge,Me){for(var Ue=0,ke=0,ht=ge.length,pt=ht-2;ke<ht;pt=ke,ke+=2)Ue+=(ge[ke]-ge[pt])*(ge[ke+1]+ge[pt+1]);if(Ue>0===Me)for(ke=0,ht=ge.length;ke<ht/2;ke+=2){var nt=ge[ke],At=ge[ke+1];ge[ke]=ge[ht-2-ke],ge[ke+1]=ge[ht-1-ke],ge[ht-2-ke]=nt,ge[ht-1-ke]=At}}(fe,ue),te.push(fe)}}function Hi(te,R){var U=(R=this.options=function(J,ue){for(var me in ue)J[me]=ue[me];return J}(Object.create(this.options),R)).debug;if(U&&console.time("preprocess data"),R.maxZoom<0||R.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(R.promoteId&&R.generateId)throw new Error("promoteId and generateId cannot be used together.");var K=function(J,ue){var me=[];if(J.type==="FeatureCollection")for(var fe=0;fe<J.features.length;fe++)je(me,J.features[fe],ue,fe);else je(me,J.type==="Feature"?J:{geometry:J},ue);return me}(te,R);this.tiles={},this.tileCoords=[],U&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",R.indexMaxZoom,R.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),K=function(J,ue){var me=ue.buffer/ue.extent,fe=J,ce=ri(J,1,-1-me,me,0,-1,2,ue),ge=ri(J,1,1-me,2+me,0,-1,2,ue);return(ce||ge)&&(fe=ri(J,1,-me,1+me,0,-1,2,ue)||[],ce&&(fe=Ii(ce,1).concat(fe)),ge&&(fe=fe.concat(Ii(ge,-1)))),fe}(K,R),K.length&&this.splitTile(K,0,0,0),U&&(K.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function qi(te,R,U){return 32*((1<<te)*U+R)+te}function Ys(te,R){const U=te.tileID.canonical;if(!this._geoJSONIndex)return R(null,null);const K=this._geoJSONIndex.getTile(U.z,U.x,U.y);if(!K)return R(null,null);const J=new ye(K.features);let ue=we.exports(J);ue.byteOffset===0&&ue.byteLength===ue.buffer.byteLength||(ue=new Uint8Array(ue)),R(null,{vectorTile:J,rawData:ue.buffer})}Hi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Hi.prototype.splitTile=function(te,R,U,K,J,ue,me){for(var fe=[te,R,U,K],ce=this.options,ge=ce.debug;fe.length;){K=fe.pop(),U=fe.pop(),R=fe.pop(),te=fe.pop();var Me=1<<R,Ue=qi(R,U,K),ke=this.tiles[Ue];if(!ke&&(ge>1&&console.time("creation"),ke=this.tiles[Ue]=Lr(te,R,U,K,ce),this.tileCoords.push({z:R,x:U,y:K}),ge)){ge>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",R,U,K,ke.numFeatures,ke.numPoints,ke.numSimplified),console.timeEnd("creation"));var ht="z"+R;this.stats[ht]=(this.stats[ht]||0)+1,this.total++}if(ke.source=te,J){if(R===ce.maxZoom||R===J)continue;var pt=1<<J-R;if(U!==Math.floor(ue/pt)||K!==Math.floor(me/pt))continue}else if(R===ce.indexMaxZoom||ke.numPoints<=ce.indexMaxPoints)continue;if(ke.source=null,te.length!==0){ge>1&&console.time("clipping");var nt,At,xt,qt,It,Lt,Qt=.5*ce.buffer/ce.extent,on=.5-Qt,Mn=.5+Qt,Ln=1+Qt;nt=At=xt=qt=null,It=ri(te,Me,U-Qt,U+Mn,0,ke.minX,ke.maxX,ce),Lt=ri(te,Me,U+on,U+Ln,0,ke.minX,ke.maxX,ce),te=null,It&&(nt=ri(It,Me,K-Qt,K+Mn,1,ke.minY,ke.maxY,ce),At=ri(It,Me,K+on,K+Ln,1,ke.minY,ke.maxY,ce),It=null),Lt&&(xt=ri(Lt,Me,K-Qt,K+Mn,1,ke.minY,ke.maxY,ce),qt=ri(Lt,Me,K+on,K+Ln,1,ke.minY,ke.maxY,ce),Lt=null),ge>1&&console.timeEnd("clipping"),fe.push(nt||[],R+1,2*U,2*K),fe.push(At||[],R+1,2*U,2*K+1),fe.push(xt||[],R+1,2*U+1,2*K),fe.push(qt||[],R+1,2*U+1,2*K+1)}}},Hi.prototype.getTile=function(te,R,U){var K=this.options,J=K.extent,ue=K.debug;if(te<0||te>24)return null;var me=1<<te,fe=qi(te,R=(R%me+me)%me,U);if(this.tiles[fe])return go(this.tiles[fe],J);ue>1&&console.log("drilling down to z%d-%d-%d",te,R,U);for(var ce,ge=te,Me=R,Ue=U;!ce&&ge>0;)ge--,Me=Math.floor(Me/2),Ue=Math.floor(Ue/2),ce=this.tiles[qi(ge,Me,Ue)];return ce&&ce.source?(ue>1&&console.log("found parent tile z%d-%d-%d",ge,Me,Ue),ue>1&&console.time("drilling down"),this.splitTile(ce.source,ge,Me,Ue,te,R,U),ue>1&&console.timeEnd("drilling down"),this.tiles[fe]?go(this.tiles[fe],J):null):null};class _o extends B{constructor(R,U,K,J){super(R,U,K,Ys),J&&(this.loadGeoJSON=J)}loadData(R,U){var K;(K=this._pendingRequest)===null||K===void 0||K.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const J=!!(R&&R.request&&R.request.collectResourceTiming)&&new c.RequestPerformance(R.request);this._pendingCallback=U,this._pendingRequest=this.loadGeoJSON(R,(ue,me)=>{if(delete this._pendingCallback,delete this._pendingRequest,ue||!me)return U(ue);if(typeof me!="object")return U(new Error(`Input data given to '${R.source}' is not a valid GeoJSON object.`));{q(me,!0);try{if(R.filter){const ce=c.createExpression(R.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ce.result==="error")throw new Error(ce.value.map(Me=>`${Me.key}: ${Me.message}`).join(", "));me={type:"FeatureCollection",features:me.features.filter(Me=>ce.value.evaluate({zoom:0},Me))}}this._geoJSONIndex=R.cluster?new kr(function({superclusterOptions:ce,clusterProperties:ge}){if(!ge||!ce)return ce;const Me={},Ue={},ke={accumulated:null,zoom:0},ht={properties:null},pt=Object.keys(ge);for(const nt of pt){const[At,xt]=ge[nt],qt=c.createExpression(xt),It=c.createExpression(typeof At=="string"?[At,["accumulated"],["get",nt]]:At);Me[nt]=qt.value,Ue[nt]=It.value}return ce.map=nt=>{ht.properties=nt;const At={};for(const xt of pt)At[xt]=Me[xt].evaluate(ke,ht);return At},ce.reduce=(nt,At)=>{ht.properties=At;for(const xt of pt)ke.accumulated=nt[xt],nt[xt]=Ue[xt].evaluate(ke,ht)},ce}(R)).load(me.features):function(ce,ge){return new Hi(ce,ge)}(me,R.geojsonVtOptions)}catch(ce){return U(ce)}this.loaded={};const fe={};if(J){const ce=J.finish();ce&&(fe.resourceTiming={},fe.resourceTiming[R.source]=JSON.parse(JSON.stringify(ce)))}U(null,fe)}})}reloadTile(R,U){const K=this.loaded;return K&&K[R.uid]?super.reloadTile(R,U):this.loadTile(R,U)}loadGeoJSON(R,U){if(R.request)return c.getJSON(R.request,U);if(typeof R.data=="string")try{U(null,JSON.parse(R.data))}catch{U(new Error(`Input data given to '${R.source}' is not a valid GeoJSON object.`))}else U(new Error(`Input data given to '${R.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(R,U){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),U()}getClusterExpansionZoom(R,U){try{U(null,this._geoJSONIndex.getClusterExpansionZoom(R.clusterId))}catch(K){U(K)}}getClusterChildren(R,U){try{U(null,this._geoJSONIndex.getChildren(R.clusterId))}catch(K){U(K)}}getClusterLeaves(R,U){try{U(null,this._geoJSONIndex.getLeaves(R.clusterId,R.limit,R.offset))}catch(K){U(K)}}}class Ms{constructor(R){this.self=R,this.actor=new c.Actor(R,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:B,geojson:_o},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(U,K)=>{if(this.workerSourceTypes[U])throw new Error(`Worker source with name "${U}" already registered.`);this.workerSourceTypes[U]=K},this.self.registerRTLTextPlugin=U=>{if(c.plugin.isParsed())throw new Error("RTL text plugin already registered.");c.plugin.applyArabicShaping=U.applyArabicShaping,c.plugin.processBidirectionalText=U.processBidirectionalText,c.plugin.processStyledBidirectionalText=U.processStyledBidirectionalText}}setReferrer(R,U){this.referrer=U}setImages(R,U,K){this.availableImages[R]=U;for(const J in this.workerSources[R]){const ue=this.workerSources[R][J];for(const me in ue)ue[me].availableImages=U}K()}setLayers(R,U,K){this.getLayerIndex(R).replace(U),K()}updateLayers(R,U,K){this.getLayerIndex(R).update(U.layers,U.removedIds),K()}loadTile(R,U,K){this.getWorkerSource(R,U.type,U.source).loadTile(U,K)}loadDEMTile(R,U,K){this.getDEMWorkerSource(R,U.source).loadTile(U,K)}reloadTile(R,U,K){this.getWorkerSource(R,U.type,U.source).reloadTile(U,K)}abortTile(R,U,K){this.getWorkerSource(R,U.type,U.source).abortTile(U,K)}removeTile(R,U,K){this.getWorkerSource(R,U.type,U.source).removeTile(U,K)}removeDEMTile(R,U){this.getDEMWorkerSource(R,U.source).removeTile(U)}removeSource(R,U,K){if(!this.workerSources[R]||!this.workerSources[R][U.type]||!this.workerSources[R][U.type][U.source])return;const J=this.workerSources[R][U.type][U.source];delete this.workerSources[R][U.type][U.source],J.removeSource!==void 0?J.removeSource(U,K):K()}loadWorkerSource(R,U,K){try{this.self.importScripts(U.url),K()}catch(J){K(J.toString())}}syncRTLPluginState(R,U,K){try{c.plugin.setState(U);const J=c.plugin.getPluginURL();if(c.plugin.isLoaded()&&!c.plugin.isParsed()&&J!=null){this.self.importScripts(J);const ue=c.plugin.isParsed();K(ue?void 0:new Error(`RTL Text Plugin failed to import scripts from ${J}`),ue)}}catch(J){K(J.toString())}}getAvailableImages(R){let U=this.availableImages[R];return U||(U=[]),U}getLayerIndex(R){let U=this.layerIndexes[R];return U||(U=this.layerIndexes[R]=new C),U}getWorkerSource(R,U,K){if(this.workerSources[R]||(this.workerSources[R]={}),this.workerSources[R][U]||(this.workerSources[R][U]={}),!this.workerSources[R][U][K]){const J={send:(ue,me,fe)=>{this.actor.send(ue,me,fe,R)}};this.workerSources[R][U][K]=new this.workerSourceTypes[U](J,this.getLayerIndex(R),this.getAvailableImages(R))}return this.workerSources[R][U][K]}getDEMWorkerSource(R,U){return this.demWorkerSources[R]||(this.demWorkerSources[R]={}),this.demWorkerSources[R][U]||(this.demWorkerSources[R][U]=new Q),this.demWorkerSources[R][U]}enforceCacheSizeLimit(R,U){c.enforceCacheSizeLimit(U)}}return c.isWorker()&&(self.worker=new Ms(self)),Ms}),l(["./shared"],function(c){var v=w;function w(m){return!function(o){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var p,y,x=new Blob([""],{type:"text/javascript"}),E=URL.createObjectURL(x);try{y=new Worker(E),p=!0}catch{p=!1}return y&&y.terminate(),URL.revokeObjectURL(E),p}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var p=document.createElement("canvas");p.width=p.height=1;var y=p.getContext("2d");if(!y)return!1;var x=y.getImageData(0,0,1,1);return x&&x.width===p.width}()?(C[h=o&&o.failIfMajorPerformanceCaveat]===void 0&&(C[h]=function(p){var y,x=function(E){var P=document.createElement("canvas"),k=Object.create(w.webGLContextAttributes);return k.failIfMajorPerformanceCaveat=E,P.getContext("webgl",k)||P.getContext("experimental-webgl",k)}(p);if(!x)return!1;try{y=x.createShader(x.VERTEX_SHADER)}catch{return!1}return!(!y||x.isContextLost())&&(x.shaderSource(y,"void main() {}"),x.compileShader(y),x.getShaderParameter(y,x.COMPILE_STATUS)===!0)}(h)),C[h]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var h}(m)}var C={};function I(m,o){if(Array.isArray(m)){if(!Array.isArray(o)||m.length!==o.length)return!1;for(let h=0;h<m.length;h++)if(!I(m[h],o[h]))return!1;return!0}if(typeof m=="object"&&m!==null&&o!==null){if(typeof o!="object"||Object.keys(m).length!==Object.keys(o).length)return!1;for(const h in m)if(!I(m[h],o[h]))return!1;return!0}return m===o}w.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class S{static testProp(o){if(!S.docStyle)return o[0];for(let h=0;h<o.length;h++)if(o[h]in S.docStyle)return o[h];return o[0]}static create(o,h,p){const y=window.document.createElement(o);return h!==void 0&&(y.className=h),p&&p.appendChild(y),y}static createNS(o,h){return window.document.createElementNS(o,h)}static disableDrag(){S.docStyle&&S.selectProp&&(S.userSelect=S.docStyle[S.selectProp],S.docStyle[S.selectProp]="none")}static enableDrag(){S.docStyle&&S.selectProp&&(S.docStyle[S.selectProp]=S.userSelect)}static setTransform(o,h){o.style[S.transformProp]=h}static addEventListener(o,h,p,y={}){o.addEventListener(h,p,"passive"in y?y:y.capture)}static removeEventListener(o,h,p,y={}){o.removeEventListener(h,p,"passive"in y?y:y.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",S.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",S.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",S.suppressClickInternal,!0)},0)}static mousePos(o,h){const p=o.getBoundingClientRect();return new c.pointGeometry(h.clientX-p.left-o.clientLeft,h.clientY-p.top-o.clientTop)}static touchPos(o,h){const p=o.getBoundingClientRect(),y=[];for(let x=0;x<h.length;x++)y.push(new c.pointGeometry(h[x].clientX-p.left-o.clientLeft,h[x].clientY-p.top-o.clientTop));return y}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}}S.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,S.selectProp=S.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),S.transformProp=S.testProp(["transform","WebkitTransform"]);class z{constructor(o){this._transformRequestFn=o}transformRequest(o,h){return this._transformRequestFn&&this._transformRequestFn(o,h)||{url:o}}normalizeSpriteURL(o,h,p){const y=function(x){const E=x.match(F);if(!E)throw new Error(`Unable to parse URL "${x}"`);return{protocol:E[1],authority:E[2],path:E[3]||"/",params:E[4]?E[4].split("&"):[]}}(o);return y.path+=`${h}${p}`,function(x){const E=x.params.length?`?${x.params.join("&")}`:"";return`${x.protocol}://${x.authority}${x.path}${E}`}(y)}setTransformRequest(o){this._transformRequestFn=o}}const F=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class B{constructor(o,h,p,y){this.context=o,this.format=p,this.texture=o.gl.createTexture(),this.update(h,y)}update(o,h,p){const{width:y,height:x}=o,E=!(this.size&&this.size[0]===y&&this.size[1]===x||p),{context:P}=this,{gl:k}=P;if(this.useMipmap=Boolean(h&&h.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),P.pixelStoreUnpackFlipY.set(!1),P.pixelStoreUnpack.set(1),P.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!h||h.premultiply!==!1)),E)this.size=[y,x],o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||c.isImageBitmap(o)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,o):k.texImage2D(k.TEXTURE_2D,0,this.format,y,x,0,this.format,k.UNSIGNED_BYTE,o.data);else{const{x:L,y:D}=p||{x:0,y:0};o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||c.isImageBitmap(o)?k.texSubImage2D(k.TEXTURE_2D,0,L,D,k.RGBA,k.UNSIGNED_BYTE,o):k.texSubImage2D(k.TEXTURE_2D,0,L,D,y,x,k.RGBA,k.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)}bind(o,h,p){const{context:y}=this,{gl:x}=y;x.bindTexture(x.TEXTURE_2D,this.texture),p!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=x.LINEAR),o!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,o),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,p||o),this.filter=o),h!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,h),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}function Q(m){const{userImage:o}=m;return!!(o&&o.render&&o.render())&&(m.data.replace(new Uint8Array(o.data.buffer)),!0)}class q extends c.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:h,callback:p}of this.requestors)this._notify(h,p);this.requestors=[]}}getImage(o){return this.images[o]}addImage(o,h){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,h)&&(this.images[o]=h)}_validate(o,h){let p=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new c.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),p=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new c.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),p=!1),this._validateContent(h.content,h)||(this.fire(new c.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),p=!1),p}_validateStretch(o,h){if(!o)return!0;let p=0;for(const y of o){if(y[0]<p||y[1]<y[0]||h<y[1])return!1;p=y[1]}return!0}_validateContent(o,h){return!(o&&(o.length!==4||o[0]<0||h.data.width<o[0]||o[1]<0||h.data.height<o[1]||o[2]<0||h.data.width<o[2]||o[3]<0||h.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,h){const p=this.images[o];if(p.data.width!==h.data.width||p.data.height!==h.data.height)throw new Error(`size mismatch between old image (${p.data.width}x${p.data.height}) and new image (${h.data.width}x${h.data.height}).`);h.version=p.version+1,this.images[o]=h,this.updatedImages[o]=!0}removeImage(o){const h=this.images[o];delete this.images[o],delete this.patterns[o],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,h){let p=!0;if(!this.isLoaded())for(const y of o)this.images[y]||(p=!1);this.isLoaded()||p?this._notify(o,h):this.requestors.push({ids:o,callback:h})}_notify(o,h){const p={};for(const y of o){this.images[y]||this.fire(new c.Event("styleimagemissing",{id:y}));const x=this.images[y];x?p[y]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,hasRenderCallback:Boolean(x.userImage&&x.userImage.render)}:c.warnOnce(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,p)}getPixelSize(){const{width:o,height:h}=this.atlasImage;return{width:o,height:h}}getPattern(o){const h=this.patterns[o],p=this.getImage(o);if(!p)return null;if(h&&h.position.version===p.version)return h.position;if(h)h.position.version=p.version;else{const y={w:p.data.width+2,h:p.data.height+2,x:0,y:0},x=new c.ImagePosition(y,p);this.patterns[o]={bin:y,position:x}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const h=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new B(o,this.atlasImage,h.RGBA),this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const x in this.patterns)o.push(this.patterns[x].bin);const{w:h,h:p}=c.potpack(o),y=this.atlasImage;y.resize({width:h||1,height:p||1});for(const x in this.patterns){const{bin:E}=this.patterns[x],P=E.x+1,k=E.y+1,L=this.images[x].data,D=L.width,V=L.height;c.RGBAImage.copy(L,y,{x:0,y:0},{x:P,y:k},{width:D,height:V}),c.RGBAImage.copy(L,y,{x:0,y:V-1},{x:P,y:k-1},{width:D,height:1}),c.RGBAImage.copy(L,y,{x:0,y:0},{x:P,y:k+V},{width:D,height:1}),c.RGBAImage.copy(L,y,{x:D-1,y:0},{x:P-1,y:k},{width:1,height:V}),c.RGBAImage.copy(L,y,{x:0,y:0},{x:P+D,y:k},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const h of o){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const p=this.images[h];p||c.warnOnce(`Image with ID: "${h}" was not found`),Q(p)&&this.updateImage(h,p)}}}const j=1e20;function G(m,o,h,p,y,x,E,P,k){for(let L=o;L<o+p;L++)se(m,h*x+L,x,y,E,P,k);for(let L=h;L<h+y;L++)se(m,L*x+o,1,p,E,P,k)}function se(m,o,h,p,y,x,E){x[0]=0,E[0]=-j,E[1]=j,y[0]=m[o];for(let P=1,k=0,L=0;P<p;P++){y[P]=m[o+P*h];const D=P*P;do{const V=x[k];L=(y[P]-y[V]+D-V*V)/(P-V)/2}while(L<=E[k]&&--k>-1);k++,x[k]=P,E[k]=L,E[k+1]=j}for(let P=0,k=0;P<p;P++){for(;E[k+1]<P;)k++;const L=x[k],D=P-L;m[o+P*h]=y[L]+D*D}}class he{constructor(o,h){this.requestManager=o,this.localIdeographFontFamily=h,this.entries={}}setURL(o){this.url=o}getGlyphs(o,h){const p=[];for(const y in o)for(const x of o[y])p.push({stack:y,id:x});c.asyncAll(p,({stack:y,id:x},E)=>{let P=this.entries[y];P||(P=this.entries[y]={glyphs:{},requests:{},ranges:{}});let k=P.glyphs[x];if(k!==void 0)return void E(null,{stack:y,id:x,glyph:k});if(k=this._tinySDF(P,y,x),k)return P.glyphs[x]=k,void E(null,{stack:y,id:x,glyph:k});const L=Math.floor(x/256);if(256*L>65535)return void E(new Error("glyphs > 65535 not supported"));if(P.ranges[L])return void E(null,{stack:y,id:x,glyph:k});let D=P.requests[L];D||(D=P.requests[L]=[],he.loadGlyphRange(y,L,this.url,this.requestManager,(V,H)=>{if(H){for(const ie in H)this._doesCharSupportLocalGlyph(+ie)||(P.glyphs[+ie]=H[+ie]);P.ranges[L]=!0}for(const ie of D)ie(V,H);delete P.requests[L]})),D.push((V,H)=>{V?E(V):H&&E(null,{stack:y,id:x,glyph:H[x]||null})})},(y,x)=>{if(y)h(y);else if(x){const E={};for(const{stack:P,id:k,glyph:L}of x)(E[P]||(E[P]={}))[k]=L&&{id:L.id,bitmap:L.bitmap.clone(),metrics:L.metrics};h(null,E)}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&(c.unicodeBlockLookup["CJK Unified Ideographs"](o)||c.unicodeBlockLookup["Hangul Syllables"](o)||c.unicodeBlockLookup.Hiragana(o)||c.unicodeBlockLookup.Katakana(o))}_tinySDF(o,h,p){const y=this.localIdeographFontFamily;if(!y||!this._doesCharSupportLocalGlyph(p))return;let x=o.tinySDF;if(!x){let P="400";/bold/i.test(h)?P="900":/medium/i.test(h)?P="500":/light/i.test(h)&&(P="200"),x=o.tinySDF=new he.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:y,fontWeight:P})}const E=x.draw(String.fromCharCode(p));return{id:p,bitmap:new c.AlphaImage({width:E.width||30,height:E.height||30},E.data),metrics:{width:E.glyphWidth||24,height:E.glyphHeight||24,left:E.glyphLeft||0,top:E.glyphTop-27||-8,advance:E.glyphAdvance||24}}}}he.loadGlyphRange=function(m,o,h,p,y){const x=256*o,E=x+255,P=p.transformRequest(h.replace("{fontstack}",m).replace("{range}",`${x}-${E}`),c.ResourceType.Glyphs);c.getArrayBuffer(P,(k,L)=>{if(k)y(k);else if(L){const D={};for(const V of c.parseGlyphPbf(L))D[V.id]=V;y(null,D)}})},he.TinySDF=class{constructor({fontSize:m=24,buffer:o=3,radius:h=8,cutoff:p=.25,fontFamily:y="sans-serif",fontWeight:x="normal",fontStyle:E="normal"}={}){this.buffer=o,this.cutoff=p,this.radius=h;const P=this.size=m+4*o,k=this._createCanvas(P),L=this.ctx=k.getContext("2d",{willReadFrequently:!0});L.font=`${E} ${x} ${m}px ${y}`,L.textBaseline="alphabetic",L.textAlign="left",L.fillStyle="black",this.gridOuter=new Float64Array(P*P),this.gridInner=new Float64Array(P*P),this.f=new Float64Array(P),this.z=new Float64Array(P+1),this.v=new Uint16Array(P)}_createCanvas(m){const o=document.createElement("canvas");return o.width=o.height=m,o}draw(m){const{width:o,actualBoundingBoxAscent:h,actualBoundingBoxDescent:p,actualBoundingBoxLeft:y,actualBoundingBoxRight:x}=this.ctx.measureText(m),E=Math.ceil(h),P=Math.min(this.size-this.buffer,Math.ceil(x-y)),k=Math.min(this.size-this.buffer,E+Math.ceil(p)),L=P+2*this.buffer,D=k+2*this.buffer,V=Math.max(L*D,0),H=new Uint8ClampedArray(V),ie={data:H,width:L,height:D,glyphWidth:P,glyphHeight:k,glyphTop:E,glyphLeft:0,glyphAdvance:o};if(P===0||k===0)return ie;const{ctx:ne,buffer:re,gridInner:pe,gridOuter:_e}=this;ne.clearRect(re,re,P,k),ne.fillText(m,re,re+E);const Ee=ne.getImageData(re,re,P,k);_e.fill(j,0,V),pe.fill(0,0,V);for(let oe=0;oe<k;oe++)for(let Ae=0;Ae<P;Ae++){const Te=Ee.data[4*(oe*P+Ae)+3]/255;if(Te===0)continue;const Oe=(oe+re)*L+Ae+re;if(Te===1)_e[Oe]=0,pe[Oe]=j;else{const De=.5-Te;_e[Oe]=De>0?De*De:0,pe[Oe]=De<0?De*De:0}}G(_e,0,0,L,D,L,this.f,this.v,this.z),G(pe,re,re,P,k,L,this.f,this.v,this.z);for(let oe=0;oe<V;oe++){const Ae=Math.sqrt(_e[oe])-Math.sqrt(pe[oe]);H[oe]=Math.round(255-255*(Ae/this.radius+this.cutoff))}return ie}};const ye=new c.Properties({anchor:new c.DataConstantProperty(c.spec.light.anchor),position:new class{constructor(){this.specification=c.spec.light.position}possiblyEvaluate(m,o){return c.sphericalToCartesian(m.expression.evaluate(o))}interpolate(m,o,h){return{x:c.number(m.x,o.x,h),y:c.number(m.y,o.y,h),z:c.number(m.z,o.z,h)}}},color:new c.DataConstantProperty(c.spec.light.color),intensity:new c.DataConstantProperty(c.spec.light.intensity)}),we="-transition";class Be extends c.Evented{constructor(o){super(),this._transitionable=new c.Transitionable(ye),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,h={}){if(!this._validate(c.validateLight,o,h))for(const p in o){const y=o[p];p.endsWith(we)?this._transitionable.setTransition(p.slice(0,-we.length),y):this._transitionable.setValue(p,y)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,h,p){return(!p||p.validate!==!1)&&c.emitValidationErrors(this,o.call(c.validateStyle,c.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:c.spec})))}}class Ve{constructor(o,h){this.width=o,this.height=h,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,h){const p=o.join(",")+String(h);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(o,h)),this.dashEntry[p]}getDashRanges(o,h,p){const y=[];let x=o.length%2==1?-o[o.length-1]*p:0,E=o[0]*p,P=!0;y.push({left:x,right:E,isDash:P,zeroLength:o[0]===0});let k=o[0];for(let L=1;L<o.length;L++){P=!P;const D=o[L];x=k*p,k+=D,E=k*p,y.push({left:x,right:E,isDash:P,zeroLength:D===0})}return y}addRoundDash(o,h,p){const y=h/2;for(let x=-p;x<=p;x++){const E=this.width*(this.nextRow+p+x);let P=0,k=o[P];for(let L=0;L<this.width;L++){L/k.right>1&&(k=o[++P]);const D=Math.abs(L-k.left),V=Math.abs(L-k.right),H=Math.min(D,V);let ie;const ne=x/p*(y+1);if(k.isDash){const re=y-Math.abs(ne);ie=Math.sqrt(H*H+re*re)}else ie=y-Math.sqrt(H*H+ne*ne);this.data[E+L]=Math.max(0,Math.min(255,ie+128))}}}addRegularDash(o){for(let P=o.length-1;P>=0;--P){const k=o[P],L=o[P+1];k.zeroLength?o.splice(P,1):L&&L.isDash===k.isDash&&(L.left=k.left,o.splice(P,1))}const h=o[0],p=o[o.length-1];h.isDash===p.isDash&&(h.left=p.left-this.width,p.right=h.right+this.width);const y=this.width*this.nextRow;let x=0,E=o[x];for(let P=0;P<this.width;P++){P/E.right>1&&(E=o[++x]);const k=Math.abs(P-E.left),L=Math.abs(P-E.right),D=Math.min(k,L);this.data[y+P]=Math.max(0,Math.min(255,(E.isDash?D:-D)+128))}}addDash(o,h){const p=h?7:0,y=2*p+1;if(this.nextRow+y>this.height)return c.warnOnce("LineAtlas out of space"),null;let x=0;for(let P=0;P<o.length;P++)x+=o[P];if(x!==0){const P=this.width/x,k=this.getDashRanges(o,this.width,P);h?this.addRoundDash(k,P,p):this.addRegularDash(k)}const E={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:x};return this.nextRow+=y,this.dirty=!0,E}bind(o){const h=o.gl;this.texture?(h.bindTexture(h.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,h.texSubImage2D(h.TEXTURE_2D,0,0,0,this.width,this.height,h.ALPHA,h.UNSIGNED_BYTE,this.data))):(this.texture=h.createTexture(),h.bindTexture(h.TEXTURE_2D,this.texture),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texImage2D(h.TEXTURE_2D,0,h.ALPHA,this.width,this.height,0,h.ALPHA,h.UNSIGNED_BYTE,this.data))}}class xe{constructor(o,h){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=c.uniqueId();const p=this.workerPool.acquire(this.id);for(let y=0;y<p.length;y++){const x=new xe.Actor(p[y],h,this.id);x.name=`Worker ${y}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,h,p){c.asyncAll(this.actors,(y,x)=>{y.send(o,h,x)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}function He(m,o,h){const p=function(y,x){if(y)return h(y);if(x){const E=c.pick(c.extend(x,m),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);x.vector_layers&&(E.vectorLayers=x.vector_layers,E.vectorLayerIds=E.vectorLayers.map(P=>P.id)),h(null,E)}};return m.url?c.getJSON(o.transformRequest(m.url,c.ResourceType.Source),p):c.exported.frame(()=>p(null,m))}xe.Actor=c.Actor;class wt{constructor(o,h,p){this.bounds=c.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=h||0,this.maxzoom=p||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const h=Math.pow(2,o.z),p=Math.floor(c.mercatorXfromLng(this.bounds.getWest())*h),y=Math.floor(c.mercatorYfromLat(this.bounds.getNorth())*h),x=Math.ceil(c.mercatorXfromLng(this.bounds.getEast())*h),E=Math.ceil(c.mercatorYfromLat(this.bounds.getSouth())*h);return o.x>=p&&o.x<x&&o.y>=y&&o.y<E}}class yt extends c.Evented{constructor(o,h,p,y){if(super(),this.id=o,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.extend(this,c.pick(h,["url","scheme","tileSize","promoteId"])),this._options=c.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y)}load(){this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=He(this._options,this.map._requestManager,(o,h)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),o?this.fire(new c.ErrorEvent(o)):h&&(c.extend(this,h),h.bounds&&(this.tileBounds=new wt(h.bounds,this.minzoom,this.maxzoom)),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return c.extend({},this._options)}loadTile(o,h){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),y={request:this.map._requestManager.transformRequest(p,c.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function x(E,P){return delete o.request,o.aborted?h(null):E&&E.status!==404?h(E):(P&&P.resourceTiming&&(o.resourceTiming=P.resourceTiming),this.map._refreshExpiredTiles&&P&&o.setExpiryData(P),o.loadVectorData(P,this.map.painter),c.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}y.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=h:o.request=o.actor.send("reloadTile",y,x.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",y,x.bind(this)))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class ot extends c.Evented{constructor(o,h,p,y){super(),this.id=o,this.dispatcher=p,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.extend({type:"raster"},h),c.extend(this,c.pick(h,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=He(this._options,this.map._requestManager,(o,h)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new c.ErrorEvent(o)):h&&(c.extend(this,h),h.bounds&&(this.tileBounds=new wt(h.bounds,this.minzoom,this.maxzoom)),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return c.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,h){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.request=c.getImage(this.map._requestManager.transformRequest(p,c.ResourceType.Tile),(y,x,E)=>{if(delete o.request,o.aborted)o.state="unloaded",h(null);else if(y)o.state="errored",h(y);else if(x){this.map._refreshExpiredTiles&&o.setExpiryData(E);const P=this.map.painter.context,k=P.gl;o.texture=this.map.painter.getTileTexture(x.width),o.texture?o.texture.update(x,{useMipmap:!0}):(o.texture=new B(P,x,k.RGBA,{useMipmap:!0}),o.texture.bind(k.LINEAR,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),P.extTextureFilterAnisotropic&&k.texParameterf(k.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax)),o.state="loaded",c.cacheEntryPossiblyAdded(this.dispatcher),h(null)}})}abortTile(o,h){o.request&&(o.request.cancel(),delete o.request),h()}unloadTile(o,h){o.texture&&this.map.painter.saveTileTexture(o.texture),h()}hasTransition(){return!1}}let zt;class Qe extends ot{constructor(o,h,p,y){super(o,h,p,y),this.type="raster-dem",this.maxzoom=22,this._options=c.extend({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(o,h){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function y(x,E){x&&(o.state="errored",h(x)),E&&(o.dem=E,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded",h(null))}o.request=c.getImage(this.map._requestManager.transformRequest(p,c.ResourceType.Tile),function(x,E){if(delete o.request,o.aborted)o.state="unloaded",h(null);else if(x)o.state="errored",h(x);else if(E){this.map._refreshExpiredTiles&&o.setExpiryData(E),delete E.cacheControl,delete E.expires;const P=c.isImageBitmap(E)&&(zt==null&&(zt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),zt)?E:c.exported.getImageData(E,1),k={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:P,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",k,y.bind(this)))}}.bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)}_getNeighboringTiles(o){const h=o.canonical,p=Math.pow(2,h.z),y=(h.x-1+p)%p,x=h.x===0?o.wrap-1:o.wrap,E=(h.x+1+p)%p,P=h.x+1===p?o.wrap+1:o.wrap,k={};return k[new c.OverscaledTileID(o.overscaledZ,x,h.z,y,h.y).key]={backfilled:!1},k[new c.OverscaledTileID(o.overscaledZ,P,h.z,E,h.y).key]={backfilled:!1},h.y>0&&(k[new c.OverscaledTileID(o.overscaledZ,x,h.z,y,h.y-1).key]={backfilled:!1},k[new c.OverscaledTileID(o.overscaledZ,o.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},k[new c.OverscaledTileID(o.overscaledZ,P,h.z,E,h.y-1).key]={backfilled:!1}),h.y+1<p&&(k[new c.OverscaledTileID(o.overscaledZ,x,h.z,y,h.y+1).key]={backfilled:!1},k[new c.OverscaledTileID(o.overscaledZ,o.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},k[new c.OverscaledTileID(o.overscaledZ,P,h.z,E,h.y+1).key]={backfilled:!1}),k}unloadTile(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})}}class yn extends c.Evented{constructor(o,h,p,y){super(),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=p.getActor(),this.setEventedParent(y),this._data=h.data,this._options=c.extend({},h),this._collectResourceTiming=h.collectResourceTiming,h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const x=c.EXTENT/this.tileSize;this.workerOptions=c.extend({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*x,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*x,extent:c.EXTENT,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:c.EXTENT,radius:(h.clusterRadius||50)*x,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData("content"),this}getClusterExpansionZoom(o,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},h),this}getClusterChildren(o,h){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},h),this}getClusterLeaves(o,h,p,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:h,offset:p},y),this}_updateWorkerData(o){const h=c.extend({},this.workerOptions),p=this._data;typeof p=="string"?(h.request=this.map._requestManager.transformRequest(c.exported.resolveURL(p),c.ResourceType.Source),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(p),this._pendingLoads++,this.fire(new c.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,h,(y,x)=>{if(this._pendingLoads--,this._removed||x&&x.abandoned)return void this.fire(new c.Event("dataabort",{dataType:"source",sourceDataType:o}));let E=null;if(x&&x.resourceTiming&&x.resourceTiming[this.id]&&(E=x.resourceTiming[this.id].slice(0)),y)return void this.fire(new c.ErrorEvent(y));const P={dataType:"source",sourceDataType:o};this._collectResourceTiming&&E&&E.length>0&&c.extend(P,{resourceTiming:E}),this.fire(new c.Event("data",P))})}loaded(){return this._pendingLoads===0}loadTile(o,h){const p=o.actor?"reloadTile":"loadTile";o.actor=this.actor;const y={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};o.request=this.actor.send(p,y,(x,E)=>(delete o.request,o.unloadVectorData(),o.aborted?h(null):x?h(x):(o.loadVectorData(E,this.map.painter,p==="reloadTile"),h(null))))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0}unloadTile(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return c.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Ne=c.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class et extends c.Evented{constructor(o,h,p,y){super(),this.id=o,this.dispatcher=p,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=h}load(o,h){this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this.url=this.options.url,c.getImage(this.map._requestManager.transformRequest(this.url,c.ResourceType.Image),(p,y)=>{this._loaded=!0,p?this.fire(new c.ErrorEvent(p)):y&&(this.image=y,o&&(this.coordinates=o),h&&h(),this._finishLoading())})}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}setCoordinates(o){this.coordinates=o;const h=o.map(c.MercatorCoordinate.fromLngLat);this.tileID=function(y){let x=1/0,E=1/0,P=-1/0,k=-1/0;for(const H of y)x=Math.min(x,H.x),E=Math.min(E,H.y),P=Math.max(P,H.x),k=Math.max(k,H.y);const L=Math.max(P-x,k-E),D=Math.max(0,Math.floor(-Math.log(L)/Math.LN2)),V=Math.pow(2,D);return new c.CanonicalTileID(D,Math.floor((x+P)/2*V),Math.floor((E+k)/2*V))}(h),this.minzoom=this.maxzoom=this.tileID.z;const p=h.map(y=>this.tileID.getTilePoint(y)._round());return this._boundsArray=new c.RasterBoundsArray,this._boundsArray.emplaceBack(p[0].x,p[0].y,0,0),this._boundsArray.emplaceBack(p[1].x,p[1].y,c.EXTENT,0),this._boundsArray.emplaceBack(p[3].x,p[3].y,0,c.EXTENT),this._boundsArray.emplaceBack(p[2].x,p[2].y,c.EXTENT,c.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,h=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Ne.members)),this.boundsSegments||(this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new B(o,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE));for(const p in this.tiles){const y=this.tiles[p];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture)}}loadTile(o,h){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},h(null)):(o.state="errored",h(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class _t extends et{constructor(o,h,p,y){super(o,h,p,y),this.roundZoom=!0,this.type="video",this.options=h}load(){this._loaded=!1;const o=this.options;this.urls=[];for(const h of o.urls)this.urls.push(this.map._requestManager.transformRequest(h,c.ResourceType.Source).url);c.getVideo(this.urls,(h,p)=>{this._loaded=!0,h?this.fire(new c.ErrorEvent(h)):p&&(this.video=p,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const h=this.video.seekable;o<h.start(0)||o>h.end(0)?this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const o=this.map.painter.context,h=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Ne.members)),this.boundsSegments||(this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new B(o,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE));for(const p in this.tiles){const y=this.tiles[p];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class at extends et{constructor(o,h,p,y){super(o,h,p,y),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(E=>typeof E!="number"))||this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${o}`,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof HTMLCanvasElement||this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${o}`,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const h=this.map.painter.context,p=h.gl;this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,Ne.members)),this.boundsSegments||(this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new B(h,this.canvas,p.RGBA,{premultiply:!0});for(const y in this.tiles){const x=this.tiles[y];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const Ot={vector:yt,raster:ot,"raster-dem":Qe,geojson:yn,video:_t,image:et,canvas:at};function tn(m,o){const h=c.create();return c.translate(h,h,[1,1,0]),c.scale(h,h,[.5*m.width,.5*m.height,1]),c.multiply(h,h,m.calculatePosMatrix(o.toUnwrapped()))}function $t(m,o,h,p,y,x){const E=function(V,H,ie){if(V)for(const ne of V){const re=H[ne];if(re&&re.source===ie&&re.type==="fill-extrusion")return!0}else for(const ne in H){const re=H[ne];if(re.source===ie&&re.type==="fill-extrusion")return!0}return!1}(y&&y.layers,o,m.id),P=x.maxPitchScaleFactor(),k=m.tilesIn(p,P,E);k.sort(cn);const L=[];for(const V of k)L.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(o,h,m._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,y,x,P,tn(m.transform,V.tileID))});const D=function(V){const H={},ie={};for(const ne of V){const re=ne.queryResults,pe=ne.wrappedTileID,_e=ie[pe]=ie[pe]||{};for(const Ee in re){const oe=re[Ee],Ae=_e[Ee]=_e[Ee]||{},Te=H[Ee]=H[Ee]||[];for(const Oe of oe)Ae[Oe.featureIndex]||(Ae[Oe.featureIndex]=!0,Te.push(Oe))}}return H}(L);for(const V in D)D[V].forEach(H=>{const ie=H.feature,ne=m.getFeatureState(ie.layer["source-layer"],ie.id);ie.source=ie.layer.source,ie.layer["source-layer"]&&(ie.sourceLayer=ie.layer["source-layer"]),ie.state=ne});return D}function cn(m,o){const h=m.tileID,p=o.tileID;return h.overscaledZ-p.overscaledZ||h.canonical.y-p.canonical.y||h.wrap-p.wrap||h.canonical.x-p.canonical.x}class sn{constructor(o,h){this.tileID=o,this.uid=c.uniqueId(),this.uses=0,this.tileSize=h,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const h=o+this.timeAdded;h<c.exported.now()||this.fadeEndTime&&h<this.fadeEndTime||(this.fadeEndTime=h)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.textures.forEach(h=>o.saveTileTexture(h)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(o,h,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(y,x){const E={};if(!x)return E;for(const P of y){const k=P.layerIds.map(L=>x.getLayer(L)).filter(Boolean);if(k.length!==0){P.layers=k,P.stateDependentLayerIds&&(P.stateDependentLayers=P.stateDependentLayerIds.map(L=>k.filter(D=>D.id===L)[0]));for(const L of k)E[L.id]=P}}return E}(o.buckets,h.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const x=this.buckets[y];if(x instanceof c.SymbolBucket){if(this.hasSymbolBuckets=!0,!p)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const x=this.buckets[y];if(x instanceof c.SymbolBucket&&x.hasRTLText){this.hasRTLText=!0,c.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const y in this.buckets){const x=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,h.style.getLayer(y).queryRadius(x))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new c.CollisionBoxArray}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const p in this.buckets){const y=this.buckets[p];y.uploadPending()&&y.upload(o)}const h=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new B(o,this.imageAtlas.image,h.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new B(o,this.glyphAtlasImage,h.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,h,p,y,x,E,P,k,L,D){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:y,cameraQueryGeometry:x,scale:E,tileSize:this.tileSize,pixelPosMatrix:D,transform:k,params:P,queryPadding:this.queryPadding*L},o,h,p):{}}querySourceFeatures(o,h){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const y=p.loadVTLayers(),x=h?h.sourceLayer:"",E=y._geojsonTileLayer||y[x];if(!E)return;const P=c.createFilter(h&&h.filter),{z:k,x:L,y:D}=this.tileID.canonical,V={z:k,x:L,y:D};for(let H=0;H<E.length;H++){const ie=E.feature(H);if(P.needGeometry){const pe=c.toEvaluationFeature(ie,!0);if(!P.filter(new c.EvaluationParameters(this.tileID.overscaledZ),pe,this.tileID.canonical))continue}else if(!P.filter(new c.EvaluationParameters(this.tileID.overscaledZ),ie))continue;const ne=p.getId(ie,x),re=new c.GeoJSONFeature(ie,k,L,D,ne);re.tile=V,o.push(re)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const h=this.expirationTime;if(o.cacheControl){const p=c.parseCacheControl(o.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const p=Date.now();let y=!1;if(this.expirationTime>p)y=!1;else if(h)if(this.expirationTime<h)y=!0;else{const x=this.expirationTime-h;x?this.expirationTime=p+Math.max(x,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,h){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const p=this.latestFeatureIndex.loadVTLayers();for(const y in this.buckets){if(!h.style.hasLayer(y))continue;const x=this.buckets[y],E=x.layers[0].sourceLayer||"_geojsonTileLayer",P=p[E],k=o[E];if(!P||!k||Object.keys(k).length===0)continue;x.update(k,P,this.imageAtlas&&this.imageAtlas.patternPositions||{});const L=h&&h.style&&h.style.getLayer(y);L&&(this.queryPadding=Math.max(this.queryPadding,L.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<c.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=c.exported.now()+o}setDependencies(o,h){const p={};for(const y of h)p[y]=!0;this.dependencies[o]=p}hasDependency(o,h){for(const p of o){const y=this.dependencies[p];if(y){for(const x of h)if(y[x])return!0}}return!1}}class Bt{constructor(o,h){this.max=o,this.onRemove=h,this.reset()}reset(){for(const o in this.data)for(const h of this.data[o])h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value);return this.data={},this.order=[],this}add(o,h,p){const y=o.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);const x={value:h,timeout:void 0};if(p!==void 0&&(x.timeout=setTimeout(()=>{this.remove(o,x)},p)),this.data[y].push(x),this.order.push(y),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const h=this.data[o].shift();return h.timeout&&clearTimeout(h.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),h.value}getByKey(o){const h=this.data[o];return h?h[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,h){if(!this.has(o))return this;const p=o.wrapped().key,y=h===void 0?0:this.data[p].indexOf(h),x=this.data[p][y];return this.data[p].splice(y,1),x.timeout&&clearTimeout(x.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(x.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}filter(o){const h=[];for(const p in this.data)for(const y of this.data[p])o(y.value)||h.push(y);for(const p of h)this.remove(p.value.tileID,p)}}class fn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,h,p){const y=String(h);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][y]=this.stateChanges[o][y]||{},c.extend(this.stateChanges[o][y],p),this.deletedStates[o]===null){this.deletedStates[o]={};for(const x in this.state[o])x!==y&&(this.deletedStates[o][x]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][y]===null){this.deletedStates[o][y]={};for(const x in this.state[o][y])p[x]||(this.deletedStates[o][y][x]=null)}else for(const x in p)this.deletedStates[o]&&this.deletedStates[o][y]&&this.deletedStates[o][y][x]===null&&delete this.deletedStates[o][y][x]}removeFeatureState(o,h,p){if(this.deletedStates[o]===null)return;const y=String(h);if(this.deletedStates[o]=this.deletedStates[o]||{},p&&h!==void 0)this.deletedStates[o][y]!==null&&(this.deletedStates[o][y]=this.deletedStates[o][y]||{},this.deletedStates[o][y][p]=null);else if(h!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][y])for(p in this.deletedStates[o][y]={},this.stateChanges[o][y])this.deletedStates[o][y][p]=null;else this.deletedStates[o][y]=null;else this.deletedStates[o]=null}getState(o,h){const p=String(h),y=c.extend({},(this.state[o]||{})[p],(this.stateChanges[o]||{})[p]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const x=this.deletedStates[o][h];if(x===null)return{};for(const E in x)delete y[E]}return y}initializeTileState(o,h){o.setFeatureState(this.state,h)}coalesceChanges(o,h){const p={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const x={};for(const E in this.stateChanges[y])this.state[y][E]||(this.state[y][E]={}),c.extend(this.state[y][E],this.stateChanges[y][E]),x[E]=this.state[y][E];p[y]=x}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const x={};if(this.deletedStates[y]===null)for(const E in this.state[y])x[E]={},this.state[y][E]={};else for(const E in this.deletedStates[y]){if(this.deletedStates[y][E]===null)this.state[y][E]={};else for(const P of Object.keys(this.deletedStates[y][E]))delete this.state[y][E][P];x[E]=this.state[y][E]}p[y]=p[y]||{},c.extend(p[y],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const y in o)o[y].setFeatureState(p,h)}}class jt extends c.Evented{constructor(o,h,p){super(),this.id=o,this.dispatcher=p,this.on("data",y=>{y.dataType==="source"&&y.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&y.dataType==="source"&&y.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(y,x,E,P){const k=new Ot[x.type](y,x,E,P);if(k.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${k.id}`);return c.bindAll(["load","abort","unload","serialize","prepare"],k),k}(o,h,p,this),this._tiles={},this._cache=new Bt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new fn}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles){const h=this._tiles[o];if(h.state!=="loaded"&&h.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,h){return this._source.loadTile(o,h)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){this._source.abortTile&&this._source.abortTile(o,()=>{}),this._source.fire(new c.Event("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const h in this._tiles){const p=this._tiles[h];p.upload(o),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(Kt).map(o=>o.key)}getRenderableIds(o){const h=[];for(const p in this._tiles)this._isIdRenderable(p,o)&&h.push(this._tiles[p]);return o?h.sort((p,y)=>{const x=p.tileID,E=y.tileID,P=new c.pointGeometry(x.canonical.x,x.canonical.y)._rotate(this.transform.angle),k=new c.pointGeometry(E.canonical.x,E.canonical.y)._rotate(this.transform.angle);return x.overscaledZ-E.overscaledZ||k.y-P.y||k.x-P.x}).map(p=>p.tileID.key):h.map(p=>p.tileID).sort(Kt).map(p=>p.key)}hasRenderableParent(o){const h=this.findLoadedParent(o,0);return!!h&&this._isIdRenderable(h.tileID.key)}_isIdRenderable(o,h){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(h||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")}}_reloadTile(o,h){const p=this._tiles[o];p&&(p.state!=="loading"&&(p.state=h),this._loadTile(p,this._tileLoaded.bind(this,p,o,h)))}_tileLoaded(o,h,p,y){if(y)return o.state="errored",void(y.status!==404?this._source.fire(new c.ErrorEvent(y,{tile:o})):this.update(this.transform,this.terrain));o.timeAdded=c.exported.now(),p==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(h,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new c.Event("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const h=this.getRenderableIds();for(let y=0;y<h.length;y++){const x=h[y];if(o.neighboringTiles&&o.neighboringTiles[x]){const E=this.getTileByID(x);p(o,E),p(E,o)}}function p(y,x){y.needsHillshadePrepare=!0,y.needsTerrainPrepare=!0;let E=x.tileID.canonical.x-y.tileID.canonical.x;const P=x.tileID.canonical.y-y.tileID.canonical.y,k=Math.pow(2,y.tileID.canonical.z),L=x.tileID.key;E===0&&P===0||Math.abs(P)>1||(Math.abs(E)>1&&(Math.abs(E+k)===1?E+=k:Math.abs(E-k)===1&&(E-=k)),x.dem&&y.dem&&(y.dem.backfillBorder(x.dem,E,P),y.neighboringTiles&&y.neighboringTiles[L]&&(y.neighboringTiles[L].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,h,p,y){for(const x in this._tiles){let E=this._tiles[x];if(y[x]||!E.hasData()||E.tileID.overscaledZ<=h||E.tileID.overscaledZ>p)continue;let P=E.tileID;for(;E&&E.tileID.overscaledZ>h+1;){const L=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[L.key],E&&E.hasData()&&(P=L)}let k=P;for(;k.overscaledZ>h;)if(k=k.scaledTo(k.overscaledZ-1),o[k.key]){y[P.key]=P;break}}}findLoadedParent(o,h){if(o.key in this._loadedParentTiles){const p=this._loadedParentTiles[o.key];return p&&p.tileID.overscaledZ>=h?p:null}for(let p=o.overscaledZ-1;p>=h;p--){const y=o.scaledTo(p),x=this._getLoadedTile(y);if(x)return x}}_getLoadedTile(o){const h=this._tiles[o.key];return h&&h.hasData()?h:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const h=Math.ceil(o.width/this._source.tileSize)+1,p=Math.ceil(o.height/this._source.tileSize)+1,y=Math.floor(h*p*5),x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(x)}handleWrapJump(o){const h=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,h){const p={};for(const y in this._tiles){const x=this._tiles[y];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+h),p[x.tileID.key]=x}this._tiles=p;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(y,this._tiles[y])}}update(o,h){if(this.transform=o,this.terrain=h,!this._sourceLoaded||this._paused)return;let p;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(L=>new c.OverscaledTileID(L.canonical.z,L.wrap,L.canonical.z,L.canonical.x,L.canonical.y)):(p=o.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:h}),this._source.hasTile&&(p=p.filter(L=>this._source.hasTile(L)))):p=[];const y=o.coveringZoomLevel(this._source),x=Math.max(y-jt.maxOverzooming,this._source.minzoom),E=Math.max(y+jt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const L={};for(const D of p)if(D.canonical.z>this._source.minzoom){const V=D.scaledTo(D.canonical.z-1);L[V.key]=V;const H=D.scaledTo(Math.max(this._source.minzoom,Math.min(D.canonical.z,5)));L[H.key]=H}p=p.concat(Object.values(L))}const P=this._updateRetainedTiles(p,y);if(Wn(this._source.type)){const L={},D={},V=Object.keys(P);for(const H of V){const ie=P[H],ne=this._tiles[H];if(!ne||ne.fadeEndTime&&ne.fadeEndTime<=c.exported.now())continue;const re=this.findLoadedParent(ie,x);re&&(this._addTile(re.tileID),L[re.tileID.key]=re.tileID),D[H]=ie}this._retainLoadedChildren(D,y,E,P);for(const H in L)P[H]||(this._coveredTiles[H]=!0,P[H]=L[H]);if(h){const H={},ie={};for(const ne of p)this._tiles[ne.key].hasData()?H[ne.key]=ne:ie[ne.key]=ne;for(const ne in ie){const re=ie[ne].children(this._source.maxzoom);this._tiles[re[0].key]&&this._tiles[re[1].key]&&this._tiles[re[2].key]&&this._tiles[re[3].key]&&(H[re[0].key]=P[re[0].key]=re[0],H[re[1].key]=P[re[1].key]=re[1],H[re[2].key]=P[re[2].key]=re[2],H[re[3].key]=P[re[3].key]=re[3],delete ie[ne])}for(const ne in ie){const re=this.findLoadedParent(ie[ne],this._source.minzoom);if(re){H[re.tileID.key]=P[re.tileID.key]=re.tileID;for(const pe in H)H[pe].isChildOf(re.tileID)&&delete H[pe]}}for(const ne in this._tiles)H[ne]||(this._coveredTiles[ne]=!0)}}for(const L in P)this._tiles[L].clearFadeHold();const k=c.keysDifference(this._tiles,P);for(const L of k){const D=this._tiles[L];D.hasSymbolBuckets&&!D.holdingForFade()?D.setHoldDuration(this.map._fadeDuration):D.hasSymbolBuckets&&!D.symbolFadeFinished()||this._removeTile(L)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,h){const p={},y={},x=Math.max(h-jt.maxOverzooming,this._source.minzoom),E=Math.max(h+jt.maxUnderzooming,this._source.minzoom),P={};for(const k of o){const L=this._addTile(k);p[k.key]=k,L.hasData()||h<this._source.maxzoom&&(P[k.key]=k)}this._retainLoadedChildren(P,h,E,p);for(const k of o){let L=this._tiles[k.key];if(L.hasData())continue;if(h+1>this._source.maxzoom){const V=k.children(this._source.maxzoom)[0],H=this.getTile(V);if(H&&H.hasData()){p[V.key]=V;continue}}else{const V=k.children(this._source.maxzoom);if(p[V[0].key]&&p[V[1].key]&&p[V[2].key]&&p[V[3].key])continue}let D=L.wasRequested();for(let V=k.overscaledZ-1;V>=x;--V){const H=k.scaledTo(V);if(y[H.key]||(y[H.key]=!0,L=this.getTile(H),!L&&D&&(L=this._addTile(H)),L&&(p[H.key]=H,D=L.wasRequested(),L.hasData())))break}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const h=[];let p,y=this._tiles[o].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){p=this._loadedParentTiles[y.key];break}h.push(y.key);const x=y.scaledTo(y.overscaledZ-1);if(p=this._getLoadedTile(x),p)break;y=x}for(const x of h)this._loadedParentTiles[x]=p}}_addTile(o){let h=this._tiles[o.key];if(h)return h;h=this._cache.getAndRemove(o),h&&(this._setTileReloadTimer(o.key,h),h.tileID=o,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,h)));const p=h;return h||(h=new sn(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(h,this._tileLoaded.bind(this,h,o.key,h.state))),h.uses++,this._tiles[o.key]=h,p||this._source.fire(new c.Event("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h}_setTileReloadTimer(o,h){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const p=h.getExpiryTimeout();p&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},p))}_removeTile(o){const h=this._tiles[o];h&&(h.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),h.uses>0||(h.hasData()&&h.state!=="reloading"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,h,p){const y=[],x=this.transform;if(!x)return y;const E=p?x.getCameraQueryGeometry(o):o,P=o.map(ne=>x.pointCoordinate(ne,this.terrain)),k=E.map(ne=>x.pointCoordinate(ne,this.terrain)),L=this.getIds();let D=1/0,V=1/0,H=-1/0,ie=-1/0;for(const ne of k)D=Math.min(D,ne.x),V=Math.min(V,ne.y),H=Math.max(H,ne.x),ie=Math.max(ie,ne.y);for(let ne=0;ne<L.length;ne++){const re=this._tiles[L[ne]];if(re.holdingForFade())continue;const pe=re.tileID,_e=Math.pow(2,x.zoom-re.tileID.overscaledZ),Ee=h*re.queryPadding*c.EXTENT/re.tileSize/_e,oe=[pe.getTilePoint(new c.MercatorCoordinate(D,V)),pe.getTilePoint(new c.MercatorCoordinate(H,ie))];if(oe[0].x-Ee<c.EXTENT&&oe[0].y-Ee<c.EXTENT&&oe[1].x+Ee>=0&&oe[1].y+Ee>=0){const Ae=P.map(Oe=>pe.getTilePoint(Oe)),Te=k.map(Oe=>pe.getTilePoint(Oe));y.push({tile:re,tileID:pe,queryGeometry:Ae,cameraQueryGeometry:Te,scale:_e})}}return y}getVisibleCoordinates(o){const h=this.getRenderableIds(o).map(p=>this._tiles[p].tileID);for(const p of h)p.posMatrix=this.transform.calculatePosMatrix(p.toUnwrapped());return h}hasTransition(){if(this._source.hasTransition())return!0;if(Wn(this._source.type))for(const o in this._tiles){const h=this._tiles[o];if(h.fadeEndTime!==void 0&&h.fadeEndTime>=c.exported.now())return!0}return!1}setFeatureState(o,h,p){this._state.updateState(o=o||"_geojsonTileLayer",h,p)}removeFeatureState(o,h,p){this._state.removeFeatureState(o=o||"_geojsonTileLayer",h,p)}getFeatureState(o,h){return this._state.getState(o=o||"_geojsonTileLayer",h)}setDependencies(o,h,p){const y=this._tiles[o];y&&y.setDependencies(h,p)}reloadTilesForDependencies(o,h){for(const p in this._tiles)this._tiles[p].hasDependency(o,h)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(o,h))}}function Kt(m,o){const h=Math.abs(2*m.wrap)-+(m.wrap<0),p=Math.abs(2*o.wrap)-+(o.wrap<0);return m.overscaledZ-o.overscaledZ||p-h||o.canonical.y-m.canonical.y||o.canonical.x-m.canonical.x}function Wn(m){return m==="raster"||m==="image"||m==="video"}jt.maxOverzooming=10,jt.maxUnderzooming=3;const In="mapboxgl_preloaded_worker_pool";class Vn{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<Vn.workerCount;)this.workers.push(new Worker(Zo.workerUrl));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(h=>{h.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[In]}numActive(){return Object.keys(this.active).length}}const kr=Math.floor(c.exported.hardwareConcurrency/2);let or;function Hn(){return or||(or=new Vn),or}function Mr(m,o){const h={};for(const p in m)p!=="ref"&&(h[p]=m[p]);return c.refProperties.forEach(p=>{p in o&&(h[p]=o[p])}),h}function jn(m){m=m.slice();const o=Object.create(null);for(let h=0;h<m.length;h++)o[m[h].id]=m[h];for(let h=0;h<m.length;h++)"ref"in m[h]&&(m[h]=Mr(m[h],o[m[h].ref]));return m}Vn.workerCount=Math.max(Math.min(kr,6),1);const Jt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function On(m,o,h){h.push({command:Jt.addSource,args:[m,o[m]]})}function kn(m,o,h){o.push({command:Jt.removeSource,args:[m]}),h[m]=!0}function ti(m,o,h,p){kn(m,h,p),On(m,o,h)}function Wt(m,o,h){let p;for(p in m[h])if(Object.prototype.hasOwnProperty.call(m[h],p)&&p!=="data"&&!I(m[h][p],o[h][p]))return!1;for(p in o[h])if(Object.prototype.hasOwnProperty.call(o[h],p)&&p!=="data"&&!I(m[h][p],o[h][p]))return!1;return!0}function nn(m,o,h,p,y,x){let E;for(E in o=o||{},m=m||{})Object.prototype.hasOwnProperty.call(m,E)&&(I(m[E],o[E])||h.push({command:x,args:[p,E,o[E],y]}));for(E in o)Object.prototype.hasOwnProperty.call(o,E)&&!Object.prototype.hasOwnProperty.call(m,E)&&(I(m[E],o[E])||h.push({command:x,args:[p,E,o[E],y]}))}function Nt(m){return m.id}function Sn(m,o){return m[o.id]=o,m}class Ut{constructor(o,h){this.reset(o,h)}reset(o,h){this.points=o||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=c.clamp(o,0,1);let h=1,p=this._distances[h];const y=o*this.paddedLength+this.padding;for(;p<y&&h<this._distances.length;)p=this._distances[++h];const x=h-1,E=this._distances[x],P=p-E,k=P>0?(y-E)/P:0;return this.points[x].mult(1-k).add(this.points[h].mult(k))}}function Re(m,o){let h=!0;return m==="always"||m!=="never"&&o!=="never"||(h=!1),h}class je{constructor(o,h,p){const y=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(o/p),this.yCellCount=Math.ceil(h/p);for(let E=0;E<this.xCellCount*this.yCellCount;E++)y.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=h,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,h,p,y,x){this._forEachCell(h,p,y,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(x)}insertCircle(o,h,p,y){this._forEachCell(h-y,p-y,h+y,p+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(h),this.circles.push(p),this.circles.push(y)}_insertBoxCell(o,h,p,y,x,E){this.boxCells[x].push(E)}_insertCircleCell(o,h,p,y,x,E){this.circleCells[x].push(E)}_query(o,h,p,y,x,E,P){if(p<0||o>this.width||y<0||h>this.height)return[];const k=[];if(o<=0&&h<=0&&this.width<=p&&this.height<=y){if(x)return[{key:null,x1:o,y1:h,x2:p,y2:y}];for(let L=0;L<this.boxKeys.length;L++)k.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(let L=0;L<this.circleKeys.length;L++){const D=this.circles[3*L],V=this.circles[3*L+1],H=this.circles[3*L+2];k.push({key:this.circleKeys[L],x1:D-H,y1:V-H,x2:D+H,y2:V+H})}}else this._forEachCell(o,h,p,y,this._queryCell,k,{hitTest:x,overlapMode:E,seenUids:{box:{},circle:{}}},P);return k}query(o,h,p,y){return this._query(o,h,p,y,!1,null)}hitTest(o,h,p,y,x,E){return this._query(o,h,p,y,!0,x,E).length>0}hitTestCircle(o,h,p,y,x){const E=o-p,P=o+p,k=h-p,L=h+p;if(P<0||E>this.width||L<0||k>this.height)return!1;const D=[];return this._forEachCell(E,k,P,L,this._queryCellCircle,D,{hitTest:!0,overlapMode:y,circle:{x:o,y:h,radius:p},seenUids:{box:{},circle:{}}},x),D.length>0}_queryCell(o,h,p,y,x,E,P,k){const{seenUids:L,hitTest:D,overlapMode:V}=P,H=this.boxCells[x];if(H!==null){const ne=this.bboxes;for(const re of H)if(!L.box[re]){L.box[re]=!0;const pe=4*re,_e=this.boxKeys[re];if(o<=ne[pe+2]&&h<=ne[pe+3]&&p>=ne[pe+0]&&y>=ne[pe+1]&&(!k||k(_e))&&(!D||!Re(V,_e.overlapMode))&&(E.push({key:_e,x1:ne[pe],y1:ne[pe+1],x2:ne[pe+2],y2:ne[pe+3]}),D))return!0}}const ie=this.circleCells[x];if(ie!==null){const ne=this.circles;for(const re of ie)if(!L.circle[re]){L.circle[re]=!0;const pe=3*re,_e=this.circleKeys[re];if(this._circleAndRectCollide(ne[pe],ne[pe+1],ne[pe+2],o,h,p,y)&&(!k||k(_e))&&(!D||!Re(V,_e.overlapMode))){const Ee=ne[pe],oe=ne[pe+1],Ae=ne[pe+2];if(E.push({key:_e,x1:Ee-Ae,y1:oe-Ae,x2:Ee+Ae,y2:oe+Ae}),D)return!0}}}return!1}_queryCellCircle(o,h,p,y,x,E,P,k){const{circle:L,seenUids:D,overlapMode:V}=P,H=this.boxCells[x];if(H!==null){const ne=this.bboxes;for(const re of H)if(!D.box[re]){D.box[re]=!0;const pe=4*re,_e=this.boxKeys[re];if(this._circleAndRectCollide(L.x,L.y,L.radius,ne[pe+0],ne[pe+1],ne[pe+2],ne[pe+3])&&(!k||k(_e))&&!Re(V,_e.overlapMode))return E.push(!0),!0}}const ie=this.circleCells[x];if(ie!==null){const ne=this.circles;for(const re of ie)if(!D.circle[re]){D.circle[re]=!0;const pe=3*re,_e=this.circleKeys[re];if(this._circlesCollide(ne[pe],ne[pe+1],ne[pe+2],L.x,L.y,L.radius)&&(!k||k(_e))&&!Re(V,_e.overlapMode))return E.push(!0),!0}}}_forEachCell(o,h,p,y,x,E,P,k){const L=this._convertToXCellCoord(o),D=this._convertToYCellCoord(h),V=this._convertToXCellCoord(p),H=this._convertToYCellCoord(y);for(let ie=L;ie<=V;ie++)for(let ne=D;ne<=H;ne++)if(x.call(this,o,h,p,y,this.xCellCount*ne+ie,E,P,k))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,h,p,y,x,E){const P=y-o,k=x-h,L=p+E;return L*L>P*P+k*k}_circleAndRectCollide(o,h,p,y,x,E,P){const k=(E-y)/2,L=Math.abs(o-(y+k));if(L>k+p)return!1;const D=(P-x)/2,V=Math.abs(h-(x+D));if(V>D+p)return!1;if(L<=k||V<=D)return!0;const H=L-k,ie=V-D;return H*H+ie*ie<=p*p}}function Xr(m,o,h,p,y){const x=c.create();return o?(c.scale(x,x,[1/y,1/y,1]),h||c.rotateZ(x,x,p.angle)):c.multiply(x,p.labelPlaneMatrix,m),x}function Dn(m,o,h,p,y){if(o){const x=c.clone(m);return c.scale(x,x,[y,y,1]),h||c.rotateZ(x,x,-p.angle),x}return p.glCoordMatrix}function Ht(m,o,h){let p;h?(p=[m.x,m.y,h(m.x,m.y),1],c.transformMat4(p,p,o)):(p=[m.x,m.y,0,1],Ii(p,p,o));const y=p[3];return{point:new c.pointGeometry(p[0]/y,p[1]/y),signedDistanceFromCamera:y}}function Vr(m,o){return .5+m/o*.5}function ni(m,o){const h=m[0]/m[3],p=m[1]/m[3];return h>=-o[0]&&h<=o[0]&&p>=-o[1]&&p<=o[1]}function ri(m,o,h,p,y,x,E,P,k,L){const D=p?m.textSizeData:m.iconSizeData,V=c.evaluateSizeForZoom(D,h.transform.zoom),H=[256/h.width*2+1,256/h.height*2+1],ie=p?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;ie.clear();const ne=m.lineVertexArray,re=p?m.text.placedSymbolArray:m.icon.placedSymbolArray,pe=h.transform.width/h.transform.height;let _e=!1;for(let Ee=0;Ee<re.length;Ee++){const oe=re.get(Ee);if(oe.hidden||oe.writingMode===c.WritingMode.vertical&&!_e){Rt(oe.numGlyphs,ie);continue}let Ae;if(_e=!1,L?(Ae=[oe.anchorX,oe.anchorY,L(oe.anchorX,oe.anchorY),1],c.transformMat4(Ae,Ae,o)):(Ae=[oe.anchorX,oe.anchorY,0,1],Ii(Ae,Ae,o)),!ni(Ae,H)){Rt(oe.numGlyphs,ie);continue}const Te=Vr(h.transform.cameraToCenterDistance,Ae[3]),Oe=c.evaluateSizeForFeature(D,V,oe),De=E?Oe/Te:Oe*Te,Ge=new c.pointGeometry(oe.anchorX,oe.anchorY),Le=Ht(Ge,y,L).point,lt={},Ke=Ft(oe,De,!1,P,o,y,x,m.glyphOffsetArray,ne,ie,Le,Ge,lt,pe,k,L);_e=Ke.useVertical,(Ke.notEnoughRoom||_e||Ke.needsFlipping&&Ft(oe,De,!0,P,o,y,x,m.glyphOffsetArray,ne,ie,Le,Ge,lt,pe,k,L).notEnoughRoom)&&Rt(oe.numGlyphs,ie)}p?m.text.dynamicLayoutVertexBuffer.updateData(ie):m.icon.dynamicLayoutVertexBuffer.updateData(ie)}function ks(m,o,h,p,y,x,E,P,k,L,D,V,H){const ie=P.glyphStartIndex+P.numGlyphs,ne=P.lineStartIndex,re=P.lineStartIndex+P.lineLength,pe=o.getoffsetX(P.glyphStartIndex),_e=o.getoffsetX(ie-1),Ee=Tr(m*pe,h,p,y,x,E,P.segment,ne,re,k,L,D,V,H);if(!Ee)return null;const oe=Tr(m*_e,h,p,y,x,E,P.segment,ne,re,k,L,D,V,H);return oe?{first:Ee,last:oe}:null}function Ye(m,o,h,p){return m===c.WritingMode.horizontal&&Math.abs(h.y-o.y)>Math.abs(h.x-o.x)*p?{useVertical:!0}:(m===c.WritingMode.vertical?o.y<h.y:o.x>h.x)?{needsFlipping:!0}:null}function Ft(m,o,h,p,y,x,E,P,k,L,D,V,H,ie,ne,re){const pe=o/24,_e=m.lineOffsetX*pe,Ee=m.lineOffsetY*pe;let oe;if(m.numGlyphs>1){const Ae=m.glyphStartIndex+m.numGlyphs,Te=m.lineStartIndex,Oe=m.lineStartIndex+m.lineLength,De=ks(pe,P,_e,Ee,h,D,V,m,k,x,H,ne,re);if(!De)return{notEnoughRoom:!0};const Ge=Ht(De.first.point,E,re).point,Le=Ht(De.last.point,E,re).point;if(p&&!h){const lt=Ye(m.writingMode,Ge,Le,ie);if(lt)return lt}oe=[De.first];for(let lt=m.glyphStartIndex+1;lt<Ae-1;lt++)oe.push(Tr(pe*P.getoffsetX(lt),_e,Ee,h,D,V,m.segment,Te,Oe,k,x,H,ne,re));oe.push(De.last)}else{if(p&&!h){const Te=Ht(V,y,re).point,Oe=m.lineStartIndex+m.segment+1,De=new c.pointGeometry(k.getx(Oe),k.gety(Oe)),Ge=Ht(De,y,re),Le=Ge.signedDistanceFromCamera>0?Ge.point:Dt(V,De,Te,1,y,re),lt=Ye(m.writingMode,Te,Le,ie);if(lt)return lt}const Ae=Tr(pe*P.getoffsetX(m.glyphStartIndex),_e,Ee,h,D,V,m.segment,m.lineStartIndex,m.lineStartIndex+m.lineLength,k,x,H,ne,re);if(!Ae)return{notEnoughRoom:!0};oe=[Ae]}for(const Ae of oe)c.addDynamicAttributes(L,Ae.point,Ae.angle);return{}}function Dt(m,o,h,p,y,x){const E=Ht(m.add(m.sub(o)._unit()),y,x).point,P=h.sub(E);return h.add(P._mult(p/P.mag()))}function Tr(m,o,h,p,y,x,E,P,k,L,D,V,H,ie){const ne=p?m-o:m+o;let re=ne>0?1:-1,pe=0;p&&(re*=-1,pe=Math.PI),re<0&&(pe+=Math.PI);let _e=re>0?P+E:P+E+1,Ee=y,oe=y,Ae=0,Te=0;const Oe=Math.abs(ne),De=[];for(;Ae+Te<=Oe;){if(_e+=re,_e<P||_e>=k)return null;if(oe=Ee,De.push(Ee),Ee=V[_e],Ee===void 0){const ct=new c.pointGeometry(L.getx(_e),L.gety(_e)),Vt=Ht(ct,D,ie);if(Vt.signedDistanceFromCamera>0)Ee=V[_e]=Vt.point;else{const Zt=_e-re;Ee=Dt(Ae===0?x:new c.pointGeometry(L.getx(Zt),L.gety(Zt)),ct,oe,Oe-Ae+1,D,ie)}}Ae+=Te,Te=oe.dist(Ee)}const Ge=(Oe-Ae)/Te,Le=Ee.sub(oe),lt=Le.mult(Ge)._add(oe);lt._add(Le._unit()._perp()._mult(h*re));const Ke=pe+Math.atan2(Ee.y-oe.y,Ee.x-oe.x);return De.push(lt),{point:lt,angle:H?Ke:0,path:De}}const os=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Rt(m,o){for(let h=0;h<m;h++){const p=o.length;o.resize(p+4),o.float32.set(os,3*p)}}function Ii(m,o,h){const p=o[0],y=o[1];return m[0]=h[0]*p+h[4]*y+h[12],m[1]=h[1]*p+h[5]*y+h[13],m[3]=h[3]*p+h[7]*y+h[15],m}const _r=100;class go{constructor(o,h=new je(o.width+200,o.height+200,25),p=new je(o.width+200,o.height+200,25)){this.transform=o,this.grid=h,this.ignoredGrid=p,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+_r,this.screenBottomBoundary=o.height+_r,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,h,p,y,x,E){const P=this.projectAndGetPerspectiveRatio(y,o.anchorPointX,o.anchorPointY,E),k=p*P.perspectiveRatio,L=o.x1*k+P.point.x,D=o.y1*k+P.point.y,V=o.x2*k+P.point.x,H=o.y2*k+P.point.y;return!this.isInsideGrid(L,D,V,H)||h!=="always"&&this.grid.hitTest(L,D,V,H,h,x)||P.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[L,D,V,H],offscreen:this.isOffscreen(L,D,V,H)}}placeCollisionCircles(o,h,p,y,x,E,P,k,L,D,V,H,ie,ne){const re=[],pe=new c.pointGeometry(h.anchorX,h.anchorY),_e=Ht(pe,E,ne),Ee=Vr(this.transform.cameraToCenterDistance,_e.signedDistanceFromCamera),oe=(D?x/Ee:x*Ee)/c.ONE_EM,Ae=Ht(pe,P,ne).point,Te=ks(oe,y,h.lineOffsetX*oe,h.lineOffsetY*oe,!1,Ae,pe,h,p,P,{},!1,ne);let Oe=!1,De=!1,Ge=!0;if(Te){const Le=.5*H*Ee+ie,lt=new c.pointGeometry(-100,-100),Ke=new c.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),ct=new Ut,Vt=Te.first,Zt=Te.last;let Pt=[];for(let un=Vt.path.length-1;un>=1;un--)Pt.push(Vt.path[un]);for(let un=1;un<Zt.path.length;un++)Pt.push(Zt.path[un]);const wn=2.5*Le;if(k){const un=Pt.map(dn=>Ht(dn,k,ne));Pt=un.some(dn=>dn.signedDistanceFromCamera<=0)?[]:un.map(dn=>dn.point)}let En=[];if(Pt.length>0){const un=Pt[0].clone(),dn=Pt[0].clone();for(let An=1;An<Pt.length;An++)un.x=Math.min(un.x,Pt[An].x),un.y=Math.min(un.y,Pt[An].y),dn.x=Math.max(dn.x,Pt[An].x),dn.y=Math.max(dn.y,Pt[An].y);En=un.x>=lt.x&&dn.x<=Ke.x&&un.y>=lt.y&&dn.y<=Ke.y?[Pt]:dn.x<lt.x||un.x>Ke.x||dn.y<lt.y||un.y>Ke.y?[]:c.clipLine([Pt],lt.x,lt.y,Ke.x,Ke.y)}for(const un of En){ct.reset(un,.25*Le);let dn=0;dn=ct.length<=.5*Le?1:Math.ceil(ct.paddedLength/wn)+1;for(let An=0;An<dn;An++){const Rr=An/Math.max(dn-1,1),Os=ct.lerp(Rr),us=Os.x+_r,Ds=Os.y+_r;re.push(us,Ds,Le,0);const Ao=us-Le,Zi=Ds-Le,mi=us+Le,eo=Ds+Le;if(Ge=Ge&&this.isOffscreen(Ao,Zi,mi,eo),De=De||this.isInsideGrid(Ao,Zi,mi,eo),o!=="always"&&this.grid.hitTestCircle(us,Ds,Le,o,V)&&(Oe=!0,!L))return{circles:[],offscreen:!1,collisionDetected:Oe}}}}return{circles:!L&&Oe||!De||Ee<this.perspectiveRatioCutoff?[]:re,offscreen:Ge,collisionDetected:Oe}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let p=1/0,y=1/0,x=-1/0,E=-1/0;for(const D of o){const V=new c.pointGeometry(D.x+_r,D.y+_r);p=Math.min(p,V.x),y=Math.min(y,V.y),x=Math.max(x,V.x),E=Math.max(E,V.y),h.push(V)}const P=this.grid.query(p,y,x,E).concat(this.ignoredGrid.query(p,y,x,E)),k={},L={};for(const D of P){const V=D.key;if(k[V.bucketInstanceId]===void 0&&(k[V.bucketInstanceId]={}),k[V.bucketInstanceId][V.featureIndex])continue;const H=[new c.pointGeometry(D.x1,D.y1),new c.pointGeometry(D.x2,D.y1),new c.pointGeometry(D.x2,D.y2),new c.pointGeometry(D.x1,D.y2)];c.polygonIntersectsPolygon(h,H)&&(k[V.bucketInstanceId][V.featureIndex]=!0,L[V.bucketInstanceId]===void 0&&(L[V.bucketInstanceId]=[]),L[V.bucketInstanceId].push(V.featureIndex))}return L}insertCollisionBox(o,h,p,y,x,E){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:x,collisionGroupID:E,overlapMode:h},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,h,p,y,x,E){const P=p?this.ignoredGrid:this.grid,k={bucketInstanceId:y,featureIndex:x,collisionGroupID:E,overlapMode:h};for(let L=0;L<o.length;L+=4)P.insertCircle(k,o[L],o[L+1],o[L+2])}projectAndGetPerspectiveRatio(o,h,p,y){let x;return y?(x=[h,p,y(h,p),1],c.transformMat4(x,x,o)):(x=[h,p,0,1],Ii(x,x,o)),{point:new c.pointGeometry((x[0]/x[3]+1)/2*this.transform.width+_r,(-x[1]/x[3]+1)/2*this.transform.height+_r),perspectiveRatio:.5+this.transform.cameraToCenterDistance/x[3]*.5}}isOffscreen(o,h,p,y){return p<_r||o>=this.screenRightBoundary||y<_r||h>this.screenBottomBoundary}isInsideGrid(o,h,p,y){return p>=0&&o<this.gridRightBoundary&&y>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const o=c.identity([]);return c.translate(o,o,[-100,-100,0]),o}}function ar(m,o,h){return o*(c.EXTENT/(m.tileSize*Math.pow(2,h-m.tileID.overscaledZ)))}class Lr{constructor(o,h,p,y){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?h:-h))):y&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class xn{constructor(o,h,p,y,x){this.text=new Lr(o?o.text:null,h,p,x),this.icon=new Lr(o?o.icon:null,h,y,x)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class yo{constructor(o,h,p){this.text=o,this.icon=h,this.skipFade=p}}class Hi{constructor(){this.invProjMatrix=c.create(),this.viewportMatrix=c.create(),this.circles=[]}}class qi{constructor(o,h,p,y,x){this.bucketInstanceId=o,this.featureIndex=h,this.sourceLayerIndex=p,this.bucketIndex=y,this.tileID=x}}class Ys{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const h=++this.maxGroupID;this.collisionGroups[o]={ID:h,predicate:p=>p.collisionGroupID===h}}return this.collisionGroups[o]}}function _o(m,o,h,p,y){const{horizontalAlign:x,verticalAlign:E}=c.getAnchorAlignment(m),P=-(x-.5)*o,k=-(E-.5)*h,L=c.evaluateVariableOffset(m,p);return new c.pointGeometry(P+L[0]*y,k+L[1]*y)}function Ms(m,o,h,p,y,x){const{x1:E,x2:P,y1:k,y2:L,anchorPointX:D,anchorPointY:V}=m,H=new c.pointGeometry(o,h);return p&&H._rotate(y?x:-x),{x1:E+H.x,y1:k+H.y,x2:P+H.x,y2:L+H.y,anchorPointX:D,anchorPointY:V}}class te{constructor(o,h,p,y,x){this.transform=o.clone(),this.terrain=h,this.collisionIndex=new go(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Ys(y),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,h,p,y){const x=p.getBucket(h),E=p.latestFeatureIndex;if(!x||!E||h.id!==x.layerIds[0])return;const P=p.collisionBoxArray,k=x.layers[0].layout,L=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),D=p.tileSize/c.EXTENT,V=this.transform.calculatePosMatrix(p.tileID.toUnwrapped()),H=k.get("text-pitch-alignment")==="map",ie=k.get("text-rotation-alignment")==="map",ne=ar(p,1,this.transform.zoom),re=Xr(V,H,ie,this.transform,ne);let pe=null;if(H){const Ee=Dn(V,H,ie,this.transform,ne);pe=c.multiply([],this.transform.labelPlaneMatrix,Ee)}this.retainedQueryData[x.bucketInstanceId]=new qi(x.bucketInstanceId,E,x.sourceLayerIndex,x.index,p.tileID);const _e={bucket:x,layout:k,posMatrix:V,textLabelPlaneMatrix:re,labelToScreenMatrix:pe,scale:L,textPixelRatio:D,holdingForFade:p.holdingForFade(),collisionBoxArray:P,partiallyEvaluatedTextSize:c.evaluateSizeForZoom(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(y)for(const Ee of x.sortKeyRanges){const{sortKey:oe,symbolInstanceStart:Ae,symbolInstanceEnd:Te}=Ee;o.push({sortKey:oe,symbolInstanceStart:Ae,symbolInstanceEnd:Te,parameters:_e})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:_e})}attemptAnchorPlacement(o,h,p,y,x,E,P,k,L,D,V,H,ie,ne,re,pe){const _e=[H.textOffset0,H.textOffset1],Ee=_o(o,p,y,_e,x),oe=this.collisionIndex.placeCollisionBox(Ms(h,Ee.x,Ee.y,E,P,this.transform.angle),V,k,L,D.predicate,pe);if((!re||this.collisionIndex.placeCollisionBox(Ms(re,Ee.x,Ee.y,E,P,this.transform.angle),V,k,L,D.predicate,pe).box.length!==0)&&oe.box.length>0){let Ae;if(this.prevPlacement&&this.prevPlacement.variableOffsets[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID].text&&(Ae=this.prevPlacement.variableOffsets[H.crossTileID].anchor),H.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[H.crossTileID]={textOffset:_e,width:p,height:y,anchor:o,textBoxScale:x,prevAnchor:Ae},this.markUsedJustification(ie,o,H,ne),ie.allowVerticalPlacement&&(this.markUsedOrientation(ie,ne,H),this.placedOrientations[H.crossTileID]=ne),{shift:Ee,placedGlyphBoxes:oe}}}placeLayerBucketPart(o,h,p){const{bucket:y,layout:x,posMatrix:E,textLabelPlaneMatrix:P,labelToScreenMatrix:k,textPixelRatio:L,holdingForFade:D,collisionBoxArray:V,partiallyEvaluatedTextSize:H,collisionGroup:ie}=o.parameters,ne=x.get("text-optional"),re=x.get("icon-optional"),pe=c.getOverlapMode(x,"text-overlap","text-allow-overlap"),_e=pe==="always",Ee=c.getOverlapMode(x,"icon-overlap","icon-allow-overlap"),oe=Ee==="always",Ae=x.get("text-rotation-alignment")==="map",Te=x.get("text-pitch-alignment")==="map",Oe=x.get("icon-text-fit")!=="none",De=x.get("symbol-z-order")==="viewport-y",Ge=_e&&(oe||!y.hasIconData()||re),Le=oe&&(_e||!y.hasTextData()||ne);!y.collisionArrays&&V&&y.deserializeCollisionBoxes(V);const lt=(Ke,ct)=>{if(h[Ke.crossTileID])return;if(D)return void(this.placements[Ke.crossTileID]=new yo(!1,!1,!1));let Vt=!1,Zt=!1,Pt=!0,wn=null,En={box:null,offscreen:null},un={box:null,offscreen:null},dn=null,An=null,Rr=null,Os=0,us=0,Ds=0;ct.textFeatureIndex?Os=ct.textFeatureIndex:Ke.useRuntimeCollisionCircles&&(Os=Ke.featureIndex),ct.verticalTextFeatureIndex&&(us=ct.verticalTextFeatureIndex);const Ao=this.retainedQueryData[y.bucketInstanceId].tileID,Zi=this.terrain?(Ar,rn)=>this.terrain.getElevation(Ao,Ar,rn):null;for(const Ar of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const rn=ct[Ar];rn&&(rn.elevation=Zi?Zi(rn.anchorPointX,rn.anchorPointY):0)}const mi=ct.textBox;if(mi){const Ar=bn=>{let Or=c.WritingMode.horizontal;if(y.allowVerticalPlacement&&!bn&&this.prevPlacement){const Dr=this.prevPlacement.placedOrientations[Ke.crossTileID];Dr&&(this.placedOrientations[Ke.crossTileID]=Dr,Or=Dr,this.markUsedOrientation(y,Or,Ke))}return Or},rn=(bn,Or)=>{if(y.allowVerticalPlacement&&Ke.numVerticalGlyphVertices>0&&ct.verticalTextBox){for(const Dr of y.writingModes)if(Dr===c.WritingMode.vertical?(En=Or(),un=En):En=bn(),En&&En.box&&En.box.length)break}else En=bn()};if(x.get("text-variable-anchor")){let bn=x.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ke.crossTileID]){const Zn=this.prevPlacement.variableOffsets[Ke.crossTileID];bn.indexOf(Zn.anchor)>0&&(bn=bn.filter(Yi=>Yi!==Zn.anchor),bn.unshift(Zn.anchor))}const Or=(Zn,Yi,Yo)=>{const Xh=Zn.x2-Zn.x1,Va=Zn.y2-Zn.y1,Rp=Ke.textBoxScale,Zh=Oe&&Ee==="never"?Yi:null;let Po={box:[],offscreen:!1};const Ko=pe!=="never"?2*bn.length:bn.length;for(let Jo=0;Jo<Ko;++Jo){const Kc=this.attemptAnchorPlacement(bn[Jo%bn.length],Zn,Xh,Va,Rp,Ae,Te,L,E,ie,Jo>=bn.length?pe:"never",Ke,y,Yo,Zh,Zi);if(Kc&&(Po=Kc.placedGlyphBoxes,Po&&Po.box&&Po.box.length)){Vt=!0,wn=Kc.shift;break}}return Po};rn(()=>Or(mi,ct.iconBox,c.WritingMode.horizontal),()=>{const Zn=ct.verticalTextBox;return y.allowVerticalPlacement&&!(En&&En.box&&En.box.length)&&Ke.numVerticalGlyphVertices>0&&Zn?Or(Zn,ct.verticalIconBox,c.WritingMode.vertical):{box:null,offscreen:null}}),En&&(Vt=En.box,Pt=En.offscreen);const Dr=Ar(En&&En.box);if(!Vt&&this.prevPlacement){const Zn=this.prevPlacement.variableOffsets[Ke.crossTileID];Zn&&(this.variableOffsets[Ke.crossTileID]=Zn,this.markUsedJustification(y,Zn.anchor,Ke,Dr))}}else{const bn=(Or,Dr)=>{const Zn=this.collisionIndex.placeCollisionBox(Or,pe,L,E,ie.predicate,Zi);return Zn&&Zn.box&&Zn.box.length&&(this.markUsedOrientation(y,Dr,Ke),this.placedOrientations[Ke.crossTileID]=Dr),Zn};rn(()=>bn(mi,c.WritingMode.horizontal),()=>{const Or=ct.verticalTextBox;return y.allowVerticalPlacement&&Ke.numVerticalGlyphVertices>0&&Or?bn(Or,c.WritingMode.vertical):{box:null,offscreen:null}}),Ar(En&&En.box&&En.box.length)}}if(dn=En,Vt=dn&&dn.box&&dn.box.length>0,Pt=dn&&dn.offscreen,Ke.useRuntimeCollisionCircles){const Ar=y.text.placedSymbolArray.get(Ke.centerJustifiedTextSymbolIndex),rn=c.evaluateSizeForFeature(y.textSizeData,H,Ar),bn=x.get("text-padding");An=this.collisionIndex.placeCollisionCircles(pe,Ar,y.lineVertexArray,y.glyphOffsetArray,rn,E,P,k,p,Te,ie.predicate,Ke.collisionCircleDiameter,bn,Zi),An.circles.length&&An.collisionDetected&&!p&&c.warnOnce("Collisions detected, but collision boxes are not shown"),Vt=_e||An.circles.length>0&&!An.collisionDetected,Pt=Pt&&An.offscreen}if(ct.iconFeatureIndex&&(Ds=ct.iconFeatureIndex),ct.iconBox){const Ar=rn=>{const bn=Oe&&wn?Ms(rn,wn.x,wn.y,Ae,Te,this.transform.angle):rn;return this.collisionIndex.placeCollisionBox(bn,Ee,L,E,ie.predicate,Zi)};un&&un.box&&un.box.length&&ct.verticalIconBox?(Rr=Ar(ct.verticalIconBox),Zt=Rr.box.length>0):(Rr=Ar(ct.iconBox),Zt=Rr.box.length>0),Pt=Pt&&Rr.offscreen}const eo=ne||Ke.numHorizontalGlyphVertices===0&&Ke.numVerticalGlyphVertices===0,Yc=re||Ke.numIconVertices===0;if(eo||Yc?Yc?eo||(Zt=Zt&&Vt):Vt=Zt&&Vt:Zt=Vt=Zt&&Vt,Vt&&dn&&dn.box&&this.collisionIndex.insertCollisionBox(dn.box,pe,x.get("text-ignore-placement"),y.bucketInstanceId,un&&un.box&&us?us:Os,ie.ID),Zt&&Rr&&this.collisionIndex.insertCollisionBox(Rr.box,Ee,x.get("icon-ignore-placement"),y.bucketInstanceId,Ds,ie.ID),An&&(Vt&&this.collisionIndex.insertCollisionCircles(An.circles,pe,x.get("text-ignore-placement"),y.bucketInstanceId,Os,ie.ID),p)){const Ar=y.bucketInstanceId;let rn=this.collisionCircleArrays[Ar];rn===void 0&&(rn=this.collisionCircleArrays[Ar]=new Hi);for(let bn=0;bn<An.circles.length;bn+=4)rn.circles.push(An.circles[bn+0]),rn.circles.push(An.circles[bn+1]),rn.circles.push(An.circles[bn+2]),rn.circles.push(An.collisionDetected?1:0)}if(Ke.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(y.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ke.crossTileID]=new yo(Vt||Ge,Zt||Le,Pt||y.justReloaded),h[Ke.crossTileID]=!0};if(De){if(o.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ke=y.getSortedSymbolIndexes(this.transform.angle);for(let ct=Ke.length-1;ct>=0;--ct){const Vt=Ke[ct];lt(y.symbolInstances.get(Vt),y.collisionArrays[Vt])}}else for(let Ke=o.symbolInstanceStart;Ke<o.symbolInstanceEnd;Ke++)lt(y.symbolInstances.get(Ke),y.collisionArrays[Ke]);if(p&&y.bucketInstanceId in this.collisionCircleArrays){const Ke=this.collisionCircleArrays[y.bucketInstanceId];c.invert(Ke.invProjMatrix,E),Ke.viewportMatrix=this.collisionIndex.getViewportMatrix()}y.justReloaded=!1}markUsedJustification(o,h,p,y){let x;x=y===c.WritingMode.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[c.getAnchorJustification(h)];const E=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const P of E)P>=0&&(o.text.placedSymbolArray.get(P).crossTileID=x>=0&&P!==x?0:p.crossTileID)}markUsedOrientation(o,h,p){const y=h===c.WritingMode.horizontal||h===c.WritingMode.horizontalOnly?h:0,x=h===c.WritingMode.vertical?h:0,E=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const P of E)o.text.placedSymbolArray.get(P).placedOrientation=y;p.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let p=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const y=h?h.symbolFadeChange(o):1,x=h?h.opacities:{},E=h?h.variableOffsets:{},P=h?h.placedOrientations:{};for(const k in this.placements){const L=this.placements[k],D=x[k];D?(this.opacities[k]=new xn(D,y,L.text,L.icon),p=p||L.text!==D.text.placed||L.icon!==D.icon.placed):(this.opacities[k]=new xn(null,y,L.text,L.icon,L.skipFade),p=p||L.text||L.icon)}for(const k in x){const L=x[k];if(!this.opacities[k]){const D=new xn(L,y,!1,!1);D.isHidden()||(this.opacities[k]=D,p=p||L.text.placed||L.icon.placed)}}for(const k in E)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=E[k]);for(const k in P)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=P[k]);if(h&&h.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:o)}updateLayerOpacities(o,h){const p={};for(const y of h){const x=y.getBucket(o);x&&y.latestFeatureIndex&&o.id===x.layerIds[0]&&this.updateBucketOpacities(x,p,y.collisionBoxArray)}}updateBucketOpacities(o,h,p){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const y=o.layers[0].layout,x=new xn(null,0,!1,!1,!0),E=y.get("text-allow-overlap"),P=y.get("icon-allow-overlap"),k=y.get("text-variable-anchor"),L=y.get("text-rotation-alignment")==="map",D=y.get("text-pitch-alignment")==="map",V=y.get("icon-text-fit")!=="none",H=new xn(null,0,E&&(P||!o.hasIconData()||y.get("icon-optional")),P&&(E||!o.hasTextData()||y.get("text-optional")),!0);!o.collisionArrays&&p&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(p);const ie=(ne,re,pe)=>{for(let _e=0;_e<re/4;_e++)ne.opacityVertexArray.emplaceBack(pe)};for(let ne=0;ne<o.symbolInstances.length;ne++){const re=o.symbolInstances.get(ne),{numHorizontalGlyphVertices:pe,numVerticalGlyphVertices:_e,crossTileID:Ee}=re;let oe=this.opacities[Ee];h[Ee]?oe=x:oe||(oe=H,this.opacities[Ee]=oe),h[Ee]=!0;const Ae=re.numIconVertices>0,Te=this.placedOrientations[re.crossTileID],Oe=Te===c.WritingMode.vertical,De=Te===c.WritingMode.horizontal||Te===c.WritingMode.horizontalOnly;if(pe>0||_e>0){const Ge=ge(oe.text);ie(o.text,pe,Oe?Me:Ge),ie(o.text,_e,De?Me:Ge);const Le=oe.text.isHidden();[re.rightJustifiedTextSymbolIndex,re.centerJustifiedTextSymbolIndex,re.leftJustifiedTextSymbolIndex].forEach(ct=>{ct>=0&&(o.text.placedSymbolArray.get(ct).hidden=Le||Oe?1:0)}),re.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(re.verticalPlacedTextSymbolIndex).hidden=Le||De?1:0);const lt=this.variableOffsets[re.crossTileID];lt&&this.markUsedJustification(o,lt.anchor,re,Te);const Ke=this.placedOrientations[re.crossTileID];Ke&&(this.markUsedJustification(o,"left",re,Ke),this.markUsedOrientation(o,Ke,re))}if(Ae){const Ge=ge(oe.icon),Le=!(V&&re.verticalPlacedIconSymbolIndex&&Oe);re.placedIconSymbolIndex>=0&&(ie(o.icon,re.numIconVertices,Le?Ge:Me),o.icon.placedSymbolArray.get(re.placedIconSymbolIndex).hidden=oe.icon.isHidden()),re.verticalPlacedIconSymbolIndex>=0&&(ie(o.icon,re.numVerticalIconVertices,Le?Me:Ge),o.icon.placedSymbolArray.get(re.verticalPlacedIconSymbolIndex).hidden=oe.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Ge=o.collisionArrays[ne];if(Ge){let Le=new c.pointGeometry(0,0);if(Ge.textBox||Ge.verticalTextBox){let Ke=!0;if(k){const ct=this.variableOffsets[Ee];ct?(Le=_o(ct.anchor,ct.width,ct.height,ct.textOffset,ct.textBoxScale),L&&Le._rotate(D?this.transform.angle:-this.transform.angle)):Ke=!1}Ge.textBox&&R(o.textCollisionBox.collisionVertexArray,oe.text.placed,!Ke||Oe,Le.x,Le.y),Ge.verticalTextBox&&R(o.textCollisionBox.collisionVertexArray,oe.text.placed,!Ke||De,Le.x,Le.y)}const lt=Boolean(!De&&Ge.verticalIconBox);Ge.iconBox&&R(o.iconCollisionBox.collisionVertexArray,oe.icon.placed,lt,V?Le.x:0,V?Le.y:0),Ge.verticalIconBox&&R(o.iconCollisionBox.collisionVertexArray,oe.icon.placed,!lt,V?Le.x:0,V?Le.y:0)}}}if(o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);if(o.bucketInstanceId in this.collisionCircleArrays){const ne=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=ne.invProjMatrix,o.placementViewportMatrix=ne.viewportMatrix,o.collisionCircleArray=ne.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,h){const p=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*p>o}setStale(){this.stale=!0}}function R(m,o,h,p,y){m.emplaceBack(o?1:0,h?1:0,p||0,y||0),m.emplaceBack(o?1:0,h?1:0,p||0,y||0),m.emplaceBack(o?1:0,h?1:0,p||0,y||0),m.emplaceBack(o?1:0,h?1:0,p||0,y||0)}const U=Math.pow(2,25),K=Math.pow(2,24),J=Math.pow(2,17),ue=Math.pow(2,16),me=Math.pow(2,9),fe=Math.pow(2,8),ce=Math.pow(2,1);function ge(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const o=m.placed?1:0,h=Math.floor(127*m.opacity);return h*U+o*K+h*J+o*ue+h*me+o*fe+h*ce+o}const Me=0;class Ue{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,h,p,y,x){const E=this._bucketParts;for(;this._currentTileIndex<o.length;)if(h.getBucketParts(E,y,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((P,k)=>P.sortKey-k.sortKey));this._currentPartIndex<E.length;)if(h.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,x())return!0;return!1}}class ke{constructor(o,h,p,y,x,E,P,k){this.placement=new te(o,h,E,P,k),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(o,h,p){const y=c.exported.now(),x=()=>{const E=c.exported.now()-y;return!this._forceFullPlacement&&E>2};for(;this._currentPlacementIndex>=0;){const E=h[o[this._currentPlacementIndex]],P=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=P)&&(!E.maxzoom||E.maxzoom>P)){if(this._inProgressLayer||(this._inProgressLayer=new Ue(E)),this._inProgressLayer.continuePlacement(p[E.source],this.placement,this._showCollisionBoxes,E,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const ht=512/c.EXTENT/2;class pt{constructor(o,h,p){this.tileID=o,this.indexedSymbolInstances={},this.bucketInstanceId=p;for(let y=0;y<h.length;y++){const x=h.get(y),E=x.key;this.indexedSymbolInstances[E]||(this.indexedSymbolInstances[E]=[]),this.indexedSymbolInstances[E].push({crossTileID:x.crossTileID,coord:this.getScaledCoordinates(x,o)})}}getScaledCoordinates(o,h){const p=ht/Math.pow(2,h.canonical.z-this.tileID.canonical.z);return{x:Math.floor((h.canonical.x*c.EXTENT+o.anchorX)*p),y:Math.floor((h.canonical.y*c.EXTENT+o.anchorY)*p)}}findMatches(o,h,p){const y=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z);for(let x=0;x<o.length;x++){const E=o.get(x);if(E.crossTileID)continue;const P=this.indexedSymbolInstances[E.key];if(!P)continue;const k=this.getScaledCoordinates(E,h);for(const L of P)if(Math.abs(L.coord.x-k.x)<=y&&Math.abs(L.coord.y-k.y)<=y&&!p[L.crossTileID]){p[L.crossTileID]=!0,E.crossTileID=L.crossTileID;break}}}}class nt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class At{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const h=Math.round((o-this.lng)/360);if(h!==0)for(const p in this.indexes){const y=this.indexes[p],x={};for(const E in y){const P=y[E];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+h),x[P.tileID.key]=P}this.indexes[p]=x}this.lng=o}addBucket(o,h,p){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let x=0;x<h.symbolInstances.length;x++)h.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const y=this.usedCrossTileIDs[o.overscaledZ];for(const x in this.indexes){const E=this.indexes[x];if(Number(x)>o.overscaledZ)for(const P in E){const k=E[P];k.tileID.isChildOf(o)&&k.findMatches(h.symbolInstances,o,y)}else{const P=E[o.scaledTo(Number(x)).key];P&&P.findMatches(h.symbolInstances,o,y)}}for(let x=0;x<h.symbolInstances.length;x++){const E=h.symbolInstances.get(x);E.crossTileID||(E.crossTileID=p.generate(),y[E.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new pt(o,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(o,h){for(const p in h.indexedSymbolInstances)for(const y of h.indexedSymbolInstances[p])delete this.usedCrossTileIDs[o][y.crossTileID]}removeStaleBuckets(o){let h=!1;for(const p in this.indexes){const y=this.indexes[p];for(const x in y)o[y[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,y[x]),delete y[x],h=!0)}return h}}class xt{constructor(){this.layerIndexes={},this.crossTileIDs=new nt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,h,p){let y=this.layerIndexes[o.id];y===void 0&&(y=this.layerIndexes[o.id]=new At);let x=!1;const E={};y.handleWrapJump(p);for(const P of h){const k=P.getBucket(o);k&&o.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(P.tileID,k,this.crossTileIDs)&&(x=!0),E[k.bucketInstanceId]=!0)}return y.removeStaleBuckets(E)&&(x=!0),x}pruneUnusedLayers(o){const h={};o.forEach(p=>{h[p]=!0});for(const p in this.layerIndexes)h[p]||delete this.layerIndexes[p]}}var qt=c.createLayout([{name:"a_pos",type:"Int16",components:2}]);class It extends c.Evented{constructor(o){super(),this.sourceCache=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=o._cache.max,o.usedForTerrain=!0,o.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const o in this._tiles){const h=this._tiles[o];h.textures.forEach(p=>p.destroy()),h.textures=[]}}update(o,h){this.sourceCache.update(o,h),this._renderableTilesKeys=[];for(const p of o.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:h}))this._renderableTilesKeys.push(p.key),this._tiles[p.key]||(p.posMatrix=new Float64Array(16),c.ortho(p.posMatrix,0,c.EXTENT,0,c.EXTENT,0,1),this._tiles[p.key]=new sn(p,this.tileSize))}removeOutdated(o){const h={};this.renderHistory=this.renderHistory.filter((p,y)=>this.renderHistory.indexOf(p)===y).slice(0,this.renderHistorySize);for(const p of this._renderableTilesKeys)h[p]=!0;for(const p of this.renderHistory)h[p]=!0;for(const p in this._tiles)h[p]||(this._tiles[p].clearTextures(o),delete this._tiles[p])}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o){const h={};for(const p of this._renderableTilesKeys){const y=this._tiles[p].tileID;if(y.canonical.equals(o.canonical)){const x=o.clone();x.posMatrix=new Float64Array(16),c.ortho(x.posMatrix,0,c.EXTENT,0,c.EXTENT,0,1),h[p]=x}else if(y.canonical.isChildOf(o.canonical)){const x=o.clone();x.posMatrix=new Float64Array(16);const E=y.canonical.z-o.canonical.z,P=y.canonical.x-(y.canonical.x>>E<<E),k=y.canonical.y-(y.canonical.y>>E<<E),L=c.EXTENT>>E;c.ortho(x.posMatrix,0,L,0,L,0,1),c.translate(x.posMatrix,x.posMatrix,[-P*L,-k*L,0]),h[p]=x}else if(o.canonical.isChildOf(y.canonical)){const x=o.clone();x.posMatrix=new Float64Array(16);const E=o.canonical.z-y.canonical.z,P=o.canonical.x-(o.canonical.x>>E<<E),k=o.canonical.y-(o.canonical.y>>E<<E),L=c.EXTENT>>E;c.ortho(x.posMatrix,0,c.EXTENT,0,c.EXTENT,0,1),c.translate(x.posMatrix,x.posMatrix,[P*L,k*L,0]),c.scale(x.posMatrix,x.posMatrix,[1/2**E,1/2**E,0]),h[p]=x}}return h}getSourceTile(o,h){const p=this.sourceCache._source;let y=o.overscaledZ-this.deltaZoom;if(y>p.maxzoom&&(y=p.maxzoom),y<p.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(y).key);let x=this.sourceCache.getTileByID(this._sourceTileCache[o.key]);if((!x||!x.dem)&&h)for(;y>=p.minzoom&&(!x||!x.dem);)x=this.sourceCache.getTileByID(o.scaledTo(y--).key);return x}tilesAfterTime(o=Date.now()){return Object.values(this._tiles).filter(h=>h.timeLoaded>=o)}}class Lt{constructor(o,h,p){this.style=o,this.sourceCache=new It(h),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.elevationOffset=typeof p.elevationOffset=="number"?p.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(o,h,p,y=c.EXTENT){if(!(h>=0&&h<y&&p>=0&&p<y))return this.elevationOffset;let x=0;const E=this.getTerrainData(o);if(E.tile&&E.tile.dem){const P=c.transformMat4$1([],[h/y*c.EXTENT,p/y*c.EXTENT],E.u_terrain_matrix),k=[P[0]*E.tile.dem.dim,P[1]*E.tile.dem.dim],L=[Math.floor(k[0]),Math.floor(k[1])],D=E.tile.dem.get(L[0],L[1]),V=E.tile.dem.get(L[0],L[1]+1),H=E.tile.dem.get(L[0]+1,L[1]),ie=E.tile.dem.get(L[0]+1,L[1]+1);x=c.number(c.number(D,V,k[0]-L[0]),c.number(H,ie,k[0]-L[0]),k[1]-L[1])}return x}rememberForRerender(o,h){for(const p in this.sourceCache._tiles){const y=this.sourceCache._tiles[p];(y.tileID.equals(h)||y.tileID.isChildOf(h))&&(o===this.sourceCache.sourceCache.id&&(y.timeLoaded=Date.now()),this._rerender[o]=this._rerender[o]||{},this._rerender[o][y.tileID.key]=!0)}}needsRerender(o,h){return this._rerender[o]&&this._rerender[o][h.key]}clearRerenderCache(){this._rerender={}}getElevation(o,h,p,y=c.EXTENT){return(this.getDEMElevation(o,h,p,y)+this.elevationOffset)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const y=this.style.map.painter.context,x=new c.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new B(y,x,y.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new B(y,new c.RGBAImage({width:1,height:1}),y.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.identity([])}const h=this.sourceCache.getSourceTile(o,!0);if(h&&h.dem&&(!h.demTexture||h.needsTerrainPrepare)){const y=this.style.map.painter.context;h.demTexture=this.style.map.painter.getTileTexture(h.dem.stride),h.demTexture?h.demTexture.update(h.dem.getPixels(),{premultiply:!1}):h.demTexture=new B(y,h.dem.getPixels(),y.gl.RGBA,{premultiply:!1}),h.demTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),h.needsTerrainPrepare=!1}const p=h&&h+h.tileID.key+o.key;if(p&&!this._demMatrixCache[p]){const y=this.sourceCache.sourceCache._source.maxzoom;let x=o.canonical.z-h.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=y?x=o.canonical.z-y:c.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=o.canonical.x-(o.canonical.x>>x<<x),P=o.canonical.y-(o.canonical.y>>x<<x),k=c.fromScaling(new Float64Array(16),[1/(c.EXTENT<<x),1/(c.EXTENT<<x),0]);c.translate(k,k,[E*c.EXTENT,P*c.EXTENT,0]),this._demMatrixCache[o.key]={matrix:k,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:h&&h.dem&&h.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:h&&h.dem&&h.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(h&&h.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:h}}getRTTFramebuffer(){const o=this.style.map.painter;if(!this._rttFramebuffer){const h=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=o.context.createFramebuffer(h,h,!0),this._rttFramebuffer.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,h,h))}return this._rttFramebuffer}getFramebuffer(o){const h=this.style.map.painter,p=h.width/devicePixelRatio,y=h.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===y||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new B(h.context,{width:p,height:y,data:null},h.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(h.context.gl.NEAREST,h.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new B(h.context,{width:p,height:y,data:null},h.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(h.context.gl.NEAREST,h.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=h.context.createFramebuffer(p,y,!0),this._fbo.depthAttachment.set(h.context.createRenderbuffer(h.context.gl.DEPTH_COMPONENT16,p,y))),this._fbo.colorAttachment.set(o==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const h=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let x=0,E=0;x<this._coordsTextureSize;x++)for(let P=0;P<this._coordsTextureSize;P++,E+=4)h[E+0]=255&P,h[E+1]=255&x,h[E+2]=P>>8<<4|x>>8,h[E+3]=0;const p=new c.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(h.buffer)),y=new B(o,p,o.gl.RGBA,{premultiply:!1});return y.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=y,y}pointCoordinate(o){const h=new Uint8Array(4),p=this.style.map.painter,y=p.context,x=y.gl;y.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),x.readPixels(o.x,p.height/devicePixelRatio-o.y-1,1,1,x.RGBA,x.UNSIGNED_BYTE,h),y.bindFramebuffer.set(null);const E=h[0]+(h[2]>>4<<8),P=h[1]+((15&h[2])<<8),k=this.coordsIndex[255-h[3]],L=k&&this.sourceCache.getTileByID(k);if(!L)return null;const D=this._coordsTextureSize,V=(1<<L.tileID.canonical.z)*D;return new c.MercatorCoordinate((L.tileID.canonical.x*D+E)/V,(L.tileID.canonical.y*D+P)/V,this.getElevation(L.tileID,E,P,D))}getTerrainMesh(){if(this._mesh)return this._mesh;const o=this.style.map.painter.context,h=new c.PosArray,p=new c.TriangleIndexArray,y=this.meshSize,x=c.EXTENT/y,E=y*y;for(let P=0;P<=y;P++)for(let k=0;k<=y;k++)h.emplaceBack(k*x,P*x);for(let P=0;P<E;P+=y+1)for(let k=0;k<y;k++)p.emplaceBack(k+P,y+k+P+1,y+k+P+2),p.emplaceBack(k+P,y+k+P+2,k+P+1);return this._mesh={indexBuffer:o.createIndexBuffer(p),vertexBuffer:o.createVertexBuffer(h,qt.members),segments:c.SegmentVector.simpleSegment(0,0,h.length,p.length)},this._mesh}getMinMaxElevation(o){const h=this.getTerrainData(o).tile,p={minElevation:null,maxElevation:null};return h&&h.dem&&(p.minElevation=(h.dem.min+this.elevationOffset)*this.exaggeration,p.maxElevation=(h.dem.max+this.elevationOffset)*this.exaggeration),p}}const Qt=(m,o)=>c.emitValidationErrors(m,o&&o.filter(h=>h.identifier!=="source.canvas")),on=c.pick(Jt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Mn=c.pick(Jt,["setCenter","setZoom","setBearing","setPitch"]),Ln=function(){const m={},o=c.spec.$version;for(const h in c.spec.$root){const p=c.spec.$root[h];if(p.required){let y=null;y=h==="version"?o:p.type==="array"?[]:{},y!=null&&(m[h]=y)}}return m}();class Sr extends c.Evented{constructor(o,h={}){super(),this.map=o,this.dispatcher=new xe(Hn(),this),this.imageManager=new q,this.imageManager.setEventedParent(this),this.glyphManager=new he(o._requestManager,h.localIdeographFontFamily),this.lineAtlas=new Ve(256,512),this.crossTileSymbolIndex=new xt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",c.getReferrer());const p=this;this._rtlTextPluginCallback=Sr.registerForPluginStateChange(y=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(x,E)=>{if(c.triggerPluginCompletionEvent(x),E&&E.every(P=>P))for(const P in p.sourceCaches)p.sourceCaches[P].reload()})}),this.on("data",y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;const x=this.sourceCaches[y.sourceId];if(!x)return;const E=x.getSource();if(E&&E.vectorLayerIds)for(const P in this._layers){const k=this._layers[P];k.source===E.id&&this._validateLayer(k)}})}loadURL(o,h={}){this.fire(new c.Event("dataloading",{dataType:"style"}));const p=typeof h.validate!="boolean"||h.validate,y=this.map._requestManager.transformRequest(o,c.ResourceType.Style);this._request=c.getJSON(y,(x,E)=>{this._request=null,x?this.fire(new c.ErrorEvent(x)):E&&this._load(E,p)})}loadJSON(o,h={}){this.fire(new c.Event("dataloading",{dataType:"style"})),this._request=c.exported.frame(()=>{this._request=null,this._load(o,h.validate!==!1)})}loadEmpty(){this.fire(new c.Event("dataloading",{dataType:"style"})),this._load(Ln,!1)}_load(o,h){if(h&&Qt(this,c.validateStyle(o)))return;this._loaded=!0,this.stylesheet=o;for(const y in o.sources)this.addSource(y,o.sources[y],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);const p=jn(this.stylesheet.layers);this._order=p.map(y=>y.id),this._layers={},this._serializedLayers={};for(let y of p)y=c.createStyleLayer(y),y.setEventedParent(this,{layer:{id:y.id}}),this._layers[y.id]=y,this._serializedLayers[y.id]=y.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Be(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new c.Event("data",{dataType:"style"})),this.fire(new c.Event("style.load"))}_loadSprite(o){this._spriteRequest=function(h,p,y,x){let E,P,k;const L=y>1?"@2x":"";let D=c.getJSON(p.transformRequest(p.normalizeSpriteURL(h,L,".json"),c.ResourceType.SpriteJSON),(ie,ne)=>{D=null,k||(k=ie,E=ne,H())}),V=c.getImage(p.transformRequest(p.normalizeSpriteURL(h,L,".png"),c.ResourceType.SpriteImage),(ie,ne)=>{V=null,k||(k=ie,P=ne,H())});function H(){if(k)x(k);else if(E&&P){const ie=c.exported.getImageData(P),ne={};for(const re in E){const{width:pe,height:_e,x:Ee,y:oe,sdf:Ae,pixelRatio:Te,stretchX:Oe,stretchY:De,content:Ge}=E[re],Le=new c.RGBAImage({width:pe,height:_e});c.RGBAImage.copy(ie,Le,{x:Ee,y:oe},{x:0,y:0},{width:pe,height:_e}),ne[re]={data:Le,pixelRatio:Te,sdf:Ae,stretchX:Oe,stretchY:De,content:Ge}}x(null,ne)}}return{cancel(){D&&(D.cancel(),D=null),V&&(V.cancel(),V=null)}}}(o,this.map._requestManager,this.map.getPixelRatio(),(h,p)=>{if(this._spriteRequest=null,h)this.fire(new c.ErrorEvent(h));else if(p)for(const y in p)this.imageManager.addImage(y,p[y]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.Event("data",{dataType:"style"}))})}_validateLayer(o){const h=this.sourceCaches[o.source];if(!h)return;const p=o.sourceLayer;if(!p)return;const y=h.getSource();(y.type==="geojson"||y.vectorLayerIds&&y.vectorLayerIds.indexOf(p)===-1)&&this.fire(new c.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${y.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const h=[];for(const p of o){const y=this._layers[p];y.type!=="custom"&&h.push(y.serialize())}return h}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const h=this._changed;if(this._changed){const y=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(y.length||x.length)&&this._updateWorkerLayers(y,x);for(const E in this._updatedSources){const P=this._updatedSources[E];if(P==="reload")this._reloadSource(E);else{if(P!=="clear")throw new Error(`Invalid action ${P}`);this._clearSource(E)}}this._updateTilesForChangedImages();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}const p={};for(const y in this.sourceCaches){const x=this.sourceCaches[y];p[y]=x.used,x.used=!1}for(const y of this._order){const x=this._layers[y];x.recalculate(o,this._availableImages),!x.isHidden(o.zoom)&&x.source&&(this.sourceCaches[x.source].used=!0)}for(const y in p){const x=this.sourceCaches[y];p[y]!==x.used&&x.fire(new c.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:y}))}this.light.recalculate(o),this.z=o.zoom,h&&this.fire(new c.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const h in this.sourceCaches)this.sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(o){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),o){const h=this.sourceCaches[o.source];if(!h)throw new Error(`cannot load terrain, because there exists no source with ID: ${o.source}`);this.terrain=new Lt(this,h,o),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=p=>{p.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=p=>{p.tile&&(p.sourceId===o.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(p.sourceId,p.tile.tileID)):p.source.type==="geojson"&&this.terrain.rememberForRerender(p.sourceId,p.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new c.Event("terrain",{terrain:o}))}setState(o){if(this._checkLoaded(),Qt(this,c.validateStyle(o)))return!1;(o=c.clone$1(o)).layers=jn(o.layers);const h=function(y,x){if(!y)return[{command:Jt.setStyle,args:[x]}];let E=[];try{if(!I(y.version,x.version))return[{command:Jt.setStyle,args:[x]}];I(y.center,x.center)||E.push({command:Jt.setCenter,args:[x.center]}),I(y.zoom,x.zoom)||E.push({command:Jt.setZoom,args:[x.zoom]}),I(y.bearing,x.bearing)||E.push({command:Jt.setBearing,args:[x.bearing]}),I(y.pitch,x.pitch)||E.push({command:Jt.setPitch,args:[x.pitch]}),I(y.sprite,x.sprite)||E.push({command:Jt.setSprite,args:[x.sprite]}),I(y.glyphs,x.glyphs)||E.push({command:Jt.setGlyphs,args:[x.glyphs]}),I(y.transition,x.transition)||E.push({command:Jt.setTransition,args:[x.transition]}),I(y.light,x.light)||E.push({command:Jt.setLight,args:[x.light]});const P={},k=[];(function(D,V,H,ie){let ne;for(ne in V=V||{},D=D||{})Object.prototype.hasOwnProperty.call(D,ne)&&(Object.prototype.hasOwnProperty.call(V,ne)||kn(ne,H,ie));for(ne in V)Object.prototype.hasOwnProperty.call(V,ne)&&(Object.prototype.hasOwnProperty.call(D,ne)?I(D[ne],V[ne])||(D[ne].type==="geojson"&&V[ne].type==="geojson"&&Wt(D,V,ne)?H.push({command:Jt.setGeoJSONSourceData,args:[ne,V[ne].data]}):ti(ne,V,H,ie)):On(ne,V,H))})(y.sources,x.sources,k,P);const L=[];y.layers&&y.layers.forEach(D=>{P[D.source]?E.push({command:Jt.removeLayer,args:[D.id]}):L.push(D)}),E=E.concat(k),function(D,V,H){V=V||[];const ie=(D=D||[]).map(Nt),ne=V.map(Nt),re=D.reduce(Sn,{}),pe=V.reduce(Sn,{}),_e=ie.slice(),Ee=Object.create(null);let oe,Ae,Te,Oe,De,Ge,Le;for(oe=0,Ae=0;oe<ie.length;oe++)Te=ie[oe],Object.prototype.hasOwnProperty.call(pe,Te)?Ae++:(H.push({command:Jt.removeLayer,args:[Te]}),_e.splice(_e.indexOf(Te,Ae),1));for(oe=0,Ae=0;oe<ne.length;oe++)Te=ne[ne.length-1-oe],_e[_e.length-1-oe]!==Te&&(Object.prototype.hasOwnProperty.call(re,Te)?(H.push({command:Jt.removeLayer,args:[Te]}),_e.splice(_e.lastIndexOf(Te,_e.length-Ae),1)):Ae++,Ge=_e[_e.length-oe],H.push({command:Jt.addLayer,args:[pe[Te],Ge]}),_e.splice(_e.length-oe,0,Te),Ee[Te]=!0);for(oe=0;oe<ne.length;oe++)if(Te=ne[oe],Oe=re[Te],De=pe[Te],!Ee[Te]&&!I(Oe,De))if(I(Oe.source,De.source)&&I(Oe["source-layer"],De["source-layer"])&&I(Oe.type,De.type)){for(Le in nn(Oe.layout,De.layout,H,Te,null,Jt.setLayoutProperty),nn(Oe.paint,De.paint,H,Te,null,Jt.setPaintProperty),I(Oe.filter,De.filter)||H.push({command:Jt.setFilter,args:[Te,De.filter]}),I(Oe.minzoom,De.minzoom)&&I(Oe.maxzoom,De.maxzoom)||H.push({command:Jt.setLayerZoomRange,args:[Te,De.minzoom,De.maxzoom]}),Oe)Object.prototype.hasOwnProperty.call(Oe,Le)&&Le!=="layout"&&Le!=="paint"&&Le!=="filter"&&Le!=="metadata"&&Le!=="minzoom"&&Le!=="maxzoom"&&(Le.indexOf("paint.")===0?nn(Oe[Le],De[Le],H,Te,Le.slice(6),Jt.setPaintProperty):I(Oe[Le],De[Le])||H.push({command:Jt.setLayerProperty,args:[Te,Le,De[Le]]}));for(Le in De)Object.prototype.hasOwnProperty.call(De,Le)&&!Object.prototype.hasOwnProperty.call(Oe,Le)&&Le!=="layout"&&Le!=="paint"&&Le!=="filter"&&Le!=="metadata"&&Le!=="minzoom"&&Le!=="maxzoom"&&(Le.indexOf("paint.")===0?nn(Oe[Le],De[Le],H,Te,Le.slice(6),Jt.setPaintProperty):I(Oe[Le],De[Le])||H.push({command:Jt.setLayerProperty,args:[Te,Le,De[Le]]}))}else H.push({command:Jt.removeLayer,args:[Te]}),Ge=_e[_e.lastIndexOf(Te)+1],H.push({command:Jt.addLayer,args:[De,Ge]})}(L,x.layers,E)}catch(P){console.warn("Unable to compute style diff:",P),E=[{command:Jt.setStyle,args:[x]}]}return E}(this.serialize(),o).filter(y=>!(y.command in Mn));if(h.length===0)return!1;const p=h.filter(y=>!(y.command in on));if(p.length>0)throw new Error(`Unimplemented: ${p.map(y=>y.command).join(", ")}.`);return h.forEach(y=>{y.command!=="setTransition"&&this[y.command].apply(this,y.args)}),this.stylesheet=o,!0}addImage(o,h){if(this.getImage(o))return this.fire(new c.ErrorEvent(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,h),this._afterImageUpdated(o)}updateImage(o,h){this.imageManager.updateImage(o,h)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new c.ErrorEvent(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,h,p={}){if(this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(c.validateStyle.source,`sources.${o}`,h,null,p))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const y=this.sourceCaches[o]=new jt(o,h,this.dispatcher);y.style=this,y.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:y.serialize(),sourceId:o})),y.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===o)return this.fire(new c.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${p}" is using it.`)));const h=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],h.fire(new c.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),h.setEventedParent(null),h.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,h){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error(`There is no source with this ID=${o}`);const p=this.sourceCaches[o].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(h),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,h,p={}){this._checkLoaded();const y=o.id;if(this.getLayer(y))return void this.fire(new c.ErrorEvent(new Error(`Layer "${y}" already exists on this map.`)));let x;if(o.type==="custom"){if(Qt(this,c.validateCustomStyleLayer(o)))return;x=c.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(y,o.source),o=c.clone$1(o),o=c.extend(o,{source:y})),this._validate(c.validateStyle.layer,`layers.${y}`,o,{arrayIndex:-1},p))return;x=c.createStyleLayer(o),this._validateLayer(x),x.setEventedParent(this,{layer:{id:y}}),this._serializedLayers[x.id]=x.serialize()}const E=h?this._order.indexOf(h):this._order.length;if(h&&E===-1)this.fire(new c.ErrorEvent(new Error(`Cannot add layer "${y}" before non-existing layer "${h}".`)));else{if(this._order.splice(E,0,y),this._layerOrderChanged=!0,this._layers[y]=x,this._removedLayers[y]&&x.source&&x.type!=="custom"){const P=this._removedLayers[y];delete this._removedLayers[y],P.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}moveLayer(o,h){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new c.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===h)return;const p=this._order.indexOf(o);this._order.splice(p,1);const y=h?this._order.indexOf(h):this._order.length;h&&y===-1?this.fire(new c.ErrorEvent(new Error(`Cannot move layer "${o}" before non-existing layer "${h}".`))):(this._order.splice(y,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const h=this._layers[o];if(!h)return void this.fire(new c.ErrorEvent(new Error(`Cannot remove non-existing layer "${o}".`)));h.setEventedParent(null);const p=this._order.indexOf(o);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=h,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],h.onRemove&&h.onRemove(this.map)}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,h,p){this._checkLoaded();const y=this.getLayer(o);y?y.minzoom===h&&y.maxzoom===p||(h!=null&&(y.minzoom=h),p!=null&&(y.maxzoom=p),this._updateLayer(y)):this.fire(new c.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,h,p={}){this._checkLoaded();const y=this.getLayer(o);if(y){if(!I(y.filter,h))return h==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(c.validateStyle.filter,`layers.${y.id}.filter`,h,null,p)||(y.filter=c.clone$1(h),this._updateLayer(y)))}else this.fire(new c.ErrorEvent(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return c.clone$1(this.getLayer(o).filter)}setLayoutProperty(o,h,p,y={}){this._checkLoaded();const x=this.getLayer(o);x?I(x.getLayoutProperty(h),p)||(x.setLayoutProperty(h,p,y),this._updateLayer(x)):this.fire(new c.ErrorEvent(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,h){const p=this.getLayer(o);if(p)return p.getLayoutProperty(h);this.fire(new c.ErrorEvent(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,h,p,y={}){this._checkLoaded();const x=this.getLayer(o);x?I(x.getPaintProperty(h),p)||(x.setPaintProperty(h,p,y)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new c.ErrorEvent(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,h){return this.getLayer(o).getPaintProperty(h)}setFeatureState(o,h){this._checkLoaded();const p=o.source,y=o.sourceLayer,x=this.sourceCaches[p];if(x===void 0)return void this.fire(new c.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const E=x.getSource().type;E==="geojson"&&y?this.fire(new c.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||y?(o.id===void 0&&this.fire(new c.ErrorEvent(new Error("The feature id parameter must be provided."))),x.setFeatureState(y,o.id,h)):this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,h){this._checkLoaded();const p=o.source,y=this.sourceCaches[p];if(y===void 0)return void this.fire(new c.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const x=y.getSource().type,E=x==="vector"?o.sourceLayer:void 0;x!=="vector"||E?h&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new c.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):y.removeFeatureState(E,o.id,h):this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const h=o.source,p=o.sourceLayer,y=this.sourceCaches[h];if(y!==void 0)return y.getSource().type!=="vector"||p?(o.id===void 0&&this.fire(new c.ErrorEvent(new Error("The feature id parameter must be provided."))),y.getFeatureState(p,o.id)):void this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return c.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return c.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:c.mapObject(this.sourceCaches,o=>o.serialize()),layers:this._serializeLayers(this._order)},o=>o!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(o){const h=E=>this._layers[E].type==="fill-extrusion",p={},y=[];for(let E=this._order.length-1;E>=0;E--){const P=this._order[E];if(h(P)){p[P]=E;for(const k of o){const L=k[P];if(L)for(const D of L)y.push(D)}}}y.sort((E,P)=>P.intersectionZ-E.intersectionZ);const x=[];for(let E=this._order.length-1;E>=0;E--){const P=this._order[E];if(h(P))for(let k=y.length-1;k>=0;k--){const L=y[k].feature;if(p[L.layer.id]<E)break;x.push(L),y.pop()}else for(const k of o){const L=k[P];if(L)for(const D of L)x.push(D.feature)}}return x}queryRenderedFeatures(o,h,p){h&&h.filter&&this._validate(c.validateStyle.filter,"queryRenderedFeatures.filter",h.filter,null,h);const y={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new c.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const E of h.layers){const P=this._layers[E];if(!P)return this.fire(new c.ErrorEvent(new Error(`The layer '${E}' does not exist in the map's style and cannot be queried for features.`))),[];y[P.source]=!0}}const x=[];h.availableImages=this._availableImages;for(const E in this.sourceCaches)h.layers&&!y[E]||x.push($t(this.sourceCaches[E],this._layers,this._serializedLayers,o,h,p));return this.placement&&x.push(function(E,P,k,L,D,V,H){const ie={},ne=V.queryRenderedSymbols(L),re=[];for(const pe of Object.keys(ne).map(Number))re.push(H[pe]);re.sort(cn);for(const pe of re){const _e=pe.featureIndex.lookupSymbolFeatures(ne[pe.bucketInstanceId],P,pe.bucketIndex,pe.sourceLayerIndex,D.filter,D.layers,D.availableImages,E);for(const Ee in _e){const oe=ie[Ee]=ie[Ee]||[],Ae=_e[Ee];Ae.sort((Te,Oe)=>{const De=pe.featureSortOrder;if(De){const Ge=De.indexOf(Te.featureIndex);return De.indexOf(Oe.featureIndex)-Ge}return Oe.featureIndex-Te.featureIndex});for(const Te of Ae)oe.push(Te)}}for(const pe in ie)ie[pe].forEach(_e=>{const Ee=_e.feature,oe=k[E[pe].source].getFeatureState(Ee.layer["source-layer"],Ee.id);Ee.source=Ee.layer.source,Ee.layer["source-layer"]&&(Ee.sourceLayer=Ee.layer["source-layer"]),Ee.state=oe});return ie}(this._layers,this._serializedLayers,this.sourceCaches,o,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(o,h){h&&h.filter&&this._validate(c.validateStyle.filter,"querySourceFeatures.filter",h.filter,null,h);const p=this.sourceCaches[o];return p?function(y,x){const E=y.getRenderableIds().map(L=>y.getTileByID(L)),P=[],k={};for(let L=0;L<E.length;L++){const D=E[L],V=D.tileID.canonical.key;k[V]||(k[V]=!0,D.querySourceFeatures(P,x))}return P}(p,h):[]}addSourceType(o,h,p){return Sr.getSourceType(o)?p(new Error(`A source type called "${o}" already exists.`)):(Sr.setSourceType(o,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:h.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(o,h={}){this._checkLoaded();const p=this.light.getLight();let y=!1;for(const E in o)if(!I(o[E],p[E])){y=!0;break}if(!y)return;const x={now:c.exported.now(),transition:c.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,h),this.light.updateTransitions(x)}_validate(o,h,p,y,x={}){return(!x||x.validate!==!1)&&Qt(this,o.call(c.validateStyle,c.extend({key:h,style:this.serialize(),value:p,styleSpec:c.spec},y)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),c.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const h=this.sourceCaches[o];h.setEventedParent(null),h.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const h in this.sourceCaches)this.sourceCaches[h].update(o,this.terrain)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,h,p,y,x=!1){let E=!1,P=!1;const k={};for(const L of this._order){const D=this._layers[L];if(D.type!=="symbol")continue;if(!k[D.source]){const H=this.sourceCaches[D.source];k[D.source]=H.getRenderableIds(!0).map(ie=>H.getTileByID(ie)).sort((ie,ne)=>ne.tileID.overscaledZ-ie.tileID.overscaledZ||(ie.tileID.isLessThan(ne.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(D,k[D.source],o.center.lng);E=E||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(c.exported.now(),o.zoom))&&(this.pauseablePlacement=new ke(o,this.terrain,this._order,x,h,p,y,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(c.exported.now()),P=!0),E&&this.pauseablePlacement.placement.setStale()),P||E)for(const L of this._order){const D=this._layers[L];D.type==="symbol"&&this.placement.updateLayerOpacities(D,k[D.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(c.exported.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,h,p){this.imageManager.getImages(h.icons,p),this._updateTilesForChangedImages();const y=this.sourceCaches[h.source];y&&y.setDependencies(h.tileID.key,h.type,h.icons)}getGlyphs(o,h,p){this.glyphManager.getGlyphs(h.stacks,p)}getResource(o,h,p){return c.makeRequest(h,p)}}Sr.getSourceType=function(m){return Ot[m]},Sr.setSourceType=function(m,o){Ot[m]=o},Sr.registerForPluginStateChange=c.registerForPluginStateChange;var as="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const jr={prelude:pn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:pn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:pn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:pn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:pn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:pn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:pn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:pn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:pn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:pn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:pn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:pn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:pn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:pn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:pn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:pn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:pn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:pn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:pn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:pn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:pn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:pn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:pn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:pn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:pn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:pn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:pn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",as),terrainDepth:pn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",as),terrainCoords:pn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",as)};function pn(m,o){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=o.match(/attribute ([\w]+) ([\w]+)/g),y=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=x?x.concat(y):y,P={};return{fragmentSource:m=m.replace(h,(k,L,D,V,H)=>(P[H]=!0,L==="define"?`
#ifndef HAS_UNIFORM_u_${H}
varying ${D} ${V} ${H};
#else
uniform ${D} ${V} u_${H};
#endif
`:`
#ifdef HAS_UNIFORM_u_${H}
    ${D} ${V} ${H} = u_${H};
#endif
`)),vertexSource:o=o.replace(h,(k,L,D,V,H)=>{const ie=V==="float"?"vec2":"vec4",ne=H.match(/color/)?"color":ie;return P[H]?L==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
attribute ${D} ${ie} a_${H};
varying ${D} ${V} ${H};
#else
uniform ${D} ${V} u_${H};
#endif
`:ne==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = a_${H};
#else
    ${D} ${V} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = unpack_mix_${ne}(a_${H}, u_${H}_t);
#else
    ${D} ${V} ${H} = u_${H};
#endif
`:L==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
attribute ${D} ${ie} a_${H};
#else
uniform ${D} ${V} u_${H};
#endif
`:ne==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${D} ${V} ${H} = a_${H};
#else
    ${D} ${V} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${D} ${V} ${H} = unpack_mix_${ne}(a_${H}, u_${H}_t);
#else
    ${D} ${V} ${H} = u_${H};
#endif
`}),staticAttributes:p,staticUniforms:E}}class $o{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,h,p,y,x,E,P,k,L){this.context=o;let D=this.boundPaintVertexBuffers.length!==y.length;for(let V=0;!D&&V<y.length;V++)this.boundPaintVertexBuffers[V]!==y[V]&&(D=!0);o.extVertexArrayObject&&this.vao&&this.boundProgram===h&&this.boundLayoutVertexBuffer===p&&!D&&this.boundIndexBuffer===x&&this.boundVertexOffset===E&&this.boundDynamicVertexBuffer===P&&this.boundDynamicVertexBuffer2===k&&this.boundDynamicVertexBuffer3===L?(o.bindVertexArrayOES.set(this.vao),P&&P.bind(),x&&x.dynamicDraw&&x.bind(),k&&k.bind(),L&&L.bind()):this.freshBind(h,p,y,x,E,P,k,L)}freshBind(o,h,p,y,x,E,P,k){let L;const D=o.numAttributes,V=this.context,H=V.gl;if(V.extVertexArrayObject)this.vao&&this.destroy(),this.vao=V.extVertexArrayObject.createVertexArrayOES(),V.bindVertexArrayOES.set(this.vao),L=0,this.boundProgram=o,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=y,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=P,this.boundDynamicVertexBuffer3=k;else{L=V.currentNumAttributes||0;for(let ie=D;ie<L;ie++)H.disableVertexAttribArray(ie)}h.enableAttributes(H,o);for(const ie of p)ie.enableAttributes(H,o);E&&E.enableAttributes(H,o),P&&P.enableAttributes(H,o),k&&k.enableAttributes(H,o),h.bind(),h.setVertexAttribPointers(H,o,x);for(const ie of p)ie.bind(),ie.setVertexAttribPointers(H,o,x);E&&(E.bind(),E.setVertexAttribPointers(H,o,x)),y&&y.bind(),P&&(P.bind(),P.setVertexAttribPointers(H,o,x)),k&&(k.bind(),k.setVertexAttribPointers(H,o,x)),V.currentNumAttributes=D}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Wo(m){const o=[];for(let h=0;h<m.length;h++){if(m[h]===null)continue;const p=m[h].split(" ");o.push(p.pop())}return o}class Pa{constructor(o,h,p,y,x,E,P){const k=o.gl;this.program=k.createProgram();const L=Wo(p.staticAttributes),D=y?y.getBinderAttributes():[],V=L.concat(D),H=jr.prelude.staticUniforms?Wo(jr.prelude.staticUniforms):[],ie=p.staticUniforms?Wo(p.staticUniforms):[],ne=y?y.getBinderUniforms():[],re=H.concat(ie).concat(ne),pe=[];for(const De of re)pe.indexOf(De)<0&&pe.push(De);const _e=y?y.defines():[];E&&_e.push("#define OVERDRAW_INSPECTOR;"),P&&_e.push("#define TERRAIN3D;");const Ee=_e.concat(jr.prelude.fragmentSource,p.fragmentSource).join(`
`),oe=_e.concat(jr.prelude.vertexSource,p.vertexSource).join(`
`),Ae=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(Ae,Ee),k.compileShader(Ae),k.attachShader(this.program,Ae);const Te=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(Te,oe),k.compileShader(Te),k.attachShader(this.program,Te),this.attributes={};const Oe={};this.numAttributes=V.length;for(let De=0;De<this.numAttributes;De++)V[De]&&(k.bindAttribLocation(this.program,De,V[De]),this.attributes[V[De]]=De);k.linkProgram(this.program),k.deleteShader(Te),k.deleteShader(Ae);for(let De=0;De<pe.length;De++){const Ge=pe[De];if(Ge&&!Oe[Ge]){const Le=k.getUniformLocation(this.program,Ge);Le&&(Oe[Ge]=Le)}}this.fixedUniforms=x(o,Oe),this.terrainUniforms=((De,Ge)=>({u_depth:new c.Uniform1i(De,Ge.u_depth),u_terrain:new c.Uniform1i(De,Ge.u_terrain),u_terrain_dim:new c.Uniform1f(De,Ge.u_terrain_dim),u_terrain_matrix:new c.UniformMatrix4f(De,Ge.u_terrain_matrix),u_terrain_unpack:new c.Uniform4f(De,Ge.u_terrain_unpack),u_terrain_offset:new c.Uniform1f(De,Ge.u_terrain_offset),u_terrain_exaggeration:new c.Uniform1f(De,Ge.u_terrain_exaggeration)}))(o,Oe),this.binderUniforms=y?y.getUniforms(o,Oe):[]}draw(o,h,p,y,x,E,P,k,L,D,V,H,ie,ne,re,pe,_e,Ee){const oe=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(p),o.setStencilMode(y),o.setColorMode(x),o.setCullFace(E),k){o.activeTexture.set(oe.TEXTURE2),oe.bindTexture(oe.TEXTURE_2D,k.depthTexture),o.activeTexture.set(oe.TEXTURE3),oe.bindTexture(oe.TEXTURE_2D,k.texture);for(const Te in this.terrainUniforms)this.terrainUniforms[Te].set(k[Te])}for(const Te in this.fixedUniforms)this.fixedUniforms[Te].set(P[Te]);re&&re.setUniforms(o,this.binderUniforms,ie,{zoom:ne});let Ae=0;switch(h){case oe.LINES:Ae=2;break;case oe.TRIANGLES:Ae=3;break;case oe.LINE_STRIP:Ae=1}for(const Te of H.get()){const Oe=Te.vaos||(Te.vaos={});(Oe[L]||(Oe[L]=new $o)).bind(o,this,D,re?re.getPaintVertexBuffers():[],V,Te.vertexOffset,pe,_e,Ee),oe.drawElements(h,Te.primitiveLength*Ae,oe.UNSIGNED_SHORT,Te.primitiveOffset*Ae*2)}}}function Ca(m,o,h){const p=1/ar(h,1,o.transform.tileZoom),y=Math.pow(2,h.tileID.overscaledZ),x=h.tileSize*Math.pow(2,o.transform.tileZoom)/y,E=x*(h.tileID.canonical.x+h.tileID.wrap*y),P=x*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[p,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[E>>16,P>>16],u_pixel_coord_lower:[65535&E,65535&P]}}const vo=(m,o,h,p)=>{const y=o.style.light,x=y.properties.get("position"),E=[x.x,x.y,x.z],P=c.create$1();y.properties.get("anchor")==="viewport"&&c.fromRotation(P,-o.transform.angle),c.transformMat3(E,E,P);const k=y.properties.get("color");return{u_matrix:m,u_lightpos:E,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+h,u_opacity:p}},ls=(m,o,h,p,y,x,E)=>c.extend(vo(m,o,h,p),Ca(x,o,E),{u_height_factor:-Math.pow(2,y.overscaledZ)/E.tileSize/8}),Ia=m=>({u_matrix:m}),ka=(m,o,h,p)=>c.extend(Ia(m),Ca(h,o,p)),Ma=(m,o)=>({u_matrix:m,u_world:o}),Ll=(m,o,h,p,y)=>c.extend(ka(m,o,h,p),{u_world:y}),Oc=(m,o,h,p)=>{const y=m.transform;let x,E;if(p.paint.get("circle-pitch-alignment")==="map"){const P=ar(h,1,y.zoom);x=!0,E=[P,P]}else x=!1,E=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(p.paint.get("circle-pitch-scale")==="map"),u_matrix:m.translatePosMatrix(o.posMatrix,h,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+x,u_device_pixel_ratio:m.pixelRatio,u_extrude_scale:E}},Ks=(m,o,h)=>{const p=ar(h,1,o.zoom),y=Math.pow(2,o.zoom-h.tileID.overscaledZ),x=h.tileID.overscaleFactor();return{u_matrix:m,u_camera_to_center_distance:o.cameraToCenterDistance,u_pixels_to_tile_units:p,u_extrude_scale:[o.pixelsToGLUnits[0]/(p*y),o.pixelsToGLUnits[1]/(p*y)],u_overscale_factor:x}},X=(m,o,h=1)=>({u_matrix:m,u_color:o,u_overlay:0,u_overlay_scale:h}),ee=m=>({u_matrix:m}),de=(m,o,h,p)=>({u_matrix:m,u_extrude_scale:ar(o,1,h),u_intensity:p});function Ce(m,o){const h=Math.pow(2,o.canonical.z),p=o.canonical.y;return[new c.MercatorCoordinate(0,p/h).toLngLat().lat,new c.MercatorCoordinate(0,(p+1)/h).toLngLat().lat]}const $e=(m,o,h,p)=>{const y=m.transform;return{u_matrix:fr(m,o,h,p),u_ratio:1/ar(o,1,y.zoom),u_device_pixel_ratio:m.pixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},ft=(m,o,h,p,y)=>c.extend($e(m,o,h,y),{u_image:0,u_image_height:p}),en=(m,o,h,p,y)=>{const x=m.transform,E=Xt(o,x);return{u_matrix:fr(m,o,h,y),u_texsize:o.imageAtlasTexture.size,u_ratio:1/ar(o,1,x.zoom),u_device_pixel_ratio:m.pixelRatio,u_image:0,u_scale:[E,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},Jn=(m,o,h,p,y,x)=>{const E=m.lineAtlas,P=Xt(o,m.transform),k=h.layout.get("line-cap")==="round",L=E.getDash(p.from,k),D=E.getDash(p.to,k),V=L.width*y.fromScale,H=D.width*y.toScale;return c.extend($e(m,o,h,x),{u_patternscale_a:[P/V,-L.height/2],u_patternscale_b:[P/H,-D.height/2],u_sdfgamma:E.width/(256*Math.min(V,H)*m.pixelRatio)/2,u_image:0,u_tex_y_a:L.y,u_tex_y_b:D.y,u_mix:y.t})};function Xt(m,o){return 1/ar(m,1,o.tileZoom)}function fr(m,o,h,p){return m.translatePosMatrix(p?p.posMatrix:o.tileID.posMatrix,o,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}const ki=(m,o,h,p,y)=>{return{u_matrix:m,u_tl_parent:o,u_scale_parent:h,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(E=y.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(x=y.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:tp(y.paint.get("raster-hue-rotate"))};var x,E};function tp(m){m*=Math.PI/180;const o=Math.sin(m),h=Math.cos(m);return[(2*h+1)/3,(-Math.sqrt(3)*o-h+1)/3,(Math.sqrt(3)*o-h+1)/3]}const bh=(m,o,h,p,y,x,E,P,k,L)=>{const D=y.transform;return{u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:D.cameraToCenterDistance,u_pitch:D.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:D.width/D.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:E,u_coord_matrix:P,u_is_text:+k,u_pitch_with_map:+p,u_texsize:L,u_texture:0}},Dc=(m,o,h,p,y,x,E,P,k,L,D)=>{const V=y.transform;return c.extend(bh(m,o,h,p,y,x,E,P,k,L),{u_gamma_scale:p?Math.cos(V._pitch)*V.cameraToCenterDistance:1,u_device_pixel_ratio:y.pixelRatio,u_is_halo:+D})},np=(m,o,h,p,y,x,E,P,k,L)=>c.extend(Dc(m,o,h,p,y,x,E,P,!0,k,!0),{u_texsize_icon:L,u_texture_icon:1}),ky=(m,o,h)=>({u_matrix:m,u_opacity:o,u_color:h}),My=(m,o,h,p,y,x)=>c.extend(function(E,P,k,L){const D=k.imageManager.getPattern(E.from.toString()),V=k.imageManager.getPattern(E.to.toString()),{width:H,height:ie}=k.imageManager.getPixelSize(),ne=Math.pow(2,L.tileID.overscaledZ),re=L.tileSize*Math.pow(2,k.transform.tileZoom)/ne,pe=re*(L.tileID.canonical.x+L.tileID.wrap*ne),_e=re*L.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:D.tl,u_pattern_br_a:D.br,u_pattern_tl_b:V.tl,u_pattern_br_b:V.br,u_texsize:[H,ie],u_mix:P.t,u_pattern_size_a:D.displaySize,u_pattern_size_b:V.displaySize,u_scale_a:P.fromScale,u_scale_b:P.toScale,u_tile_units_to_pixels:1/ar(L,1,k.transform.tileZoom),u_pixel_coord_upper:[pe>>16,_e>>16],u_pixel_coord_lower:[65535&pe,65535&_e]}}(p,x,h,y),{u_matrix:m,u_opacity:o}),wh={fillExtrusion:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_lightpos:new c.Uniform3f(m,o.u_lightpos),u_lightintensity:new c.Uniform1f(m,o.u_lightintensity),u_lightcolor:new c.Uniform3f(m,o.u_lightcolor),u_vertical_gradient:new c.Uniform1f(m,o.u_vertical_gradient),u_opacity:new c.Uniform1f(m,o.u_opacity)}),fillExtrusionPattern:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_lightpos:new c.Uniform3f(m,o.u_lightpos),u_lightintensity:new c.Uniform1f(m,o.u_lightintensity),u_lightcolor:new c.Uniform3f(m,o.u_lightcolor),u_vertical_gradient:new c.Uniform1f(m,o.u_vertical_gradient),u_height_factor:new c.Uniform1f(m,o.u_height_factor),u_image:new c.Uniform1i(m,o.u_image),u_texsize:new c.Uniform2f(m,o.u_texsize),u_pixel_coord_upper:new c.Uniform2f(m,o.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(m,o.u_pixel_coord_lower),u_scale:new c.Uniform3f(m,o.u_scale),u_fade:new c.Uniform1f(m,o.u_fade),u_opacity:new c.Uniform1f(m,o.u_opacity)}),fill:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix)}),fillPattern:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_image:new c.Uniform1i(m,o.u_image),u_texsize:new c.Uniform2f(m,o.u_texsize),u_pixel_coord_upper:new c.Uniform2f(m,o.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(m,o.u_pixel_coord_lower),u_scale:new c.Uniform3f(m,o.u_scale),u_fade:new c.Uniform1f(m,o.u_fade)}),fillOutline:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_world:new c.Uniform2f(m,o.u_world)}),fillOutlinePattern:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_world:new c.Uniform2f(m,o.u_world),u_image:new c.Uniform1i(m,o.u_image),u_texsize:new c.Uniform2f(m,o.u_texsize),u_pixel_coord_upper:new c.Uniform2f(m,o.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(m,o.u_pixel_coord_lower),u_scale:new c.Uniform3f(m,o.u_scale),u_fade:new c.Uniform1f(m,o.u_fade)}),circle:(m,o)=>({u_camera_to_center_distance:new c.Uniform1f(m,o.u_camera_to_center_distance),u_scale_with_map:new c.Uniform1i(m,o.u_scale_with_map),u_pitch_with_map:new c.Uniform1i(m,o.u_pitch_with_map),u_extrude_scale:new c.Uniform2f(m,o.u_extrude_scale),u_device_pixel_ratio:new c.Uniform1f(m,o.u_device_pixel_ratio),u_matrix:new c.UniformMatrix4f(m,o.u_matrix)}),collisionBox:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_camera_to_center_distance:new c.Uniform1f(m,o.u_camera_to_center_distance),u_pixels_to_tile_units:new c.Uniform1f(m,o.u_pixels_to_tile_units),u_extrude_scale:new c.Uniform2f(m,o.u_extrude_scale),u_overscale_factor:new c.Uniform1f(m,o.u_overscale_factor)}),collisionCircle:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_inv_matrix:new c.UniformMatrix4f(m,o.u_inv_matrix),u_camera_to_center_distance:new c.Uniform1f(m,o.u_camera_to_center_distance),u_viewport_size:new c.Uniform2f(m,o.u_viewport_size)}),debug:(m,o)=>({u_color:new c.UniformColor(m,o.u_color),u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_overlay:new c.Uniform1i(m,o.u_overlay),u_overlay_scale:new c.Uniform1f(m,o.u_overlay_scale)}),clippingMask:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix)}),heatmap:(m,o)=>({u_extrude_scale:new c.Uniform1f(m,o.u_extrude_scale),u_intensity:new c.Uniform1f(m,o.u_intensity),u_matrix:new c.UniformMatrix4f(m,o.u_matrix)}),heatmapTexture:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_world:new c.Uniform2f(m,o.u_world),u_image:new c.Uniform1i(m,o.u_image),u_color_ramp:new c.Uniform1i(m,o.u_color_ramp),u_opacity:new c.Uniform1f(m,o.u_opacity)}),hillshade:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_image:new c.Uniform1i(m,o.u_image),u_latrange:new c.Uniform2f(m,o.u_latrange),u_light:new c.Uniform2f(m,o.u_light),u_shadow:new c.UniformColor(m,o.u_shadow),u_highlight:new c.UniformColor(m,o.u_highlight),u_accent:new c.UniformColor(m,o.u_accent)}),hillshadePrepare:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_image:new c.Uniform1i(m,o.u_image),u_dimension:new c.Uniform2f(m,o.u_dimension),u_zoom:new c.Uniform1f(m,o.u_zoom),u_unpack:new c.Uniform4f(m,o.u_unpack)}),line:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_ratio:new c.Uniform1f(m,o.u_ratio),u_device_pixel_ratio:new c.Uniform1f(m,o.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(m,o.u_units_to_pixels)}),lineGradient:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_ratio:new c.Uniform1f(m,o.u_ratio),u_device_pixel_ratio:new c.Uniform1f(m,o.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(m,o.u_units_to_pixels),u_image:new c.Uniform1i(m,o.u_image),u_image_height:new c.Uniform1f(m,o.u_image_height)}),linePattern:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_texsize:new c.Uniform2f(m,o.u_texsize),u_ratio:new c.Uniform1f(m,o.u_ratio),u_device_pixel_ratio:new c.Uniform1f(m,o.u_device_pixel_ratio),u_image:new c.Uniform1i(m,o.u_image),u_units_to_pixels:new c.Uniform2f(m,o.u_units_to_pixels),u_scale:new c.Uniform3f(m,o.u_scale),u_fade:new c.Uniform1f(m,o.u_fade)}),lineSDF:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_ratio:new c.Uniform1f(m,o.u_ratio),u_device_pixel_ratio:new c.Uniform1f(m,o.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(m,o.u_units_to_pixels),u_patternscale_a:new c.Uniform2f(m,o.u_patternscale_a),u_patternscale_b:new c.Uniform2f(m,o.u_patternscale_b),u_sdfgamma:new c.Uniform1f(m,o.u_sdfgamma),u_image:new c.Uniform1i(m,o.u_image),u_tex_y_a:new c.Uniform1f(m,o.u_tex_y_a),u_tex_y_b:new c.Uniform1f(m,o.u_tex_y_b),u_mix:new c.Uniform1f(m,o.u_mix)}),raster:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_tl_parent:new c.Uniform2f(m,o.u_tl_parent),u_scale_parent:new c.Uniform1f(m,o.u_scale_parent),u_buffer_scale:new c.Uniform1f(m,o.u_buffer_scale),u_fade_t:new c.Uniform1f(m,o.u_fade_t),u_opacity:new c.Uniform1f(m,o.u_opacity),u_image0:new c.Uniform1i(m,o.u_image0),u_image1:new c.Uniform1i(m,o.u_image1),u_brightness_low:new c.Uniform1f(m,o.u_brightness_low),u_brightness_high:new c.Uniform1f(m,o.u_brightness_high),u_saturation_factor:new c.Uniform1f(m,o.u_saturation_factor),u_contrast_factor:new c.Uniform1f(m,o.u_contrast_factor),u_spin_weights:new c.Uniform3f(m,o.u_spin_weights)}),symbolIcon:(m,o)=>({u_is_size_zoom_constant:new c.Uniform1i(m,o.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(m,o.u_is_size_feature_constant),u_size_t:new c.Uniform1f(m,o.u_size_t),u_size:new c.Uniform1f(m,o.u_size),u_camera_to_center_distance:new c.Uniform1f(m,o.u_camera_to_center_distance),u_pitch:new c.Uniform1f(m,o.u_pitch),u_rotate_symbol:new c.Uniform1i(m,o.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(m,o.u_aspect_ratio),u_fade_change:new c.Uniform1f(m,o.u_fade_change),u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(m,o.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(m,o.u_coord_matrix),u_is_text:new c.Uniform1i(m,o.u_is_text),u_pitch_with_map:new c.Uniform1i(m,o.u_pitch_with_map),u_texsize:new c.Uniform2f(m,o.u_texsize),u_texture:new c.Uniform1i(m,o.u_texture)}),symbolSDF:(m,o)=>({u_is_size_zoom_constant:new c.Uniform1i(m,o.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(m,o.u_is_size_feature_constant),u_size_t:new c.Uniform1f(m,o.u_size_t),u_size:new c.Uniform1f(m,o.u_size),u_camera_to_center_distance:new c.Uniform1f(m,o.u_camera_to_center_distance),u_pitch:new c.Uniform1f(m,o.u_pitch),u_rotate_symbol:new c.Uniform1i(m,o.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(m,o.u_aspect_ratio),u_fade_change:new c.Uniform1f(m,o.u_fade_change),u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(m,o.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(m,o.u_coord_matrix),u_is_text:new c.Uniform1i(m,o.u_is_text),u_pitch_with_map:new c.Uniform1i(m,o.u_pitch_with_map),u_texsize:new c.Uniform2f(m,o.u_texsize),u_texture:new c.Uniform1i(m,o.u_texture),u_gamma_scale:new c.Uniform1f(m,o.u_gamma_scale),u_device_pixel_ratio:new c.Uniform1f(m,o.u_device_pixel_ratio),u_is_halo:new c.Uniform1i(m,o.u_is_halo)}),symbolTextAndIcon:(m,o)=>({u_is_size_zoom_constant:new c.Uniform1i(m,o.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(m,o.u_is_size_feature_constant),u_size_t:new c.Uniform1f(m,o.u_size_t),u_size:new c.Uniform1f(m,o.u_size),u_camera_to_center_distance:new c.Uniform1f(m,o.u_camera_to_center_distance),u_pitch:new c.Uniform1f(m,o.u_pitch),u_rotate_symbol:new c.Uniform1i(m,o.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(m,o.u_aspect_ratio),u_fade_change:new c.Uniform1f(m,o.u_fade_change),u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(m,o.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(m,o.u_coord_matrix),u_is_text:new c.Uniform1i(m,o.u_is_text),u_pitch_with_map:new c.Uniform1i(m,o.u_pitch_with_map),u_texsize:new c.Uniform2f(m,o.u_texsize),u_texsize_icon:new c.Uniform2f(m,o.u_texsize_icon),u_texture:new c.Uniform1i(m,o.u_texture),u_texture_icon:new c.Uniform1i(m,o.u_texture_icon),u_gamma_scale:new c.Uniform1f(m,o.u_gamma_scale),u_device_pixel_ratio:new c.Uniform1f(m,o.u_device_pixel_ratio),u_is_halo:new c.Uniform1i(m,o.u_is_halo)}),background:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_opacity:new c.Uniform1f(m,o.u_opacity),u_color:new c.UniformColor(m,o.u_color)}),backgroundPattern:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_opacity:new c.Uniform1f(m,o.u_opacity),u_image:new c.Uniform1i(m,o.u_image),u_pattern_tl_a:new c.Uniform2f(m,o.u_pattern_tl_a),u_pattern_br_a:new c.Uniform2f(m,o.u_pattern_br_a),u_pattern_tl_b:new c.Uniform2f(m,o.u_pattern_tl_b),u_pattern_br_b:new c.Uniform2f(m,o.u_pattern_br_b),u_texsize:new c.Uniform2f(m,o.u_texsize),u_mix:new c.Uniform1f(m,o.u_mix),u_pattern_size_a:new c.Uniform2f(m,o.u_pattern_size_a),u_pattern_size_b:new c.Uniform2f(m,o.u_pattern_size_b),u_scale_a:new c.Uniform1f(m,o.u_scale_a),u_scale_b:new c.Uniform1f(m,o.u_scale_b),u_pixel_coord_upper:new c.Uniform2f(m,o.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(m,o.u_pixel_coord_lower),u_tile_units_to_pixels:new c.Uniform1f(m,o.u_tile_units_to_pixels)}),terrain:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_texture:new c.Uniform1i(m,o.u_texture)}),terrainDepth:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix)}),terrainCoords:(m,o)=>({u_matrix:new c.UniformMatrix4f(m,o.u_matrix),u_texture:new c.Uniform1i(m,o.u_texture),u_terrain_coords_id:new c.Uniform1f(m,o.u_terrain_coords_id)})};class Eh{constructor(o,h,p){this.context=o;const y=o.gl;this.buffer=y.createBuffer(),this.dynamicDraw=Boolean(p),this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const h=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Th={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Sh{constructor(o,h,p,y){this.length=h.length,this.attributes=p,this.itemSize=h.bytesPerElement,this.dynamicDraw=y,this.context=o;const x=o.gl;this.buffer=x.createBuffer(),o.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,h){for(let p=0;p<this.attributes.length;p++){const y=h.attributes[this.attributes[p].name];y!==void 0&&o.enableVertexAttribArray(y)}}setVertexAttribPointers(o,h,p){for(let y=0;y<this.attributes.length;y++){const x=this.attributes[y],E=h.attributes[x.name];E!==void 0&&o.vertexAttribPointer(E,x.components,o[Th[x.type]],!1,this.itemSize,x.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class _n{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class rp extends _n{getDefault(){return c.Color.transparent}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Ly extends _n{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class Rl extends _n{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Ol extends _n{getDefault(){return[!0,!0,!0,!0]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class ip extends _n{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Mi extends _n{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Ah extends _n{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const h=this.current;(o.func!==h.func||o.ref!==h.ref||o.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class zc extends _n{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Fc extends _n{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=o,this.dirty=!1}}class Ph extends _n{getDefault(){return[0,1]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class Ch extends _n{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=o,this.dirty=!1}}class Bc extends _n{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Ih extends _n{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.BLEND):h.disable(h.BLEND),this.current=o,this.dirty=!1}}class kh extends _n{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class Nc extends _n{getDefault(){return c.Color.transparent}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class sp extends _n{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class op extends _n{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=o,this.dirty=!1}}class La extends _n{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Ry extends _n{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class Oy extends _n{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class Dy extends _n{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class zy extends _n{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Fy extends _n{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class By extends _n{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Mh extends _n{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Uc extends _n{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Lh extends _n{getDefault(){return null}set(o){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Rh extends _n{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class Ra extends _n{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class ap extends _n{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class lp extends _n{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Vc extends _n{constructor(o,h){super(o),this.context=o,this.parent=h}getDefault(){return null}}class Ho extends Vc{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class cp extends Vc{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Oa{constructor(o,h,p,y){this.context=o,this.width=h,this.height=p;const x=o.gl,E=this.framebuffer=x.createFramebuffer();if(this.colorAttachment=new Ho(o,E),y&&(this.depthAttachment=new cp(o,E)),x.checkFramebufferStatus(x.FRAMEBUFFER)!==x.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const o=this.context.gl,h=this.colorAttachment.get();if(h&&o.deleteTexture(h),this.depthAttachment){const p=this.depthAttachment.get();p&&o.deleteRenderbuffer(p)}o.deleteFramebuffer(this.framebuffer)}}class Gn{constructor(o,h,p){this.blendFunction=o,this.blendColor=h,this.mask=p}}Gn.Replace=[1,0],Gn.disabled=new Gn(Gn.Replace,c.Color.transparent,[!1,!1,!1,!1]),Gn.unblended=new Gn(Gn.Replace,c.Color.transparent,[!0,!0,!0,!0]),Gn.alphaBlended=new Gn([1,771],c.Color.transparent,[!0,!0,!0,!0]);class up{constructor(o){this.gl=o,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new rp(this),this.clearDepth=new Ly(this),this.clearStencil=new Rl(this),this.colorMask=new Ol(this),this.depthMask=new ip(this),this.stencilMask=new Mi(this),this.stencilFunc=new Ah(this),this.stencilOp=new zc(this),this.stencilTest=new Fc(this),this.depthRange=new Ph(this),this.depthTest=new Ch(this),this.depthFunc=new Bc(this),this.blend=new Ih(this),this.blendFunc=new kh(this),this.blendColor=new Nc(this),this.blendEquation=new sp(this),this.cullFace=new op(this),this.cullFaceSide=new La(this),this.frontFace=new Ry(this),this.program=new Oy(this),this.activeTexture=new Dy(this),this.viewport=new zy(this),this.bindFramebuffer=new Fy(this),this.bindRenderbuffer=new By(this),this.bindTexture=new Mh(this),this.bindVertexBuffer=new Uc(this),this.bindElementBuffer=new Lh(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Rh(this),this.pixelStoreUnpack=new Ra(this),this.pixelStoreUnpackPremultiplyAlpha=new ap(this),this.pixelStoreUnpackFlipY=new lp(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=o.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(o.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,h){return new Eh(this,o,h)}createVertexBuffer(o,h,p){return new Sh(this,o,h,p)}createRenderbuffer(o,h,p){const y=this.gl,x=y.createRenderbuffer();return this.bindRenderbuffer.set(x),y.renderbufferStorage(y.RENDERBUFFER,o,h,p),this.bindRenderbuffer.set(null),x}createFramebuffer(o,h,p){return new Oa(this,o,h,p)}clear({color:o,depth:h}){const p=this.gl;let y=0;o&&(y|=p.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(y|=p.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),p.clear(y)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){I(o.blendFunction,Gn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class ln{constructor(o,h,p){this.func=o,this.mask=h,this.range=p}}ln.ReadOnly=!1,ln.ReadWrite=!0,ln.disabled=new ln(519,ln.ReadOnly,[0,1]);const vn=7680;class zn{constructor(o,h,p,y,x,E){this.test=o,this.ref=h,this.mask=p,this.fail=y,this.depthFail=x,this.pass=E}}zn.disabled=new zn({func:519,mask:0},0,0,vn,vn,vn);class qn{constructor(o,h,p){this.enable=o,this.mode=h,this.frontFace=p}}let Dl;function Da(m,o,h,p,y,x,E){const P=m.context,k=P.gl,L=m.useProgram("collisionBox"),D=[];let V=0,H=0;for(let oe=0;oe<p.length;oe++){const Ae=p[oe],Te=o.getTile(Ae),Oe=Te.getBucket(h);if(!Oe)continue;let De=Ae.posMatrix;y[0]===0&&y[1]===0||(De=m.translatePosMatrix(Ae.posMatrix,Te,y,x));const Ge=E?Oe.textCollisionBox:Oe.iconCollisionBox,Le=Oe.collisionCircleArray;if(Le.length>0){const lt=c.create(),Ke=De;c.mul(lt,Oe.placementInvProjMatrix,m.transform.glCoordMatrix),c.mul(lt,lt,Oe.placementViewportMatrix),D.push({circleArray:Le,circleOffset:H,transform:Ke,invTransform:lt,coord:Ae}),V+=Le.length/4,H=V}Ge&&L.draw(P,k.LINES,ln.disabled,zn.disabled,m.colorModeForRenderPass(),qn.disabled,Ks(De,m.transform,Te),m.style.terrain&&m.style.terrain.getTerrainData(Ae),h.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,null,m.transform.zoom,null,null,Ge.collisionVertexBuffer)}if(!E||!D.length)return;const ie=m.useProgram("collisionCircle"),ne=new c.CollisionCircleLayoutArray;ne.resize(4*V),ne._trim();let re=0;for(const oe of D)for(let Ae=0;Ae<oe.circleArray.length/4;Ae++){const Te=4*Ae,Oe=oe.circleArray[Te+0],De=oe.circleArray[Te+1],Ge=oe.circleArray[Te+2],Le=oe.circleArray[Te+3];ne.emplace(re++,Oe,De,Ge,Le,0),ne.emplace(re++,Oe,De,Ge,Le,1),ne.emplace(re++,Oe,De,Ge,Le,2),ne.emplace(re++,Oe,De,Ge,Le,3)}(!Dl||Dl.length<2*V)&&(Dl=function(oe){const Ae=2*oe,Te=new c.QuadTriangleArray;Te.resize(Ae),Te._trim();for(let Oe=0;Oe<Ae;Oe++){const De=6*Oe;Te.uint16[De+0]=4*Oe+0,Te.uint16[De+1]=4*Oe+1,Te.uint16[De+2]=4*Oe+2,Te.uint16[De+3]=4*Oe+2,Te.uint16[De+4]=4*Oe+3,Te.uint16[De+5]=4*Oe+0}return Te}(V));const pe=P.createIndexBuffer(Dl,!0),_e=P.createVertexBuffer(ne,c.collisionCircleLayout.members,!0);for(const oe of D){const Ae={u_matrix:oe.transform,u_inv_matrix:oe.invTransform,u_camera_to_center_distance:(Ee=m.transform).cameraToCenterDistance,u_viewport_size:[Ee.width,Ee.height]};ie.draw(P,k.TRIANGLES,ln.disabled,zn.disabled,m.colorModeForRenderPass(),qn.disabled,Ae,m.style.terrain&&m.style.terrain.getTerrainData(oe.coord),h.id,_e,pe,c.SegmentVector.simpleSegment(0,2*oe.circleOffset,oe.circleArray.length,oe.circleArray.length/2),null,m.transform.zoom,null,null,null)}var Ee;_e.destroy(),pe.destroy()}qn.disabled=new qn(!1,1029,2305),qn.backCCW=new qn(!0,1029,2305);const Ny=c.identity(new Float32Array(16));function Uy(m,o,h,p,y,x){const{horizontalAlign:E,verticalAlign:P}=c.getAnchorAlignment(m),k=-(E-.5)*o,L=-(P-.5)*h,D=c.evaluateVariableOffset(m,p);return new c.pointGeometry((k/y+D[0])*x,(L/y+D[1])*x)}function hp(m,o,h,p,y,x,E,P,k,L,D){const V=m.text.placedSymbolArray,H=m.text.dynamicLayoutVertexArray,ie=m.icon.dynamicLayoutVertexArray,ne={};H.clear();for(let re=0;re<V.length;re++){const pe=V.get(re),_e=m.allowVerticalPlacement&&!pe.placedOrientation,Ee=pe.hidden||!pe.crossTileID||_e?null:p[pe.crossTileID];if(Ee){const oe=new c.pointGeometry(pe.anchorX,pe.anchorY),Ae=Ht(oe,h?E:x,D),Te=Vr(y.cameraToCenterDistance,Ae.signedDistanceFromCamera);let Oe=c.evaluateSizeForFeature(m.textSizeData,k,pe)*Te/c.ONE_EM;h&&(Oe*=m.tilePixelRatio/P);const{width:De,height:Ge,anchor:Le,textOffset:lt,textBoxScale:Ke}=Ee,ct=Uy(Le,De,Ge,lt,Ke,Oe),Vt=h?Ht(oe.add(ct),x,D).point:Ae.point.add(o?ct.rotate(-y.angle):ct),Zt=m.allowVerticalPlacement&&pe.placedOrientation===c.WritingMode.vertical?Math.PI/2:0;for(let Pt=0;Pt<pe.numGlyphs;Pt++)c.addDynamicAttributes(H,Vt,Zt);L&&pe.associatedIconIndex>=0&&(ne[pe.associatedIconIndex]={shiftedAnchor:Vt,angle:Zt})}else Rt(pe.numGlyphs,H)}if(L){ie.clear();const re=m.icon.placedSymbolArray;for(let pe=0;pe<re.length;pe++){const _e=re.get(pe);if(_e.hidden)Rt(_e.numGlyphs,ie);else{const Ee=ne[pe];if(Ee)for(let oe=0;oe<_e.numGlyphs;oe++)c.addDynamicAttributes(ie,Ee.shiftedAnchor,Ee.angle);else Rt(_e.numGlyphs,ie)}}m.icon.dynamicLayoutVertexBuffer.updateData(ie)}m.text.dynamicLayoutVertexBuffer.updateData(H)}function Vy(m,o,h){return h.iconsInText&&o?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function jc(m,o,h,p,y,x,E,P,k,L,D,V){const H=m.context,ie=H.gl,ne=m.transform,re=P==="map",pe=k==="map",_e=P!=="viewport"&&h.layout.get("symbol-placement")!=="point",Ee=re&&!pe&&!_e,oe=!h.layout.get("symbol-sort-key").isConstant();let Ae=!1;const Te=m.depthModeForSublayer(0,ln.ReadOnly),Oe=h.layout.get("text-variable-anchor"),De=[];for(const Ge of p){const Le=o.getTile(Ge),lt=Le.getBucket(h);if(!lt)continue;const Ke=y?lt.text:lt.icon;if(!Ke||!Ke.segments.get().length)continue;const ct=Ke.programConfigurations.get(h.id),Vt=y||lt.sdfIcons,Zt=y?lt.textSizeData:lt.iconSizeData,Pt=pe||ne.pitch!==0,wn=m.useProgram(Vy(Vt,y,lt),ct),En=c.evaluateSizeForZoom(Zt,ne.zoom),un=m.style.terrain&&m.style.terrain.getTerrainData(Ge);let dn,An,Rr,Os,us=[0,0],Ds=null;if(y){if(An=Le.glyphAtlasTexture,Rr=ie.LINEAR,dn=Le.glyphAtlasTexture.size,lt.iconsInText){us=Le.imageAtlasTexture.size,Ds=Le.imageAtlasTexture;const Yi=Zt.kind==="composite"||Zt.kind==="camera";Os=Pt||m.options.rotating||m.options.zooming||Yi?ie.LINEAR:ie.NEAREST}}else{const Yi=h.layout.get("icon-size").constantOr(0)!==1||lt.iconsNeedLinear;An=Le.imageAtlasTexture,Rr=Vt||m.options.rotating||m.options.zooming||Yi||Pt?ie.LINEAR:ie.NEAREST,dn=Le.imageAtlasTexture.size}const Ao=ar(Le,1,m.transform.zoom),Zi=Xr(Ge.posMatrix,pe,re,m.transform,Ao),mi=Dn(Ge.posMatrix,pe,re,m.transform,Ao),eo=Oe&&lt.hasTextData(),Yc=h.layout.get("icon-text-fit")!=="none"&&eo&&lt.hasIconData();if(_e){const Yi=m.style.terrain?(Xh,Va)=>m.style.terrain.getElevation(Ge,Xh,Va):null,Yo=h.layout.get("text-rotation-alignment")==="map";ri(lt,Ge.posMatrix,m,y,Zi,mi,pe,L,Yo,Yi)}const Ar=m.translatePosMatrix(Ge.posMatrix,Le,x,E),rn=_e||y&&Oe||Yc?Ny:Zi,bn=m.translatePosMatrix(mi,Le,x,E,!0),Or=Vt&&h.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Dr;Dr=Vt?lt.iconsInText?np(Zt.kind,En,Ee,pe,m,Ar,rn,bn,dn,us):Dc(Zt.kind,En,Ee,pe,m,Ar,rn,bn,y,dn,!0):bh(Zt.kind,En,Ee,pe,m,Ar,rn,bn,y,dn);const Zn={program:wn,buffers:Ke,uniformValues:Dr,atlasTexture:An,atlasTextureIcon:Ds,atlasInterpolation:Rr,atlasInterpolationIcon:Os,isSDF:Vt,hasHalo:Or};if(oe&&lt.canOverlap){Ae=!0;const Yi=Ke.segments.get();for(const Yo of Yi)De.push({segments:new c.SegmentVector([Yo]),sortKey:Yo.sortKey,state:Zn,terrainData:un})}else De.push({segments:Ke.segments,sortKey:0,state:Zn,terrainData:un})}Ae&&De.sort((Ge,Le)=>Ge.sortKey-Le.sortKey);for(const Ge of De){const Le=Ge.state;if(H.activeTexture.set(ie.TEXTURE0),Le.atlasTexture.bind(Le.atlasInterpolation,ie.CLAMP_TO_EDGE),Le.atlasTextureIcon&&(H.activeTexture.set(ie.TEXTURE1),Le.atlasTextureIcon&&Le.atlasTextureIcon.bind(Le.atlasInterpolationIcon,ie.CLAMP_TO_EDGE)),Le.isSDF){const lt=Le.uniformValues;Le.hasHalo&&(lt.u_is_halo=1,zl(Le.buffers,Ge.segments,h,m,Le.program,Te,D,V,lt,Ge.terrainData)),lt.u_is_halo=0}zl(Le.buffers,Ge.segments,h,m,Le.program,Te,D,V,Le.uniformValues,Ge.terrainData)}}function zl(m,o,h,p,y,x,E,P,k,L){const D=p.context;y.draw(D,D.gl.TRIANGLES,x,E,P,qn.disabled,k,L,h.id,m.layoutVertexBuffer,m.indexBuffer,o,h.paint,p.transform.zoom,m.programConfigurations.get(h.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function Fl(m,o,h,p,y,x,E){const P=m.context.gl,k=h.paint.get("fill-pattern"),L=k&&k.constantOr(1),D=h.getCrossfadeParameters();let V,H,ie,ne,re;E?(H=L&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=P.LINES):(H=L?"fillPattern":"fill",V=P.TRIANGLES);for(const pe of p){const _e=o.getTile(pe);if(L&&!_e.patternsLoaded())continue;const Ee=_e.getBucket(h);if(!Ee)continue;const oe=Ee.programConfigurations.get(h.id),Ae=m.useProgram(H,oe),Te=m.style.terrain&&m.style.terrain.getTerrainData(pe);L&&(m.context.activeTexture.set(P.TEXTURE0),_e.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),oe.updatePaintBuffers(D));const Oe=k.constantOr(null);if(Oe&&_e.imageAtlas){const Le=_e.imageAtlas,lt=Le.patternPositions[Oe.to.toString()],Ke=Le.patternPositions[Oe.from.toString()];lt&&Ke&&oe.setConstantPatternPositions(lt,Ke)}const De=Te?pe:null,Ge=m.translatePosMatrix(De?De.posMatrix:pe.posMatrix,_e,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(E){ne=Ee.indexBuffer2,re=Ee.segments2;const Le=[P.drawingBufferWidth,P.drawingBufferHeight];ie=H==="fillOutlinePattern"&&L?Ll(Ge,m,D,_e,Le):Ma(Ge,Le)}else ne=Ee.indexBuffer,re=Ee.segments,ie=L?ka(Ge,m,D,_e):Ia(Ge);Ae.draw(m.context,V,y,m.stencilModeForClipping(pe),x,qn.disabled,ie,Te,h.id,Ee.layoutVertexBuffer,ne,re,h.paint,m.transform.zoom,oe)}}function Bl(m,o,h,p,y,x,E){const P=m.context,k=P.gl,L=h.paint.get("fill-extrusion-pattern"),D=L.constantOr(1),V=h.getCrossfadeParameters(),H=h.paint.get("fill-extrusion-opacity");for(const ie of p){const ne=o.getTile(ie),re=ne.getBucket(h);if(!re)continue;const pe=m.style.terrain&&m.style.terrain.getTerrainData(ie),_e=re.programConfigurations.get(h.id),Ee=m.useProgram(D?"fillExtrusionPattern":"fillExtrusion",_e);D&&(m.context.activeTexture.set(k.TEXTURE0),ne.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),_e.updatePaintBuffers(V));const oe=L.constantOr(null);if(oe&&ne.imageAtlas){const De=ne.imageAtlas,Ge=De.patternPositions[oe.to.toString()],Le=De.patternPositions[oe.from.toString()];Ge&&Le&&_e.setConstantPatternPositions(Ge,Le)}const Ae=m.translatePosMatrix(ie.posMatrix,ne,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Te=h.paint.get("fill-extrusion-vertical-gradient"),Oe=D?ls(Ae,m,Te,H,ie,V,ne):vo(Ae,m,Te,H);Ee.draw(P,P.gl.TRIANGLES,y,x,E,qn.backCCW,Oe,pe,h.id,re.layoutVertexBuffer,re.indexBuffer,re.segments,h.paint,m.transform.zoom,_e,m.style.terrain&&re.centroidVertexBuffer)}}function Oh(m,o,h,p,y,x,E){const P=m.context,k=P.gl,L=h.fbo;if(!L)return;const D=m.useProgram("hillshade"),V=m.style.terrain&&m.style.terrain.getTerrainData(o);P.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,L.colorAttachment.get()),D.draw(P,k.TRIANGLES,y,x,E,qn.disabled,((H,ie,ne,re)=>{const pe=ne.paint.get("hillshade-shadow-color"),_e=ne.paint.get("hillshade-highlight-color"),Ee=ne.paint.get("hillshade-accent-color");let oe=ne.paint.get("hillshade-illumination-direction")*(Math.PI/180);ne.paint.get("hillshade-illumination-anchor")==="viewport"&&(oe-=H.transform.angle);const Ae=!H.options.moving;return{u_matrix:re?re.posMatrix:H.transform.calculatePosMatrix(ie.tileID.toUnwrapped(),Ae),u_image:0,u_latrange:Ce(0,ie.tileID),u_light:[ne.paint.get("hillshade-exaggeration"),oe],u_shadow:pe,u_highlight:_e,u_accent:Ee}})(m,h,p,V?o:null),V,p.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}function dp(m,o,h,p,y,x){const E=m.context,P=E.gl,k=o.dem;if(k&&k.data){const L=k.dim,D=k.stride,V=k.getPixels();if(E.activeTexture.set(P.TEXTURE1),E.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||m.getTileTexture(D),o.demTexture){const ie=o.demTexture;ie.update(V,{premultiply:!1}),ie.bind(P.NEAREST,P.CLAMP_TO_EDGE)}else o.demTexture=new B(E,V,P.RGBA,{premultiply:!1}),o.demTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE);E.activeTexture.set(P.TEXTURE0);let H=o.fbo;if(!H){const ie=new B(E,{width:L,height:L,data:null},P.RGBA);ie.bind(P.LINEAR,P.CLAMP_TO_EDGE),H=o.fbo=E.createFramebuffer(L,L,!0),H.colorAttachment.set(ie.texture)}E.bindFramebuffer.set(H.framebuffer),E.viewport.set([0,0,L,L]),m.useProgram("hillshadePrepare").draw(E,P.TRIANGLES,p,y,x,qn.disabled,((ie,ne)=>{const re=ne.stride,pe=c.create();return c.ortho(pe,0,c.EXTENT,-c.EXTENT,0,0,1),c.translate(pe,pe,[0,-c.EXTENT,0]),{u_matrix:pe,u_image:1,u_dimension:[re,re],u_zoom:ie.overscaledZ,u_unpack:ne.getUnpackVector()}})(o.tileID,k),null,h.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function Gc(m,o,h,p,y,x){const E=p.paint.get("raster-fade-duration");if(!x&&E>0){const P=c.exported.now(),k=(P-m.timeAdded)/E,L=o?(P-o.timeAdded)/E:-1,D=h.getSource(),V=y.coveringZoomLevel({tileSize:D.tileSize,roundZoom:D.roundZoom}),H=!o||Math.abs(o.tileID.overscaledZ-V)>Math.abs(m.tileID.overscaledZ-V),ie=H&&m.refreshedUponExpiration?1:c.clamp(H?k:1-L,0,1);return m.refreshedUponExpiration&&k>=1&&(m.refreshedUponExpiration=!1),o?{opacity:1,mix:1-ie}:{opacity:ie,mix:0}}return{opacity:1,mix:0}}const $c=new c.Color(1,0,0,1),cs=new c.Color(0,1,0,1),fp=new c.Color(0,0,1,1),Dh=new c.Color(1,0,1,1),pp=new c.Color(0,1,1,1);function qo(m,o,h,p){za(m,0,o+h/2,m.transform.width,h,p)}function Nl(m,o,h,p){za(m,o-h/2,0,h,m.transform.height,p)}function za(m,o,h,p,y,x){const E=m.context,P=E.gl;P.enable(P.SCISSOR_TEST),P.scissor(o*m.pixelRatio,h*m.pixelRatio,p*m.pixelRatio,y*m.pixelRatio),E.clear({color:x}),P.disable(P.SCISSOR_TEST)}function jy(m,o,h){const p=m.context,y=p.gl,x=h.posMatrix,E=m.useProgram("debug"),P=ln.disabled,k=zn.disabled,L=m.colorModeForRenderPass(),D="$debug",V=m.style.terrain&&m.style.terrain.getTerrainData(h);p.activeTexture.set(y.TEXTURE0),m.emptyTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE);const H=o.getTileByID(h.key).latestRawTileData,ie=Math.floor((H&&H.byteLength||0)/1024),ne=o.getTile(h).tileSize,re=512/Math.min(ne,512)*(h.overscaledZ/m.transform.zoom)*.5;let pe=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(pe+=` => ${h.overscaledZ}`),function(_e,Ee){_e.initDebugOverlayCanvas();const oe=_e.debugOverlayCanvas,Ae=_e.context.gl,Te=_e.debugOverlayCanvas.getContext("2d");Te.clearRect(0,0,oe.width,oe.height),Te.shadowColor="white",Te.shadowBlur=2,Te.lineWidth=1.5,Te.strokeStyle="white",Te.textBaseline="top",Te.font="bold 36px Open Sans, sans-serif",Te.fillText(Ee,5,5),Te.strokeText(Ee,5,5),_e.debugOverlayTexture.update(oe),_e.debugOverlayTexture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE)}(m,`${pe} ${ie}kB`),E.draw(p,y.TRIANGLES,P,k,Gn.alphaBlended,qn.disabled,X(x,c.Color.transparent,re),null,D,m.debugBuffer,m.quadTriangleIndexBuffer,m.debugSegments),E.draw(p,y.LINE_STRIP,P,k,L,qn.disabled,X(x,c.Color.red),V,D,m.debugBuffer,m.tileBorderIndexBuffer,m.debugSegments)}function Wc(m,o,h){const p=m.context,y=p.gl,x=m.colorModeForRenderPass(),E=new ln(y.LEQUAL,ln.ReadWrite,m.depthRangeFor3D),P=m.useProgram("terrain"),k=o.getTerrainMesh(),L=o.getTerrainData(h.tileID);p.bindFramebuffer.set(null),p.viewport.set([0,0,m.width,m.height]),p.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,o.getRTTFramebuffer().colorAttachment.get());const D=m.transform.calculatePosMatrix(h.tileID.toUnwrapped());P.draw(p,y.TRIANGLES,E,zn.disabled,x,qn.backCCW,{u_matrix:D,u_texture:0},L,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}function mp(m,o,h,p){const y=m.context,x=h.tileSize*o.qualityFactor;h.textures[p]||(h.textures[p]=m.getTileTexture(x)||new B(y,{width:x,height:x,data:null},y.gl.RGBA),h.textures[p].bind(y.gl.LINEAR,y.gl.CLAMP_TO_EDGE),p===0&&o.sourceCache.renderHistory.unshift(h.tileID.key));const E=o.getRTTFramebuffer();E.colorAttachment.set(h.textures[p].texture),y.bindFramebuffer.set(E.framebuffer),y.viewport.set([0,0,x,x])}class gp{constructor(o){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=o,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=o.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const o=this.painter.style,h=o.terrain;for(const p in o.sourceCaches){this._coordsDescendingInv[p]={};const y=o.sourceCaches[p].getVisibleCoordinates();for(const x of y){const E=h.sourceCache.getTerrainCoords(x);for(const P in E)this._coordsDescendingInv[p][P]||(this._coordsDescendingInv[p][P]=[]),this._coordsDescendingInv[p][P].push(E[P])}}for(const p of o._order){const y=o._layers[p],x=y.source;if(this._renderToTexture[y.type]&&!this._coordsDescendingInvStr[x]){this._coordsDescendingInvStr[x]={};for(const E in this._coordsDescendingInv[x])this._coordsDescendingInvStr[x][E]=this._coordsDescendingInv[x][E].map(P=>P.key).sort().join()}}return this._renderableTiles.forEach(p=>{for(const y in this._coordsDescendingInvStr){const x=this._coordsDescendingInvStr[y][p.tileID.key];x&&x!==p.textureCoords[y]&&p.clearTextures(this.painter),h.needsRerender(y,p.tileID)&&p.clearTextures(this.painter)}this._rerender[p.tileID.key]=!p.textures.length}),h.clearRerenderCache(),h.sourceCache.removeOutdated(this.painter),this}renderLayer(o){const h=o.type,p=this.painter,y=p.style._order,x=p.currentLayer,E=x+1===y.length;if(this._renderToTexture[h]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=h,this._stacks[this._stacks.length-1].push(y[x]),!E))return!0;if(this._renderToTexture[this._prevType]||h==="hillshade"||this._renderToTexture[h]&&E){this._prevType=h;const P=this._stacks.length-1,k=this._stacks[P]||[];for(const L of this._renderableTiles){if(mp(p,p.style.terrain,L,P),this._rerender[L.tileID.key]){p.context.clear({color:c.Color.transparent});for(let D=0;D<k.length;D++){const V=p.style._layers[k[D]],H=V.source?this._coordsDescendingInv[V.source][L.tileID.key]:[L.tileID];p._renderTileClippingMasks(V,H),p.renderLayer(p,p.style.sourceCaches[V.source],V,H),V.source&&(L.textureCoords[V.source]=this._coordsDescendingInvStr[V.source][L.tileID.key])}}Wc(p,p.style.terrain,L)}if(h==="hillshade"){this._stacks.push([y[x]]);for(const L of this._renderableTiles){const D=this._coordsDescendingInv[o.source][L.tileID.key];mp(p,p.style.terrain,L,this._stacks.length-1),p.context.clear({color:c.Color.transparent}),p._renderTileClippingMasks(o,D),p.renderLayer(p,p.style.sourceCaches[o.source],o,D),Wc(p,p.style.terrain,L)}return!0}return this._renderToTexture[h]}return!1}}const Ul={symbol:function(m,o,h,p,y){if(m.renderPass!=="translucent")return;const x=zn.disabled,E=m.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(P,k,L,D,V,H,ie){const ne=k.transform,re=V==="map",pe=H==="map";for(const _e of P){const Ee=D.getTile(_e),oe=Ee.getBucket(L);if(!oe||!oe.text||!oe.text.segments.get().length)continue;const Ae=c.evaluateSizeForZoom(oe.textSizeData,ne.zoom),Te=ar(Ee,1,k.transform.zoom),Oe=Xr(_e.posMatrix,pe,re,k.transform,Te),De=L.layout.get("icon-text-fit")!=="none"&&oe.hasIconData();if(Ae){const Ge=Math.pow(2,ne.zoom-Ee.tileID.overscaledZ);hp(oe,re,pe,ie,ne,Oe,_e.posMatrix,Ge,Ae,De,k.style.terrain?(Le,lt)=>k.style.terrain.getElevation(_e,Le,lt):null)}}}(p,m,h,o,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),y),h.paint.get("icon-opacity").constantOr(1)!==0&&jc(m,o,h,p,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),x,E),h.paint.get("text-opacity").constantOr(1)!==0&&jc(m,o,h,p,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),x,E),o.map.showCollisionBoxes&&(Da(m,o,h,p,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),Da(m,o,h,p,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(m,o,h,p){if(m.renderPass!=="translucent")return;const y=h.paint.get("circle-opacity"),x=h.paint.get("circle-stroke-width"),E=h.paint.get("circle-stroke-opacity"),P=!h.layout.get("circle-sort-key").isConstant();if(y.constantOr(1)===0&&(x.constantOr(1)===0||E.constantOr(1)===0))return;const k=m.context,L=k.gl,D=m.depthModeForSublayer(0,ln.ReadOnly),V=zn.disabled,H=m.colorModeForRenderPass(),ie=[];for(let ne=0;ne<p.length;ne++){const re=p[ne],pe=o.getTile(re),_e=pe.getBucket(h);if(!_e)continue;const Ee=_e.programConfigurations.get(h.id),oe=m.useProgram("circle",Ee),Ae=_e.layoutVertexBuffer,Te=_e.indexBuffer,Oe=m.style.terrain&&m.style.terrain.getTerrainData(re),De={programConfiguration:Ee,program:oe,layoutVertexBuffer:Ae,indexBuffer:Te,uniformValues:Oc(m,re,pe,h),terrainData:Oe};if(P){const Ge=_e.segments.get();for(const Le of Ge)ie.push({segments:new c.SegmentVector([Le]),sortKey:Le.sortKey,state:De})}else ie.push({segments:_e.segments,sortKey:0,state:De})}P&&ie.sort((ne,re)=>ne.sortKey-re.sortKey);for(const ne of ie){const{programConfiguration:re,program:pe,layoutVertexBuffer:_e,indexBuffer:Ee,uniformValues:oe,terrainData:Ae}=ne.state;pe.draw(k,L.TRIANGLES,D,V,H,qn.disabled,oe,Ae,h.id,_e,Ee,ne.segments,h.paint,m.transform.zoom,re)}},heatmap:function(m,o,h,p){if(h.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const y=m.context,x=y.gl,E=zn.disabled,P=new Gn([x.ONE,x.ONE],c.Color.transparent,[!0,!0,!0,!0]);(function(k,L,D){const V=k.gl;k.activeTexture.set(V.TEXTURE1),k.viewport.set([0,0,L.width/4,L.height/4]);let H=D.heatmapFbo;if(H)V.bindTexture(V.TEXTURE_2D,H.colorAttachment.get()),k.bindFramebuffer.set(H.framebuffer);else{const ie=V.createTexture();V.bindTexture(V.TEXTURE_2D,ie),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_T,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,V.LINEAR),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,V.LINEAR),H=D.heatmapFbo=k.createFramebuffer(L.width/4,L.height/4,!1),function(ne,re,pe,_e){const Ee=ne.gl;Ee.texImage2D(Ee.TEXTURE_2D,0,Ee.RGBA,re.width/4,re.height/4,0,Ee.RGBA,ne.extRenderToTextureHalfFloat?ne.extTextureHalfFloat.HALF_FLOAT_OES:Ee.UNSIGNED_BYTE,null),_e.colorAttachment.set(pe)}(k,L,ie,H)}})(y,m,h),y.clear({color:c.Color.transparent});for(let k=0;k<p.length;k++){const L=p[k];if(o.hasRenderableParent(L))continue;const D=o.getTile(L),V=D.getBucket(h);if(!V)continue;const H=V.programConfigurations.get(h.id),ie=m.useProgram("heatmap",H),{zoom:ne}=m.transform;ie.draw(y,x.TRIANGLES,ln.disabled,E,P,qn.disabled,de(L.posMatrix,D,ne,h.paint.get("heatmap-intensity")),null,h.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,h.paint,m.transform.zoom,H)}y.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(y,x){const E=y.context,P=E.gl,k=x.heatmapFbo;if(!k)return;E.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,k.colorAttachment.get()),E.activeTexture.set(P.TEXTURE1);let L=x.colorRampTexture;L||(L=x.colorRampTexture=new B(E,x.colorRamp,P.RGBA)),L.bind(P.LINEAR,P.CLAMP_TO_EDGE),y.useProgram("heatmapTexture").draw(E,P.TRIANGLES,ln.disabled,zn.disabled,y.colorModeForRenderPass(),qn.disabled,((D,V,H,ie)=>{const ne=c.create();c.ortho(ne,0,D.width,D.height,0,0,1);const re=D.context.gl;return{u_matrix:ne,u_world:[re.drawingBufferWidth,re.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:V.paint.get("heatmap-opacity")}})(y,x),null,x.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments,x.paint,y.transform.zoom)}(m,h))},line:function(m,o,h,p){if(m.renderPass!=="translucent")return;const y=h.paint.get("line-opacity"),x=h.paint.get("line-width");if(y.constantOr(1)===0||x.constantOr(1)===0)return;const E=m.depthModeForSublayer(0,ln.ReadOnly),P=m.colorModeForRenderPass(),k=h.paint.get("line-dasharray"),L=h.paint.get("line-pattern"),D=L.constantOr(1),V=h.paint.get("line-gradient"),H=h.getCrossfadeParameters(),ie=D?"linePattern":k?"lineSDF":V?"lineGradient":"line",ne=m.context,re=ne.gl;let pe=!0;for(const _e of p){const Ee=o.getTile(_e);if(D&&!Ee.patternsLoaded())continue;const oe=Ee.getBucket(h);if(!oe)continue;const Ae=oe.programConfigurations.get(h.id),Te=m.context.program.get(),Oe=m.useProgram(ie,Ae),De=pe||Oe.program!==Te,Ge=m.style.terrain&&m.style.terrain.getTerrainData(_e),Le=L.constantOr(null);if(Le&&Ee.imageAtlas){const ct=Ee.imageAtlas,Vt=ct.patternPositions[Le.to.toString()],Zt=ct.patternPositions[Le.from.toString()];Vt&&Zt&&Ae.setConstantPatternPositions(Vt,Zt)}const lt=Ge?_e:null,Ke=D?en(m,Ee,h,H,lt):k?Jn(m,Ee,h,k,H,lt):V?ft(m,Ee,h,oe.lineClipsArray.length,lt):$e(m,Ee,h,lt);if(D)ne.activeTexture.set(re.TEXTURE0),Ee.imageAtlasTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),Ae.updatePaintBuffers(H);else if(k&&(De||m.lineAtlas.dirty))ne.activeTexture.set(re.TEXTURE0),m.lineAtlas.bind(ne);else if(V){const ct=oe.gradients[h.id];let Vt=ct.texture;if(h.gradientVersion!==ct.version){let Zt=256;if(h.stepInterpolant){const Pt=o.getSource().maxzoom,wn=_e.canonical.z===Pt?Math.ceil(1<<m.transform.maxZoom-_e.canonical.z):1;Zt=c.clamp(c.nextPowerOfTwo(oe.maxLineLength/c.EXTENT*1024*wn),256,ne.maxTextureSize)}ct.gradient=c.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:Zt,image:ct.gradient||void 0,clips:oe.lineClipsArray}),ct.texture?ct.texture.update(ct.gradient):ct.texture=new B(ne,ct.gradient,re.RGBA),ct.version=h.gradientVersion,Vt=ct.texture}ne.activeTexture.set(re.TEXTURE0),Vt.bind(h.stepInterpolant?re.NEAREST:re.LINEAR,re.CLAMP_TO_EDGE)}Oe.draw(ne,re.TRIANGLES,E,m.stencilModeForClipping(_e),P,qn.disabled,Ke,Ge,h.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,h.paint,m.transform.zoom,Ae,oe.layoutVertexBuffer2),pe=!1}},fill:function(m,o,h,p){const y=h.paint.get("fill-color"),x=h.paint.get("fill-opacity");if(x.constantOr(1)===0)return;const E=m.colorModeForRenderPass(),P=h.paint.get("fill-pattern"),k=m.opaquePassEnabledForLayer()&&!P.constantOr(1)&&y.constantOr(c.Color.transparent).a===1&&x.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===k){const L=m.depthModeForSublayer(1,m.renderPass==="opaque"?ln.ReadWrite:ln.ReadOnly);Fl(m,o,h,p,L,E,!1)}if(m.renderPass==="translucent"&&h.paint.get("fill-antialias")){const L=m.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,ln.ReadOnly);Fl(m,o,h,p,L,E,!0)}},"fill-extrusion":function(m,o,h,p){const y=h.paint.get("fill-extrusion-opacity");if(y!==0&&m.renderPass==="translucent"){const x=new ln(m.context.gl.LEQUAL,ln.ReadWrite,m.depthRangeFor3D);if(y!==1||h.paint.get("fill-extrusion-pattern").constantOr(1))Bl(m,o,h,p,x,zn.disabled,Gn.disabled),Bl(m,o,h,p,x,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const E=m.colorModeForRenderPass();Bl(m,o,h,p,x,zn.disabled,E)}}},hillshade:function(m,o,h,p){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const y=m.context,x=m.depthModeForSublayer(0,ln.ReadOnly),E=m.colorModeForRenderPass(),[P,k]=m.renderPass==="translucent"?m.stencilConfigForOverlap(p):[{},p];for(const L of k){const D=o.getTile(L);D.needsHillshadePrepare!==void 0&&D.needsHillshadePrepare&&m.renderPass==="offscreen"?dp(m,D,h,x,zn.disabled,E):m.renderPass==="translucent"&&Oh(m,L,D,h,x,P[L.overscaledZ],E)}y.viewport.set([0,0,m.width,m.height])},raster:function(m,o,h,p){if(m.renderPass!=="translucent"||h.paint.get("raster-opacity")===0||!p.length)return;const y=m.context,x=y.gl,E=o.getSource(),P=m.useProgram("raster"),k=m.colorModeForRenderPass(),[L,D]=E instanceof et?[{},p]:m.stencilConfigForOverlap(p),V=D[D.length-1].overscaledZ,H=!m.options.moving;for(const ie of D){const ne=m.depthModeForSublayer(ie.overscaledZ-V,h.paint.get("raster-opacity")===1?ln.ReadWrite:ln.ReadOnly,x.LESS),re=o.getTile(ie);re.registerFadeDuration(h.paint.get("raster-fade-duration"));const pe=o.findLoadedParent(ie,0),_e=Gc(re,pe,o,h,m.transform,m.style.terrain);let Ee,oe;const Ae=h.paint.get("raster-resampling")==="nearest"?x.NEAREST:x.LINEAR;y.activeTexture.set(x.TEXTURE0),re.texture.bind(Ae,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST),y.activeTexture.set(x.TEXTURE1),pe?(pe.texture.bind(Ae,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST),Ee=Math.pow(2,pe.tileID.overscaledZ-re.tileID.overscaledZ),oe=[re.tileID.canonical.x*Ee%1,re.tileID.canonical.y*Ee%1]):re.texture.bind(Ae,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST);const Te=m.style.terrain&&m.style.terrain.getTerrainData(ie),Oe=Te?ie:null,De=Oe?Oe.posMatrix:m.transform.calculatePosMatrix(ie.toUnwrapped(),H),Ge=ki(De,oe||[0,0],Ee||1,_e,h);E instanceof et?P.draw(y,x.TRIANGLES,ne,zn.disabled,k,qn.disabled,Ge,Te,h.id,E.boundsBuffer,m.quadTriangleIndexBuffer,E.boundsSegments):P.draw(y,x.TRIANGLES,ne,L[ie.overscaledZ],k,qn.disabled,Ge,Te,h.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}},background:function(m,o,h,p){const y=h.paint.get("background-color"),x=h.paint.get("background-opacity");if(x===0)return;const E=m.context,P=E.gl,k=m.transform,L=k.tileSize,D=h.paint.get("background-pattern");if(m.isPatternMissing(D))return;const V=!D&&y.a===1&&x===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==V)return;const H=zn.disabled,ie=m.depthModeForSublayer(0,V==="opaque"?ln.ReadWrite:ln.ReadOnly),ne=m.colorModeForRenderPass(),re=m.useProgram(D?"backgroundPattern":"background"),pe=p||k.coveringTiles({tileSize:L,terrain:m.style.terrain});D&&(E.activeTexture.set(P.TEXTURE0),m.imageManager.bind(m.context));const _e=h.getCrossfadeParameters();for(const Ee of pe){const oe=p?Ee.posMatrix:m.transform.calculatePosMatrix(Ee.toUnwrapped()),Ae=D?My(oe,x,m,D,{tileID:Ee,tileSize:L},_e):ky(oe,x,y),Te=m.style.terrain&&m.style.terrain.getTerrainData(Ee);re.draw(E,P.TRIANGLES,ie,H,ne,qn.disabled,Ae,Te,h.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}},debug:function(m,o,h){for(let p=0;p<h.length;p++)jy(m,o,h[p])},custom:function(m,o,h){const p=m.context,y=h.implementation;if(m.renderPass==="offscreen"){const x=y.prerender;x&&(m.setCustomLayerDefaults(),p.setColorMode(m.colorModeForRenderPass()),x.call(y,p.gl,m.transform.customLayerMatrix()),p.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),p.setColorMode(m.colorModeForRenderPass()),p.setStencilMode(zn.disabled);const x=y.renderingMode==="3d"?new ln(m.context.gl.LEQUAL,ln.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,ln.ReadOnly);p.setDepthMode(x),y.render(p.gl,m.transform.customLayerMatrix()),p.setDirty(),m.setBaseState(),p.bindFramebuffer.set(null)}}};class zh{constructor(o,h){this.context=new up(o),this.transform=h,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.create(),renderTime:0},this.setup(),this.numSublayers=jt.maxUnderzooming+jt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new xt,this.gpuTimers={}}resize(o,h,p){if(this.width=o*p,this.height=h*p,this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style._order)this.style._layers[y].resize()}setup(){const o=this.context,h=new c.PosArray;h.emplaceBack(0,0),h.emplaceBack(c.EXTENT,0),h.emplaceBack(0,c.EXTENT),h.emplaceBack(c.EXTENT,c.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(h,qt.members),this.tileExtentSegments=c.SegmentVector.simpleSegment(0,0,4,2);const p=new c.PosArray;p.emplaceBack(0,0),p.emplaceBack(c.EXTENT,0),p.emplaceBack(0,c.EXTENT),p.emplaceBack(c.EXTENT,c.EXTENT),this.debugBuffer=o.createVertexBuffer(p,qt.members),this.debugSegments=c.SegmentVector.simpleSegment(0,0,4,5);const y=new c.RasterBoundsArray;y.emplaceBack(0,0,0,0),y.emplaceBack(c.EXTENT,0,c.EXTENT,0),y.emplaceBack(0,c.EXTENT,0,c.EXTENT),y.emplaceBack(c.EXTENT,c.EXTENT,c.EXTENT,c.EXTENT),this.rasterBoundsBuffer=o.createVertexBuffer(y,Ne.members),this.rasterBoundsSegments=c.SegmentVector.simpleSegment(0,0,4,2);const x=new c.PosArray;x.emplaceBack(0,0),x.emplaceBack(1,0),x.emplaceBack(0,1),x.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(x,qt.members),this.viewportSegments=c.SegmentVector.simpleSegment(0,0,4,2);const E=new c.LineStripIndexArray;E.emplaceBack(0),E.emplaceBack(1),E.emplaceBack(3),E.emplaceBack(2),E.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(E);const P=new c.TriangleIndexArray;P.emplaceBack(0,1,2),P.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(P),this.emptyTexture=new B(o,{width:1,height:1,data:new Uint8Array([0,0,0,0])},o.gl.RGBA);const k=this.context.gl;this.stencilClearMode=new zn({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)}clearStencil(){const o=this.context,h=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=c.create();c.ortho(p,0,this.width,this.height,0,0,1),c.scale(p,p,[h.drawingBufferWidth,h.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(o,h.TRIANGLES,ln.disabled,this.stencilClearMode,Gn.disabled,qn.disabled,ee(p),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,h){if(this.currentStencilSource===o.source||!o.isTileClipped()||!h||!h.length)return;this.currentStencilSource=o.source;const p=this.context,y=p.gl;this.nextStencilID+h.length>256&&this.clearStencil(),p.setColorMode(Gn.disabled),p.setDepthMode(ln.disabled);const x=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const E of h){const P=this._tileClippingMaskIDs[E.key]=this.nextStencilID++,k=this.style.terrain&&this.style.terrain.getTerrainData(E);x.draw(p,y.TRIANGLES,ln.disabled,new zn({func:y.ALWAYS,mask:0},P,255,y.KEEP,y.KEEP,y.REPLACE),Gn.disabled,qn.disabled,ee(E.posMatrix),k,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,h=this.context.gl;return new zn({func:h.NOTEQUAL,mask:255},o,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(o){const h=this.context.gl;return new zn({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(o){const h=this.context.gl,p=o.sort((E,P)=>P.overscaledZ-E.overscaledZ),y=p[p.length-1].overscaledZ,x=p[0].overscaledZ-y+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const E={};for(let P=0;P<x;P++)E[P+y]=new zn({func:h.GEQUAL,mask:255},P+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=x,[E,p]}return[{[y]:zn.disabled},p]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new Gn([o.CONSTANT_COLOR,o.ONE],new c.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Gn.unblended:Gn.alphaBlended}depthModeForSublayer(o,h,p){if(!this.opaquePassEnabledForLayer())return ln.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new ln(p||this.context.gl.LEQUAL,h,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,h){this.style=o,this.options=h,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(c.exported.now()),this.imageManager.beginFrame();const p=this.style._order,y=this.style.sourceCaches,x=this.style.terrain&&new gp(this);for(const L in y){const D=y[L];D.used&&D.prepare(this.context)}const E={},P={},k={};for(const L in y){const D=y[L];E[L]=D.getVisibleCoordinates(),P[L]=E[L].slice().reverse(),k[L]=D.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let L=0;L<p.length;L++)if(this.style._layers[p[L]].is3D()){this.opaquePassCutoff=L;break}if(x){this.opaquePassCutoff=0;const L=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!c.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||L.length)&&(c.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(D,V){const H=D.context,ie=H.gl,ne=Gn.unblended,re=new ln(ie.LEQUAL,ln.ReadWrite,[0,1]),pe=V.getTerrainMesh(),_e=V.sourceCache.getRenderableTiles(),Ee=D.useProgram("terrainDepth");H.bindFramebuffer.set(V.getFramebuffer("depth").framebuffer),H.viewport.set([0,0,D.width/devicePixelRatio,D.height/devicePixelRatio]),H.clear({color:c.Color.transparent,depth:1});for(const oe of _e){const Ae=V.getTerrainData(oe.tileID),Te=D.transform.calculatePosMatrix(oe.tileID.toUnwrapped());Ee.draw(H,ie.TRIANGLES,re,zn.disabled,ne,qn.backCCW,{u_matrix:Te},Ae,"terrain",pe.vertexBuffer,pe.indexBuffer,pe.segments)}H.bindFramebuffer.set(null),H.viewport.set([0,0,D.width,D.height])}(this,this.style.terrain),function(D,V){const H=D.context,ie=H.gl,ne=Gn.unblended,re=new ln(ie.LEQUAL,ln.ReadWrite,[0,1]),pe=V.getTerrainMesh(),_e=V.getCoordsTexture(),Ee=V.sourceCache.getRenderableTiles(),oe=D.useProgram("terrainCoords");H.bindFramebuffer.set(V.getFramebuffer("coords").framebuffer),H.viewport.set([0,0,D.width/devicePixelRatio,D.height/devicePixelRatio]),H.clear({color:c.Color.transparent,depth:1}),V.coordsIndex=[];for(const Ae of Ee){const Te=V.getTerrainData(Ae.tileID);H.activeTexture.set(ie.TEXTURE0),ie.bindTexture(ie.TEXTURE_2D,_e.texture);const Oe=D.transform.calculatePosMatrix(Ae.tileID.toUnwrapped());oe.draw(H,ie.TRIANGLES,re,zn.disabled,ne,qn.backCCW,{u_matrix:Oe,u_terrain_coords_id:(255-V.coordsIndex.length)/255,u_texture:0},Te,"terrain",pe.vertexBuffer,pe.indexBuffer,pe.segments),V.coordsIndex.push(Ae.tileID.key)}H.bindFramebuffer.set(null),H.viewport.set([0,0,D.width,D.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const L of p){const D=this.style._layers[L];if(!D.hasOffscreenPass()||D.isHidden(this.transform.zoom))continue;const V=P[D.source];(D.type==="custom"||V.length)&&this.renderLayer(this,y[D.source],D,V)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:h.showOverdrawInspector?c.Color.black:c.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!x)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const L=this.style._layers[p[this.currentLayer]],D=y[L.source],V=E[L.source];this._renderTileClippingMasks(L,V),this.renderLayer(this,D,L,V)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const L=this.style._layers[p[this.currentLayer]],D=y[L.source];if(x&&x.renderLayer(L))continue;const V=(L.type==="symbol"?k:P)[L.source];this._renderTileClippingMasks(L,E[L.source]),this.renderLayer(this,D,L,V)}if(this.options.showTileBoundaries){let L,D;Object.values(this.style._layers).forEach(V=>{V.source&&!V.isHidden(this.transform.zoom)&&(V.source!==(D&&D.id)&&(D=this.style.sourceCaches[V.source]),(!L||L.getSource().maxzoom<D.getSource().maxzoom)&&(L=D))}),L&&Ul.debug(this,L,L.getVisibleCoordinates())}this.options.showPadding&&function(L){const D=L.transform.padding;qo(L,L.transform.height-(D.top||0),3,$c),qo(L,D.bottom||0,3,cs),Nl(L,D.left||0,3,fp),Nl(L,L.transform.width-(D.right||0),3,Dh);const V=L.transform.centerPoint;(function(H,ie,ne,re){za(H,ie-1,ne-10,2,20,re),za(H,ie-10,ne-1,20,2,re)})(L,V.x,L.transform.height-V.y,pp)}(this),this.context.setDefault()}renderLayer(o,h,p,y){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="custom"||(y||[]).length)&&(this.id=p.id,this.gpuTimingStart(p),Ul[p.type](o,h,p,y,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;let p=this.gpuTimers[o.id];p||(p=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:h.createQueryEXT()}),p.calls++,h.beginQueryEXT(h.TIME_ELAPSED_EXT,p.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}queryGpuTimers(o){const h={};for(const p in o){const y=o[p],x=this.context.extTimerQuery,E=x.getQueryObjectEXT(y.query,x.QUERY_RESULT_EXT)/1e6;x.deleteQueryEXT(y.query),h[p]=E}return h}translatePosMatrix(o,h,p,y,x){if(!p[0]&&!p[1])return o;const E=x?y==="map"?this.transform.angle:0:y==="viewport"?-this.transform.angle:0;if(E){const L=Math.sin(E),D=Math.cos(E);p=[p[0]*D-p[1]*L,p[0]*L+p[1]*D]}const P=[x?p[0]:ar(h,p[0],this.transform.zoom),x?p[1]:ar(h,p[1],this.transform.zoom),0],k=new Float32Array(16);return c.translate(k,o,P),k}saveTileTexture(o){const h=this._tileTextures[o.size[0]];h?h.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const h=this._tileTextures[o];return h&&h.length>0?h.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const h=this.imageManager.getPattern(o.from.toString()),p=this.imageManager.getPattern(o.to.toString());return!h||!p}useProgram(o,h){this.cache=this.cache||{};const p=o+(h?h.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[p]||(this.cache[p]=new Pa(this.context,o,jr[o],h,wh[o],this._showOverdrawInspector,this.style.terrain)),this.cache[p]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new B(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class Hc{constructor(o,h){this.points=o,this.planes=h}static fromInvProjectionMatrix(o,h,p){const y=Math.pow(2,p),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(P=>{const k=1/(P=c.transformMat4([],P,o))[3]/h*y;return c.mul$1(P,P,[k,k,1/P[3],k])}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(P=>{const k=c.sub([],x[P[0]],x[P[1]]),L=c.sub([],x[P[2]],x[P[1]]),D=c.normalize([],c.cross([],k,L)),V=-c.dot(D,x[P[1]]);return D.concat(V)});return new Hc(x,E)}}class Vl{constructor(o,h){this.min=o,this.max=h,this.center=c.scale$1([],c.add([],this.min,this.max),.5)}quadrant(o){const h=[o%2==0,o<2],p=c.clone$2(this.min),y=c.clone$2(this.max);for(let x=0;x<h.length;x++)p[x]=h[x]?this.min[x]:this.center[x],y[x]=h[x]?this.center[x]:this.max[x];return y[2]=this.max[2],new Vl(p,y)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersects(o){const h=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let p=!0;for(let y=0;y<o.planes.length;y++){const x=o.planes[y];let E=0;for(let P=0;P<h.length;P++)c.dot$1(x,h[P])>=0&&E++;if(E===0)return 0;E!==h.length&&(p=!1)}if(p)return 2;for(let y=0;y<3;y++){let x=Number.MAX_VALUE,E=-Number.MAX_VALUE;for(let P=0;P<o.points.length;P++){const k=o.points[P][y]-this.min[y];x=Math.min(x,k),E=Math.max(E,k)}if(E<0||x>this.max[y]-this.min[y])return 0}return 1}}class Fa{constructor(o=0,h=0,p=0,y=0){if(isNaN(o)||o<0||isNaN(h)||h<0||isNaN(p)||p<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=h,this.left=p,this.right=y}interpolate(o,h,p){return h.top!=null&&o.top!=null&&(this.top=c.number(o.top,h.top,p)),h.bottom!=null&&o.bottom!=null&&(this.bottom=c.number(o.bottom,h.bottom,p)),h.left!=null&&o.left!=null&&(this.left=c.number(o.left,h.left,p)),h.right!=null&&o.right!=null&&(this.right=c.number(o.right,h.right,p)),this}getCenter(o,h){const p=c.clamp((this.left+o-this.right)/2,0,o),y=c.clamp((this.top+h-this.bottom)/2,0,h);return new c.pointGeometry(p,y)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Fa(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class jl{constructor(o,h,p,y,x){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=x===void 0||!!x,this._minZoom=o||0,this._maxZoom=h||22,this._minPitch=p==null?0:p,this._maxPitch=y==null?60:y,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Fa,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const o=new jl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o.tileSize=this.tileSize,o.latRange=this.latRange,o.width=this.width,o.height=this.height,o._center=this._center,o._elevation=this._elevation,o.zoom=this.zoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._calcMatrices(),o}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(o){const h=-c.wrap(o,-180,180)*Math.PI/180;var p;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(p=new c.ARRAY_TYPE(4),c.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p),function(y,x,E){var P=x[0],k=x[1],L=x[2],D=x[3],V=Math.sin(E),H=Math.cos(E);y[0]=P*H+L*V,y[1]=k*H+D*V,y[2]=P*-V+L*H,y[3]=k*-V+D*H}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const h=c.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(o){const h=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._zoom=h,this.scale=this.zoomScale(h),this.tileZoom=Math.floor(h),this.zoomFraction=h-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(o){o!==this._elevation&&(this._elevation=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,h,p){this._unmodified=!1,this._edgeInsets.interpolate(o,h,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const h=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(o){const h=[new c.UnwrappedTileID(0,o)];if(this._renderWorldCopies){const p=this.pointCoordinate(new c.pointGeometry(0,0)),y=this.pointCoordinate(new c.pointGeometry(this.width,0)),x=this.pointCoordinate(new c.pointGeometry(this.width,this.height)),E=this.pointCoordinate(new c.pointGeometry(0,this.height)),P=Math.floor(Math.min(p.x,y.x,x.x,E.x)),k=Math.floor(Math.max(p.x,y.x,x.x,E.x)),L=1;for(let D=P-L;D<=k+L;D++)D!==0&&h.push(new c.UnwrappedTileID(D,o))}return h}coveringTiles(o){var h,p;let y=this.coveringZoomLevel(o);const x=y;if(o.minzoom!==void 0&&y<o.minzoom)return[];o.maxzoom!==void 0&&y>o.maxzoom&&(y=o.maxzoom);const E=this.pointCoordinate(this.getCameraPoint()),P=c.MercatorCoordinate.fromLngLat(this.center),k=Math.pow(2,y),L=[k*E.x,k*E.y,0],D=[k*P.x,k*P.y,0],V=Hc.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,y);let H=o.minzoom||0;!o.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(H=y);const ie=o.terrain?2/Math.min(this.tileSize,o.tileSize)*this.tileSize:3,ne=oe=>({aabb:new Vl([oe*k,0,0],[(oe+1)*k,k,0]),zoom:0,x:0,y:0,wrap:oe,fullyVisible:!1}),re=[],pe=[],_e=y,Ee=o.reparseOverscaled?x:y;if(this._renderWorldCopies)for(let oe=1;oe<=3;oe++)re.push(ne(-oe)),re.push(ne(oe));for(re.push(ne(0));re.length>0;){const oe=re.pop(),Ae=oe.x,Te=oe.y;let Oe=oe.fullyVisible;if(!Oe){const ct=oe.aabb.intersects(V);if(ct===0)continue;Oe=ct===2}const De=o.terrain?L:D,Ge=oe.aabb.distanceX(De),Le=oe.aabb.distanceY(De),lt=Math.max(Math.abs(Ge),Math.abs(Le)),Ke=ie+(1<<_e-oe.zoom)-2;if(oe.zoom===_e||lt>Ke&&oe.zoom>=H){const ct=_e-oe.zoom,Vt=L[0]-.5-(Ae<<ct),Zt=L[1]-.5-(Te<<ct);pe.push({tileID:new c.OverscaledTileID(oe.zoom===_e?Ee:oe.zoom,oe.wrap,oe.zoom,Ae,Te),distanceSq:c.sqrLen([D[0]-.5-Ae,D[1]-.5-Te]),tileDistanceToCamera:Math.sqrt(Vt*Vt+Zt*Zt)})}else for(let ct=0;ct<4;ct++){const Vt=(Ae<<1)+ct%2,Zt=(Te<<1)+(ct>>1),Pt=oe.zoom+1;let wn=oe.aabb.quadrant(ct);if(o.terrain){const En=new c.OverscaledTileID(Pt,oe.wrap,Pt,Vt,Zt),un=o.terrain.getMinMaxElevation(En),dn=(h=un.minElevation)!==null&&h!==void 0?h:this.elevation,An=(p=un.maxElevation)!==null&&p!==void 0?p:this.elevation;wn=new Vl([wn.min[0],wn.min[1],dn],[wn.max[0],wn.max[1],An])}re.push({aabb:wn,zoom:Pt,x:Vt,y:Zt,wrap:oe.wrap,fullyVisible:Oe})}}return pe.sort((oe,Ae)=>oe.distanceSq-Ae.distanceSq).map(oe=>oe.tileID)}resize(o,h){this.width=o,this.height=h,this.pixelsToGLUnits=[2/o,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const h=c.clamp(o.lat,-this.maxValidLatitude,this.maxValidLatitude);return new c.pointGeometry(c.mercatorXfromLng(o.lng)*this.worldSize,c.mercatorYfromLat(h)*this.worldSize)}unproject(o){return new c.MercatorCoordinate(o.x/this.worldSize,o.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(o){this.freezeElevation||(this.elevation=o?this.getElevation(this._center,o):0)}getElevation(o,h){const p=c.MercatorCoordinate.fromLngLat(o),y=(1<<this.tileZoom)*c.EXTENT,x=p.x*y,E=p.y*y,P=Math.floor(x/c.EXTENT),k=Math.floor(E/c.EXTENT),L=new c.OverscaledTileID(this.tileZoom,0,this.tileZoom,P,k);return h.getElevation(L,x%c.EXTENT,E%c.EXTENT,c.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(o){const h=this.pointLocation(this.centerPoint,o),p=this.getElevation(h,o);if(!(this.elevation-p))return;const y=this.getCameraPosition(),x=c.MercatorCoordinate.fromLngLat(y.lngLat,y.altitude),E=c.MercatorCoordinate.fromLngLat(h,p),P=x.x-E.x,k=x.y-E.y,L=x.z-E.z,D=Math.sqrt(P*P+k*k+L*L),V=this.scaleZoom(this.cameraToCenterDistance/D/this.tileSize);this._elevation=p,this._center=h,this.zoom=V}setLocationAtPoint(o,h){const p=this.pointCoordinate(h),y=this.pointCoordinate(this.centerPoint),x=this.locationCoordinate(o),E=new c.MercatorCoordinate(x.x-(p.x-y.x),x.y-(p.y-y.y));this.center=this.coordinateLocation(E),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(o,h){return h?this.coordinatePoint(this.locationCoordinate(o),this.getElevation(o,h),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(o))}pointLocation(o,h){return this.coordinateLocation(this.pointCoordinate(o,h))}locationCoordinate(o){return c.MercatorCoordinate.fromLngLat(o)}coordinateLocation(o){return o&&o.toLngLat()}pointCoordinate(o,h){if(h){const H=h.pointCoordinate(o);if(H!=null)return H}const p=[o.x,o.y,0,1],y=[o.x,o.y,1,1];c.transformMat4(p,p,this.pixelMatrixInverse),c.transformMat4(y,y,this.pixelMatrixInverse);const x=p[3],E=y[3],P=p[1]/x,k=y[1]/E,L=p[2]/x,D=y[2]/E,V=L===D?0:(0-L)/(D-L);return new c.MercatorCoordinate(c.number(p[0]/x,y[0]/E,V)/this.worldSize,c.number(P,k,V)/this.worldSize)}coordinatePoint(o,h=0,p=this.pixelMatrix){const y=[o.x*this.worldSize,o.y*this.worldSize,h,1];return c.transformMat4(y,y,p),new c.pointGeometry(y[0]/y[3],y[1]/y[3])}getBounds(){const o=Math.max(0,this.height/2-this.getHorizon());return new c.LngLatBounds().extend(this.pointLocation(new c.pointGeometry(0,o))).extend(this.pointLocation(new c.pointGeometry(this.width,o))).extend(this.pointLocation(new c.pointGeometry(this.width,this.height))).extend(this.pointLocation(new c.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new c.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(o){o?(this.lngRange=[o.getWest(),o.getEast()],this.latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(o,h=!1){const p=o.key,y=h?this._alignedPosMatrixCache:this._posMatrixCache;if(y[p])return y[p];const x=o.canonical,E=this.worldSize/this.zoomScale(x.z),P=x.x+Math.pow(2,x.z)*o.wrap,k=c.identity(new Float64Array(16));return c.translate(k,k,[P*E,x.y*E,0]),c.scale(k,k,[E/c.EXTENT,E/c.EXTENT,1]),c.multiply(k,h?this.alignedProjMatrix:this.projMatrix,k),y[p]=new Float32Array(k),y[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let o,h,p,y,x=-90,E=90,P=-180,k=180;const L=this.size,D=this._unmodified;if(this.latRange){const ie=this.latRange;x=c.mercatorYfromLat(ie[1])*this.worldSize,E=c.mercatorYfromLat(ie[0])*this.worldSize,o=E-x<L.y?L.y/(E-x):0}if(this.lngRange){const ie=this.lngRange;P=c.wrap(c.mercatorXfromLng(ie[0])*this.worldSize,0,this.worldSize),k=c.wrap(c.mercatorXfromLng(ie[1])*this.worldSize,0,this.worldSize),k<P&&(k+=this.worldSize),h=k-P<L.x?L.x/(k-P):0}const V=this.point,H=Math.max(h||0,o||0);if(H)return this.center=this.unproject(new c.pointGeometry(h?(k+P)/2:V.x,o?(E+x)/2:V.y)),this.zoom+=this.scaleZoom(H),this._unmodified=D,void(this._constraining=!1);if(this.latRange){const ie=V.y,ne=L.y/2;ie-ne<x&&(y=x+ne),ie+ne>E&&(y=E-ne)}if(this.lngRange){const ie=(P+k)/2,ne=c.wrap(V.x,ie-this.worldSize/2,ie+this.worldSize/2),re=L.x/2;ne-re<P&&(p=P+re),ne+re>k&&(p=k-re)}p===void 0&&y===void 0||(this.center=this.unproject(new c.pointGeometry(p!==void 0?p:V.x,y!==void 0?y:V.y)).wrap()),this._unmodified=D,this._constraining=!1}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,h=this.point.x,p=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let y=c.identity(new Float64Array(16));c.scale(y,y,[this.width/2,-this.height/2,1]),c.translate(y,y,[1,-1,0]),this.labelPlaneMatrix=y,y=c.identity(new Float64Array(16)),c.scale(y,y,[1,-1,1]),c.translate(y,y,[-1,-1,0]),c.scale(y,y,[2/this.width,2/this.height,1]),this.glCoordMatrix=y,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const x=Math.PI/2+this._pitch,E=this._fov*(.5+o.y/this.height),P=Math.sin(E)*this.cameraToSeaLevelDistance/Math.sin(c.clamp(Math.PI-x-E,.01,Math.PI-.01)),k=this.getHorizon(),L=2*Math.atan(k/this.cameraToCenterDistance)*(.5+o.y/(2*k)),D=Math.sin(L)*this.cameraToSeaLevelDistance/Math.sin(c.clamp(Math.PI-x-L,.01,Math.PI-.01)),V=Math.cos(Math.PI/2-this._pitch)*P+this.cameraToSeaLevelDistance,H=Math.cos(Math.PI/2-this._pitch)*D+this.cameraToSeaLevelDistance,ie=1.01*Math.min(V,H),ne=this.height/50;y=new Float64Array(16),c.perspective(y,this._fov,this.width/this.height,ne,ie),y[8]=2*-o.x/this.width,y[9]=2*o.y/this.height,c.scale(y,y,[1,-1,1]),c.translate(y,y,[0,0,-this.cameraToCenterDistance]),c.rotateX(y,y,this._pitch),c.rotateZ(y,y,this.angle),c.translate(y,y,[-h,-p,0]),this.mercatorMatrix=c.scale([],y,[this.worldSize,this.worldSize,this.worldSize]),c.scale(y,y,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.multiply(new Float64Array(16),this.labelPlaneMatrix,y),c.translate(y,y,[0,0,-this.elevation]),this.projMatrix=y,this.invProjMatrix=c.invert([],y),this.pixelMatrix3D=c.multiply(new Float64Array(16),this.labelPlaneMatrix,y);const re=this.width%2/2,pe=this.height%2/2,_e=Math.cos(this.angle),Ee=Math.sin(this.angle),oe=h-Math.round(h)+_e*re+Ee*pe,Ae=p-Math.round(p)+_e*pe+Ee*re,Te=new Float64Array(y);if(c.translate(Te,Te,[oe>.5?oe-1:oe,Ae>.5?Ae-1:Ae,0]),this.alignedProjMatrix=Te,y=c.invert(new Float64Array(16),this.pixelMatrix),!y)throw new Error("failed to invert matrix");this.pixelMatrixInverse=y,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const o=this.pointCoordinate(new c.pointGeometry(0,0)),h=[o.x*this.worldSize,o.y*this.worldSize,0,1];return c.transformMat4(h,h,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.pointGeometry(0,o))}getCameraQueryGeometry(o){const h=this.getCameraPoint();if(o.length===1)return[o[0],h];{let p=h.x,y=h.y,x=h.x,E=h.y;for(const P of o)p=Math.min(p,P.x),y=Math.min(y,P.y),x=Math.max(x,P.x),E=Math.max(E,P.y);return[new c.pointGeometry(p,y),new c.pointGeometry(x,y),new c.pointGeometry(x,E),new c.pointGeometry(p,E),new c.pointGeometry(p,y)]}}}class yp{constructor(o){this._hashName=o&&encodeURIComponent(o),c.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(h,p){let y=!1,x=null;const E=()=>{x=null,y&&(h(),x=setTimeout(E,300),y=!1)};return()=>(y=!0,x||E(),x)}(this._updateHashUnthrottled.bind(this))}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(o){const h=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,y=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,y),E=Math.round(h.lng*x)/x,P=Math.round(h.lat*x)/x,k=this._map.getBearing(),L=this._map.getPitch();let D="";if(D+=o?`/${E}/${P}/${p}`:`${p}/${P}/${E}`,(k||L)&&(D+="/"+Math.round(10*k)/10),L&&(D+=`/${Math.round(L)}`),this._hashName){const V=this._hashName;let H=!1;const ie=window.location.hash.slice(1).split("&").map(ne=>{const re=ne.split("=")[0];return re===V?(H=!0,`${re}=${D}`):ne}).filter(ne=>ne);return H||ie.push(`${V}=${D}`),`#${ie.join("&")}`}return`#${D}`}_getCurrentHash(){const o=window.location.hash.replace("#","");if(this._hashName){let h;return o.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(h=p)}),(h&&h[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._getCurrentHash();if(o.length>=3&&!o.some(h=>isNaN(h))){const h=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:h,pitch:+(o[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,o)}catch{}}}const Gl={linearity:.3,easing:c.bezier(0,0,.3,1)},_p=c.extend({deceleration:2500,maxSpeed:1400},Gl),vp=c.extend({deceleration:20,maxSpeed:1400},Gl),xp=c.extend({deceleration:1e3,maxSpeed:360},Gl),Ba=c.extend({deceleration:1e3,maxSpeed:90},Gl);class bp{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:c.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,h=c.exported.now();for(;o.length>0&&h-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const h={zoom:0,bearing:0,pitch:0,pan:new c.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)h.zoom+=x.zoomDelta||0,h.bearing+=x.bearingDelta||0,h.pitch+=x.pitchDelta||0,x.panDelta&&h.pan._add(x.panDelta),x.around&&(h.around=x.around),x.pinchAround&&(h.pinchAround=x.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(h.pan.mag()){const x=Wl(h.pan.mag(),p,c.extend({},_p,o||{}));y.offset=h.pan.mult(x.amount/h.pan.mag()),y.center=this._map.transform.center,$l(y,x)}if(h.zoom){const x=Wl(h.zoom,p,vp);y.zoom=this._map.transform.zoom+x.amount,$l(y,x)}if(h.bearing){const x=Wl(h.bearing,p,xp);y.bearing=this._map.transform.bearing+c.clamp(x.amount,-179,179),$l(y,x)}if(h.pitch){const x=Wl(h.pitch,p,Ba);y.pitch=this._map.transform.pitch+x.amount,$l(y,x)}if(y.zoom||y.bearing){const x=h.pinchAround===void 0?h.around:h.pinchAround;y.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),c.extend(y,{noMoveStart:!0})}}function $l(m,o){(!m.duration||m.duration<o.duration)&&(m.duration=o.duration,m.easing=o.easing)}function Wl(m,o,h){const{maxSpeed:p,linearity:y,deceleration:x}=h,E=c.clamp(m*y/(o/1e3),-p,p),P=Math.abs(E)/(x*y);return{easing:h.easing,duration:1e3*P,amount:E*(P/2)}}class Li extends c.Event{constructor(o,h,p,y={}){const x=S.mousePos(h.getCanvasContainer(),p),E=h.unproject(x);super(o,c.extend({point:x,lngLat:E,originalEvent:p},y)),this._defaultPrevented=!1,this.target=h}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Hl extends c.Event{constructor(o,h,p){const y=o==="touchend"?p.changedTouches:p.touches,x=S.touchPos(h.getCanvasContainer(),y),E=x.map(k=>h.unproject(k)),P=x.reduce((k,L,D,V)=>k.add(L.div(V.length)),new c.pointGeometry(0,0));super(o,{points:x,point:P,lngLats:E,lngLat:h.unproject(P),originalEvent:p}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Ri extends c.Event{constructor(o,h,p){super(o,{originalEvent:p}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Gy{constructor(o,h){this._map=o,this._clickTolerance=h.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new Ri(o.type,this._map,o))}mousedown(o,h){return this._mousedownPos=h,this._firePreventable(new Li(o.type,this._map,o))}mouseup(o){this._map.fire(new Li(o.type,this._map,o))}click(o,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||this._map.fire(new Li(o.type,this._map,o))}dblclick(o){return this._firePreventable(new Li(o.type,this._map,o))}mouseover(o){this._map.fire(new Li(o.type,this._map,o))}mouseout(o){this._map.fire(new Li(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Hl(o.type,this._map,o))}touchmove(o){this._map.fire(new Hl(o.type,this._map,o))}touchend(o){this._map.fire(new Hl(o.type,this._map,o))}touchcancel(o){this._map.fire(new Hl(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class xo{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new Li(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Li("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new Li(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wp{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,h){this.isEnabled()&&o.shiftKey&&o.button===0&&(S.disableDrag(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(o,h){if(!this._active)return;const p=h;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const y=this._startPos;this._lastPos=p,this._box||(this._box=S.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const x=Math.min(y.x,p.x),E=Math.max(y.x,p.x),P=Math.min(y.y,p.y),k=Math.max(y.y,p.y);S.setTransform(this._box,`translate(${x}px,${P}px)`),this._box.style.width=E-x+"px",this._box.style.height=k-P+"px"}mouseupWindow(o,h){if(!this._active||o.button!==0)return;const p=this._startPos,y=h;if(this.reset(),S.suppressClick(),p.x!==y.x||p.y!==y.y)return this._map.fire(new c.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:x=>x.fitScreenCoordinates(p,y,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(S.remove(this._box),this._box=null),S.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,h){return this._map.fire(new c.Event(o,{originalEvent:h}))}}function Js(m,o){if(m.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${m.length}, points ${o.length}`);const h={};for(let p=0;p<m.length;p++)h[m[p].identifier]=o[p];return h}class ql{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,h,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),p.length===this.numTouches&&(this.centroid=function(y){const x=new c.pointGeometry(0,0);for(const E of y)x._add(E);return x.div(y.length)}(h),this.touches=Js(p,h)))}touchmove(o,h,p){if(this.aborted||!this.centroid)return;const y=Js(p,h);for(const x in this.touches){const E=this.touches[x],P=y[x];(!P||P.dist(E)>30)&&(this.aborted=!0)}}touchend(o,h,p){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class Fh{constructor(o){this.singleTap=new ql(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,h,p){this.singleTap.touchstart(o,h,p)}touchmove(o,h,p){this.singleTap.touchmove(o,h,p)}touchend(o,h,p){const y=this.singleTap.touchend(o,h,p);if(y){const x=o.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(y)<30;if(x&&E||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class $y{constructor(){this._zoomIn=new Fh({numTouches:1,numTaps:2}),this._zoomOut=new Fh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,h,p){this._zoomIn.touchstart(o,h,p),this._zoomOut.touchstart(o,h,p)}touchmove(o,h,p){this._zoomIn.touchmove(o,h,p),this._zoomOut.touchmove(o,h,p)}touchend(o,h,p){const y=this._zoomIn.touchend(o,h,p),x=this._zoomOut.touchend(o,h,p);return y?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()+1,around:E.unproject(y)},{originalEvent:o})}):x?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()-1,around:E.unproject(x)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Wy={0:1,2:2};class qc{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(o,h){return!1}_move(o,h){return{}}mousedown(o,h){if(this._lastPoint)return;const p=S.mouseButton(o);this._correctButton(o,p)&&(this._lastPoint=h,this._eventButton=p)}mousemoveWindow(o,h){const p=this._lastPoint;if(p){if(o.preventDefault(),function(y,x){const E=Wy[x];return y.buttons===void 0||(y.buttons&E)!==E}(o,this._eventButton))this.reset();else if(this._moved||!(h.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(p,h)}}mouseupWindow(o){this._lastPoint&&S.mouseButton(o)===this._eventButton&&(this._moved&&S.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xl extends qc{mousedown(o,h){super.mousedown(o,h),this._lastPoint&&(this._active=!0)}_correctButton(o,h){return h===0&&!o.ctrlKey}_move(o,h){return{around:h,panDelta:h.sub(o)}}}class Qs extends qc{_correctButton(o,h){return h===0&&o.ctrlKey||h===2}_move(o,h){const p=.8*(h.x-o.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(o){o.preventDefault()}}class dt extends qc{_correctButton(o,h){return h===0&&o.ctrlKey||h===2}_move(o,h){const p=-.5*(h.y-o.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(o){o.preventDefault()}}class Ep{constructor(o,h){this._minTouches=o.cooperativeGestures?2:1,this._clickTolerance=o.clickTolerance||1,this._map=h,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(o,h,p){return this._calculateTransform(o,h,p)}touchmove(o,h,p){if(this._map._cooperativeGestures&&(this._minTouches===2&&p.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(o,!1,p.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(p.length<this._minTouches))return o.preventDefault(),this._calculateTransform(o,h,p)}touchend(o,h,p){this._calculateTransform(o,h,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,h,p){p.length>0&&(this._active=!0);const y=Js(p,h),x=new c.pointGeometry(0,0),E=new c.pointGeometry(0,0);let P=0;for(const L in y){const D=y[L],V=this._touches[L];V&&(x._add(D),E._add(D.sub(V)),P++,y[L]=D)}if(this._touches=y,P<this._minTouches||!E.mag())return;const k=E.div(P);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(P),panDelta:k}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xo{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(o){}_move(o,h,p){return{}}touchstart(o,h,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([h[0],h[1]]))}touchmove(o,h,p){if(!this._firstTwoTouches)return;o.preventDefault();const[y,x]=this._firstTwoTouches,E=bo(p,h,y),P=bo(p,h,x);if(!E||!P)return;const k=this._aroundCenter?null:E.add(P).div(2);return this._move([E,P],k,o)}touchend(o,h,p){if(!this._firstTwoTouches)return;const[y,x]=this._firstTwoTouches,E=bo(p,h,y),P=bo(p,h,x);E&&P||(this._active&&S.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function bo(m,o,h){for(let p=0;p<m.length;p++)if(m[p].identifier===h)return o[p]}function Bh(m,o){return Math.log(m/o)/Math.LN2}class rt extends Xo{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,h){const p=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Bh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Bh(this._distance,p),pinchAround:h}}}function Xc(m,o){return 180*m.angleWith(o)/Math.PI}class Hy extends Xo{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,h){const p=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Xc(this._vector,p),pinchAround:h}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const h=25/(Math.PI*this._minDiameter)*360,p=Xc(o,this._startVector);return Math.abs(p)<h}}function Nh(m){return Math.abs(m.y)>Math.abs(m.x)}class Uh extends Xo{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,h,p){super.touchstart(o,h,p),this._currentTouchCount=p.length}_start(o){this._lastPoints=o,Nh(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,h,p){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const y=o[0].sub(this._lastPoints[0]),x=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(y,x,p.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(y.y+x.y)/2*-.5}):void 0}gestureBeginsVertically(o,h,p){if(this._valid!==void 0)return this._valid;const y=o.mag()>=2,x=h.mag()>=2;if(!y&&!x)return;if(!y||!x)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const E=o.y>0==h.y>0;return Nh(o)&&Nh(h)&&E}}const Tp={panStep:100,bearingStep:15,pitchStep:10};class Sp{constructor(){const o=Tp;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let h=0,p=0,y=0,x=0,E=0;switch(o.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:o.shiftKey?p=-1:(o.preventDefault(),x=-1);break;case 39:o.shiftKey?p=1:(o.preventDefault(),x=1);break;case 38:o.shiftKey?y=1:(o.preventDefault(),E=-1);break;case 40:o.shiftKey?y=-1:(o.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(p=0,y=0),{cameraAnimation:P=>{const k=P.getZoom();P.easeTo({duration:300,easeId:"keyboardHandler",easing:qy,zoom:h?Math.round(k)+h*(o.shiftKey?2:1):k,bearing:P.getBearing()+p*this._bearingStep,pitch:P.getPitch()+y*this._pitchStep,offset:[-x*this._panStep,-E*this._panStep],center:P.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function qy(m){return m*(2-m)}const Ap=4.000244140625;class Vh{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._handler=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,c.bindAll(["_onTimeout"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;o.preventDefault()}let h=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const p=c.exported.now(),y=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,h!==0&&h%Ap==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(y*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),o.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=o,this._delta-=h,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=S.mousePos(this._el,o);this._around=c.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(h)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;if(this._delta!==0){const P=this._type==="wheel"&&Math.abs(this._delta)>Ap?this._wheelZoomRate:this._defaultZoomRate;let k=2/(1+Math.exp(-Math.abs(this._delta*P)));this._delta<0&&k!==0&&(k=1/k);const L=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(L*k))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const h=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,p=this._startZoom,y=this._easing;let x,E=!1;if(this._type==="wheel"&&p&&y){const P=Math.min((c.exported.now()-this._lastWheelEventTime)/200,1),k=y(P);x=c.number(p,h,k),P<1?this._frameId||(this._frameId=!0):E=!0}else x=h,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!E,zoomDelta:x-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let h=c.ease;if(this._prevEase){const p=this._prevEase,y=(c.exported.now()-p.start)/p.duration,x=p.easing(y+.01)-p.easing(y),E=.27/Math.sqrt(x*x+1e-4)*.01,P=Math.sqrt(.0729-E*E);h=c.bezier(E,P,.25,1)}return this._prevEase={start:c.exported.now(),duration:o,easing:h},h}reset(){this._active=!1}}class jh{constructor(o,h){this._clickZoom=o,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Gh{constructor(){this.reset()}reset(){this._active=!1}dblclick(o,h){return o.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(o.shiftKey?-1:1),around:p.unproject(h)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $h{constructor(){this._tap=new Fh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(o,h,p){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=h[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(o,h,p))}touchmove(o,h,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const y=h[0],x=y.y-this._swipePoint.y;return this._swipePoint=y,o.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(o,h,p)}touchend(o,h,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(o,h,p)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pi{constructor(o,h,p){this._el=o,this._mousePan=h,this._touchPan=p}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class wo{constructor(o,h,p){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=h,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Pp{constructor(o,h,p,y){this._el=o,this._touchZoom=h,this._touchRotate=p,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Na=m=>m.zoom||m.drag||m.pitch||m.rotate;class Wh extends c.Event{}function Zl(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class Cp{constructor(o,h){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new bp(o),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(h),c.bindAll(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[y,x,E]of this._listeners)S.addEventListener(y,x,y===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[o,h,p]of this._listeners)S.removeEventListener(o,h,o===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(o){const h=this._map,p=h.getCanvasContainer();this._add("mapEvent",new Gy(h,o));const y=h.boxZoom=new wp(h,o);this._add("boxZoom",y);const x=new $y,E=new Gh;h.doubleClickZoom=new jh(E,x),this._add("tapZoom",x),this._add("clickZoom",E);const P=new $h;this._add("tapDragZoom",P);const k=h.touchPitch=new Uh(h);this._add("touchPitch",k);const L=new Qs(o),D=new dt(o);h.dragRotate=new wo(o,L,D),this._add("mouseRotate",L,["mousePitch"]),this._add("mousePitch",D,["mouseRotate"]);const V=new Xl(o),H=new Ep(o,h);h.dragPan=new pi(p,V,H),this._add("mousePan",V),this._add("touchPan",H,["touchZoom","touchRotate"]);const ie=new Hy,ne=new rt;h.touchZoomRotate=new Pp(p,ne,ie,P),this._add("touchRotate",ie,["touchPan","touchZoom"]),this._add("touchZoom",ne,["touchPan","touchRotate"]);const re=h.scrollZoom=new Vh(h,this);this._add("scrollZoom",re,["mousePan"]);const pe=h.keyboard=new Sp;this._add("keyboard",pe),this._add("blockableMapEvent",new xo(h));for(const _e of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[_e]&&h[_e].enable(o[_e])}_add(o,h,p){this._handlers.push({handlerName:o,handler:h,allowed:p}),this._handlersById[o]=h}stop(o){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Na(this._eventsInProgress))||this.isZooming()}_blockedByActive(o,h,p){for(const y in o)if(y!==p&&(!h||h.indexOf(y)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const h=[];for(const p of o)this._el.contains(p.target)&&h.push(p);return h}handleEvent(o,h){if(o.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const p=o.type==="renderFrame"?void 0:o,y={needsRenderFrame:!1},x={},E={},P=o.touches,k=P?this._getMapTouches(P):void 0,L=k?S.touchPos(this._el,k):S.mousePos(this._el,o);for(const{handlerName:H,handler:ie,allowed:ne}of this._handlers){if(!ie.isEnabled())continue;let re;this._blockedByActive(E,ne,H)?ie.reset():ie[h||o.type]&&(re=ie[h||o.type](o,L,k),this.mergeHandlerResult(y,x,re,H,p),re&&re.needsRenderFrame&&this._triggerRenderFrame()),(re||ie.isActive())&&(E[H]=ie)}const D={};for(const H in this._previousActiveHandlers)E[H]||(D[H]=p);this._previousActiveHandlers=E,(Object.keys(D).length||Zl(y))&&(this._changes.push([y,x,D]),this._triggerRenderFrame()),(Object.keys(E).length||Zl(y))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:V}=y;V&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],V(this._map))}mergeHandlerResult(o,h,p,y,x){if(!p)return;c.extend(o,p);const E={handlerName:y,originalEvent:p.originalEvent||x};p.zoomDelta!==void 0&&(h.zoom=E),p.panDelta!==void 0&&(h.drag=E),p.pitchDelta!==void 0&&(h.pitch=E),p.bearingDelta!==void 0&&(h.rotate=E)}_applyChanges(){const o={},h={},p={};for(const[y,x,E]of this._changes)y.panDelta&&(o.panDelta=(o.panDelta||new c.pointGeometry(0,0))._add(y.panDelta)),y.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(o.around=y.around),y.pinchAround!==void 0&&(o.pinchAround=y.pinchAround),y.noInertia&&(o.noInertia=y.noInertia),c.extend(h,x),c.extend(p,E);this._updateMapTransform(o,h,p),this._changes=[]}_updateMapTransform(o,h,p){const y=this._map,x=y.transform,E=y.style&&y.style.terrain;if(!(Zl(o)||E&&this._drag))return this._fireEvents(h,p,!0);let{panDelta:P,zoomDelta:k,bearingDelta:L,pitchDelta:D,around:V,pinchAround:H}=o;H!==void 0&&(V=H),y._stop(!0),V=V||y.transform.centerPoint;const ie=x.pointLocation(P?V.sub(P):V);L&&(x.bearing+=L),D&&(x.pitch+=D),k&&(x.zoom+=k),E?h.drag&&!this._drag?(this._drag={center:x.centerPoint,lngLat:x.pointLocation(V),point:V,handlerName:h.drag.handlerName},y.fire(new c.Event("freezeElevation",{freeze:!0}))):this._drag&&p[this._drag.handlerName]?(y.fire(new c.Event("freezeElevation",{freeze:!1})),this._drag=null):h.drag&&this._drag&&(x.center=x.pointLocation(x.centerPoint.sub(P))):x.setLocationAtPoint(ie,V),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(h,p,!0)}_fireEvents(o,h,p){const y=Na(this._eventsInProgress),x=Na(o),E={};for(const D in o){const{originalEvent:V}=o[D];this._eventsInProgress[D]||(E[`${D}start`]=V),this._eventsInProgress[D]=o[D]}!y&&x&&this._fireEvent("movestart",x.originalEvent);for(const D in E)this._fireEvent(D,E[D]);x&&this._fireEvent("move",x.originalEvent);for(const D in o){const{originalEvent:V}=o[D];this._fireEvent(D,V)}const P={};let k;for(const D in this._eventsInProgress){const{handlerName:V,originalEvent:H}=this._eventsInProgress[D];this._handlersById[V].isActive()||(delete this._eventsInProgress[D],k=h[V]||H,P[`${D}end`]=k)}for(const D in P)this._fireEvent(D,P[D]);const L=Na(this._eventsInProgress);if(p&&(y||x)&&!L){this._updatingCamera=!0;const D=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=H=>H!==0&&-this._bearingSnap<H&&H<this._bearingSnap;D?(V(D.bearing||this._map.getBearing())&&(D.bearing=0),this._map.easeTo(D,{originalEvent:k})):(this._map.fire(new c.Event("moveend",{originalEvent:k})),V(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,h){this._map.fire(new c.Event(o,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new Wh("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Xi={extend:(m,...o)=>c.extend(m,...o),run(m){m()},logToElement(m,o=!1,h="log"){const p=window.document.getElementById(h);p&&(o&&(p.innerHTML=""),p.innerHTML+=`<br>${m}`)}};class Xn extends c.Evented{constructor(o,h){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=h.bearingSnap,c.bindAll(["_renderFrameCallback"],this)}getCenter(){return new c.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,h){return this.jumpTo({center:o},h)}panBy(o,h,p){return o=c.pointGeometry.convert(o).mult(-1),this.panTo(this.transform.center,c.extend({offset:o},h),p)}panTo(o,h,p){return this.easeTo(c.extend({center:o},h),p)}getZoom(){return this.transform.zoom}setZoom(o,h){return this.jumpTo({zoom:o},h),this}zoomTo(o,h,p){return this.easeTo(c.extend({zoom:o},h),p)}zoomIn(o,h){return this.zoomTo(this.getZoom()+1,o,h),this}zoomOut(o,h){return this.zoomTo(this.getZoom()-1,o,h),this}getBearing(){return this.transform.bearing}setBearing(o,h){return this.jumpTo({bearing:o},h),this}getPadding(){return this.transform.padding}setPadding(o,h){return this.jumpTo({padding:o},h),this}rotateTo(o,h,p){return this.easeTo(c.extend({bearing:o},h),p)}resetNorth(o,h){return this.rotateTo(0,c.extend({duration:1e3},o),h),this}resetNorthPitch(o,h){return this.easeTo(c.extend({bearing:0,pitch:0,duration:1e3},o),h),this}snapToNorth(o,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,h):this}getPitch(){return this.transform.pitch}setPitch(o,h){return this.jumpTo({pitch:o},h),this}cameraForBounds(o,h){o=c.LngLatBounds.convert(o);const p=h&&h.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),p,h)}_cameraForBoxAndBearing(o,h,p,y){const x={top:0,bottom:0,right:0,left:0};if(typeof(y=c.extend({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},y)).padding=="number"){const Te=y.padding;y.padding={top:Te,bottom:Te,right:Te,left:Te}}y.padding=c.extend(x,y.padding);const E=this.transform,P=E.padding,k=E.project(c.LngLat.convert(o)),L=E.project(c.LngLat.convert(h)),D=k.rotate(-p*Math.PI/180),V=L.rotate(-p*Math.PI/180),H=new c.pointGeometry(Math.max(D.x,V.x),Math.max(D.y,V.y)),ie=new c.pointGeometry(Math.min(D.x,V.x),Math.min(D.y,V.y)),ne=H.sub(ie),re=(E.width-(P.left+P.right+y.padding.left+y.padding.right))/ne.x,pe=(E.height-(P.top+P.bottom+y.padding.top+y.padding.bottom))/ne.y;if(pe<0||re<0)return void c.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const _e=Math.min(E.scaleZoom(E.scale*Math.min(re,pe)),y.maxZoom),Ee=c.pointGeometry.convert(y.offset),oe=new c.pointGeometry((y.padding.left-y.padding.right)/2,(y.padding.top-y.padding.bottom)/2).rotate(p*Math.PI/180),Ae=Ee.add(oe).mult(E.scale/E.zoomScale(_e));return{center:E.unproject(k.add(L).div(2).sub(Ae)),zoom:_e,bearing:p}}fitBounds(o,h,p){return this._fitInternal(this.cameraForBounds(o,h),h,p)}fitScreenCoordinates(o,h,p,y,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.pointGeometry.convert(o)),this.transform.pointLocation(c.pointGeometry.convert(h)),p,y),y,x)}_fitInternal(o,h,p){return o?(delete(h=c.extend(o,h)).padding,h.linear?this.easeTo(h,p):this.flyTo(h,p)):this}jumpTo(o,h){this.stop();const p=this.transform;let y=!1,x=!1,E=!1;return"zoom"in o&&p.zoom!==+o.zoom&&(y=!0,p.zoom=+o.zoom),o.center!==void 0&&(p.center=c.LngLat.convert(o.center)),"bearing"in o&&p.bearing!==+o.bearing&&(x=!0,p.bearing=+o.bearing),"pitch"in o&&p.pitch!==+o.pitch&&(E=!0,p.pitch=+o.pitch),o.padding==null||p.isPaddingEqual(o.padding)||(p.padding=o.padding),this.fire(new c.Event("movestart",h)).fire(new c.Event("move",h)),y&&this.fire(new c.Event("zoomstart",h)).fire(new c.Event("zoom",h)).fire(new c.Event("zoomend",h)),x&&this.fire(new c.Event("rotatestart",h)).fire(new c.Event("rotate",h)).fire(new c.Event("rotateend",h)),E&&this.fire(new c.Event("pitchstart",h)).fire(new c.Event("pitch",h)).fire(new c.Event("pitchend",h)),this.fire(new c.Event("moveend",h))}calculateCameraOptionsFromTo(o,h,p,y=0){const x=c.MercatorCoordinate.fromLngLat(o,h),E=c.MercatorCoordinate.fromLngLat(p,y),P=E.x-x.x,k=E.y-x.y,L=E.z-x.z,D=Math.hypot(P,k,L);if(D===0)throw new Error("Can't calculate camera options with same From and To");const V=Math.hypot(P,k),H=this.transform.scaleZoom(this.transform.cameraToCenterDistance/D/this.transform.tileSize),ie=180*Math.atan2(P,-k)/Math.PI;let ne=180*Math.acos(V/D)/Math.PI;return ne=L<0?90-ne:90+ne,{center:E.toLngLat(),zoom:H,pitch:ne,bearing:ie}}easeTo(o,h){this._stop(!1,o.easeId),((o=c.extend({offset:[0,0],duration:500,easing:c.ease},o)).animate===!1||!o.essential&&c.exported.prefersReducedMotion)&&(o.duration=0);const p=this.transform,y=this.getZoom(),x=this.getBearing(),E=this.getPitch(),P=this.getPadding(),k="zoom"in o?+o.zoom:y,L="bearing"in o?this._normalizeBearing(o.bearing,x):x,D="pitch"in o?+o.pitch:E,V="padding"in o?o.padding:p.padding,H=c.pointGeometry.convert(o.offset);let ie=p.centerPoint.add(H);const ne=p.pointLocation(ie),re=c.LngLat.convert(o.center||ne);this._normalizeCenter(re);const pe=p.project(ne),_e=p.project(re).sub(pe),Ee=p.zoomScale(k-y);let oe,Ae;o.around&&(oe=c.LngLat.convert(o.around),Ae=p.locationPoint(oe));const Te={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||k!==y,this._rotating=this._rotating||x!==L,this._pitching=this._pitching||D!==E,this._padding=!p.isPaddingEqual(V),this._easeId=o.easeId,this._prepareEase(h,o.noMoveStart,Te),this._ease(Oe=>{if(this._zooming&&(p.zoom=c.number(y,k,Oe)),this._rotating&&(p.bearing=c.number(x,L,Oe)),this._pitching&&(p.pitch=c.number(E,D,Oe)),this._padding&&(p.interpolatePadding(P,V,Oe),ie=p.centerPoint.add(H)),oe)p.setLocationAtPoint(oe,Ae);else{const De=p.zoomScale(p.zoom-y),Ge=k>y?Math.min(2,Ee):Math.max(.5,Ee),Le=Math.pow(Ge,1-Oe),lt=p.unproject(pe.add(_e.mult(Oe*Le)).mult(De));p.setLocationAtPoint(p.renderWorldCopies?lt.wrap():lt,ie)}this._fireMoveEvents(h)},Oe=>{this._afterEase(h,Oe)},o),this}_prepareEase(o,h,p={}){this._moving=!0,this.fire(new c.Event("freezeElevation",{freeze:!0})),h||p.moving||this.fire(new c.Event("movestart",o)),this._zooming&&!p.zooming&&this.fire(new c.Event("zoomstart",o)),this._rotating&&!p.rotating&&this.fire(new c.Event("rotatestart",o)),this._pitching&&!p.pitching&&this.fire(new c.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new c.Event("move",o)),this._zooming&&this.fire(new c.Event("zoom",o)),this._rotating&&this.fire(new c.Event("rotate",o)),this._pitching&&this.fire(new c.Event("pitch",o))}_afterEase(o,h){if(this._easeId&&h&&this._easeId===h)return;delete this._easeId,this.fire(new c.Event("freezeElevation",{freeze:!1}));const p=this._zooming,y=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new c.Event("zoomend",o)),y&&this.fire(new c.Event("rotateend",o)),x&&this.fire(new c.Event("pitchend",o)),this.fire(new c.Event("moveend",o))}flyTo(o,h){if(!o.essential&&c.exported.prefersReducedMotion){const Pt=c.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Pt,h)}this.stop(),o=c.extend({offset:[0,0],speed:1.2,curve:1.42,easing:c.ease},o);const p=this.transform,y=this.getZoom(),x=this.getBearing(),E=this.getPitch(),P=this.getPadding(),k="zoom"in o?c.clamp(+o.zoom,p.minZoom,p.maxZoom):y,L="bearing"in o?this._normalizeBearing(o.bearing,x):x,D="pitch"in o?+o.pitch:E,V="padding"in o?o.padding:p.padding,H=p.zoomScale(k-y),ie=c.pointGeometry.convert(o.offset);let ne=p.centerPoint.add(ie);const re=p.pointLocation(ne),pe=c.LngLat.convert(o.center||re);this._normalizeCenter(pe);const _e=p.project(re),Ee=p.project(pe).sub(_e);let oe=o.curve;const Ae=Math.max(p.width,p.height),Te=Ae/H,Oe=Ee.mag();if("minZoom"in o){const Pt=c.clamp(Math.min(o.minZoom,y,k),p.minZoom,p.maxZoom),wn=Ae/p.zoomScale(Pt-y);oe=Math.sqrt(wn/Oe*2)}const De=oe*oe;function Ge(Pt){const wn=(Te*Te-Ae*Ae+(Pt?-1:1)*De*De*Oe*Oe)/(2*(Pt?Te:Ae)*De*Oe);return Math.log(Math.sqrt(wn*wn+1)-wn)}function Le(Pt){return(Math.exp(Pt)-Math.exp(-Pt))/2}function lt(Pt){return(Math.exp(Pt)+Math.exp(-Pt))/2}const Ke=Ge(0);let ct=function(Pt){return lt(Ke)/lt(Ke+oe*Pt)},Vt=function(Pt){return Ae*((lt(Ke)*(Le(wn=Ke+oe*Pt)/lt(wn))-Le(Ke))/De)/Oe;var wn},Zt=(Ge(1)-Ke)/oe;if(Math.abs(Oe)<1e-6||!isFinite(Zt)){if(Math.abs(Ae-Te)<1e-6)return this.easeTo(o,h);const Pt=Te<Ae?-1:1;Zt=Math.abs(Math.log(Te/Ae))/oe,Vt=function(){return 0},ct=function(wn){return Math.exp(Pt*oe*wn)}}return o.duration="duration"in o?+o.duration:1e3*Zt/("screenSpeed"in o?+o.screenSpeed/oe:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=x!==L,this._pitching=D!==E,this._padding=!p.isPaddingEqual(V),this._prepareEase(h,!1),this._ease(Pt=>{const wn=Pt*Zt,En=1/ct(wn);p.zoom=Pt===1?k:y+p.scaleZoom(En),this._rotating&&(p.bearing=c.number(x,L,Pt)),this._pitching&&(p.pitch=c.number(E,D,Pt)),this._padding&&(p.interpolatePadding(P,V,Pt),ne=p.centerPoint.add(ie));const un=Pt===1?pe:p.unproject(_e.add(Ee.mult(Vt(wn))).mult(En));p.setLocationAtPoint(p.renderWorldCopies?un.wrap():un,ne),this._fireMoveEvents(h)},()=>this._afterEase(h),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,h)}if(!o){const p=this.handlers;p&&p.stop(!1)}return this}_ease(o,h,p){p.animate===!1||p.duration===0?(o(1),h()):(this._easeStart=c.exported.now(),this._easeOptions=p,this._onEaseFrame=o,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((c.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,h){o=c.wrap(o,-180,180);const p=Math.abs(o-h);return Math.abs(o-360-h)<p&&(o-=360),Math.abs(o+360-h)<p&&(o+=360),o}_normalizeCenter(o){const h=this.transform;if(!h.renderWorldCopies||h.lngRange)return;const p=o.lng-h.center.lng;o.lng+=p>180?-360:p<-180?360:0}}class Yl{constructor(o={}){this.options=o,c.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options&&this.options.compact,this._container=S.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=S.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=S.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){S.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,h){const p=this._map._getUIString(`AttributionControl.${h}`);o.title=p,o.setAttribute("aria-label",p)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(y=>typeof y!="string"?"":y)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const h=this._map.style.sourceCaches;for(const y in h){const x=h[y];if(x.used||x.usedForTerrain){const E=x.getSource();E.attribution&&o.indexOf(E.attribution)<0&&o.push(E.attribution)}}o=o.filter(y=>String(y).trim()),o.sort((y,x)=>y.length-x.length),o=o.filter((y,x)=>{for(let E=x+1;E<o.length;E++)if(o[E].indexOf(y)>=0)return!1;return!0});const p=o.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,o.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class Zc{constructor(o={}){this.options=o,c.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=S.create("div","maplibregl-ctrl mapboxgl-ctrl");const h=S.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://maplibre.org/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){S.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const o=this._container.children;if(o.length){const h=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&h.classList.add("maplibregl-compact","mapboxgl-compact"):h.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class Ip{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const h=++this._id;return this._queue.push({callback:o,id:h,cancelled:!1}),h}remove(o){const h=this._currentlyRunning,p=h?this._queue.concat(h):this._queue;for(const y of p)if(y.id===o)return void(y.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const h=this._currentlyRunning=this._queue;this._queue=[];for(const p of h)if(!p.cancelled&&(p.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const kp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},Mp={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},Xy={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ls{constructor(o,h,p=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new Qs({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,p&&(this.mousePitch=new dt({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),c.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),S.addEventListener(h,"mousedown",this.mousedown),S.addEventListener(h,"touchstart",this.touchstart,{passive:!1}),S.addEventListener(h,"touchmove",this.touchmove),S.addEventListener(h,"touchend",this.touchend),S.addEventListener(h,"touchcancel",this.reset)}down(o,h){this.mouseRotate.mousedown(o,h),this.mousePitch&&this.mousePitch.mousedown(o,h),S.disableDrag()}move(o,h){const p=this.map,y=this.mouseRotate.mousemoveWindow(o,h);if(y&&y.bearingDelta&&p.setBearing(p.getBearing()+y.bearingDelta),this.mousePitch){const x=this.mousePitch.mousemoveWindow(o,h);x&&x.pitchDelta&&p.setPitch(p.getPitch()+x.pitchDelta)}}off(){const o=this.element;S.removeEventListener(o,"mousedown",this.mousedown),S.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),S.removeEventListener(o,"touchmove",this.touchmove),S.removeEventListener(o,"touchend",this.touchend),S.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){S.enableDrag(),S.removeEventListener(window,"mousemove",this.mousemove),S.removeEventListener(window,"mouseup",this.mouseup)}mousedown(o){this.down(c.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),S.mousePos(this.element,o)),S.addEventListener(window,"mousemove",this.mousemove),S.addEventListener(window,"mouseup",this.mouseup)}mousemove(o){this.move(o,S.mousePos(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=S.touchPos(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=S.touchPos(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Kl(m,o,h){if(m=new c.LngLat(m.lng,m.lat),o){const p=new c.LngLat(m.lng-360,m.lat),y=new c.LngLat(m.lng+360,m.lat),x=h.locationPoint(m).distSqr(o);h.locationPoint(p).distSqr(o)<x?m=p:h.locationPoint(y).distSqr(o)<x&&(m=y)}for(;Math.abs(m.lng-h.center.lng)>180;){const p=h.locationPoint(m);if(p.x>=0&&p.y>=0&&p.x<=h.width&&p.y<=h.height)break;m.lng>h.center.lng?m.lng-=360:m.lng+=360}return m}const vt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function kt(m,o,h){const p=m.classList;for(const y in vt)p.remove(`maplibregl-${h}-anchor-${y}`,`mapboxgl-${h}-anchor-${y}`);p.add(`maplibregl-${h}-anchor-${o}`,`mapboxgl-${h}-anchor-${o}`)}class Ua extends c.Evented{constructor(o,h){if(super(),(o instanceof HTMLElement||h)&&(o=c.extend({element:o},h)),c.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=c.pointGeometry.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=S.create("div"),this._element.setAttribute("aria-label","Map marker");const p=S.createNS("http://www.w3.org/2000/svg","svg"),y=41,x=27;p.setAttributeNS(null,"display","block"),p.setAttributeNS(null,"height",`${y}px`),p.setAttributeNS(null,"width",`${x}px`),p.setAttributeNS(null,"viewBox",`0 0 ${x} ${y}`);const E=S.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"stroke","none"),E.setAttributeNS(null,"stroke-width","1"),E.setAttributeNS(null,"fill","none"),E.setAttributeNS(null,"fill-rule","evenodd");const P=S.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"fill-rule","nonzero");const k=S.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");const L=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ee of L){const oe=S.createNS("http://www.w3.org/2000/svg","ellipse");oe.setAttributeNS(null,"opacity","0.04"),oe.setAttributeNS(null,"cx","10.5"),oe.setAttributeNS(null,"cy","5.80029008"),oe.setAttributeNS(null,"rx",Ee.rx),oe.setAttributeNS(null,"ry",Ee.ry),k.appendChild(oe)}const D=S.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"fill",this._color);const V=S.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),D.appendChild(V);const H=S.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"opacity","0.25"),H.setAttributeNS(null,"fill","#000000");const ie=S.createNS("http://www.w3.org/2000/svg","path");ie.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),H.appendChild(ie);const ne=S.createNS("http://www.w3.org/2000/svg","g");ne.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ne.setAttributeNS(null,"fill","#FFFFFF");const re=S.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"transform","translate(8.0, 8.0)");const pe=S.createNS("http://www.w3.org/2000/svg","circle");pe.setAttributeNS(null,"fill","#000000"),pe.setAttributeNS(null,"opacity","0.25"),pe.setAttributeNS(null,"cx","5.5"),pe.setAttributeNS(null,"cy","5.5"),pe.setAttributeNS(null,"r","5.4999962");const _e=S.createNS("http://www.w3.org/2000/svg","circle");_e.setAttributeNS(null,"fill","#FFFFFF"),_e.setAttributeNS(null,"cx","5.5"),_e.setAttributeNS(null,"cy","5.5"),_e.setAttributeNS(null,"r","5.4999962"),re.appendChild(pe),re.appendChild(_e),P.appendChild(k),P.appendChild(D),P.appendChild(H),P.appendChild(ne),P.appendChild(re),p.appendChild(P),p.setAttributeNS(null,"height",y*this._scale+"px"),p.setAttributeNS(null,"width",x*this._scale+"px"),this._element.appendChild(p),this._offset=c.pointGeometry.convert(o&&o.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",p=>{p.preventDefault()}),this._element.addEventListener("mousedown",p=>{p.preventDefault()}),kt(this._element,this._anchor,"marker"),this._popup=null}addTo(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),S.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=c.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const y=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(o){const h=o.code,p=o.charCode||o.keyCode;h!=="Space"&&h!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(o){const h=o.originalEvent.target,p=this._element;this._popup&&(h===p||p.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this}_update(o){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Kl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let h="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?h=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(h=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let p="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?p="rotateX(0deg)":this._pitchAlignment==="map"&&(p=`rotateX(${this._map.getPitch()}deg)`),o&&o.type!=="moveend"||(this._pos=this._pos.round()),S.setTransform(this._element,`${vt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${p} ${h}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const y=this._map.unproject(this._pos),x=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=y.distanceTo(this._lngLat)>20*x?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(o){return this._offset=c.pointGeometry.convert(o),this._update(),this}_onMove(o){if(!this._isDragging){const h=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=h}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.Event("dragstart"))),this.fire(new c.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.Event("dragend")),this._state="inactive"}_addDragHandler(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Hh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Eo,Gr=0,To=!1;const Rs={maxWidth:100,unit:"metric"};function Lp(m,o,h){const p=h&&h.maxWidth||100,y=m._container.clientHeight/2,x=m.unproject([0,y]),E=m.unproject([p,y]),P=x.distanceTo(E);if(h&&h.unit==="imperial"){const k=3.2808*P;k>5280?So(o,p,k/5280,m._getUIString("ScaleControl.Miles")):So(o,p,k,m._getUIString("ScaleControl.Feet"))}else h&&h.unit==="nautical"?So(o,p,P/1852,m._getUIString("ScaleControl.NauticalMiles")):P>=1e3?So(o,p,P/1e3,m._getUIString("ScaleControl.Kilometers")):So(o,p,P,m._getUIString("ScaleControl.Meters"))}function So(m,o,h,p){const y=function(x){const E=Math.pow(10,`${Math.floor(x)}`.length-1);let P=x/E;return P=P>=10?10:P>=5?5:P>=3?3:P>=2?2:P>=1?1:function(k){const L=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*L)/L}(P),E*P}(h);m.style.width=o*(y/h)+"px",m.innerHTML=`${y}&nbsp;${p}`}const lr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},vr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function qh(m){if(m){if(typeof m=="number"){const o=Math.round(Math.sqrt(.5*Math.pow(m,2)));return{center:new c.pointGeometry(0,0),top:new c.pointGeometry(0,m),"top-left":new c.pointGeometry(o,o),"top-right":new c.pointGeometry(-o,o),bottom:new c.pointGeometry(0,-m),"bottom-left":new c.pointGeometry(o,-o),"bottom-right":new c.pointGeometry(-o,-o),left:new c.pointGeometry(m,0),right:new c.pointGeometry(-m,0)}}if(m instanceof c.pointGeometry||Array.isArray(m)){const o=c.pointGeometry.convert(m);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:c.pointGeometry.convert(m.center||[0,0]),top:c.pointGeometry.convert(m.top||[0,0]),"top-left":c.pointGeometry.convert(m["top-left"]||[0,0]),"top-right":c.pointGeometry.convert(m["top-right"]||[0,0]),bottom:c.pointGeometry.convert(m.bottom||[0,0]),"bottom-left":c.pointGeometry.convert(m["bottom-left"]||[0,0]),"bottom-right":c.pointGeometry.convert(m["bottom-right"]||[0,0]),left:c.pointGeometry.convert(m.left||[0,0]),right:c.pointGeometry.convert(m.right||[0,0])}}return qh(new c.pointGeometry(0,0))}const Zo={supported:v,setRTLTextPlugin:c.setRTLTextPlugin,getRTLTextPluginStatus:c.getRTLTextPluginStatus,Map:class extends Xn{constructor(m){var o;if(c.PerformanceUtils.mark(c.PerformanceMarkers.create),(m=c.extend({},Mp,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new jl(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),{bearingSnap:m.bearingSnap}),this._interactive=m.interactive,this._cooperativeGestures=m.cooperativeGestures,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._renderTaskQueue=new Ip,this._controls=[],this._mapId=c.uniqueId(),this._locale=c.extend({},kp,m.locale),this._clickTolerance=m.clickTolerance,this._pixelRatio=(o=m.pixelRatio)!==null&&o!==void 0?o:devicePixelRatio,this._requestManager=new z(m.transformRequest),typeof m.container=="string"){if(this._container=document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),c.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Cp(this,m),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=m.hash&&new yp(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,c.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localIdeographFontFamily:m.localIdeographFontFamily}),m.attributionControl&&this.addControl(new Yl({customAttribution:m.customAttribution})),m.maplibreLogo&&this.addControl(new Zc,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new c.Event(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new c.Event(`${h.dataType}dataloading`,h))}),this.on("dataabort",h=>{this.fire(new c.Event("sourcedataabort",h))})}_getMapId(){return this._mapId}addControl(m,o){if(o===void 0&&(o=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new c.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=m.onAdd(this);this._controls.push(m);const p=this._controlPositions[o];return o.indexOf("bottom")!==-1?p.insertBefore(h,p.firstChild):p.appendChild(h),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new c.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(m);return o>-1&&this._controls.splice(o,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}calculateCameraOptionsFromTo(m,o,h,p){return p==null&&this.style.terrain&&(p=this.transform.getElevation(h,this.style.terrain)),super.calculateCameraOptionsFromTo(m,o,h,p)}resize(m){const o=this._containerDimensions(),h=o[0],p=o[1];this._resizeCanvas(h,p,this.getPixelRatio()),this.transform.resize(h,p),this.painter.resize(h,p,this.getPixelRatio());const y=!this._moving;return y&&(this.stop(),this.fire(new c.Event("movestart",m)).fire(new c.Event("move",m))),this.fire(new c.Event("resize",m)),y&&this.fire(new c.Event("moveend",m)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(m){const[o,h]=this._containerDimensions();this._pixelRatio=m,this._resizeCanvas(o,h,m),this.painter.resize(o,h,m)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(m){return this.transform.setMaxBounds(c.LngLatBounds.convert(m)),this._update()}setMinZoom(m){if((m=m==null?-2:m)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m==null?22:m)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m==null?0:m)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m==null?60:m)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this._update()}project(m){return this.transform.locationPoint(c.LngLat.convert(m),this.style&&this.style.terrain)}unproject(m){return this.transform.pointLocation(c.pointGeometry.convert(m),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(m,o,h){if(m==="mouseenter"||m==="mouseover"){let p=!1;return{layer:o,listener:h,delegates:{mousemove:x=>{const E=this.getLayer(o)?this.queryRenderedFeatures(x.point,{layers:[o]}):[];E.length?p||(p=!0,h.call(this,new Li(m,this,x.originalEvent,{features:E}))):p=!1},mouseout:()=>{p=!1}}}}if(m==="mouseleave"||m==="mouseout"){let p=!1;return{layer:o,listener:h,delegates:{mousemove:E=>{(this.getLayer(o)?this.queryRenderedFeatures(E.point,{layers:[o]}):[]).length?p=!0:p&&(p=!1,h.call(this,new Li(m,this,E.originalEvent)))},mouseout:E=>{p&&(p=!1,h.call(this,new Li(m,this,E.originalEvent)))}}}}{const p=y=>{const x=this.getLayer(o)?this.queryRenderedFeatures(y.point,{layers:[o]}):[];x.length&&(y.features=x,h.call(this,y),delete y.features)};return{layer:o,listener:h,delegates:{[m]:p}}}}on(m,o,h){if(h===void 0)return super.on(m,o);const p=this._createDelegatedListener(m,o,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(p);for(const y in p.delegates)this.on(y,p.delegates[y]);return this}once(m,o,h){if(h===void 0)return super.once(m,o);const p=this._createDelegatedListener(m,o,h);for(const y in p.delegates)this.once(y,p.delegates[y]);return this}off(m,o,h){return h===void 0?super.off(m,o):(this._delegatedListeners&&this._delegatedListeners[m]&&(p=>{const y=this._delegatedListeners[m];for(let x=0;x<y.length;x++){const E=y[x];if(E.layer===o&&E.listener===h){for(const P in E.delegates)this.off(P,E.delegates[P]);return y.splice(x,1),this}}})(),this)}queryRenderedFeatures(m,o){if(!this.style)return[];let h;if(o!==void 0||m===void 0||m instanceof c.pointGeometry||Array.isArray(m)||(o=m,m=void 0),o=o||{},(m=m||[[0,0],[this.transform.width,this.transform.height]])instanceof c.pointGeometry||typeof m[0]=="number")h=[c.pointGeometry.convert(m)];else{const p=c.pointGeometry.convert(m[0]),y=c.pointGeometry.convert(m[1]);h=[p,new c.pointGeometry(y.x,p.y),y,new c.pointGeometry(p.x,y.y),p]}return this.style.queryRenderedFeatures(h,o,this.transform)}querySourceFeatures(m,o){return this.style.querySourceFeatures(m,o)}setStyle(m,o){return(o=c.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(m,o))}setTransformRequest(m){return this._requestManager.setTransformRequest(m),this}_getUIString(m){const o=this._locale[m];if(o==null)throw new Error(`Missing UI string '${m}'`);return o}_updateStyle(m,o){return this.style&&(this.style.setEventedParent(null),this.style._remove()),m?(this.style=new Sr(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m):this.style.loadJSON(m),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Sr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,o){if(typeof m=="string"){const h=this._requestManager.transformRequest(m,c.ResourceType.Style);c.getJSON(h,(p,y)=>{p?this.fire(new c.ErrorEvent(p)):y&&this._updateDiff(y,o)})}else typeof m=="object"&&this._updateDiff(m,o)}_updateDiff(m,o){try{this.style.setState(m)&&this._update(!0)}catch(h){c.warnOnce(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(m,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.warnOnce("There is no style added to the map.")}addSource(m,o){return this._lazyInitEmptyStyle(),this.style.addSource(m,o),this._update(!0)}isSourceLoaded(m){const o=this.style&&this.style.sourceCaches[m];if(o!==void 0)return o.loaded();this.fire(new c.ErrorEvent(new Error(`There is no source with ID '${m}'`)))}setTerrain(m){return this.style.setTerrain(m),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const m=this.style&&this.style.sourceCaches;for(const o in m){const h=m[o]._tiles;for(const p in h){const y=h[p];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}addSourceType(m,o,h){return this._lazyInitEmptyStyle(),this.style.addSourceType(m,o,h)}removeSource(m){return this.style.removeSource(m),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,o,{pixelRatio:h=1,sdf:p=!1,stretchX:y,stretchY:x,content:E}={}){if(this._lazyInitEmptyStyle(),o instanceof HTMLImageElement||c.isImageBitmap(o)){const{width:P,height:k,data:L}=c.exported.getImageData(o);this.style.addImage(m,{data:new c.RGBAImage({width:P,height:k},L),pixelRatio:h,stretchX:y,stretchY:x,content:E,sdf:p,version:0})}else{if(o.width===void 0||o.height===void 0)return this.fire(new c.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:P,height:k,data:L}=o,D=o;this.style.addImage(m,{data:new c.RGBAImage({width:P,height:k},new Uint8Array(L)),pixelRatio:h,stretchX:y,stretchY:x,content:E,sdf:p,version:0,userImage:D}),D.onAdd&&D.onAdd(this,m)}}}updateImage(m,o){const h=this.style.getImage(m);if(!h)return this.fire(new c.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=o instanceof HTMLImageElement||c.isImageBitmap(o)?c.exported.getImageData(o):o,{width:y,height:x,data:E}=p;if(y===void 0||x===void 0)return this.fire(new c.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(y!==h.data.width||x!==h.data.height)return this.fire(new c.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const P=!(o instanceof HTMLImageElement||c.isImageBitmap(o));h.data.replace(E,P),this.style.updateImage(m,h)}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new c.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,o){c.getImage(this._requestManager.transformRequest(m,c.ResourceType.Image),o)}listImages(){return this.style.listImages()}addLayer(m,o){return this._lazyInitEmptyStyle(),this.style.addLayer(m,o),this._update(!0)}moveLayer(m,o){return this.style.moveLayer(m,o),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,o,h){return this.style.setLayerZoomRange(m,o,h),this._update(!0)}setFilter(m,o,h={}){return this.style.setFilter(m,o,h),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,o,h,p={}){return this.style.setPaintProperty(m,o,h,p),this._update(!0)}getPaintProperty(m,o){return this.style.getPaintProperty(m,o)}setLayoutProperty(m,o,h,p={}){return this.style.setLayoutProperty(m,o,h,p),this._update(!0)}getLayoutProperty(m,o){return this.style.getLayoutProperty(m,o)}setLight(m,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,o),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(m,o){return this.style.setFeatureState(m,o),this._update()}removeFeatureState(m,o){return this.style.removeFeatureState(m,o),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let m=0,o=0;return this._container&&(m=this._container.clientWidth||400,o=this._container.clientHeight||300),[m,o]}_setupContainer(){const m=this._container;m.classList.add("maplibregl-map","mapboxgl-map");const o=this._canvasContainer=S.create("div","maplibregl-canvas-container mapboxgl-canvas-container",m);this._interactive&&o.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=S.create("canvas","maplibregl-canvas mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const h=this._containerDimensions();this._resizeCanvas(h[0],h[1],this.getPixelRatio());const p=this._controlContainer=S.create("div","maplibregl-control-container mapboxgl-control-container",m),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{y[x]=S.create("div",`maplibregl-ctrl-${x} mapboxgl-ctrl-${x}`,p)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const m=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=S.create("div","maplibregl-cooperative-gesture-screen",m);let o="Control",h=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(h=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map",o="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${h}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",p=>{p.key===o&&(this._metaPress=!0)}),document.addEventListener("keyup",p=>{p.key===o&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",p=>{this._onCooperativeGesture(p,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(m,o,h){this._canvas.width=h*m,this._canvas.height=h*o,this._canvas.style.width=`${m}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const m=c.extend({},v.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);o?(this.painter=new zh(o,this.transform),c.exported$1.testSupport(o)):this.fire(new c.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new c.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new c.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(m,o,h){return!o&&h<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_render(m){let o,h=0;const p=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(o=p.createQueryEXT(),p.beginQueryEXT(p.TIME_ELAPSED_EXT,o),h=c.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._removed)return;let y=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const E=this.transform.zoom,P=c.exported.now();this.style.zoomHistory.update(E,P);const k=new c.EvaluationParameters(E,{now:P,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),L=k.crossFadingFactor();L===1&&L===this._crossFadingFactor||(y=!0,this._crossFadingFactor=L),this.style.update(k)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new c.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.PerformanceUtils.mark(c.PerformanceMarkers.load),this.fire(new c.Event("load"))),this.style&&(this.style.hasTransitions()||y)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const E=c.exported.now()-h;p.endQueryEXT(p.TIME_ELAPSED_EXT,o),setTimeout(()=>{const P=p.getQueryObjectEXT(o,p.QUERY_RESULT_EXT)/1e6;p.deleteQueryEXT(o),this.fire(new c.Event("gpu-timing-frame",{cpuTime:E,gpuTime:P}))},50)}if(this.listens("gpu-timing-layer")){const E=this.painter.collectGpuTimers();setTimeout(()=>{const P=this.painter.queryGpuTimers(E);this.fire(new c.Event("gpu-timing-layer",{layerTimes:P}))},50)}const x=this._sourcesDirty||this._styleDirty||this._placementDirty;return x||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.Event("idle")),!this._loaded||this._fullyLoaded||x||(this._fullyLoaded=!0,c.PerformanceUtils.mark(c.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),S.remove(this._canvasContainer),S.remove(this._controlContainer),this._cooperativeGestures&&S.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),c.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new c.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=c.exported.frame(m=>{c.PerformanceUtils.frame(m),this._frame=null,this._render(m)}))}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}_setCacheLimits(m,o){c.setCacheLimits(m,o)}get version(){return"2.4.0"}},NavigationControl:class{constructor(m){this.options=c.extend({},Xy,m),this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(c.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),S.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),S.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(c.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=S.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map.getZoom(),o=m===this._map.getMaxZoom(),h=m===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())}_rotateCompassArrow(){const m=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=m}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ls(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){S.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(m,o){const h=S.create("button",m,this._container);return h.type="button",h.addEventListener("click",o),h}_setButtonTitle(m,o){const h=this._map._getUIString(`NavigationControl.${o}`);m.title=h,m.setAttribute("aria-label",h)}},GeolocateControl:class extends c.Evented{constructor(m){super(),this.options=c.extend({},Hh,m),c.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(m){var o;return this._map=m,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),o=this._setupUI,Eo!==void 0?o(Eo):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(h=>{Eo=h.state!=="denied",o(Eo)}):(Eo=!!window.navigator.geolocation,o(Eo)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),S.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Gr=0,To=!1}_isOutOfMapMaxBounds(m){const o=this._map.getMaxBounds(),h=m.coords;return o&&(h.longitude<o.getWest()||h.longitude>o.getEast()||h.latitude<o.getSouth()||h.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new c.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new c.Event("geolocate",m)),this._finish()}}_updateCamera(m){const o=new c.LngLat(m.coords.longitude,m.coords.latitude),h=m.coords.accuracy,p=this._map.getBearing(),y=c.extend({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(h),y,{geolocateSource:!0})}_updateMarker(m){if(m){const o=new c.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map._container.clientHeight/2,o=this._map.unproject([0,m]),h=this._map.unproject([1,m]),p=o.distanceTo(h),y=Math.ceil(2*this._accuracy/p);this._circleElement.style.width=`${y}px`,this._circleElement.style.height=`${y}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&To)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new c.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=S.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),S.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){c.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=S.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new Ua(this._dotElement),this._circleElement=S.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ua({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new c.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return c.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Gr--,To=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new c.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Gr++,Gr>1?(m={maximumAge:6e5,timeout:0},To=!0):(m=this.options.positionOptions,To=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Yl,LogoControl:Zc,ScaleControl:class{constructor(m){this.options=c.extend({},Rs,m),c.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Lp(this._map,this._container,this.options)}onAdd(m){return this._map=m,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){S.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(m){this.options.unit=m,Lp(this._map,this._container,this.options)}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:c.warnOnce("Full screen control 'container' must be a DOM element.")),c.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=S.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",c.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){S.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=S.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);S.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.title=m}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(m){this.options=m,c.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(m){return this._map=m,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=S.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),S.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){S.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends c.Evented{constructor(m){super(),this.options=c.extend(Object.create(lr),m),c.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new c.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&S.remove(this._content),this._container&&(S.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new c.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=c.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const o=document.createDocumentFragment(),h=document.createElement("body");let p;for(h.innerHTML=m;p=h.firstChild,p;)o.appendChild(p);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=S.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(m){this._container&&this._container.classList.add(m)}removeClassName(m){this._container&&this._container.classList.remove(m)}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){if(this._container)return this._container.classList.toggle(m)}_createCloseButton(){this.options.closeButton&&(this._closeButton=S.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(m){this._update(m.point)}_onMouseMove(m){this._update(m.point)}_onDrag(m){this._update(m.point)}_update(m){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=S.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=S.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(x=>this._container.classList.add(x)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Kl(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!m))return;const o=this._pos=this._trackPointer&&m?m:this._map.project(this._lngLat);let h=this.options.anchor;const p=qh(this.options.offset);if(!h){const x=this._container.offsetWidth,E=this._container.offsetHeight;let P;P=o.y+p.bottom.y<E?["top"]:o.y>this._map.transform.height-E?["bottom"]:[],o.x<x/2?P.push("left"):o.x>this._map.transform.width-x/2&&P.push("right"),h=P.length===0?"bottom":P.join("-")}const y=o.add(p[h]).round();S.setTransform(this._container,`${vt[h]} translate(${y.x}px,${y.y}px)`),kt(this._container,h,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(vr);m&&m.focus()}_onClose(){this.remove()}},Marker:Ua,Style:Sr,LngLat:c.LngLat,LngLatBounds:c.LngLatBounds,Point:c.pointGeometry,MercatorCoordinate:c.MercatorCoordinate,Evented:c.Evented,AJAXError:c.AJAXError,config:c.config,CanvasSource:at,GeoJSONSource:yn,ImageSource:et,RasterDEMTileSource:Qe,RasterTileSource:ot,VectorTileSource:yt,VideoSource:_t,prewarm:function(){Hn().acquire(In)},clearPrewarmedResources:function(){const m=or;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(In),or=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return Vn.workerCount},set workerCount(m){Vn.workerCount=m},get maxParallelImageRequests(){return c.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){c.config.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){c.clearTileCache(m)},workerUrl:"",addProtocol(m,o){c.config.REGISTERED_PROTOCOLS[m]=o},removeProtocol(m){delete c.config.REGISTERED_PROTOCOLS[m]}};return Xi.extend(Zo,{isSafari:c.isSafari,getPerformanceMetrics:c.PerformanceUtils.getPerformanceMetrics}),Zo});var d=s;return d})})(ik);const qW=ik.exports,XW="modulepreload",ZW=function(t,e){return new URL(t,e).href},rS={},YW=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(l=>{if(l=ZW(l,r),l in rS)return;rS[l]=!0;const d=l.endsWith(".css"),c=d?'[rel="stylesheet"]':"";if(!!r)for(let C=s.length-1;C>=0;C--){const I=s[C];if(I.href===l&&(!d||I.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${c}`))return;const w=document.createElement("link");if(w.rel=d?"stylesheet":XW,d||(w.as="script",w.crossOrigin=""),w.href=l,document.head.appendChild(w),d)return new Promise((C,I)=>{w.addEventListener("load",C),w.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${l}`)))})})).then(()=>e())},KW=Ie.exports.createContext(null);function JW(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function iS(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function sS(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const s=t.center;t.center=new s.constructor(n.longitude,n.latitude),r=r||s!==t.center}if("zoom"in n){const s=t.zoom;t.zoom=n.zoom,r=r||s!==t.zoom}if("bearing"in n){const s=t.bearing;t.bearing=n.bearing,r=r||s!==t.bearing}if("pitch"in n){const s=t.pitch;t.pitch=n.pitch,r=r||s!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const QW=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function oS(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{const s=e[r.ref];let l=null;if("interactive"in r&&(l={...r},delete l.interactive),s){l=l||{...r},delete l.ref;for(const d of QW)d in s&&(l[d]=s[d])}return l||r});return{...t,layers:n}}function eH(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,s=Array.isArray(e)?e[0]:e?e.x:0,l=Array.isArray(e)?e[1]:e?e.y:0;return n===s&&r===l}function rl(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!rl(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const s of n)if(!e.hasOwnProperty(s)||!rl(t[s],e[s]))return!1;return!0}return!1}const aS={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},N0={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},lS={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},tH=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],nH=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class hh{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=s=>{const l=this.props[lS[s.type]];l&&l(s)},this._onPointerEvent=s=>{(s.type==="mousemove"||s.type==="mouseout")&&this._updateHover(s);const l=this.props[aS[s.type]];if(l){if(this.props.interactiveLayerIds&&s.type!=="mouseover"&&s.type!=="mouseout"){const d=this._hoveredFeatures||this._map.queryRenderedFeatures(s.point,{layers:this.props.interactiveLayerIds});s.features=d}l(s),delete s.features}},this._onCameraEvent=s=>{if(!this._internalUpdate){const l=this.props[N0[s.type]];l&&l(s)}s.type in this._deferredEvents&&(this._deferredEvents[s.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const s=this._updateSize(e),l=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||s||l&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=hh.savedMaps.pop();if(!r)return null;const s=r.map,l=s.getContainer();for(n.className=l.className;l.childNodes.length>0;)n.appendChild(l.childNodes[0]);s._container=n,r.setProps({...e,styleDiffing:!1}),s.resize();const{initialViewState:d}=e;return d&&(d.bounds?s.fitBounds(d.bounds,{...d.fitBoundsOptions,duration:0}):r._updateViewState(d,!1)),s.isStyleLoaded()?s.fire("load"):s.once("styledata",()=>s.fire("load")),r}_initialize(e){const{props:n}=this,r={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||rH()||null,container:e,style:oS(n.mapStyle)},s=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const w=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=w,n.gl)}const l=new this._MapClass(r);s.padding&&l.setPadding(s.padding),n.cursor&&(l.getCanvas().style.cursor=n.cursor),this._createShadowTransform(l);const d=l._render;l._render=w=>{this._inRender=!0,d.call(l,w),this._inRender=!1};const c=l._renderTaskQueue.run;l._renderTaskQueue.run=w=>{c.call(l._renderTaskQueue,w),this._onBeforeRepaint()},l.on("render",()=>this._onAfterRepaint());const v=l.fire;l.fire=this._fireEvent.bind(this,v),l.on("resize",()=>{this._renderTransform.resize(l.transform.width,l.transform.height)}),l.on("styledata",()=>this._updateStyleComponents(this.props,{})),l.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const w in aS)l.on(w,this._onPointerEvent);for(const w in N0)l.on(w,this._onCameraEvent);for(const w in lS)l.on(w,this._onEvent);this._map=l}recycle(){hh.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=JW(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,s=this._renderTransform,{zoom:l,pitch:d,bearing:c}=s,v=r.isMoving();v&&(s.cameraElevationReference="sea");const w=sS(s,{...iS(r.transform),...e});if(v&&(s.cameraElevationReference="ground"),w&&n){const C=this._deferredEvents;C.move=!0,C.zoom||(C.zoom=l!==s.zoom),C.rotate||(C.rotate=c!==s.bearing),C.pitch||(C.pitch=d!==s.pitch)}return v||sS(r.transform,e),w}_updateSettings(e,n){const r=this._map;let s=!1;for(const l of tH)l in e&&!rl(e[l],n[l])&&(s=!0,r[`set${l[0].toUpperCase()}${l.slice(1)}`](e[l]));return s}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor),e.mapStyle!==n.mapStyle){const r={diff:e.styleDiffing};return"localIdeographFontFamily"in e&&(r.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(oS(e.mapStyle),r),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let s=!1;return r.style.loaded()&&("light"in e&&!rl(e.light,n.light)&&(s=!0,r.setLight(e.light)),"fog"in e&&!rl(e.fog,n.fog)&&(s=!0,r.setFog(e.fog)),"terrain"in e&&!rl(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(s=!0,r.setTerrain(e.terrain))),s}_updateHandlers(e,n){const r=this._map;let s=!1;for(const l of nH){const d=e[l];rl(d,n[l])||(s=!0,d?r[l].enable(d):r[l].disable())}return s}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const l=e.type,d=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0;let c;if(l==="mousemove")try{c=this._map.queryRenderedFeatures(e.point,{layers:r.interactiveLayerIds})}catch{c=[]}else c=[];const v=c.length>0;!v&&d&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=c,v&&!d&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=l}else this._hoveredFeatures=null}_fireEvent(e,n,r){const s=this._map,l=s.transform,d=typeof n=="string"?n:n.type;return d==="move"&&this._updateViewState(this.props,!1),d in N0&&(typeof n=="object"&&(n.viewState=iS(l)),this._map.isMoving())?(s.transform=this._renderTransform,e.call(s,n,r),s.transform=l,s):(e.call(s,n,r),s)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=n}}}hh.savedMaps=[];function rH(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||process.env.MapboxAccessToken}catch{}try{t=t||process.env.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const iH=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function sH(t,e){if(!t)return null;const n=t.map,r={getMap:()=>n,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:s=>t.transform.locationPoint(e.LngLat.convert(s)),unproject:s=>t.transform.pointLocation(e.Point.convert(s)),queryTerrainElevation:(s,l)=>{const d=n.transform;n.transform=t.transform;const c=n.queryTerrainElevation(s,l);return n.transform=d,c}};for(const s of oH(n))!(s in r)&&!iH.includes(s)&&(r[s]=n[s].bind(n));return r}function oH(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const aH=typeof document<"u"?Ie.exports.useLayoutEffect:Ie.exports.useEffect,lH=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function cH(t,e){for(const n of lH)n in e&&(t[n]=e[n]);e.RTLTextPlugin&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(e.RTLTextPlugin,n=>{n&&console.error(n)},!1)}const Cy=Ie.exports.createContext(null),uH={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:t=>console.error(t.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},J1=Ie.exports.forwardRef((t,e)=>{const n=Ie.exports.useContext(KW),[r,s]=Ie.exports.useState(null),l=Ie.exports.useRef(),{current:d}=Ie.exports.useRef({mapLib:null,map:null});Ie.exports.useEffect(()=>{const v=t.mapLib;let w=!0,C;return Promise.resolve(v||YW(()=>import("./mapbox-gl.99ad841b.js").then(I=>I.m),[],import.meta.url)).then(I=>{if(!!w){if(I.Map||(I=I.default),!I||!I.Map)throw new Error("Invalid mapLib");if(I.supported(t))cH(I,t),t.reuseMaps&&(C=hh.reuse(t,l.current)),C||(C=new hh(I.Map,t,l.current)),d.map=sH(C,I),d.mapLib=I,s(C),n==null||n.onMapMount(d.map,t.id);else throw new Error("Map is not supported by this browser")}}).catch(I=>{t.onError({type:"error",target:null,originalEvent:null,error:I})}),()=>{w=!1,C&&(n==null||n.onMapUnmount(t.id),t.reuseMaps?C.recycle():C.destroy())}},[]),aH(()=>{r&&r.setProps(t)}),Ie.exports.useImperativeHandle(e,()=>d.map,[r]);const c=Ie.exports.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]);return hn("div",{id:t.id,ref:l,style:c,children:r&&hn(Cy.Provider,{value:d,children:t.children})})});J1.displayName="Map";J1.defaultProps=uH;const hH=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Rc(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const s=e[r];Number.isFinite(s)&&!hH.test(r)?n[r]=`${s}px`:n[r]=s}}const dH={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function ok(t){const{map:e,mapLib:n}=Ie.exports.useContext(Cy),r=Ie.exports.useRef({props:t});r.current.props=t;const s=Ie.exports.useMemo(()=>{let l=!1;Ie.exports.Children.forEach(t.children,v=>{v&&(l=!0)});const d={...t,element:l?document.createElement("div"):null},c=new n.Marker(d).setLngLat([t.longitude,t.latitude]);return c.getElement().addEventListener("click",v=>{var w,C;(C=(w=r.current.props).onClick)===null||C===void 0||C.call(w,{type:"click",target:c,originalEvent:v})}),c.on("dragstart",v=>{var w,C;const I=v;I.lngLat=s.getLngLat(),(C=(w=r.current.props).onDragStart)===null||C===void 0||C.call(w,I)}),c.on("drag",v=>{var w,C;const I=v;I.lngLat=s.getLngLat(),(C=(w=r.current.props).onDrag)===null||C===void 0||C.call(w,I)}),c.on("dragend",v=>{var w,C;const I=v;I.lngLat=s.getLngLat(),(C=(w=r.current.props).onDragEnd)===null||C===void 0||C.call(w,I)}),c},[]);return Ie.exports.useEffect(()=>(s.addTo(e.getMap()),()=>{s.remove()}),[]),Ie.exports.useEffect(()=>{Rc(s.getElement(),t.style)},[t.style]),(s.getLngLat().lng!==t.longitude||s.getLngLat().lat!==t.latitude)&&s.setLngLat([t.longitude,t.latitude]),t.offset&&!eH(s.getOffset(),t.offset)&&s.setOffset(t.offset),s.isDraggable()!==t.draggable&&s.setDraggable(t.draggable),s.getRotation()!==t.rotation&&s.setRotation(t.rotation),s.getRotationAlignment()!==t.rotationAlignment&&s.setRotationAlignment(t.rotationAlignment),s.getPitchAlignment()!==t.pitchAlignment&&s.setPitchAlignment(t.pitchAlignment),s.getPopup()!==t.popup&&s.setPopup(t.popup),gl.exports.createPortal(t.children,s.getElement())}ok.defaultProps=dH;Ie.exports.memo(ok);function cS(t){return new Set(t?t.trim().split(/\s+/):[])}function fH(t){const{map:e,mapLib:n}=Ie.exports.useContext(Cy),r=Ie.exports.useMemo(()=>document.createElement("div"),[]),s=Ie.exports.useRef({props:t});s.current.props=t;const l=Ie.exports.useMemo(()=>{const d={...t},c=new n.Popup(d).setLngLat([t.longitude,t.latitude]);return c.once("open",v=>{var w,C;(C=(w=s.current.props).onOpen)===null||C===void 0||C.call(w,v)}),c},[]);if(Ie.exports.useEffect(()=>{const d=c=>{var v,w;(w=(v=s.current.props).onClose)===null||w===void 0||w.call(v,c)};return l.on("close",d),l.setDOMContent(r).addTo(e.getMap()),()=>{l.off("close",d),l.isOpen()&&l.remove()}},[]),Ie.exports.useEffect(()=>{Rc(l.getElement(),t.style)},[t.style]),l.isOpen()&&((l.getLngLat().lng!==t.longitude||l.getLngLat().lat!==t.latitude)&&l.setLngLat([t.longitude,t.latitude]),t.offset&&!rl(l.options.offset,t.offset)&&l.setOffset(t.offset),(l.options.anchor!==t.anchor||l.options.maxWidth!==t.maxWidth)&&(l.options.anchor=t.anchor,l.setMaxWidth(t.maxWidth)),l.options.className!==t.className)){const d=cS(l.options.className),c=cS(t.className);for(const v of d)c.has(v)||l.removeClassName(v);for(const v of c)d.has(v)||l.addClassName(v);l.options.className=t.className}return gl.exports.createPortal(t.children,r)}Ie.exports.memo(fH);function Jf(t,e,n,r){const s=Ie.exports.useContext(Cy),l=Ie.exports.useMemo(()=>t(s),[]);return Ie.exports.useEffect(()=>{const d=r||n||e,c=typeof e=="function"&&typeof n=="function"?e:null,v=typeof n=="function"?n:typeof e=="function"?e:null,{map:w}=s;return w.hasControl(l)||(w.addControl(l,d==null?void 0:d.position),c&&c(s)),()=>{v&&v(s),w.hasControl(l)&&w.removeControl(l)}},[]),l}function pH(t){const e=Jf(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return Ie.exports.useEffect(()=>{Rc(e._container,t.style)},[t.style]),null}Ie.exports.memo(pH);function mH(t){const e=Jf(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return Ie.exports.useEffect(()=>{Rc(e._controlContainer,t.style)},[t.style]),null}Ie.exports.memo(mH);const ak=Ie.exports.forwardRef((t,e)=>{const n=Ie.exports.useRef({props:t}),r=Jf(({mapLib:s})=>{const l=new s.GeolocateControl(t),d=l._setupUI;return l._setupUI=c=>{l._container.hasChildNodes()||d(c)},l.on("geolocate",c=>{var v,w;(w=(v=n.current.props).onGeolocate)===null||w===void 0||w.call(v,c)}),l.on("error",c=>{var v,w;(w=(v=n.current.props).onError)===null||w===void 0||w.call(v,c)}),l.on("outofmaxbounds",c=>{var v,w;(w=(v=n.current.props).onOutOfMaxBounds)===null||w===void 0||w.call(v,c)}),l.on("trackuserlocationstart",c=>{var v,w;(w=(v=n.current.props).onTrackUserLocationStart)===null||w===void 0||w.call(v,c)}),l.on("trackuserlocationend",c=>{var v,w;(w=(v=n.current.props).onTrackUserLocationEnd)===null||w===void 0||w.call(v,c)}),l},{position:t.position});return n.current.props=t,Ie.exports.useImperativeHandle(e,()=>({trigger:()=>r.trigger()}),[]),Ie.exports.useEffect(()=>{Rc(r._container,t.style)},[t.style]),null});ak.displayName="GeolocateControl";Ie.exports.memo(ak);function gH(t){const e=Jf(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return Ie.exports.useEffect(()=>{Rc(e._container,t.style)},[t.style]),null}Ie.exports.memo(gH);const yH={unit:"metric",maxWidth:100};function lk(t){const e=Jf(({mapLib:n})=>new n.ScaleControl(t),{position:t.position});return(e.options.unit!==t.unit||e.options.maxWidth!==t.maxWidth)&&(e.options.maxWidth=t.maxWidth,e.setUnit(t.unit)),Ie.exports.useEffect(()=>{Rc(e._container,t.style)},[t.style]),null}lk.defaultProps=yH;Ie.exports.memo(lk);const _H=[{id:1,name:"Nueva casita",description:"DESC #1",fileName:"IMG_20220105_213935.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"43.322484,-3.025605",date:"Wednesday, 5 January 2022, 21:39",width:128,height:277},{id:2,name:"Old casita",description:"DESC #2",fileName:"IMG_20220122_004852.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"43.322473,-3.025589",date:"Saturday, 22 January 2022, 00:48",width:128,height:277},{id:3,name:"Cambre",description:"DESC #3",fileName:"IMG_20220128_230726.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"43.326605,-3.02437",date:"Friday, 28 January 2022, 23:07",width:128,height:277},{id:4,name:"Esencia",description:"DESC #4",fileName:"IMG_20220212_221813.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"43.249106,-2.919873",date:"Saturday, 12 February 2022, 22:18",width:128,height:170},{id:5,name:"Puente colgante",description:"DESC #5",fileName:"IMG_20220213_165804.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"43.31441,-3.006411",date:"Sunday, 13 February 2022, 16:58",width:128,height:59},{id:6,name:"Cenita chula",description:"DESC #6",fileName:"IMG_20220225_203103.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"43.31781,-3.023135",date:"Friday, 25 February 2022, 20:31",width:128,height:277},{id:7,name:"Primer chiringuito",description:"DESC #7",fileName:"IMG-20220502-WA0040.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"TODO: CHIRINGUITO ",date:"Monday, 2 May 2022, 21:49",width:128,height:170},{id:8,name:"Vivir Fuengirola",description:"DESC #8",fileName:"IMG_0315.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.6986,-4.4498",date:"Saturday, 14 May 2022, 20:14",width:128,height:170},{id:9,name:"Estreno casa fuengirola",description:"DESC #9",fileName:"IMG_0329.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.543,-4.6214",date:"Sunday, 15 May 2022, 14:24",width:128,height:170},{id:10,name:"Primer garito fuengirola",description:"DESC #10",fileName:"IMG_0338.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.5428083,-4.6216944",date:"Sunday, 15 May 2022, 15:10",width:128,height:170},{id:11,name:"Primer d\xEDa Myramar",description:"DESC #11",fileName:"IMG_0580.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.5284,-4.6314",date:"Wednesday, 18 May 2022, 20:50",width:128,height:170},{id:12,name:"Los cari\xF1os de Urkote",description:"DESC #12",fileName:"IMG_0637.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.554,-4.622",date:"Friday, 20 May 2022, 17:13",width:128,height:170},{id:13,name:"\xA1Anda! \xA1Que hay un toro!",description:"DESC #13",fileName:"IMG_0695.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.5607,-4.6098",date:"Friday, 20 May 2022, 17:13",width:128,height:96},{id:14,name:"Paseo por la playa",description:"DESC #14",fileName:"IMG_0755.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.5269,-4.626",date:"Sunday, 22 May 2022, 20:51",width:128,height:96},{id:15,name:"Vaya elementos",description:"DESC #15",fileName:"IMG_0823.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.564,-4.6011",date:"Tuesday, 24 May 2022, 20:06",width:128,height:96},{id:16,name:"Parquecito",description:"DESC #16",fileName:"IMG_1121.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.5879,-4.5802",date:"Saturday, 28 May 2022, 18:24",width:128,height:96},{id:17,name:"Bonitos paseos",description:"DESC #17",fileName:"IMG_1412.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.5429,-4.6215",date:"Saturday, 4 June 2022, 21:58",width:128,height:170},{id:18,name:"El Gecko",description:"DESC #18",fileName:"IMG_1494.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.5744,-4.5842",date:"Sunday, 5 June 2022, 18:19",width:128,height:96},{id:19,name:"Piscina post-operaci\xF3n",description:"DESC #19",fileName:"81C57173-CF3C-4BAF-85A3-EEEDE7917AC6.JPG",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.5537396,-4.6219774",date:"Saturday, 18 June 2022, 19:09",width:128,height:72},{id:20,name:"Besitos en la nueva casita, un rato sin collar\xEDn",description:"DESC #20",fileName:"IMG_3867.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.5557,-4.6152",date:"Wednesday, 27 July 2022, 18:42",width:128,height:96},{id:21,name:"Bye bye collar\xEDn",description:"DESC #21",fileName:"81e9de42-26ef-47ae-867f-a0f3aaa40f43.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.5557,-4.6152",date:"Wednesday, 3 August 2022, 19:09",width:128,height:227},{id:22,name:"Ba\xF1adores y piscinita",description:"DESC #22",fileName:"e5f3c6c2-3645-491c-9174-ba67b6abafd9.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"TODO: PLAYA",date:"Friday, 5 August 2022, 14:08",width:128,height:227},{id:23,name:"Makati - primera cenita",description:"DESC #23",fileName:"IMG_4225.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.5476583,-4.6165528",date:"Saturday, 6 August 2022, 22:36",width:128,height:96},{id:24,name:"Primer d\xEDa en M\xE1laga capital",description:"DESC #24",fileName:"IMG_4352.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.7214,-4.4171",date:"Thursday, 11 August 2022, 20:01",width:128,height:170},{id:25,name:"Pre-viaje a Granada",description:"DESC #25",fileName:"IMG_5035.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.7128,-4.4327",date:"Monday, 5 September 2022, 09:39",width:128,height:96},{id:26,name:"Granada juntos",description:"DESC #26",fileName:"IMG_5120.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"37.1774,-3.5893",date:"Monday, 5 September 2022, 17:57",width:128,height:170},{id:27,name:"Noches bonitas de la mano",description:"DESC #27",fileName:"IMG_6569.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.5807306,-4.5573361",date:"Friday, 21 October 2022, 21:26",width:128,height:96},{id:28,name:"Halloween",description:"DESC #28",fileName:"IMG_6864.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.5557,-4.6151",date:"Monday, 31 October 2022, 21:20",width:128,height:170},{id:29,name:"Noches de juegos y mimos",description:"DESC #29",fileName:"IMG_7245.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.5555611,-4.6151833",date:"Sunday, 13 November 2022, 00:32",width:128,height:170},{id:30,name:"Ben\xE1mdadena de la mano",description:"DESC #16",fileName:"IMG_1167.jpg",driveId:"1JzKmgvXmAwxIqLTjPctYl2Ogz4Kdxk9L",location:"36.5879,-4.5802",date:"Saturday, 28 May 2022, 18:24",width:128,height:96}];var Tt={},px={exports:{}};(function(t,e){(function(n,r){var s="1.0.32",l="",d="?",c="function",v="undefined",w="object",C="string",I="major",S="model",z="name",F="type",B="vendor",Q="version",q="architecture",j="console",G="mobile",se="tablet",he="smarttv",ye="wearable",we="embedded",Be=350,Ve="Amazon",xe="Apple",He="ASUS",wt="BlackBerry",yt="Browser",ot="Chrome",zt="Edge",Qe="Firefox",yn="Google",Ne="Huawei",et="LG",_t="Microsoft",at="Motorola",Ot="Opera",tn="Samsung",$t="Sharp",cn="Sony",sn="Xiaomi",Bt="Zebra",fn="Facebook",jt=function(Wt,nn){var Nt={};for(var Sn in Wt)nn[Sn]&&nn[Sn].length%2===0?Nt[Sn]=nn[Sn].concat(Wt[Sn]):Nt[Sn]=Wt[Sn];return Nt},Kt=function(Wt){for(var nn={},Nt=0;Nt<Wt.length;Nt++)nn[Wt[Nt].toUpperCase()]=Wt[Nt];return nn},Wn=function(Wt,nn){return typeof Wt===C?In(nn).indexOf(In(Wt))!==-1:!1},In=function(Wt){return Wt.toLowerCase()},Vn=function(Wt){return typeof Wt===C?Wt.replace(/[^\d\.]/g,l).split(".")[0]:r},kr=function(Wt,nn){if(typeof Wt===C)return Wt=Wt.replace(/^\s\s*/,l).replace(/\s\s*$/,l),typeof nn===v?Wt:Wt.substring(0,Be)},or=function(Wt,nn){for(var Nt=0,Sn,Ut,Re,je,Xr,Dn;Nt<nn.length&&!Xr;){var Ht=nn[Nt],Vr=nn[Nt+1];for(Sn=Ut=0;Sn<Ht.length&&!Xr;)if(Xr=Ht[Sn++].exec(Wt),Xr)for(Re=0;Re<Vr.length;Re++)Dn=Xr[++Ut],je=Vr[Re],typeof je===w&&je.length>0?je.length===2?typeof je[1]==c?this[je[0]]=je[1].call(this,Dn):this[je[0]]=je[1]:je.length===3?typeof je[1]===c&&!(je[1].exec&&je[1].test)?this[je[0]]=Dn?je[1].call(this,Dn,je[2]):r:this[je[0]]=Dn?Dn.replace(je[1],je[2]):r:je.length===4&&(this[je[0]]=Dn?je[3].call(this,Dn.replace(je[1],je[2])):r):this[je]=Dn||r;Nt+=2}},Hn=function(Wt,nn){for(var Nt in nn)if(typeof nn[Nt]===w&&nn[Nt].length>0){for(var Sn=0;Sn<nn[Nt].length;Sn++)if(Wn(nn[Nt][Sn],Wt))return Nt===d?r:Nt}else if(Wn(nn[Nt],Wt))return Nt===d?r:Nt;return Wt},Mr={"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},jn={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Jt={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[Q,[z,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[Q,[z,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[z,Q],[/opios[\/ ]+([\w\.]+)/i],[Q,[z,Ot+" Mini"]],[/\bopr\/([\w\.]+)/i],[Q,[z,Ot]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[z,Q],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[Q,[z,"UC"+yt]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[Q,[z,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[Q,[z,"WeChat"]],[/konqueror\/([\w\.]+)/i],[Q,[z,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[Q,[z,"IE"]],[/yabrowser\/([\w\.]+)/i],[Q,[z,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[z,/(.+)/,"$1 Secure "+yt],Q],[/\bfocus\/([\w\.]+)/i],[Q,[z,Qe+" Focus"]],[/\bopt\/([\w\.]+)/i],[Q,[z,Ot+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[Q,[z,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[Q,[z,"Dolphin"]],[/coast\/([\w\.]+)/i],[Q,[z,Ot+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[Q,[z,"MIUI "+yt]],[/fxios\/([-\w\.]+)/i],[Q,[z,Qe]],[/\bqihu|(qi?ho?o?|360)browser/i],[[z,"360 "+yt]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[z,/(.+)/,"$1 "+yt],Q],[/(comodo_dragon)\/([\w\.]+)/i],[[z,/_/g," "],Q],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[z,Q],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[z],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[z,fn],Q],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[z,Q],[/\bgsa\/([\w\.]+) .*safari\//i],[Q,[z,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[Q,[z,ot+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[z,ot+" WebView"],Q],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[Q,[z,"Android "+yt]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[z,Q],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[Q,[z,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[Q,z],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[z,[Q,Hn,Mr]],[/(webkit|khtml)\/([\w\.]+)/i],[z,Q],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[z,"Netscape"],Q],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[Q,[z,Qe+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[z,Q]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[q,"amd64"]],[/(ia32(?=;))/i],[[q,In]],[/((?:i[346]|x)86)[;\)]/i],[[q,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[q,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[q,"armhf"]],[/windows (ce|mobile); ppc;/i],[[q,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[q,/ower/,l,In]],[/(sun4\w)[;\)]/i],[[q,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[q,In]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[S,[B,tn],[F,se]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[S,[B,tn],[F,G]],[/\((ip(?:hone|od)[\w ]*);/i],[S,[B,xe],[F,G]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[S,[B,xe],[F,se]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[S,[B,Ne],[F,se]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[S,[B,Ne],[F,G]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[S,/_/g," "],[B,sn],[F,G]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[S,/_/g," "],[B,sn],[F,se]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[S,[B,"OPPO"],[F,G]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[S,[B,"Vivo"],[F,G]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[S,[B,"Realme"],[F,G]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[S,[B,at],[F,G]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[S,[B,at],[F,se]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[S,[B,et],[F,se]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[S,[B,et],[F,G]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[S,[B,"Lenovo"],[F,se]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[S,/_/g," "],[B,"Nokia"],[F,G]],[/(pixel c)\b/i],[S,[B,yn],[F,se]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[S,[B,yn],[F,G]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[S,[B,cn],[F,G]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[S,"Xperia Tablet"],[B,cn],[F,se]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[S,[B,"OnePlus"],[F,G]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[S,[B,Ve],[F,se]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[S,/(.+)/g,"Fire Phone $1"],[B,Ve],[F,G]],[/(playbook);[-\w\),; ]+(rim)/i],[S,B,[F,se]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[S,[B,wt],[F,G]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[S,[B,He],[F,se]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[S,[B,He],[F,G]],[/(nexus 9)/i],[S,[B,"HTC"],[F,se]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony(?!-bra))[-_ ]?([-\w]*)/i],[B,[S,/_/g," "],[F,G]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[S,[B,"Acer"],[F,se]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[S,[B,"Meizu"],[F,G]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[S,[B,$t],[F,G]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[B,S,[F,G]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[B,S,[F,se]],[/(surface duo)/i],[S,[B,_t],[F,se]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[S,[B,"Fairphone"],[F,G]],[/(u304aa)/i],[S,[B,"AT&T"],[F,G]],[/\bsie-(\w*)/i],[S,[B,"Siemens"],[F,G]],[/\b(rct\w+) b/i],[S,[B,"RCA"],[F,se]],[/\b(venue[\d ]{2,7}) b/i],[S,[B,"Dell"],[F,se]],[/\b(q(?:mv|ta)\w+) b/i],[S,[B,"Verizon"],[F,se]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[S,[B,"Barnes & Noble"],[F,se]],[/\b(tm\d{3}\w+) b/i],[S,[B,"NuVision"],[F,se]],[/\b(k88) b/i],[S,[B,"ZTE"],[F,se]],[/\b(nx\d{3}j) b/i],[S,[B,"ZTE"],[F,G]],[/\b(gen\d{3}) b.+49h/i],[S,[B,"Swiss"],[F,G]],[/\b(zur\d{3}) b/i],[S,[B,"Swiss"],[F,se]],[/\b((zeki)?tb.*\b) b/i],[S,[B,"Zeki"],[F,se]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[B,"Dragon Touch"],S,[F,se]],[/\b(ns-?\w{0,9}) b/i],[S,[B,"Insignia"],[F,se]],[/\b((nxa|next)-?\w{0,9}) b/i],[S,[B,"NextBook"],[F,se]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[B,"Voice"],S,[F,G]],[/\b(lvtel\-)?(v1[12]) b/i],[[B,"LvTel"],S,[F,G]],[/\b(ph-1) /i],[S,[B,"Essential"],[F,G]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[S,[B,"Envizen"],[F,se]],[/\b(trio[-\w\. ]+) b/i],[S,[B,"MachSpeed"],[F,se]],[/\btu_(1491) b/i],[S,[B,"Rotor"],[F,se]],[/(shield[\w ]+) b/i],[S,[B,"Nvidia"],[F,se]],[/(sprint) (\w+)/i],[B,S,[F,G]],[/(kin\.[onetw]{3})/i],[[S,/\./g," "],[B,_t],[F,G]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[S,[B,Bt],[F,se]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[S,[B,Bt],[F,G]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[B,S,[F,j]],[/droid.+; (shield) bui/i],[S,[B,"Nvidia"],[F,j]],[/(playstation [345portablevi]+)/i],[S,[B,cn],[F,j]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[S,[B,_t],[F,j]],[/smart-tv.+(samsung)/i],[B,[F,he]],[/hbbtv.+maple;(\d+)/i],[[S,/^/,"SmartTV"],[B,tn],[F,he]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[B,et],[F,he]],[/(apple) ?tv/i],[B,[S,xe+" TV"],[F,he]],[/crkey/i],[[S,ot+"cast"],[B,yn],[F,he]],[/droid.+aft(\w)( bui|\))/i],[S,[B,Ve],[F,he]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[S,[B,$t],[F,he]],[/(bravia[\w ]+)( bui|\))/i],[S,[B,cn],[F,he]],[/(mitv-\w{5}) bui/i],[S,[B,sn],[F,he]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[B,kr],[S,kr],[F,he]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[F,he]],[/((pebble))app/i],[B,S,[F,ye]],[/droid.+; (glass) \d/i],[S,[B,yn],[F,ye]],[/droid.+; (wt63?0{2,3})\)/i],[S,[B,Bt],[F,ye]],[/(quest( 2)?)/i],[S,[B,fn],[F,ye]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[B,[F,we]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[S,[F,G]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[S,[F,se]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[F,se]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[F,G]],[/(android[-\w\. ]{0,9});.+buil/i],[S,[B,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[Q,[z,zt+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[Q,[z,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[z,Q],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[Q,z]],os:[[/microsoft (windows) (vista|xp)/i],[z,Q],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[z,[Q,Hn,jn]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[z,"Windows"],[Q,Hn,jn]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[Q,/_/g,"."],[z,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[z,"Mac OS"],[Q,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[Q,z],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[z,Q],[/\(bb(10);/i],[Q,[z,wt]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[Q,[z,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[Q,[z,Qe+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[Q,[z,"webOS"]],[/crkey\/([\d\.]+)/i],[Q,[z,ot+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[z,"Chromium OS"],Q],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[z,Q],[/(sunos) ?([\w\.\d]*)/i],[[z,"Solaris"],Q],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[z,Q]]},On=function(Wt,nn){if(typeof Wt===w&&(nn=Wt,Wt=r),!(this instanceof On))return new On(Wt,nn).getResult();var Nt=Wt||(typeof n!==v&&n.navigator&&n.navigator.userAgent?n.navigator.userAgent:l),Sn=nn?jt(Jt,nn):Jt;return this.getBrowser=function(){var Ut={};return Ut[z]=r,Ut[Q]=r,or.call(Ut,Nt,Sn.browser),Ut.major=Vn(Ut.version),Ut},this.getCPU=function(){var Ut={};return Ut[q]=r,or.call(Ut,Nt,Sn.cpu),Ut},this.getDevice=function(){var Ut={};return Ut[B]=r,Ut[S]=r,Ut[F]=r,or.call(Ut,Nt,Sn.device),Ut},this.getEngine=function(){var Ut={};return Ut[z]=r,Ut[Q]=r,or.call(Ut,Nt,Sn.engine),Ut},this.getOS=function(){var Ut={};return Ut[z]=r,Ut[Q]=r,or.call(Ut,Nt,Sn.os),Ut},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return Nt},this.setUA=function(Ut){return Nt=typeof Ut===C&&Ut.length>Be?kr(Ut,Be):Ut,this},this.setUA(Nt),this};On.VERSION=s,On.BROWSER=Kt([z,Q,I]),On.CPU=Kt([q]),On.DEVICE=Kt([S,B,F,j,G,he,se,ye,we]),On.ENGINE=On.OS=Kt([z,Q]),t.exports&&(e=t.exports=On),e.UAParser=On;var kn=typeof n!==v&&(n.jQuery||n.Zepto);if(kn&&!kn.ua){var ti=new On;kn.ua=ti.getResult(),kn.ua.get=function(){return ti.getUA()},kn.ua.set=function(Wt){ti.setUA(Wt);var nn=ti.getResult();for(var Nt in nn)kn.ua[Nt]=nn[Nt]}}})(typeof window=="object"?window:gS)})(px,px.exports);Object.defineProperty(Tt,"__esModule",{value:!0});function vH(t){return t&&typeof t=="object"&&"default"in t?t.default:t}var Ai=Ie.exports,nr=vH(Ai),ck=px.exports,kl=new ck,Ci=kl.getBrowser(),xH=kl.getCPU(),Is=kl.getDevice(),Q1=kl.getEngine(),Ml=kl.getOS(),Qf=kl.getUA(),uk=function(e){return kl.setUA(e)},ep=function(e){if(!e){console.error("No userAgent string was provided");return}var n=new ck(e);return{UA:n,browser:n.getBrowser(),cpu:n.getCPU(),device:n.getDevice(),engine:n.getEngine(),os:n.getOS(),ua:n.getUA(),setUserAgent:function(s){return n.setUA(s)}}},hk=Object.freeze({ClientUAInstance:kl,browser:Ci,cpu:xH,device:Is,engine:Q1,os:Ml,ua:Qf,setUa:uk,parseUserAgent:ep});function uS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function bH(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?uS(Object(n),!0).forEach(function(r){TH(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):uS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function nf(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?nf=function(e){return typeof e}:nf=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nf(t)}function wH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hS(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function EH(t,e,n){return e&&hS(t.prototype,e),n&&hS(t,n),t}function TH(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mx(){return mx=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},mx.apply(this,arguments)}function SH(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yx(t,e)}function gx(t){return gx=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},gx(t)}function yx(t,e){return yx=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},yx(t,e)}function AH(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,l;for(l=0;l<r.length;l++)s=r[l],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function Zs(t,e){if(t==null)return{};var n=AH(t,e),r,s;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(s=0;s<l.length;s++)r=l[s],!(e.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,r)||(n[r]=t[r]))}return n}function ig(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PH(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ig(t)}function CH(t,e){return IH(t)||kH(t,e)||MH(t,e)||LH()}function IH(t){if(Array.isArray(t))return t}function kH(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r=[],s=!0,l=!1,d,c;try{for(n=n.call(t);!(s=(d=n.next()).done)&&(r.push(d.value),!(e&&r.length===e));s=!0);}catch(v){l=!0,c=v}finally{try{!s&&n.return!=null&&n.return()}finally{if(l)throw c}}return r}}function MH(t,e){if(!!t){if(typeof t=="string")return dS(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dS(t,e)}}function dS(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function LH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ei={Mobile:"mobile",Tablet:"tablet",SmartTv:"smarttv",Console:"console",Wearable:"wearable",Embedded:"embedded",Browser:void 0},ss={Chrome:"Chrome",Firefox:"Firefox",Opera:"Opera",Yandex:"Yandex",Safari:"Safari",InternetExplorer:"Internet Explorer",Edge:"Edge",Chromium:"Chromium",Ie:"IE",MobileSafari:"Mobile Safari",EdgeChromium:"Edge Chromium",MIUI:"MIUI Browser",SamsungBrowser:"Samsung Browser"},xh={IOS:"iOS",Android:"Android",WindowsPhone:"Windows Phone",Windows:"Windows",MAC_OS:"Mac OS"},RH={isMobile:!1,isTablet:!1,isBrowser:!1,isSmartTV:!1,isConsole:!1,isWearable:!1},OH=function(e){switch(e){case Ei.Mobile:return{isMobile:!0};case Ei.Tablet:return{isTablet:!0};case Ei.SmartTv:return{isSmartTV:!0};case Ei.Console:return{isConsole:!0};case Ei.Wearable:return{isWearable:!0};case Ei.Browser:return{isBrowser:!0};case Ei.Embedded:return{isEmbedded:!0};default:return RH}},DH=function(e){return uk(e)},Gt=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none";return e||n},eb=function(){return typeof window<"u"&&(window.navigator||navigator)?window.navigator||navigator:!1},tb=function(e){var n=eb();return n&&n.platform&&(n.platform.indexOf(e)!==-1||n.platform==="MacIntel"&&n.maxTouchPoints>1&&!window.MSStream)},zH=function(e,n,r,s,l){return{isBrowser:e,browserMajorVersion:Gt(n.major),browserFullVersion:Gt(n.version),browserName:Gt(n.name),engineName:Gt(r.name),engineVersion:Gt(r.version),osName:Gt(s.name),osVersion:Gt(s.version),userAgent:Gt(l)}},fS=function(e,n,r,s){return bH({},e,{vendor:Gt(n.vendor),model:Gt(n.model),os:Gt(r.name),osVersion:Gt(r.version),ua:Gt(s)})},FH=function(e,n,r,s){return{isSmartTV:e,engineName:Gt(n.name),engineVersion:Gt(n.version),osName:Gt(r.name),osVersion:Gt(r.version),userAgent:Gt(s)}},BH=function(e,n,r,s){return{isConsole:e,engineName:Gt(n.name),engineVersion:Gt(n.version),osName:Gt(r.name),osVersion:Gt(r.version),userAgent:Gt(s)}},NH=function(e,n,r,s){return{isWearable:e,engineName:Gt(n.name),engineVersion:Gt(n.version),osName:Gt(r.name),osVersion:Gt(r.version),userAgent:Gt(s)}},UH=function(e,n,r,s,l){return{isEmbedded:e,vendor:Gt(n.vendor),model:Gt(n.model),engineName:Gt(r.name),engineVersion:Gt(r.version),osName:Gt(s.name),osVersion:Gt(s.version),userAgent:Gt(l)}};function VH(t){var e=t?ep(t):hk,n=e.device,r=e.browser,s=e.engine,l=e.os,d=e.ua,c=OH(n.type),v=c.isBrowser,w=c.isMobile,C=c.isTablet,I=c.isSmartTV,S=c.isConsole,z=c.isWearable,F=c.isEmbedded;if(v)return zH(v,r,s,l,d);if(I)return FH(I,s,l,d);if(S)return BH(S,s,l,d);if(w||C)return fS(c,n,l,d);if(z)return NH(z,s,l,d);if(F)return UH(F,n,s,l,d)}var dk=function(e){var n=e.type;return n===Ei.Mobile},fk=function(e){var n=e.type;return n===Ei.Tablet},pk=function(e){var n=e.type;return n===Ei.Mobile||n===Ei.Tablet},mk=function(e){var n=e.type;return n===Ei.SmartTv},qg=function(e){var n=e.type;return n===Ei.Browser},gk=function(e){var n=e.type;return n===Ei.Wearable},yk=function(e){var n=e.type;return n===Ei.Console},_k=function(e){var n=e.type;return n===Ei.Embedded},vk=function(e){var n=e.vendor;return Gt(n)},xk=function(e){var n=e.model;return Gt(n)},bk=function(e){var n=e.type;return Gt(n,"browser")},wk=function(e){var n=e.name;return n===xh.Android},Ek=function(e){var n=e.name;return n===xh.Windows},Tk=function(e){var n=e.name;return n===xh.MAC_OS},Sk=function(e){var n=e.name;return n===xh.WindowsPhone},Ak=function(e){var n=e.name;return n===xh.IOS},Pk=function(e){var n=e.version;return Gt(n)},Ck=function(e){var n=e.name;return Gt(n)},Ik=function(e){var n=e.name;return n===ss.Chrome},kk=function(e){var n=e.name;return n===ss.Firefox},Mk=function(e){var n=e.name;return n===ss.Chromium},Xg=function(e){var n=e.name;return n===ss.Edge},Lk=function(e){var n=e.name;return n===ss.Yandex},Rk=function(e){var n=e.name;return n===ss.Safari||n===ss.MobileSafari},Ok=function(e){var n=e.name;return n===ss.MobileSafari},Dk=function(e){var n=e.name;return n===ss.Opera},zk=function(e){var n=e.name;return n===ss.InternetExplorer||n===ss.Ie},Fk=function(e){var n=e.name;return n===ss.MIUI},Bk=function(e){var n=e.name;return n===ss.SamsungBrowser},Nk=function(e){var n=e.version;return Gt(n)},Uk=function(e){var n=e.major;return Gt(n)},Vk=function(e){var n=e.name;return Gt(n)},jk=function(e){var n=e.name;return Gt(n)},Gk=function(e){var n=e.version;return Gt(n)},$k=function(){var e=eb(),n=e&&e.userAgent&&e.userAgent.toLowerCase();return typeof n=="string"?/electron/.test(n):!1},qu=function(e){return typeof e=="string"&&e.indexOf("Edg/")!==-1},Wk=function(){var e=eb();return e&&(/iPad|iPhone|iPod/.test(e.platform)||e.platform==="MacIntel"&&e.maxTouchPoints>1)&&!window.MSStream},Bo=function(){return tb("iPad")},Hk=function(){return tb("iPhone")},qk=function(){return tb("iPod")},Xk=function(e){return Gt(e)};function Zk(t){var e=t||hk,n=e.device,r=e.browser,s=e.os,l=e.engine,d=e.ua;return{isSmartTV:mk(n),isConsole:yk(n),isWearable:gk(n),isEmbedded:_k(n),isMobileSafari:Ok(r)||Bo(),isChromium:Mk(r),isMobile:pk(n)||Bo(),isMobileOnly:dk(n),isTablet:fk(n)||Bo(),isBrowser:qg(n),isDesktop:qg(n),isAndroid:wk(s),isWinPhone:Sk(s),isIOS:Ak(s)||Bo(),isChrome:Ik(r),isFirefox:kk(r),isSafari:Rk(r),isOpera:Dk(r),isIE:zk(r),osVersion:Pk(s),osName:Ck(s),fullBrowserVersion:Nk(r),browserVersion:Uk(r),browserName:Vk(r),mobileVendor:vk(n),mobileModel:xk(n),engineName:jk(l),engineVersion:Gk(l),getUA:Xk(d),isEdge:Xg(r)||qu(d),isYandex:Lk(r),deviceType:bk(n),isIOS13:Wk(),isIPad13:Bo(),isIPhone13:Hk(),isIPod13:qk(),isElectron:$k(),isEdgeChromium:qu(d),isLegacyEdge:Xg(r)&&!qu(d),isWindows:Ek(s),isMacOs:Tk(s),isMIUI:Fk(r),isSamsungBrowser:Bk(r)}}var Yk=mk(Is),Kk=yk(Is),Jk=gk(Is),jH=_k(Is),GH=Ok(Ci)||Bo(),$H=Mk(Ci),Iy=pk(Is)||Bo(),Qk=dk(Is),eM=fk(Is)||Bo(),tM=qg(Is),WH=qg(Is),nM=wk(Ml),rM=Sk(Ml),iM=Ak(Ml)||Bo(),HH=Ik(Ci),qH=kk(Ci),XH=Rk(Ci),ZH=Dk(Ci),sM=zk(Ci),YH=Pk(Ml),KH=Ck(Ml),JH=Nk(Ci),QH=Uk(Ci),eq=Vk(Ci),tq=vk(Is),nq=xk(Is),rq=jk(Q1),iq=Gk(Q1),sq=Xk(Qf),oq=Xg(Ci)||qu(Qf),aq=Lk(Ci),lq=bk(Is),cq=Wk(),uq=Bo(),hq=Hk(),dq=qk(),fq=$k(),pq=qu(Qf),mq=Xg(Ci)&&!qu(Qf),gq=Ek(Ml),yq=Tk(Ml),_q=Fk(Ci),vq=Bk(Ci),xq=function(e){if(!e||typeof e!="string"){console.error("No valid user agent string was provided");return}var n=ep(e),r=n.device,s=n.browser,l=n.os,d=n.engine,c=n.ua;return Zk({device:r,browser:s,os:l,engine:d,ua:c})},bq=function(e){var n=e.renderWithFragment,r=e.children,s=Zs(e,["renderWithFragment","children"]);return nM?n?nr.createElement(Ai.Fragment,null,r):nr.createElement("div",s,r):null},wq=function(e){var n=e.renderWithFragment,r=e.children,s=Zs(e,["renderWithFragment","children"]);return tM?n?nr.createElement(Ai.Fragment,null,r):nr.createElement("div",s,r):null},Eq=function(e){var n=e.renderWithFragment,r=e.children,s=Zs(e,["renderWithFragment","children"]);return sM?n?nr.createElement(Ai.Fragment,null,r):nr.createElement("div",s,r):null},Tq=function(e){var n=e.renderWithFragment,r=e.children,s=Zs(e,["renderWithFragment","children"]);return iM?n?nr.createElement(Ai.Fragment,null,r):nr.createElement("div",s,r):null},Sq=function(e){var n=e.renderWithFragment,r=e.children,s=Zs(e,["renderWithFragment","children"]);return Iy?n?nr.createElement(Ai.Fragment,null,r):nr.createElement("div",s,r):null},Aq=function(e){var n=e.renderWithFragment,r=e.children,s=Zs(e,["renderWithFragment","children"]);return eM?n?nr.createElement(Ai.Fragment,null,r):nr.createElement("div",s,r):null},Pq=function(e){var n=e.renderWithFragment,r=e.children,s=Zs(e,["renderWithFragment","children"]);return rM?n?nr.createElement(Ai.Fragment,null,r):nr.createElement("div",s,r):null},Cq=function(e){var n=e.renderWithFragment,r=e.children;e.viewClassName,e.style;var s=Zs(e,["renderWithFragment","children","viewClassName","style"]);return Qk?n?nr.createElement(Ai.Fragment,null,r):nr.createElement("div",s,r):null},Iq=function(e){var n=e.renderWithFragment,r=e.children,s=Zs(e,["renderWithFragment","children"]);return Yk?n?nr.createElement(Ai.Fragment,null,r):nr.createElement("div",s,r):null},kq=function(e){var n=e.renderWithFragment,r=e.children,s=Zs(e,["renderWithFragment","children"]);return Kk?n?nr.createElement(Ai.Fragment,null,r):nr.createElement("div",s,r):null},Mq=function(e){var n=e.renderWithFragment,r=e.children,s=Zs(e,["renderWithFragment","children"]);return Jk?n?nr.createElement(Ai.Fragment,null,r):nr.createElement("div",s,r):null},Lq=function(e){var n=e.renderWithFragment,r=e.children;e.viewClassName,e.style;var s=e.condition,l=Zs(e,["renderWithFragment","children","viewClassName","style","condition"]);return s?n?nr.createElement(Ai.Fragment,null,r):nr.createElement("div",l,r):null};function Rq(t){return function(e){SH(n,e);function n(r){var s;return wH(this,n),s=PH(this,gx(n).call(this,r)),s.isEventListenerAdded=!1,s.handleOrientationChange=s.handleOrientationChange.bind(ig(s)),s.onOrientationChange=s.onOrientationChange.bind(ig(s)),s.onPageLoad=s.onPageLoad.bind(ig(s)),s.state={isLandscape:!1,isPortrait:!1},s}return EH(n,[{key:"handleOrientationChange",value:function(){this.isEventListenerAdded||(this.isEventListenerAdded=!0);var s=window.innerWidth>window.innerHeight?90:0;this.setState({isPortrait:s===0,isLandscape:s===90})}},{key:"onOrientationChange",value:function(){this.handleOrientationChange()}},{key:"onPageLoad",value:function(){this.handleOrientationChange()}},{key:"componentDidMount",value:function(){(typeof window>"u"?"undefined":nf(window))!==void 0&&Iy&&(this.isEventListenerAdded?window.removeEventListener("load",this.onPageLoad,!1):(this.handleOrientationChange(),window.addEventListener("load",this.onPageLoad,!1)),window.addEventListener("resize",this.onOrientationChange,!1))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onOrientationChange,!1)}},{key:"render",value:function(){return nr.createElement(t,mx({},this.props,{isLandscape:this.state.isLandscape,isPortrait:this.state.isPortrait}))}}]),n}(nr.Component)}function Oq(){var t=Ai.useState(function(){var l=window.innerWidth>window.innerHeight?90:0;return{isPortrait:l===0,isLandscape:l===90,orientation:l===0?"portrait":"landscape"}}),e=CH(t,2),n=e[0],r=e[1],s=Ai.useCallback(function(){var l=window.innerWidth>window.innerHeight?90:0,d={isPortrait:l===0,isLandscape:l===90,orientation:l===0?"portrait":"landscape"};n.orientation!==d.orientation&&r(d)},[n.orientation]);return Ai.useEffect(function(){return(typeof window>"u"?"undefined":nf(window))!==void 0&&Iy&&(s(),window.addEventListener("load",s,!1),window.addEventListener("resize",s,!1)),function(){window.removeEventListener("resize",s,!1),window.removeEventListener("load",s,!1)}},[s]),n}function oM(t){var e=t||window.navigator.userAgent;return ep(e)}function Dq(t){var e=t||window.navigator.userAgent,n=oM(e),r=Zk(n);return[r,n]}Tt.AndroidView=bq;Tt.BrowserTypes=ss;Tt.BrowserView=wq;Tt.ConsoleView=kq;Tt.CustomView=Lq;Tt.IEView=Eq;Tt.IOSView=Tq;Tt.MobileOnlyView=Cq;Tt.MobileView=Sq;Tt.OsTypes=xh;Tt.SmartTVView=Iq;Tt.TabletView=Aq;Tt.WearableView=Mq;Tt.WinPhoneView=Pq;Tt.browserName=eq;Tt.browserVersion=QH;Tt.deviceDetect=VH;Tt.deviceType=lq;Tt.engineName=rq;Tt.engineVersion=iq;Tt.fullBrowserVersion=JH;Tt.getSelectorsByUserAgent=xq;Tt.getUA=sq;Tt.isAndroid=nM;Tt.isBrowser=tM;Tt.isChrome=HH;Tt.isChromium=$H;Tt.isConsole=Kk;Tt.isDesktop=WH;Tt.isEdge=oq;Tt.isEdgeChromium=pq;Tt.isElectron=fq;Tt.isEmbedded=jH;Tt.isFirefox=qH;Tt.isIE=sM;Tt.isIOS=iM;Tt.isIOS13=cq;Tt.isIPad13=uq;Tt.isIPhone13=hq;Tt.isIPod13=dq;Tt.isLegacyEdge=mq;Tt.isMIUI=_q;Tt.isMacOs=yq;var pS=Tt.isMobile=Iy;Tt.isMobileOnly=Qk;Tt.isMobileSafari=GH;Tt.isOpera=ZH;Tt.isSafari=XH;Tt.isSamsungBrowser=vq;Tt.isSmartTV=Yk;Tt.isTablet=eM;Tt.isWearable=Jk;Tt.isWinPhone=rM;Tt.isWindows=gq;Tt.isYandex=aq;Tt.mobileModel=nq;Tt.mobileVendor=tq;Tt.osName=KH;Tt.osVersion=YH;Tt.parseUserAgent=ep;Tt.setUserAgent=DH;Tt.useDeviceData=oM;Tt.useDeviceSelectors=Dq;Tt.useMobileOrientation=Oq;Tt.withOrientationChange=Rq;function zq({name:t,description:e,fileName:n,width:r,height:s}){return ch(nW,{children:[hn(gW,{component:"img",image:"/images/original/"+n,alt:"",width:r*3,height:s*3}),ch(lW,{children:[hn(eS,{gutterBottom:!0,variant:"h5",component:"div",children:t}),hn(eS,{variant:"body2",color:"text.secondary",children:e})]})]})}const Fq={latitude:40.132527,longitude:-4.114423,zoom:5.5,pitch:0,bearing:0,dragRotate:!1},Bq=_H.map(({location:t,driveId:e,...n})=>({...n,coordinates:t.split(",").reverse().map(Number)}));function Nq(){typeof navigator<"u"&&/iPad|iPhone|iPod/.test(navigator.userAgent);const[t,e]=Ie.exports.useState(null),[n,r]=Ie.exports.useState(null),s=[new z1({id:"images-layer",visible:!0,pickable:!0,data:Bq,getIcon:l=>({url:`images/${l.id===(t==null?void 0:t.id)?"original":"reduced"}/${l.fileName}`,width:l.width*(l.id===(t==null?void 0:t.id)?5:1),height:l.height*(l.id===(t==null?void 0:t.id)?5:1)}),sizeScale:3,getSize:l=>l.id===(t==null?void 0:t.id)?100:25,getPosition:l=>l.coordinates,onHover:l=>e(l==null?void 0:l.object),onClick:l=>r((l==null?void 0:l.object)||null),updateTriggers:{getIcon:t,getSize:t}})];return ch(H8,{initialViewState:Fq,controller:!0,layers:s,children:[hn(J1,{reuseMaps:!0,mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",mapLib:qW}),hn(HW,{variant:"persistent",anchor:pS?"bottom":"left",open:!!n,onClose:()=>r(null),onOpen:()=>{},hideBackdrop:!0,children:hn(a7,{sx:{width:pS?"100%":"500px"},role:"presentation",children:n&&hn(zq,{...n})})})]})}U0.createRoot(document.getElementById("root")).render(hn(Fu.StrictMode,{children:hn(Nq,{})}));export{gS as c};
